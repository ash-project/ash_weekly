# ash

> A declarative, extensible framework for building Elixir applications.

## Docs

### Ash.CodeInterface (module)

Used to define the functions of a code interface for a resource.

### Ash.CodeInterface.define_interface/3 (macro)

Defines the code interface for a given resource + domain combination in the current module. For example:

```elixir
defmodule MyApp.Accounting do
  require Ash.CodeInterface

  Ash.CodeInterface.define_interface(MyApp.Accounting, MyApp.Accounting.Transaction)
  Ash.CodeInterface.define_interface(MyApp.Accounting, MyApp.Accounting.Account)
  Ash.CodeInterface.define_interface(MyApp.Accounting, MyApp.Accounting.Invoice)
end
```

### Ash.CodeInterface.params_and_opts/3 (function)

See `params_and_opts/2`.

Adds a post process function that can takes the opts and can further process,
validate, or transform them.

### Ash.DataLayer (behaviour)

The behaviour for backing resource actions with persistence layers.

### Ash.DataLayer.add_aggregate/3 (callback)



### Ash.DataLayer.add_aggregates/3 (function)



### Ash.DataLayer.add_aggregates/3 (callback)



### Ash.DataLayer.add_calculation/4 (callback)



### Ash.DataLayer.add_calculations/3 (function)



### Ash.DataLayer.add_calculations/3 (callback)



### Ash.DataLayer.bulk_create/3 (function)



### Ash.DataLayer.bulk_create/3 (callback)



### Ash.DataLayer.bulk_create_options/0 (type)



### Ash.DataLayer.bulk_update_options/0 (type)



### Ash.DataLayer.calculate/3 (function)



### Ash.DataLayer.calculate/3 (callback)



### Ash.DataLayer.can?/2 (function)



### Ash.DataLayer.can?/2 (callback)



### Ash.DataLayer.combination_of/3 (function)



### Ash.DataLayer.combination_of/3 (callback)



### Ash.DataLayer.combination_type/0 (type)



### Ash.DataLayer.create/2 (function)



### Ash.DataLayer.create/2 (callback)



### Ash.DataLayer.data_layer/1 (function)

The data layer of the resource, or nil if it does not have one

### Ash.DataLayer.data_layer_can?/2 (function)

Whether or not the data layer supports a specific feature

### Ash.DataLayer.data_layer_functions/1 (function)

Custom functions supported by the data layer of the resource

### Ash.DataLayer.data_layer_query/0 (type)



### Ash.DataLayer.destroy/2 (function)



### Ash.DataLayer.destroy/2 (callback)



### Ash.DataLayer.destroy_query/3 (function)



### Ash.DataLayer.destroy_query/4 (callback)



### Ash.DataLayer.distinct/3 (function)



### Ash.DataLayer.distinct/3 (callback)



### Ash.DataLayer.distinct_sort/3 (function)



### Ash.DataLayer.distinct_sort/3 (callback)



### Ash.DataLayer.feature/0 (type)



### Ash.DataLayer.filter/3 (function)



### Ash.DataLayer.filter/3 (callback)



### Ash.DataLayer.functions/1 (function)



### Ash.DataLayer.functions/1 (callback)



### Ash.DataLayer.in_transaction?/1 (function)



### Ash.DataLayer.in_transaction?/1 (callback)



### Ash.DataLayer.lateral_join_link/0 (type)



### Ash.DataLayer.limit/3 (function)



### Ash.DataLayer.limit/3 (callback)



### Ash.DataLayer.lock/3 (function)



### Ash.DataLayer.lock/3 (callback)



### Ash.DataLayer.lock_type/0 (type)



### Ash.DataLayer.offset/3 (function)



### Ash.DataLayer.offset/3 (callback)



### Ash.DataLayer.prefer_lateral_join_for_many_to_many?/0 (callback)



### Ash.DataLayer.prefer_lateral_join_for_many_to_many?/1 (function)

Whether or not lateral joins should be used for many to many relationships by default

### Ash.DataLayer.prefer_transaction?/1 (function)



### Ash.DataLayer.prefer_transaction?/1 (callback)



### Ash.DataLayer.prefer_transaction_for_atomic_updates?/1 (function)



### Ash.DataLayer.prefer_transaction_for_atomic_updates?/1 (callback)



### Ash.DataLayer.resource_to_query/2 (function)



### Ash.DataLayer.resource_to_query/2 (callback)



### Ash.DataLayer.return_query/2 (function)



### Ash.DataLayer.return_query/2 (callback)



### Ash.DataLayer.rollback/2 (function)

Rolls back the current transaction

### Ash.DataLayer.rollback/2 (callback)



### Ash.DataLayer.run_aggregate_query/3 (function)



### Ash.DataLayer.run_aggregate_query/3 (callback)



### Ash.DataLayer.run_aggregate_query_with_lateral_join/5 (function)



### Ash.DataLayer.run_aggregate_query_with_lateral_join/5 (callback)



### Ash.DataLayer.run_query/2 (function)



### Ash.DataLayer.run_query/2 (callback)



### Ash.DataLayer.run_query_with_lateral_join/4 (function)



### Ash.DataLayer.run_query_with_lateral_join/4 (callback)



### Ash.DataLayer.select/3 (function)



### Ash.DataLayer.select/3 (callback)



### Ash.DataLayer.set_context/3 (function)



### Ash.DataLayer.set_context/3 (callback)



### Ash.DataLayer.set_tenant/3 (function)



### Ash.DataLayer.set_tenant/3 (callback)



### Ash.DataLayer.sort/3 (function)



### Ash.DataLayer.sort/3 (callback)



### Ash.DataLayer.source/1 (function)



### Ash.DataLayer.source/1 (callback)



### Ash.DataLayer.t/0 (type)



### Ash.DataLayer.transaction/4 (function)

Wraps the execution of the function in a transaction with the resource's data_layer

### Ash.DataLayer.transaction/4 (callback)



### Ash.DataLayer.transaction_reason/0 (type)



### Ash.DataLayer.transform_query/1 (function)



### Ash.DataLayer.transform_query/1 (callback)



### Ash.DataLayer.update/2 (function)



### Ash.DataLayer.update/2 (callback)



### Ash.DataLayer.update_query/3 (function)



### Ash.DataLayer.update_query/4 (callback)



### Ash.DataLayer.upsert/3 (callback)



### Ash.DataLayer.upsert/4 (function)



### Ash.DataLayer.upsert/4 (callback)



### Ash.Notifier (behaviour)

A notifier is an extension that receives various events

### Ash.Notifier.notify/1 (function)

Sends any notifications that can be sent, and returns the rest.

A notification can only be sent if you are not currently in a transaction
for the resource in question.

### Ash.Notifier.notify/1 (callback)



### Ash.Notifier.requires_original_data?/2 (callback)



### Ash.Notifier.Notification (module)

Represents a notification that will be handled by a resource's notifiers

Set the `for` key to a notifier or a list of notifiers to route the notification
to them. This allows you to produce notifications inside of a `change` module
and target specific notifiers with them.

`metadata` is freeform data to be set however you want. `resource`, `action`, `data`,
`changeset` and `actor` are all set by default based on the details of the action, so
they can be omitted.

When creating a notification, a resource is required to ensure that the notification isn't
sent until the current transaction for that resource is closed. If you don't need this
behavior you can explicitly supply `nil` for the resource. If you supply `nil` for the resource,
however, you must manually set the `for` option, e.g: `for: Notifier` or `for: [Notifier1, Notifier2]`

### Ash.Notifier.Notification.new/2 (function)



### Ash.Notifier.Notification.t/0 (type)



### Ash.Resource.Attribute.Helpers (module)

Helpers for building attributes

### Ash.Resource.Attribute.Helpers.timestamps/1 (macro)

Defines create and update timestamp attributes.

Shorthand for `d:Ash.Resource.Dsl.attributes.create_timestamp` and
`d:Ash.Resource.Dsl.attributes.update_timestamp` with the attribute names
`:inserted_at` and `:updated_at` respectively.  Any options passed to this
helper are passed to both timestamp macros.

### Ash.Resource.Calculation (behaviour)

The behaviour for defining a module calculation, and the struct for storing a defined calculation.

### Ash.Resource.Calculation.calculate/3 (callback)



### Ash.Resource.Calculation.describe/1 (callback)



### Ash.Resource.Calculation.expression/2 (callback)



### Ash.Resource.Calculation.has_expression?/0 (callback)



### Ash.Resource.Calculation.init/1 (callback)



### Ash.Resource.Calculation.init/2 (function)



### Ash.Resource.Calculation.load/3 (callback)



### Ash.Resource.Calculation.opts/0 (type)



### Ash.Resource.Calculation.ref/0 (type)



### Ash.Resource.Calculation.schema/0 (function)



### Ash.Resource.Calculation.strict_loads?/0 (callback)



### Ash.Resource.Calculation.t/0 (type)



### Ash.Resource.Calculation.Builtins (module)

Built in calculations that are automatically imported in the calculations section

### Ash.Resource.Calculation.Builtins.concat/2 (function)

An example concatenation calculation, that accepts the delimiter as an argument

### Examples - Ash.Resource.Calculation.Builtins.concat/2 (function)

calculate :full_name, :string, concat([:first_name, :last_name], " ")

### Ash.Resource.ManualCreate (behaviour)

A module to implement manual create actions.

### Ash.Resource.ManualCreate.bulk_create/3 (callback)



### Ash.Resource.ManualCreate.create/3 (callback)



### Ash.Resource.ManualDestroy (behaviour)

A module to implement manual destroy actions.

Note that in the returns of these functions you must return the destroyed record or records.

### Ash.Resource.ManualDestroy.bulk_destroy/3 (callback)



### Ash.Resource.ManualDestroy.destroy/3 (callback)



### Ash.Resource.ManualRead (behaviour)

A module to implement manual read actions.

### Ash.Resource.ManualRead.context/0 (type)



### Ash.Resource.ManualRead.extra_info/0 (type)



### Ash.Resource.ManualRead.load_relationships/5 (callback)



### Ash.Resource.ManualRead.read/4 (callback)



### Ash.Resource.ManualRelationship (behaviour)

A module to implement manual relationships.

### Ash.Resource.ManualRelationship.load/3 (callback)



### Ash.Resource.ManualRelationship.select/1 (callback)



### Ash.Resource.ManualUpdate (behaviour)

A module to implement manual update actions.

### Ash.Resource.ManualUpdate.bulk_update/3 (callback)



### Ash.Resource.ManualUpdate.update/3 (callback)



### Ash (module)

The primary interface to call actions and interact with resources.

### Ash.actor/0 (type)



### Ash.aggregate/0 (type)



### Ash.aggregate/3 (function)

Runs an aggregate or aggregates over a resource query

If you pass an `%Ash.Query.Aggregate{}`, gotten from `Ash.Query.Aggregate.new()`,
the query provided as the first argument to this function will not apply. For this
reason, it is preferred that you pass in the tuple format, i.e

Prefer this:
`Api.aggregate(query, {:count_of_things, :count})`

Over this:
`Api.aggregate(query, Ash.Query.Aggregate.new(...))`

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

### Ash.aggregate!/3 (function)

Runs an aggregate or aggregates over a resource query. See `aggregate/3` for more.

### Ash.avg/3 (function)

Fetches the average of all values of a given field.

### Ash.avg!/3 (function)

Fetches the average of all values of a given field or raises an error.

### Ash.bulk_create/4 (function)

Creates many records.

### Assumptions - Ash.bulk_create/4 (function)

We assume that the input is a list of changesets all for the same action, or a list of input maps for the
same action with the `:resource` and `:action` option provided to illustrate which action it is for.

### Performance/Feasibility - Ash.bulk_create/4 (function)

The performance of this operation depends on the data layer in question.
Data layers like AshPostgres will choose reasonable batch sizes in an attempt
to handle large bulk actions, but that does not mean that you can pass a list of
500k inputs and expect things to go off without a hitch (although it might).
If you need to do large data processing, you should look into projects like
GenStage and Broadway. With that said, if you want to do things like support CSV upload
and you place some reasonable limits on the size this is a great tool. You'll need to
test it yourself, YMMV.

Passing `return_records?: true` can significantly increase the time it takes to perform the operation,
and can also make the operation completely unreasonable due to the memory requirement. If you want to
do very large bulk creates and display all of the results, the suggestion is to annotate them with a
"bulk_create_id" in the data layer, and then read the records with that `bulk_create_id` so that they can
be retrieved later if necessary.

### Changes/Validations - Ash.bulk_create/4 (function)

Changes will be applied in the order they are given on the actions as normal. Any change that exposes
the `bulk_change` callbacks will be applied on the entire list.

### After Action Hooks - Ash.bulk_create/4 (function)

The following requirements must be met for `after_action` hooks to function properly. If they are not met,
and an after_action hook being applied to a changeset in a `change`.

1. `return_records?` must be set to `true`.
2. The changeset must be setting the primary key as part of its changes, so that we know which result applies to which
   changeset.

It is possible to use `after_action` hooks with `bulk_change/3`, but you need to return the hooks along with the changesets.
This allows for setting up `after_action` hooks that don't need access to the returned record,
or `after_action` hooks that can operate on the entire list at once.  See the documentation for that callback for more on
how to do accomplish that.

### Options - Ash.bulk_create/4 (function)

* `:upsert?` (`t:boolean/0`) - If a conflict is found based on the primary key, the record is updated in the database (requires upsert support) The default value is `false`.

* `:upsert_identity` (`t:atom/0`) - The identity to use when detecting conflicts for `upsert?`, e.g. `upsert_identity: :full_name`. By default, the primary key is used. Has no effect if `upsert?: true` is not provided

* `:upsert_fields` - The fields to upsert. If not set, the action's `upsert_fields` is used. Unlike singular `create`, `bulk_create` with `upsert?` requires that `upsert_fields` be specified explicitly in one of these two locations.

* `:after_action` (function of arity 2) - An after_action hook to be added to each processed changeset

* `:upsert_condition` (`t:term/0`) - An expression to check if the record should be updated when there's a conflict.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

* `:return_notifications?` (`t:boolean/0`) - Use this if you're running ash actions in your own transaction and you want to manually handle sending notifications.  
  If a transaction is ongoing, and this is false, notifications will be discarded, otherwise
  the return value is `{:ok, result, notifications}` (or `{:ok, notifications}`)  
  To send notifications later, use `Ash.Notifier.notify(notifications)`. It sends any notifications
  that can be sent, and returns the rest. The default value is `false`.

* `:rollback_on_error?` (`t:boolean/0`) - Whether or not to rollback the transaction on error, if the resource is in a transaction.  
  If the action has `transaction? false` this option has no effect. If an error is returned from the
  data layer and the resource is in a transaction, the transaction is always rolled back, regardless. The default value is `true`.

* `:notification_metadata` (`t:term/0`) - Metadata to be merged into the metadata field for all notifications sent from this operation. The default value is `%{}`.

* `:read_action` (`t:atom/0`) - The action to use when building the read query.

* `:assume_casted?` (`t:boolean/0`) - Whether or not to cast attributes and arguments as input. This is an optimization for cases where the input is already casted and/or not in need of casting The default value is `false`.

* `:load` (`t:term/0`) - A load statement to apply to records. Ignored if `return_records?` is not true.

* `:select` (list of `t:atom/0`) - A select statement to apply to records. Ignored if `return_records?` is not true.

* `:authorize_query_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. Uses `authorize_with` if not set. Valid values are :filter, :error

* `:authorize_changeset_with` - If set to `:error`, instead of filtering unauthorized changes, unauthorized changes will raise an appropriate forbidden error. Uses `authorize_with` if not set. Valid values are :filter, :error

* `:authorize_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. Valid values are :filter, :error The default value is `:filter`.

* `:context` (`t:map/0`) - Context to set on each changeset

* `:sorted?` (`t:boolean/0`) - Whether or not to sort results by their input position, in cases where `return_records?: true` was provided. The default value is `false`.

* `:return_records?` (`t:boolean/0`) - Whether or not to return all of the records that were inserted. Defaults to false to account for large inserts. The default value is `false`.

* `:return_errors?` (`t:boolean/0`) - Whether or not to return all of the errors that occur. Defaults to false to account for large inserts. The default value is `true`.

* `:batch_size` (`t:pos_integer/0`) - The number of records to include in each batch. Defaults to the `default_limit`
  or `max_page_size` of the action, or 100.

* `:return_stream?` (`t:boolean/0`) - If set to `true`, instead of an `Ash.BulkResult`, a mixed stream is returned.  
  Potential elements:  
  `{:notification, notification}` - if `return_notifications?` is set to `true`
  `{:ok, record}` - if `return_records?` is set to `true`
  `{:error, error}` - an error that occurred. May be changeset or an individual error. The default value is `false`.

* `:return_nothing?` (`t:boolean/0`) - Mutes warnings about returning nothing.  
  Only relevant if `return_stream?` is set to `true` and all other
  `return_*?` options are set to `false`. The default value is `false`.

* `:stop_on_error?` (`t:boolean/0`) - If true, the first encountered error will stop the action and be returned. Otherwise, errors
  will be skipped. The default value is `true`.

* `:notify?` (`t:boolean/0`) - Whether or not to generate any notifications. If this is set to `true` then the data layer must return
  the results from each batch. This may be intensive for large bulk actions.  
  Notifications will be automatically sent unless `return_notifications?` is set to `true`. The default value is `false`.

* `:transaction` - Whether or not to wrap the entire execution in a transaction, each batch, or not at all.  
  Keep in mind:  
  `before_transaction` and `after_transaction` hooks attached to changesets will have to be run
  *inside* the transaction if you choose `transaction: :all`.
   Valid values are :all, :batch, false The default value is `:batch`.

* `:max_concurrency` (`t:non_neg_integer/0`) - If set to a value greater than 0, up to that many tasks will be started to run batches asynchronously The default value is `0`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

### Ash.bulk_create!/4 (function)

Creates many records, raising any errors that are returned. See `bulk_create/4` for more.

### Ash.bulk_destroy/4 (function)

Destroys all items in the provided enumerable or query with the provided input.

The input is a map of valid inputs for the action. The input will be applied to all records in the enumerable/query.

If the data layer supports destroying from a query, and the destroy action can be done fully atomically,
it will be updated in a single pass using the data layer.

Otherwise, this will stream each record and update it.

### Options - Ash.bulk_destroy/4 (function)

* `:resource` (`Ash.Resource`) - The resource being destroyed. This must be provided if the input given is a stream, so we know ahead of time what the resource being updated is.

* `:stream_batch_size` (`t:integer/0`) - Batch size to use if provided a query and the query must be streamed

* `:authorize_query?` (`t:boolean/0`) - If a query is given, determines whether or not authorization is run on that query. The default value is `true`.

* `:strategy` - The strategy or strategies to enable. :stream is used in all cases if the data layer does not support atomics. Valid values are :atomic, :atomic_batches, :stream The default value is `:atomic`.

* `:filter` (`t:term/0`) - A filter to apply to records. This is also applied to a stream of inputs.

* `:allow_stream_with` - The 'worst' strategy allowed to be used to fetch records. See `Ash.stream!/2` docs for more. Valid values are :keyset, :offset, :full_read The default value is `:keyset`.

* `:stream_with` - The specific strategy to use to fetch records. See `Ash.stream!/2` docs for more. Valid values are :keyset, :offset, :full_read

* `:lock` (`t:term/0`) - A lock statement to add onto the query

* `:return_query?` (`t:boolean/0`) - If `true`, the query that was ultimately used is returned as a third tuple element.  
  The query goes through many potential changes during a request, potentially adding
  authorization filters, or replacing relationships for other data layers with their
  corresponding ids. This option can be used to get the true query that was sent to
  the data layer. The default value is `false`.

* `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

* `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
    a list of fields to fetch on a relationship, which allows for more
    optimized data-fetching.  
    See `Ash.Query.load/2`. The default value is `false`.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

* `:return_notifications?` (`t:boolean/0`) - Use this if you're running ash actions in your own transaction and you want to manually handle sending notifications.  
  If a transaction is ongoing, and this is false, notifications will be discarded, otherwise
  the return value is `{:ok, result, notifications}` (or `{:ok, notifications}`)  
  To send notifications later, use `Ash.Notifier.notify(notifications)`. It sends any notifications
  that can be sent, and returns the rest. The default value is `false`.

* `:rollback_on_error?` (`t:boolean/0`) - Whether or not to rollback the transaction on error, if the resource is in a transaction.  
  If the action has `transaction? false` this option has no effect. If an error is returned from the
  data layer and the resource is in a transaction, the transaction is always rolled back, regardless. The default value is `true`.

* `:notification_metadata` (`t:term/0`) - Metadata to be merged into the metadata field for all notifications sent from this operation. The default value is `%{}`.

* `:read_action` (`t:atom/0`) - The action to use when building the read query.

* `:assume_casted?` (`t:boolean/0`) - Whether or not to cast attributes and arguments as input. This is an optimization for cases where the input is already casted and/or not in need of casting The default value is `false`.

* `:load` (`t:term/0`) - A load statement to apply to records. Ignored if `return_records?` is not true.

* `:select` (list of `t:atom/0`) - A select statement to apply to records. Ignored if `return_records?` is not true.

* `:authorize_query_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. Uses `authorize_with` if not set. Valid values are :filter, :error

* `:authorize_changeset_with` - If set to `:error`, instead of filtering unauthorized changes, unauthorized changes will raise an appropriate forbidden error. Uses `authorize_with` if not set. Valid values are :filter, :error

* `:authorize_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. Valid values are :filter, :error The default value is `:filter`.

* `:context` (`t:map/0`) - Context to set on each changeset

* `:sorted?` (`t:boolean/0`) - Whether or not to sort results by their input position, in cases where `return_records?: true` was provided. The default value is `false`.

* `:return_records?` (`t:boolean/0`) - Whether or not to return all of the records that were inserted. Defaults to false to account for large inserts. The default value is `false`.

* `:return_errors?` (`t:boolean/0`) - Whether or not to return all of the errors that occur. Defaults to false to account for large inserts. The default value is `true`.

* `:batch_size` (`t:pos_integer/0`) - The number of records to include in each batch. Defaults to the `default_limit`
  or `max_page_size` of the action, or 100.

* `:return_stream?` (`t:boolean/0`) - If set to `true`, instead of an `Ash.BulkResult`, a mixed stream is returned.  
  Potential elements:  
  `{:notification, notification}` - if `return_notifications?` is set to `true`
  `{:ok, record}` - if `return_records?` is set to `true`
  `{:error, error}` - an error that occurred. May be changeset or an individual error. The default value is `false`.

* `:return_nothing?` (`t:boolean/0`) - Mutes warnings about returning nothing.  
  Only relevant if `return_stream?` is set to `true` and all other
  `return_*?` options are set to `false`. The default value is `false`.

* `:stop_on_error?` (`t:boolean/0`) - If true, the first encountered error will stop the action and be returned. Otherwise, errors
  will be skipped. The default value is `true`.

* `:notify?` (`t:boolean/0`) - Whether or not to generate any notifications. If this is set to `true` then the data layer must return
  the results from each batch. This may be intensive for large bulk actions.  
  Notifications will be automatically sent unless `return_notifications?` is set to `true`. The default value is `false`.

* `:transaction` - Whether or not to wrap the entire execution in a transaction, each batch, or not at all.  
  Keep in mind:  
  `before_transaction` and `after_transaction` hooks attached to changesets will have to be run
  *inside* the transaction if you choose `transaction: :all`.
   Valid values are :all, :batch, false The default value is `:batch`.

* `:max_concurrency` (`t:non_neg_integer/0`) - If set to a value greater than 0, up to that many tasks will be started to run batches asynchronously The default value is `0`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

### Ash.bulk_destroy!/4 (function)

Destroys all items in the provided enumerable or query with the provided input.

See `bulk_destroy/4` for more.

### Ash.bulk_update/4 (function)

Updates all items in the provided enumerable or query with the provided input.

The input is a map of valid inputs for the action. The input will be applied to all records in the enumerable/query.

If the data layer supports updating from a query, and the update action can be done fully atomically,
it will be updated in a single pass using the data layer.

Otherwise, this will stream each record and update it.

### Options - Ash.bulk_update/4 (function)

* `:resource` (`Ash.Resource`) - The resource being updated. This must be provided if the input given is a stream, so we know ahead of time what the resource being updated is.

* `:atomic_update` (`t:map/0`) - A map of atomic updates to apply. See `Ash.Changeset.atomic_update/3` for more.

* `:stream_batch_size` (`t:integer/0`) - Batch size to use if provided a query and the query must be streamed

* `:authorize_query?` (`t:boolean/0`) - If a query is given, determines whether or not authorization is run on that query. The default value is `true`.

* `:filter` (`t:term/0`) - A filter to apply to records. This is also applied to a stream of inputs.

* `:strategy` - The strategy or strategies to enable. :stream is used in all cases if the data layer does not support atomics. Valid values are :atomic, :atomic_batches, :stream The default value is `[:atomic]`.

* `:allow_stream_with` - The 'worst' strategy allowed to be used to fetch records. See `Ash.stream!/2` docs for more. Valid values are :keyset, :offset, :full_read The default value is `:keyset`.

* `:stream_with` - The specific strategy to use to fetch records. See `Ash.stream!/2` docs for more. Valid values are :keyset, :offset, :full_read

* `:lock` (`t:term/0`) - A lock statement to add onto the query

* `:return_query?` (`t:boolean/0`) - If `true`, the query that was ultimately used is returned as a third tuple element.  
  The query goes through many potential changes during a request, potentially adding
  authorization filters, or replacing relationships for other data layers with their
  corresponding ids. This option can be used to get the true query that was sent to
  the data layer. The default value is `false`.

* `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

* `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
    a list of fields to fetch on a relationship, which allows for more
    optimized data-fetching.  
    See `Ash.Query.load/2`. The default value is `false`.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

* `:return_notifications?` (`t:boolean/0`) - Use this if you're running ash actions in your own transaction and you want to manually handle sending notifications.  
  If a transaction is ongoing, and this is false, notifications will be discarded, otherwise
  the return value is `{:ok, result, notifications}` (or `{:ok, notifications}`)  
  To send notifications later, use `Ash.Notifier.notify(notifications)`. It sends any notifications
  that can be sent, and returns the rest. The default value is `false`.

* `:rollback_on_error?` (`t:boolean/0`) - Whether or not to rollback the transaction on error, if the resource is in a transaction.  
  If the action has `transaction? false` this option has no effect. If an error is returned from the
  data layer and the resource is in a transaction, the transaction is always rolled back, regardless. The default value is `true`.

* `:notification_metadata` (`t:term/0`) - Metadata to be merged into the metadata field for all notifications sent from this operation. The default value is `%{}`.

* `:read_action` (`t:atom/0`) - The action to use when building the read query.

* `:assume_casted?` (`t:boolean/0`) - Whether or not to cast attributes and arguments as input. This is an optimization for cases where the input is already casted and/or not in need of casting The default value is `false`.

* `:load` (`t:term/0`) - A load statement to apply to records. Ignored if `return_records?` is not true.

* `:select` (list of `t:atom/0`) - A select statement to apply to records. Ignored if `return_records?` is not true.

* `:authorize_query_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. Uses `authorize_with` if not set. Valid values are :filter, :error

* `:authorize_changeset_with` - If set to `:error`, instead of filtering unauthorized changes, unauthorized changes will raise an appropriate forbidden error. Uses `authorize_with` if not set. Valid values are :filter, :error

* `:authorize_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. Valid values are :filter, :error The default value is `:filter`.

* `:context` (`t:map/0`) - Context to set on each changeset

* `:sorted?` (`t:boolean/0`) - Whether or not to sort results by their input position, in cases where `return_records?: true` was provided. The default value is `false`.

* `:return_records?` (`t:boolean/0`) - Whether or not to return all of the records that were inserted. Defaults to false to account for large inserts. The default value is `false`.

* `:return_errors?` (`t:boolean/0`) - Whether or not to return all of the errors that occur. Defaults to false to account for large inserts. The default value is `true`.

* `:batch_size` (`t:pos_integer/0`) - The number of records to include in each batch. Defaults to the `default_limit`
  or `max_page_size` of the action, or 100.

* `:return_stream?` (`t:boolean/0`) - If set to `true`, instead of an `Ash.BulkResult`, a mixed stream is returned.  
  Potential elements:  
  `{:notification, notification}` - if `return_notifications?` is set to `true`
  `{:ok, record}` - if `return_records?` is set to `true`
  `{:error, error}` - an error that occurred. May be changeset or an individual error. The default value is `false`.

* `:return_nothing?` (`t:boolean/0`) - Mutes warnings about returning nothing.  
  Only relevant if `return_stream?` is set to `true` and all other
  `return_*?` options are set to `false`. The default value is `false`.

* `:stop_on_error?` (`t:boolean/0`) - If true, the first encountered error will stop the action and be returned. Otherwise, errors
  will be skipped. The default value is `true`.

* `:notify?` (`t:boolean/0`) - Whether or not to generate any notifications. If this is set to `true` then the data layer must return
  the results from each batch. This may be intensive for large bulk actions.  
  Notifications will be automatically sent unless `return_notifications?` is set to `true`. The default value is `false`.

* `:transaction` - Whether or not to wrap the entire execution in a transaction, each batch, or not at all.  
  Keep in mind:  
  `before_transaction` and `after_transaction` hooks attached to changesets will have to be run
  *inside* the transaction if you choose `transaction: :all`.
   Valid values are :all, :batch, false The default value is `:batch`.

* `:max_concurrency` (`t:non_neg_integer/0`) - If set to a value greater than 0, up to that many tasks will be started to run batches asynchronously The default value is `0`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

### Ash.bulk_update!/4 (function)

Updates all items in the provided enumerable or query with the provided input.

See `bulk_update/4` for more.

### Ash.calculate/3 (function)

Evaluates the calculation on the resource.

If a record is provided, its field values will be used to evaluate the calculation.

* `:args` (`t:map/0`) - Values for arguments referenced by the calculation. The default value is `%{}`.

* `:refs` (`t:map/0`) - Values for references used by the calculation. The default value is `%{}`.

* `:actor` (`t:term/0`) - The actor for handling `^actor/1` templates, supplied to calculation context.

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - The tenant, supplied to calculation context.

* `:authorize?` (`t:boolean/0`) - Whether or not the request is being authorized, provided to calculation context. The default value is `true`.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer, provided to the calculation context.

* `:record` (`t:term/0`) - A record to use as the base of the calculation

* `:data_layer?` (`t:boolean/0`) - Set to `true` to require that the value be computed within the data layer. Only works for calculations that define an expression.

* `:reuse_values?` (`t:boolean/0`) - Set to `true` to reuse existing values on any provided record. Only necessary if providing a record as the basis for calculation. The default value is `false`.

* `:domain` (`Ash.Domain`) - The domain to use for the action

### Ash.calculate!/3 (function)

Evaluates the calculation on the resource or raises an error. See `calculate/3` for more.

### Ash.can/3 (function)

Returns whether or not the user can perform the action, or `:maybe`, returning any errors.

In cases with "runtime" checks (checks after the action), we may not be able to determine
an answer, and so the value `:maybe` will be returned from `can/2`. The `can?` function assumes that
`:maybe` means `true`. Keep in mind, this is just for doing things like "can they do this" in a UI,
so assuming `:maybe` is `true` is fine. The actual action invocation will be properly checked regardless.
If you have runtime checks, you may need to use `can` instead of `can?`, or configure what `:maybe` means.

### Accepted inputs - Ash.can/3 (function)

You can pass many different inputs as the subject to `can/3`.

```elixir
# Can this user run this query.
Ash.Query.t()

# Can this user run this changeset.
Ash.Changeset.t()

# Can this user run this action.
Ash.ActionInput.t()

# Can this user run this action.
{Ash.Resource.t(), :action}

# Can this user run this action.
{Ash.Resource.t(), %Action{}}

# Can this user run this action with this input.
{Ash.Resource.t(), :atom, %{...input}}

# Can this user run this action with this input.
{Ash.Resource.t(), %Action{}, %{...input}}
```

### Options - Ash.can/3 (function)

* `:maybe_is` (`t:term/0`) - If the actor *may* be able to perform the action, what value should be returned. The default value is `:maybe`.

* `:filter_with` - If set to `:error`, the query will raise an error on a match. If set to `:filter` the query will filter out unauthorized access. Valid values are :filter, :error The default value is `:filter`.

* `:validate?` (`t:boolean/0`) - Whether or not to treat an invalid action as a non-allowed action. The default value is `false`.

* `:reuse_values?` (`t:boolean/0`) - Whether or not loaded data like aggregates, calculations and relationships should be checked in memory if possible, instead of querying. No effect if `pre_flight?` is `false`. The default value is `false`.

* `:pre_flight?` (`t:boolean/0`) - Whether or not this is a pre_flight check (which may perform optimized in-memory checks) or the final proper check. The default value is `true`.

* `:run_queries?` (`t:boolean/0`) - Whether or not to run queries. If set to `true`, `:maybe` will not be returned. The default value is `true`.

* `:data` - The record or records specifically attempting to be acted upon.

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - The tenant to use for authorization

* `:alter_source?` (`t:boolean/0`) - If set to `true`, the source being authorized is returned so it can be run. The default value is `false`.

* `:base_query` (`t:term/0`) - A base query on which to apply an generated filters

* `:no_check?` (`t:boolean/0`) - Whether or not authorization must pass at the strict/filter step, or if post-checks are allowed to be run The default value is `false`.

* `:on_must_pass_strict_check` (`t:term/0`) - Override the value returned when `no_check?` is `true` but a check must be run.

* `:atomic_changeset` (`t:term/0`) - A base query on which to apply an generated filters

* `:return_forbidden_error?` (`t:boolean/0`) - Whether or not to return a forbidden error in cases of not being authorized. The default value is `false`.

### Ash.can?/3 (function)

Returns whether or not the user can perform the action, or raises on errors.

Calls `can/3` with a `maybe_is: true`. See `can/3` for more info.

### Options - Ash.can?/3 (function)

* `:maybe_is` (`t:term/0`) - If the actor *may* be able to perform the action, what value should be returned. The default value is `true`.

* `:filter_with` - If set to `:error`, the query will raise an error on a match. If set to `:filter` the query will filter out unauthorized access. Valid values are :filter, :error The default value is `:filter`.

* `:validate?` (`t:boolean/0`) - Whether or not to treat an invalid action as a non-allowed action. The default value is `false`.

* `:reuse_values?` (`t:boolean/0`) - Whether or not loaded data like aggregates, calculations and relationships should be checked in memory if possible, instead of querying. No effect if `pre_flight?` is `false`. The default value is `false`.

* `:pre_flight?` (`t:boolean/0`) - Whether or not this is a pre_flight check (which may perform optimized in-memory checks) or the final proper check. The default value is `true`.

* `:run_queries?` (`t:boolean/0`) - Whether or not to run queries. If set to `true`, `:maybe` will not be returned. The default value is `true`.

* `:data` - The record or records specifically attempting to be acted upon.

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - The tenant to use for authorization

* `:alter_source?` (`t:boolean/0`) - If set to `true`, the source being authorized is returned so it can be run. The default value is `false`.

* `:base_query` (`t:term/0`) - A base query on which to apply an generated filters

* `:no_check?` (`t:boolean/0`) - Whether or not authorization must pass at the strict/filter step, or if post-checks are allowed to be run The default value is `false`.

* `:on_must_pass_strict_check` (`t:term/0`) - Override the value returned when `no_check?` is `true` but a check must be run.

* `:atomic_changeset` (`t:term/0`) - A base query on which to apply an generated filters

* `:return_forbidden_error?` (`t:boolean/0`) - Whether or not to return a forbidden error in cases of not being authorized. The default value is `false`.

### Ash.context_to_opts/2 (function)

See  Ash.Context.to_opts/2 .

### Ash.count/2 (function)

Fetches the count of results that would be returned from a given query.

### Ash.count!/2 (function)

Fetches the count of results that would be returned from a given query, or raises an error.

### Ash.create/3 (function)

Create a record.

* `:upsert?` (`t:boolean/0`) - If a conflict is found based on the primary key, the record is updated in the database (requires upsert support) The default value is `false`.

* `:return_skipped_upsert?` (`t:boolean/0`) - If `true`, and a record was *not* upserted because its filter prevented the upsert, the original record (which was *not* upserted) will be returned. The default value is `false`.

* `:upsert_identity` (`t:atom/0`) - The identity to use when detecting conflicts for `upsert?`, e.g. `upsert_identity: :full_name`. By default, the primary key is used. Has no effect if `upsert?: true` is not provided

* `:upsert_fields` - The fields to upsert. If not set, the action's upsert_fields is used, and if that is not set, then any fields not being set to defaults are written.

* `:upsert_condition` (`t:term/0`) - An expression to check if the record should be updated when there's a conflict.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

* `:return_notifications?` (`t:boolean/0`) - Use this if you're running ash actions in your own transaction and you want to manually handle sending notifications.  
  If a transaction is ongoing, and this is false, notifications will be discarded, otherwise
  the return value is `{:ok, result, notifications}` (or `{:ok, notifications}`)  
  To send notifications later, use `Ash.Notifier.notify(notifications)`. It sends any notifications
  that can be sent, and returns the rest. The default value is `false`.

* `:rollback_on_error?` (`t:boolean/0`) - Whether or not to rollback the transaction on error, if the resource is in a transaction.  
  If the action has `transaction? false` this option has no effect. If an error is returned from the
  data layer and the resource is in a transaction, the transaction is always rolled back, regardless. The default value is `true`.

* `:notification_metadata` (`t:term/0`) - Metadata to be merged into the metadata field for all notifications sent from this operation. The default value is `%{}`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:load` (`t:term/0`) - A load statement to add onto the changeset

### Ash.create!/3 (function)

Create a record or raises an error. See `create/2` for more information.

### Ash.destroy/2 (function)

Destroy a record.

* `:return_destroyed?` (`t:boolean/0`) - If true, the destroyed record is included in the return result, e.g `{:ok, destroyed}` or `{:ok, destroyed, notifications}` The default value is `false`.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

* `:return_notifications?` (`t:boolean/0`) - Use this if you're running ash actions in your own transaction and you want to manually handle sending notifications.  
  If a transaction is ongoing, and this is false, notifications will be discarded, otherwise
  the return value is `{:ok, result, notifications}` (or `{:ok, notifications}`)  
  To send notifications later, use `Ash.Notifier.notify(notifications)`. It sends any notifications
  that can be sent, and returns the rest. The default value is `false`.

* `:rollback_on_error?` (`t:boolean/0`) - Whether or not to rollback the transaction on error, if the resource is in a transaction.  
  If the action has `transaction? false` this option has no effect. If an error is returned from the
  data layer and the resource is in a transaction, the transaction is always rolled back, regardless. The default value is `true`.

* `:notification_metadata` (`t:term/0`) - Metadata to be merged into the metadata field for all notifications sent from this operation. The default value is `%{}`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:load` (`t:term/0`) - A load statement to add onto the changeset

### Ash.destroy!/2 (function)

Destroy a record. See `destroy/2` for more information.

### Ash.exists/2 (function)

Returns whether or not the query would return any results.

### Ash.exists?/2 (function)

Returns whether or not the query would return any results, or raises an error.

### Ash.first/3 (function)

Fetches the first value for a given field, or raises an error.

### Ash.first!/3 (function)

Fetches the first value for a given field.

### Ash.get/3 (function)

Get a record by an identifier.

For a resource with a composite primary key, pass a keyword list or map, e.g
`Ash.get(MyResource, %{first_key: 1, second_key: 2})`

Additionally, a keyword list or map of keys matching an identity can be provided.

* `:error?` (`t:boolean/0`) - Whether or not an error should be returned or raised when the record is not found. If set to false, `nil` will be returned. The default value is `true`.

* `:load` (`t:term/0`) - Fields or relationships to load in the query. See `Ash.Query.load/2`

* `:lock` (`t:term/0`) - A lock statement to add onto the query

* `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

* `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
    a list of fields to fetch on a relationship, which allows for more
    optimized data-fetching.  
    See `Ash.Query.load/2`. The default value is `false`.

* `:authorize_with` - If set to `:error`, instead of applying authorization filters as a filter, any records not matching the authorization filter will cause an error to be returned. Valid values are :filter, :error The default value is `:filter`.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

### Ash.get!/3 (function)

Get a record by an identifier, or raises an error. See `get/3` for more.

### Ash.list/3 (function)

Fetches a list of all values of a given field.

### Ash.list!/3 (function)

Fetches a list of all values of a given field or raises an error.

### Ash.load/3 (function)

Load fields or relationships on already fetched records.

Accepts a list of non-loaded fields and loads them on the provided records or a query, in
which case the loaded fields of the query are used. Relationship loads can be nested, for
example: `Ash.load(record, [posts: [:comments]])`.

* `:lazy?` (`t:boolean/0`) - If set to true, values will only be loaded if the related value isn't currently loaded. The default value is `false`.

* `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

* `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
    a list of fields to fetch on a relationship, which allows for more
    optimized data-fetching.  
    See `Ash.Query.load/2`. The default value is `false`.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

### Ash.load!/3 (function)

Load fields or relationships on already fetched records. See `load/3` for more information.

### Ash.load_statement/0 (type)



### Ash.max/3 (function)

Fetches the greatest of all values of a given field.

### Ash.max!/3 (function)

Fetches the greatest of all values of a given field or raises an error.

### Ash.min/3 (function)

Fetches the least of all values of a given field.

### Ash.min!/3 (function)

Fetches the least of all values of a given field or raises an error.

### Ash.page/2 (function)

Fetch a page relative to the provided page.

### Ash.page!/2 (function)

Fetch a page relative to the provided page or raises an error

### Ash.page_request/0 (type)



### Ash.read/2 (function)

Runs an `Ash.Query`.

For more information on building a query, see `Ash.Query`.

* `:page` - Pagination options, see `Ash.read/2` for more.

* `:load` (`t:term/0`) - A load statement to add onto the query

* `:max_concurrency` (`t:non_neg_integer/0`) - The maximum number of processes allowed to be started for parallel loading of relationships and calculations. Defaults to `System.schedulers_online() * 2`

* `:lock` (`t:term/0`) - A lock statement to add onto the query

* `:return_query?` (`t:boolean/0`) - If `true`, the query that was ultimately used is returned as a third tuple element.  
  The query goes through many potential changes during a request, potentially adding
  authorization filters, or replacing relationships for other data layers with their
  corresponding ids. This option can be used to get the true query that was sent to
  the data layer. The default value is `false`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

* `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
    a list of fields to fetch on a relationship, which allows for more
    optimized data-fetching.  
    See `Ash.Query.load/2`. The default value is `false`.

* `:authorize_with` - If set to `:error`, instead of applying authorization filters as a filter, any records not matching the authorization filter will cause an error to be returned. Valid values are :filter, :error The default value is `:filter`.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

### Pagination - Ash.read/2 (function)

#### Limit/offset pagination
* `:offset` (`t:non_neg_integer/0`) - The number of records to skip from the beginning of the query

* `:limit` (`t:pos_integer/0`) - The number of records to include in the page

* `:filter` (`t:term/0`) - A filter to apply for pagination purposes, that should not be considered in the full count.  
  This is used by the liveview paginator to only fetch the records that were *already* on the
  page when refreshing data, to avoid pages jittering.

* `:count` (`t:boolean/0`) - Whether or not to return the page with a full count of all records



#### Keyset pagination
* `:before` (`t:String.t/0`) - Get records that appear before the provided keyset (mutually exclusive with `after`)

* `:after` (`t:String.t/0`) - Get records that appear after the provided keyset (mutually exclusive with `before`)

* `:limit` (`t:pos_integer/0`) - How many records to include in the page

* `:filter` (`t:term/0`) - See the `filter` option for offset pagination, this behaves the same.

* `:count` (`t:boolean/0`) - Whether or not to return the page with a full count of all records

### Ash.read!/2 (function)

Run an `Ash.Query`. See `read/2` for more.

### Ash.read_first/2 (function)

Runs a query on a resource, returning a first result, nil, or an error.

Query is automatically limited to only return one result, unlike `read_one/3`

### Options - Ash.read_first/2 (function)

* `:not_found_error?` (`t:boolean/0`) - Whether or not to return an `Ash.Error.Query.NotFound` if no record is found. The default value is `false`.

* `:page` - Pagination options, see `Ash.read/2` for more.

* `:load` (`t:term/0`) - A load statement to add onto the query

* `:max_concurrency` (`t:non_neg_integer/0`) - The maximum number of processes allowed to be started for parallel loading of relationships and calculations. Defaults to `System.schedulers_online() * 2`

* `:lock` (`t:term/0`) - A lock statement to add onto the query

* `:return_query?` (`t:boolean/0`) - If `true`, the query that was ultimately used is returned as a third tuple element.  
  The query goes through many potential changes during a request, potentially adding
  authorization filters, or replacing relationships for other data layers with their
  corresponding ids. This option can be used to get the true query that was sent to
  the data layer. The default value is `false`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

* `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
    a list of fields to fetch on a relationship, which allows for more
    optimized data-fetching.  
    See `Ash.Query.load/2`. The default value is `false`.

* `:authorize_with` - If set to `:error`, instead of applying authorization filters as a filter, any records not matching the authorization filter will cause an error to be returned. Valid values are :filter, :error The default value is `:filter`.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

### Ash.read_first!/2 (function)

Runs an Ash query, returning the first result or nil, or raising an error. See `read_first/2` for more.

### Ash.read_one/2 (function)

Runs a query on a resource, returning a single result, nil, or an error.

If more than one result would be returned, an error is returned instead.

### Options - Ash.read_one/2 (function)

* `:not_found_error?` (`t:boolean/0`) - Whether or not to return an `Ash.Error.Query.NotFound` if no record is found. The default value is `false`.

* `:page` - Pagination options, see `Ash.read/2` for more.

* `:load` (`t:term/0`) - A load statement to add onto the query

* `:max_concurrency` (`t:non_neg_integer/0`) - The maximum number of processes allowed to be started for parallel loading of relationships and calculations. Defaults to `System.schedulers_online() * 2`

* `:lock` (`t:term/0`) - A lock statement to add onto the query

* `:return_query?` (`t:boolean/0`) - If `true`, the query that was ultimately used is returned as a third tuple element.  
  The query goes through many potential changes during a request, potentially adding
  authorization filters, or replacing relationships for other data layers with their
  corresponding ids. This option can be used to get the true query that was sent to
  the data layer. The default value is `false`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

* `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
    a list of fields to fetch on a relationship, which allows for more
    optimized data-fetching.  
    See `Ash.Query.load/2`. The default value is `false`.

* `:authorize_with` - If set to `:error`, instead of applying authorization filters as a filter, any records not matching the authorization filter will cause an error to be returned. Valid values are :filter, :error The default value is `:filter`.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

### Ash.read_one!/2 (function)

Runs an ash query, returning a single result or raise an error. See `read_one/2` for more.

### Ash.record_or_records/0 (type)



### Ash.record_with_args/0 (type)



### Ash.reload/2 (function)

Refetches a record by primary key. See `get/2` for more.

### Ash.reload!/2 (function)

Refetches a record by primary key or raises an error. See `reload/2` for more.

### Ash.resource_with_args/0 (type)



### Ash.run_action/2 (function)

Runs a generic action.

Options:

* `:actor` (`t:term/0`) - The actor for handling `^actor/1` templates, supplied to calculation context.

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - The tenant, supplied to calculation context.

* `:authorize?` (`t:boolean/0`) - Whether or not the request should be authorized.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer, provided to the calculation context.

* `:domain` (`Ash.Domain`) - The domain to use for the action

* `:context` (`t:map/0`) - Context to set on the action input

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

### Ash.run_action!/2 (function)

Runs a generic action or raises an error. See `run_action/2` for more

### Ash.stream!/2 (function)

Streams the results of a query.

### Strategies - Ash.stream!/2 (function)

There are three strategies supported, and the best one available is always chosen. They are,
in order from best to worst:

- `:keyset`
- `:offset`
- `:full_read`

By default, only `:keyset` is supported. If you want to allow worse strategies to be used, pass
the worst one you wish to allow as the `allow_stream_with` option, i.e `allow_stream_with: :full_read`.
If you wish to specify a specific strategy to use, pass `stream_with: :strategy_name`.

### Keyset - Ash.stream!/2 (function)

This utilizes keyset pagination to accomplish this stream. The action must support keyset pagination.
This is the most efficient way to stream a query, because it works by using filters which can benefit
from indexes in the data layer.

### Offset - Ash.stream!/2 (function)

This utilizes offset/limit to accomplish this stream. If the action supports offset pagination, that will
be used. Otherwise, if the data layer supports limit/offset, then explicit limits/offsets will be used.
This is a much less efficient way of streaming a resource than `keyset`. To use limit/offset to reliably
stream, a sort must always be applied, and limit/offset in the data layer will generally require sorting
the entire table to figure out what is in each batch.

### Full Read - Ash.stream!/2 (function)

This reads the entire table into memory with no limit. This is, generally speaking, the least efficient.

### Options - Ash.stream!/2 (function)

* `:batch_size` (`t:integer/0`) - How many records to request in each query run. Defaults to the pagination limits on the resource, or 250.

* `:allow_stream_with` - The 'worst' strategy allowed to be used to fetch records. See `Ash.stream!/2` docs for more. Valid values are :keyset, :offset, :full_read The default value is `:keyset`.

* `:stream_with` - The specific strategy to use to fetch records. See `Ash.stream!/2` docs for more. Valid values are :keyset, :offset, :full_read

* `:load` (`t:term/0`) - A load statement to add onto the query

* `:max_concurrency` (`t:non_neg_integer/0`) - The maximum number of processes allowed to be started for parallel loading of relationships and calculations. Defaults to `System.schedulers_online() * 2`

* `:lock` (`t:term/0`) - A lock statement to add onto the query

* `:return_query?` (`t:boolean/0`) - If `true`, the query that was ultimately used is returned as a third tuple element.  
  The query goes through many potential changes during a request, potentially adding
  authorization filters, or replacing relationships for other data layers with their
  corresponding ids. This option can be used to get the true query that was sent to
  the data layer. The default value is `false`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

* `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
    a list of fields to fetch on a relationship, which allows for more
    optimized data-fetching.  
    See `Ash.Query.load/2`. The default value is `false`.

* `:authorize_with` - If set to `:error`, instead of applying authorization filters as a filter, any records not matching the authorization filter will cause an error to be returned. Valid values are :filter, :error The default value is `:filter`.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

### Ash.sum/3 (function)

Fetches the sum of a given field.

### Ash.sum!/3 (function)

Fetches the sum of a given field or raises an error.

### Ash.transaction/3 (function)

Wraps the execution of the function in a transaction with the resource's data_layer.
Collects notifications during the function's execution and sends them if the transaction was successful.

* `:timeout` (`t:timeout/0`) - The time in milliseconds (as an integer) to wait for the transaction to finish or `:infinity` to wait indefinitely.  
  If not specified then default behaviour is adapter specific - for `Ecto`-based data layers it will be `15_000`.

* `:return_notifications?` (`t:boolean/0`) - Use this if you want to manually handle sending notifications.  
  If true the returned tuple will contain notifications list as the last element.  
  To send notifications use `Ash.Notifier.notify(notifications)`. It sends any notifications that can be sent, and returns the rest. The default value is `false`.

### Ash.update/3 (function)

Update a record.

* `:params` (`t:map/0`) - Parameters to supply, ignored if the input is a changeset, only used when an identifier is given.

* `:atomic_upgrade?` (`t:boolean/0`) - If true the action will be done atomically if it can (and is configured to do so), ignoring the in memory transformations and validations. You should not generally need to disable this. The default value is `true`.

* `:domain` (`Ash.Domain`) - The domain to use.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

* `:return_notifications?` (`t:boolean/0`) - Use this if you're running ash actions in your own transaction and you want to manually handle sending notifications.  
  If a transaction is ongoing, and this is false, notifications will be discarded, otherwise
  the return value is `{:ok, result, notifications}` (or `{:ok, notifications}`)  
  To send notifications later, use `Ash.Notifier.notify(notifications)`. It sends any notifications
  that can be sent, and returns the rest. The default value is `false`.

* `:rollback_on_error?` (`t:boolean/0`) - Whether or not to rollback the transaction on error, if the resource is in a transaction.  
  If the action has `transaction? false` this option has no effect. If an error is returned from the
  data layer and the resource is in a transaction, the transaction is always rolled back, regardless. The default value is `true`.

* `:notification_metadata` (`t:term/0`) - Metadata to be merged into the metadata field for all notifications sent from this operation. The default value is `%{}`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:load` (`t:term/0`) - A load statement to add onto the changeset

### Ash.update!/3 (function)

Update a record. See `update/2` for more information.

### Ash.ActionInput (module)

Input for a custom action

Much like an `Ash.Query` and `Ash.Changeset` are used to provide inputs into
CRUD actions, this struct provides the inputs required to execute a generic
action.

### Ash.ActionInput.add_error/3 (function)

Add an error to the errors list and mark the action input as invalid.

See `Ash.Error.to_ash_error/3` for more on supported values for `error`

### Ash.ActionInput.fetch_argument/2 (function)

Fetches the value of an argument provided to the input or `:error`.

### Examples - Ash.ActionInput.fetch_argument/2 (function)

iex> Post
    ...> |> Ash.ActionInput.for_action(:example, %{arg: "banana"})
    ...> |> Ash.ActionInput.fetch_argument(:arg)
    {:ok, "banana"}

    iex> Post
    ...> |> Ash.ActionInput.for_action(:example, %{})
    ...> |> Ash.ActionInput.fetch_argument(:banana)
    :error

### Ash.ActionInput.for_action/4 (function)

Creates a new input for a generic action

### Options - Ash.ActionInput.for_action/4 (function)

* `:domain` (`Ash.Domain`) - The domain to use for the action. The resource's domain is used by default.

* `:context` (`t:map/0`) - Context to set on the action input. The default value is `%{}`.

* `:authorize?` - Whether or not to run authorization on the action. Default behavior of this option is controlled by the domain.

* `:tenant` (`t:term/0`) - The tenant to use for the action.

* `:actor` (`t:term/0`) - The actor performing the action

* `:skip_unknown_inputs` - A list of unknown inputs to skip. Use `:*` to skip all unknown inputs.

* `:tracer` (`t:term/0`) - A tracer or list of tracers to trace action execution.

* `:private_arguments` (`t:map/0`) - A list of private arguments to be set before the action is invoked. The default value is `%{}`.

### Examples - Ash.ActionInput.for_action/4 (function)

iex> Post
    ...> |> Ash.ActionInput.for_action(:example, %{})
    ...> |> then(& &1.action.name)
    :example

### Ash.ActionInput.get_argument/2 (function)

Gets the value of an argument provided to the input.

### Example - Ash.ActionInput.get_argument/2 (function)

iex> Post
    ...> |> Ash.ActionInput.for_action(:example, %{arg: "banana"})
    ...> |> Ash.ActionInput.get_argument(:arg)
    "banana"

### Ash.ActionInput.new/2 (function)

Create a new action input from a resource.

### Examples - Ash.ActionInput.new/2 (function)

iex> Ash.ActionInput.new(Post)
    %Ash.ActionInput{resource: Post}

    iex> Ash.ActionInput.new(Post, Domain)
    %Ash.ActionInput{resource: Post, domain: Domain}

### Ash.ActionInput.set_argument/3 (function)

Set an argument value

### Example - Ash.ActionInput.set_argument/3 (function)

iex> Post
    ...> |> Ash.ActionInput.for_action(:example, %{})
    ...> |> Ash.ActionInput.set_argument(:arg, "banana")
    ...> |> Ash.ActionInput.get_argument(:arg)
    "banana"

### Ash.ActionInput.set_context/2 (function)

Deep merges the provided map into the input context that can be used later

Do not use the `private` key in your custom context, as that is reserved for
internal use.

### Example - Ash.ActionInput.set_context/2 (function)

iex> Post
    ...> |> Ash.ActionInput.new()
    ...> |> Ash.ActionInput.set_context(%{favourite_fruit: :banana})
    ...> |> then(& &1.context.favourite_fruit)
    :banana

### Ash.ActionInput.set_private_argument/3 (function)

Sets a private argument value

### Example - Ash.ActionInput.set_private_argument/3 (function)

iex> Post
    ...> |> Ash.ActionInput.for_action(:example, %{})
    ...> |> Ash.ActionInput.set_private_argument(:private_arg, "banana")
    ...> |> Ash.ActionInput.get_argument(:private_arg)
    "banana"

### Ash.ActionInput.set_tenant/2 (function)

Set the tenant to use when calling the action.

### Example - Ash.ActionInput.set_tenant/2 (function)

iex> Post
    ...> |> Ash.ActionInput.new()
    ...> |> Ash.ActionInput.set_tenant("banana")
    ...> |> then(& &1.tenant)
    "banana"

### Ash.ActionInput.t/0 (type)



### Ash.BulkResult (module)

The return value for bulk actions.

### Ash.BulkResult.t/0 (type)



### Ash.Changeset (module)

Changesets are used to create and update data in Ash.

Create a changeset with `new/1` or `new/2`, and alter the attributes
and relationships using the functions provided in this module.  Nothing in this module
actually incurs changes in a data layer. To commit a changeset, see `Ash.create/2`
and `Ash.update/2`.

# Changeset lifecycle

### Action Lifecycle - Ash.Changeset (module)

The following example illustrates the hook lifecycle of a changeset.

```elixir
defmodule AshChangesetLifeCycleExample do
  def change(changeset, _, _) do
    changeset
    # execute code both before and after the transaction
    |> Ash.Changeset.around_transaction(fn changeset, callback ->
      callback.(changeset)
    end)
    # execute code before the transaction is started. Use for things like external calls
    |> Ash.Changeset.before_transaction(fn changeset -> changeset end)
    # execute code in the transaction, before and after the data layer is called
    |> Ash.Changeset.around_action(fn changeset, callback ->
      callback.(changeset)
    end)
    # execute code in the transaction, before the data layer is called
    |> Ash.Changeset.before_action(fn changeset -> changeset end)
    # execute code in the transaction, after the data layer is called, only if the action is successful
    |> Ash.Changeset.after_action(fn changeset, result -> {:ok, result} end)
    # execute code after the transaction, both in success and error cases
    |> Ash.Changeset.after_transaction(fn changeset, success_or_error_result -> success_or_error_result end
  end
end
```

### Ash.Changeset.accessing/3 (function)

Returns a list of attributes, aggregates, relationships, and calculations that are being loaded

Provide a list of field types to narrow down the returned results.

### Ash.Changeset.add_error/3 (function)

Add an error to the errors list and mark the changeset as invalid.

See `Ash.Error.to_ash_error/3` for more on supported values for `error`

### Ash.Changeset.after_action/3 (function)

Adds an after_action hook to the changeset.

Provide the option `prepend?: true` to place the hook before all
other hooks instead of after.

### Ash.Changeset.after_action_fun/0 (type)



### Ash.Changeset.after_transaction/3 (function)

Adds an after_transaction hook to the changeset. Cannot be called within other hooks.

`after_transaction` hooks differ from `after_action` hooks in that they are run
on success *and* failure of the action or some previous hook.

Provide the option `prepend?: true` to place the hook before all
other hooks instead of after.

### Ash.Changeset.after_transaction_fun/0 (type)



### Ash.Changeset.apply_attributes/2 (function)

Returns the original data with attribute changes merged, if the changeset is valid.

Options:

* force? - applies current attributes even if the changeset is not valid

### Ash.Changeset.around_action/2 (function)

Adds an around_action hook to the changeset.

Your function will get the changeset, and a callback that must be called with a changeset (that may be modified).
The callback will return `{:ok, result, changeset, instructions}` or `{:error, error}`. You can modify these values, but the
return value must be one of those types. Instructions contains the notifications in its `notifications` key, i.e
`%{notifications: [%Ash.Resource.Notification{}, ...]}`.

The around_action calls happen first, and then (after they each resolve their callbacks) the `before_action`
hooks are called, followed by the action itself occurring at the data layer and then the `after_action` hooks being run.
Then, the code that appeared *after* the callbacks were called is then run.

For example:
```elixir
changeset
|> Ash.Changeset.around_action(fn changeset, callback ->
  IO.puts("first around: before")
  result = callback.(changeset)
  IO.puts("first around: after")

  result
end)
|> Ash.Changeset.around_action(fn changeset, callback ->
  IO.puts("second around: before")
  result = callback.(changeset)
  IO.puts("second around: after")

  result
end)
|> Ash.Changeset.before_action(fn changeset ->
  IO.puts("first before")
  changeset
end)
|> Ash.Changeset.before_action(fn changeset ->
  IO.puts("second before")
  changeset
end)
|> Ash.Changeset.after_action(fn changeset, result ->
  IO.puts("first after")
  {:ok, result}
end)
|> Ash.Changeset.after_action(fn changeset, result ->
  IO.puts("second after")
  {:ok, result}
end)
```

This would print:
```
first around: before
second around: before
first before
second before
             <-- action happens here
first after
second after
second around: after <-- Notice that because of the callbacks, the after of the around hooks is reversed from the before
first around: after
```

Warning: using this without understanding how it works can cause big problems.
You *must* call the callback function that is provided to your hook, and the return value must
contain the same structure that was given to you, i.e `{:ok, result_of_action, instructions}`.

You can almost always get the same effect by using `before_action`, setting some context on the changeset
and reading it out in an `after_action` hook.

### Ash.Changeset.around_action_callback/0 (type)



### Ash.Changeset.around_action_fun/0 (type)



### Ash.Changeset.around_action_result/0 (type)



### Ash.Changeset.around_transaction/2 (function)

Adds an around_transaction hook to the changeset.

Your function will get the changeset, and a callback that must be called with a changeset (that may be modified).
The callback will return `{:ok, result}` or `{:error, error}`. You can modify these values, but the return value
must be one of those types.

The around_transaction calls happen first, and then (after they each resolve their callbacks) the `before_transaction`
hooks are called, followed by the action hooks and then the `after_transaction` hooks being run.
Then, the code that appeared *after* the callbacks were called is then run.

For example:

```elixir
changeset
|> Ash.Changeset.around_transaction(fn changeset, callback ->
  IO.puts("first around: before")
  result = callback.(changeset)
  IO.puts("first around: after")

  result
end)
|> Ash.Changeset.around_transaction(fn changeset, callback ->
  IO.puts("second around: before")
  result = callback.(changeset)
  IO.puts("second around: after")

  result
end)
|> Ash.Changeset.before_transaction(fn changeset ->
  IO.puts("first before")
  changeset
end)
|> Ash.Changeset.before_transaction(fn changeset ->
  IO.puts("second before")
  changeset
end)
|> Ash.Changeset.after_transaction(fn changeset, result ->
  IO.puts("first after")
  result
end)
|> Ash.Changeset.after_transaction(fn changeset, result ->
  IO.puts("second after")
  result
end)
```

This would print:

```
first around: before
second around: before
first before
second before
             <-- action hooks happens here
first after
second after
second around: after <-- Notice that because of the callbacks, the after of the around hooks is reversed from the before
first around: after
```

Warning: using this without understanding how it works can cause big problems.
You *must* call the callback function that is provided to your hook, and the return value must
contain the same structure that was given to you, i.e `{:ok, result_of_action}`.

You can almost always get the same effect by using `before_transaction`, setting some context on the changeset
and reading it out in an `after_transaction` hook.

### Ash.Changeset.around_transaction_callback/0 (type)



### Ash.Changeset.around_transaction_fun/0 (type)



### Ash.Changeset.around_transaction_result/0 (type)



### Ash.Changeset.atomic_defaults/1 (function)



### Ash.Changeset.atomic_ref/2 (function)

Gets a reference to a field, or the current atomic update expression of that field.

### Ash.Changeset.atomic_update/2 (function)

Adds multiple atomic changes to the changeset

See `atomic_update/3` for more information.

### Ash.Changeset.atomic_update/3 (function)

Adds an atomic change to the changeset.

Atomic changes are applied by the data layer, and as such have guarantees that are not
given by changes that are based on looking at the previous value and updating it. Here
is an example of a change that is not safe to do concurrently:

```elixir
change fn changeset, _ ->
  Ash.Changeset.change_attribute(changeset, :score, changeset.data.score + 1)
end
```

If two processes run this concurrently, they will both read the same value of `score`, and
set the new score to the same value. This means that one of the increments will be lost.
If you were to instead do this using `atomic_update`, you would get the correct result:

```elixir
Ash.Changeset.atomic_update(changeset, :score, expr(score + 1))
```

There are drawbacks/things to consider, however. The first is that atomic update results
are not known until after the action is run. The following functional validation would not
be able to enforce the score being less than 10, because the atomic happens after the validation.

```elixir
validate fn changeset, _ ->
  if Ash.Changeset.get_attribute(changeset, :score) < 10 do
    :ok
  else
    {:error, field: :score, message: "must be less than 10"}
  end
end
```

If you want to use atomic updates, it is suggested to write module-based validations & changes,
and implement the appropriate atomic callbacks on those modules. All builtin validations and changes
implement these callbacks in addition to the standard callbacks. Validations will only be run atomically
when the entire action is being run atomically or if one of the relevant fields is being updated atomically.

### Ash.Changeset.attribute_present?/2 (function)

Checks if an attribute is not nil, either in the original data, or that it is not being changed to a `nil` value if it is changing.

This also accounts for the `accessing_from` context that is set when using `manage_relationship`, so it is aware that a particular value
*will* be set by `manage_relationship` even if it isn't currently being set.

### Ash.Changeset.before_action/3 (function)

Adds a before_action hook to the changeset.

Provide the option `prepend?: true` to place the hook before all
other hooks instead of after.

### Ash.Changeset.before_action_fun/0 (type)



### Ash.Changeset.before_transaction/3 (function)

Adds a before_transaction hook to the changeset.

Provide the option `prepend?: true` to place the hook before all
other hooks instead of after.

### Ash.Changeset.before_transaction_fun/0 (type)



### Ash.Changeset.change_attribute/3 (function)

Adds a change to the changeset, unless the value matches the existing value.

### Ash.Changeset.change_attributes/2 (function)

Calls `change_attribute/3` for each key/value pair provided.

### Ash.Changeset.change_default_attribute/3 (function)

The same as `change_attribute`, but annotates that the attribute is currently holding a default value.

This information can be used in changes to see if a value was explicitly set or if it was set by being the default.
Additionally, this is used in `upsert` actions to not overwrite existing values with the default.

### Ash.Changeset.change_new_attribute/3 (function)

Change an attribute only if is not currently being changed

### Ash.Changeset.change_new_attribute_lazy/3 (function)

Change an attribute if is not currently being changed, by calling the provided function.

Use this if you want to only perform some expensive calculation for an attribute value
only if there isn't already a change for that attribute.

### Ash.Changeset.changing_attribute?/2 (function)

Returns true if an attribute exists in the changes

### Ash.Changeset.changing_attributes?/1 (function)

Returns true if any attributes on the resource are being changed.

### Ash.Changeset.changing_relationship?/2 (function)

Returns true if a relationship exists in the changes

### Ash.Changeset.clear_change/2 (function)

Clears an attribute or relationship change off of the changeset.

### Ash.Changeset.delete_argument/2 (function)

Remove an argument from the changeset

### Ash.Changeset.deselect/2 (function)

Ensure the the specified attributes are `nil` in the changeset results.

### Ash.Changeset.ensure_selected/2 (function)

Ensures that the given attributes are selected.

The first call to `select/2` will *limit* the fields to only the provided fields.
Use `ensure_selected/2` to say "select this field (or these fields) without deselecting anything else".

See `select/2` for more.

### Ash.Changeset.error_info/0 (type)



### Ash.Changeset.expand_upsert_fields/2 (function)

Turns the special case {:replace, fields}, :replace_all and {:replace_all_except, fields} upsert_fields
options into a list of fields

### Ash.Changeset.fetch_argument/2 (function)

Fetches the value of an argument provided to the changeset or `:error`.

### Ash.Changeset.fetch_argument_or_change/2 (function)

Gets the value of an argument provided to the changeset, falling back to `Ash.Changeset.fetch_change/2` if nothing was provided.

### Ash.Changeset.fetch_change/2 (function)

Gets the new value for an attribute, or `:error` if it is not being changed.

### Ash.Changeset.filter/2 (function)

Adds a filter for a record being updated or destroyed.

Used by optimistic locking. See `Ash.Resource.Change.Builtins.optimistic_lock/1` for more.

### Ash.Changeset.for_action/4 (function)

Constructs a changeset for a given action, and validates it.

Calls `for_create/4`, `for_update/4` or `for_destroy/4` based on the type of action passed in.

See those functions for more explanation.

### Ash.Changeset.for_create/4 (function)

Constructs a changeset for a given create action, and validates it.

Anything that is modified prior to `for_create/4` is validated against the rules of the action, while *anything after it is not*.
This runs any `change`s contained on your action. To have your logic execute *only* during the action, you can use `after_action/2`
or `before_action/2`.

Multitenancy is *not* validated until an action is called. This allows you to avoid specifying a tenant until just before calling
the domain action.

### Params - Ash.Changeset.for_create/4 (function)

`params` may be attributes, relationships, or arguments. You can safely pass user/form input directly into this function.
Only public attributes and relationships are supported. If you want to change private attributes as well, see the
Customization section below. `params` are stored directly as given in the `params` field of the changeset, which can be
used to retrieve the originally input value.

### Opts - Ash.Changeset.for_create/4 (function)

* `:require?` (`t:boolean/0`) - If set to `false`, values are only required when the action is run (instead of immediately). The default value is `false`.

* `:actor` (`t:term/0`) - set the actor, which can be used in any `Ash.Resource.Change`s configured on the action. (in the `context` argument)

* `:authorize?` (`t:term/0`) - set authorize?, which can be used in any `Ash.Resource.Change`s configured on the action. (in the `context` argument)

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer to use. Will be carried over to the action. For more information see `Ash.Tracer`.

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - set the tenant on the changeset

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:load` (`t:term/0`) - Data to load on the result after running the action.

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:private_arguments` (`t:map/0`) - Private argument values to set before validations and changes. The default value is `%{}`.

* `:return_skipped_upsert?` (`t:boolean/0`) - If `true`, and a record was *not* upserted because its filter prevented the upsert, the original record (which was *not* upserted) will be returned. The default value is `false`.

### Customization - Ash.Changeset.for_create/4 (function)

A changeset can be provided as the first argument, instead of a resource, to allow
setting specific attributes ahead of time.

For example:

    MyResource
    |> Ash.Changeset.new()
    |> Ash.Changeset.change_attribute(:foo, 1)
    |> Ash.Changeset.for_create(:create, ...opts)

Once a changeset has been validated by `for_create/4` (or `for_update/4`), it isn't validated again in the action.
New changes added are validated individually, though. This allows you to create a changeset according
to a given action, and then add custom changes if necessary.

### What does this function do? - Ash.Changeset.for_create/4 (function)

The following steps are run when calling `Ash.Changeset.for_create/4`.

- Cast input params | This is any arguments in addition to any accepted attributes
- Set argument defaults
- Require any missing arguments
- Validate all provided attributes are accepted
- Require any accepted attributes that are `allow_nil?` false
- Set any default values for attributes
- Run action changes & validations
- Run validations, or add them in `before_action` hooks if using `d:Ash.Resource.Dsl.actions.create.validate|before_action?`. Any global validations are skipped if the action has `skip_global_validations?` set to `true`.

### Ash.Changeset.for_destroy/4 (function)

Constructs a changeset for a given destroy action, and validates it.

### Opts - Ash.Changeset.for_destroy/4 (function)

* `:actor` - set the actor, which can be used in any `Ash.Resource.Change`s configured on the action. (in the `context` argument)
* `:tenant` - set the tenant on the changeset
* `:private_arguments` - set private arguments on the changeset before validations and changes are run

Anything that is modified prior to `for_destroy/4` is validated against the rules of the action, while *anything after it is not*.

Once a changeset has been validated by `for_destroy/4`, it isn't validated again in the action.
New changes added are validated individually, though. This allows you to create a changeset according
to a given action, and then add custom changes if necessary.

### What does this function do? - Ash.Changeset.for_destroy/4 (function)

The following steps are run when calling `Ash.Changeset.for_destroy/4`.

- Cast input params | This is any arguments in addition to any accepted attributes
- Set argument defaults
- Require any missing arguments
- Validate all provided attributes are accepted
- Require any accepted attributes that are `allow_nil?` false
- Set any default values for attributes
- Run action changes & validations
- Run validations, or add them in `before_action` hooks if using `d:Ash.Resource.Dsl.actions.destroy.validate|before_action?`. Any global validations are skipped if the action has `skip_global_validations?` set to `true`.

### Ash.Changeset.for_update/4 (function)

Constructs a changeset for a given update action, and validates it.

Anything that is modified prior to `for_update/4` is validated against the rules of the action, while *anything after it is not*.

### What does this function do? - Ash.Changeset.for_update/4 (function)

The following steps are run when calling `Ash.Changeset.for_update/4`.

- Cast input params | This is any arguments in addition to any accepted attributes
- Set argument defaults
- Require any missing arguments
- Validate all provided attributes are accepted
- Require any accepted attributes that are `allow_nil?` false
- Set any default values for attributes
- Run action changes & validations
- Run validations, or add them in `before_action` hooks if using `d:Ash.Resource.Dsl.actions.update.validate|before_action?`. Any global validations are skipped if the action has `skip_global_validations?` set to `true`.

### Ash.Changeset.force_change_attribute/3 (function)

Changes an attribute even if it isn't writable

### Ash.Changeset.force_change_attributes/2 (function)

Calls `force_change_attribute/3` for each key/value pair provided.

### Ash.Changeset.force_change_new_attribute/3 (function)

Force change an attribute if it is not currently being changed.

See `change_new_attribute/3` for more.

### Ash.Changeset.force_change_new_attribute_lazy/3 (function)

Force change an attribute if it is not currently being changed, by calling the provided function.

See `change_new_attribute_lazy/3` for more.

### Ash.Changeset.force_delete_argument/2 (function)

Remove an argument from the changeset, not warning if the changeset has already been validated.

### Ash.Changeset.force_set_argument/3 (function)

Add an argument to the changeset, which will be provided to the action.

Does not show a warning when used in before/after action hooks.

### Ash.Changeset.force_set_arguments/2 (function)

Merge a map of arguments to the arguments list.

Does not show a warning when used in before/after action hooks.

### Ash.Changeset.fully_atomic_changeset/4 (function)



### Ash.Changeset.get_argument/2 (function)

Gets the value of an argument provided to the changeset.

### Ash.Changeset.get_argument_or_attribute/2 (function)

Gets the value of an argument provided to the changeset, falling back to `Ash.Changeset.get_attribute/2` if nothing was provided.

### Ash.Changeset.get_attribute/2 (function)

Gets the changing value or the original value of an attribute.

### Ash.Changeset.get_data/2 (function)

Gets the original value for an attribute

### Ash.Changeset.handle_errors/2 (function)

Sets a custom error handler on the changeset.

The error handler should be a two argument function or an mfa, in which case the first two arguments will be set
to the changeset and the error, w/ the supplied arguments following those. The changeset will be marked
as invalid regardless of the outcome of this callback.

Any errors generated are passed to `handle_errors`, which can return any of the following:

* `:ignore` - the error is discarded.
* `changeset` - a new (or the same) changeset. The error is not added.
* `{changeset, error}` - a new (or the same) error and changeset. The error is added to the changeset.
* `anything_else` - is treated as a new, transformed version of the error. The result is added as an error to the changeset.

### Ash.Changeset.is_valid/1 (macro)

A guard which checks if the Changeset is valid.

### Ash.Changeset.load/2 (function)

Calls the provided load statement on the result of the action at the very end of the action.

### Ash.Changeset.loading?/2 (function)

Returns true if the field/relationship or path to field/relationship is being loaded.

It accepts an atom or a list of atoms, which is treated for as a "path", i.e:

    Resource |> Ash.Changeset.load(friends: [enemies: [:score]]) |> Ash.Changeset.loading?([:friends, :enemies, :score])
    iex> true

    Resource |> Ash.Changeset.load(friends: [enemies: [:score]]) |> Ash.Changeset.loading?([:friends, :score])
    iex> false

    Resource |> Ash.Changeset.load(friends: [enemies: [:score]]) |> Ash.Changeset.loading?(:friends)
    iex> true

### Ash.Changeset.manage_relationship/4 (function)

Manages the related records by creating, updating, or destroying them as necessary.

Keep in mind that the default values for all `on_*` are `:ignore`, meaning nothing will happen
unless you provide instructions.

The input provided to `manage_relationship` should be a map, in the case of to_one relationships, or a list of maps
in the case of to_many relationships. The following steps are followed for each input provided:

- The input is checked against the currently related records to find any matches. The primary key and unique identities are used to find matches.
- For any input that had a match in the current relationship, the `:on_match` behavior is triggered
- For any input that does not have a match:
  - if there is `on_lookup` behavior:
    - we try to find the record in the data layer.
    - if the record is found, the on_lookup behavior is triggered
    - if the record is not found, the `on_no_match` behavior is triggered
  - if there is no `on_lookup` behavior:
    - the `on_no_match` behavior is triggered
- finally, for any records present in the *current relationship* that had no match *in the input*, the `on_missing` behavior is triggered

### Options - Ash.Changeset.manage_relationship/4 (function)

* `:type` - If the `type` is specified, the default values of each option is modified to match that `type` of operation.  
  This allows for specifying certain operations much more succinctly. The defaults that are modified are listed below:  
  - `:append_and_remove`  
        [
          on_lookup: :relate,
          on_no_match: :error,
          on_match: :ignore,
          on_missing: :unrelate
        ]  
  - `:append`  
        [
          on_lookup: :relate,
          on_no_match: :error,
          on_match: :ignore,
          on_missing: :ignore
        ]  
  - `:remove`  
        [
          on_no_match: :error,
          on_match: :unrelate,
          on_missing: :ignore
        ]  
  - `:direct_control`  
        [
          on_lookup: :ignore,
          on_no_match: :create,
          on_match: :update,
          on_missing: :destroy
        ]  
  - `:create`  
        [
          on_no_match: :create,
          on_match: :ignore
        ]
   Valid values are :append_and_remove, :append, :remove, :direct_control, :create

* `:authorize?` (`t:boolean/0`) - Authorize reads and changes to the destination records, if the primary change is being authorized as well. The default value is `true`.

* `:eager_validate_with` (`t:atom/0`) - Validates that any referenced entities exist *before* the action is being performed, using the provided domain for the read. The default value is `false`.

* `:on_no_match` (`t:term/0`) - Instructions for handling records where no matching record existed in the relationship.  
  * `:ignore` (default) - those inputs are ignored
  * `:match` - For `has_one` and `belongs_to` only, any input is treated as a match for an existing value. For `has_many` and `many_to_many`, this is the same as `:ignore`.
  * `:create` - the records are created using the destination's primary create action
  * `{:create, :action_name}` - the records are created using the specified action on the destination resource
  * `{:create, :action_name, :join_table_action_name, [:list, :of, :join_table, :params]}` - Same as `{:create, :action_name}` but takes
      the list of params specified out and applies them when creating the join record, with the provided join_table_action_name.
  * `:error`  - an error is returned indicating that a record would have been created
    *  If `on_lookup` is set, and the data contained a primary key or identity, then the error is a `NotFound` error
    * Otherwise, an `InvalidRelationship` error is returned The default value is `:ignore`.

* `:value_is_key` (`t:atom/0`) - Configures what key to use when a single value is provided.  
  This is useful when you use things like a list of strings i.e `friend_emails` to manage the relationship, instead of a list of maps.  
  By default, we assume it is the primary key of the destination resource, unless it is a composite primary key.

* `:order_is_key` (`t:atom/0`) - If set, the order that each input appears in the list will be added to the input as this key.  
  This is useful when you want to accept an ordered list of related records and write that order to the entity.
  This should only currently be used with `type: :direct_control` or `type: :create` when there are no currently
  existing related records (like when creating the source record).  
  If you have an identity on the field and relationship id on the destination, and you are using
  AshPostgres, you will want to use the `deferrable` option to ensure that conflicting orders are temporarily
  allowed within a single transaction.

* `:identity_priority` (list of `t:atom/0`) - The list, in priority order, of identities to use when looking up records for `on_lookup`, and matching records with `on_match`.  
  Use `:_primary_key` to prioritize checking a match with the primary key.
  All identities, along with `:_primary_key` are checked regardless, this only allows ensuring that some are checked first.
  Defaults to the list provided by `use_identities`, so you typically won't need this option.

* `:use_identities` (list of `t:atom/0`) - A list of identities that may be used to look up and compare records. Use `:_primary_key` to include the primary key. By default, only `[:_primary_key]` is used.

* `:on_lookup` (`t:term/0`) - Before creating a record (because no match was found in the relationship), the record can be looked up and related.  
  * `:ignore` (default) - Does not look for existing entries (matches in the current relationship are still considered updates)
  * `:relate` - Same as calling `{:relate, primary_action_name}`
  * `{:relate, :action_name}` - the records are looked up by primary key/the first identity that is found (using the primary read action), and related. The action should be:
      * `many_to_many` - a create action on the join resource
      * `has_many` - an update action on the destination resource
      * `has_one` - an update action on the destination resource
      * `belongs_to` - an update action on the source resource
  * `{:relate, :action_name, :read_action_name}` - Same as the above, but customizes the read action called to search for matches.
  * `:relate_and_update` - Same as `:relate`, but the remaining parameters from the lookup are passed into the action that is used to change the relationship key
  * `{:relate_and_update, :action_name}` - Same as the above, but customizes the action used. The action should be:
      * `many_to_many` - a create action on the join resource
      * `has_many` - an update action on the destination resource
      * `has_one` - an update action on the destination resource
      * `belongs_to` - an update action on the source resource
  * `{:relate_and_update, :action_name, :read_action_name}` - Same as the above, but customizes the read action called to search for matches.
  * `{:relate_and_update, :action_name, :read_action_name, [:list, :of, :join_table, :params]}` - Same as the above, but uses the provided list of parameters when creating
      the join row (only relevant for many to many relationships). Use `:*` to *only* update the join record, and pass all parameters to its action The default value is `:ignore`.

* `:on_match` (`t:term/0`) - Instructions for handling records where a matching record existed in the relationship already.  
  * `:ignore` (default) - those inputs are ignored
  * `:update` - the record is updated using the destination's primary update action
  * `{:update, :action_name}` - the record is updated using the specified action on the destination resource
  * `{:update, :action_name, :join_table_action_name, [:list, :of, :params]}` - Same as `{:update, :action_name}` but takes
      the list of params specified out and applies them as an update to the join record (only valid for many to many)
  * `:update_join` - update only the join record (only valid for many to many)
  * `{:update_join, :join_table_action_name}` - use the specified update action on a join resource
  * `{:update_join, :join_table_action_name, [:list, :of, :params]}` - pass specified params from input into a join resource update action
  * `{:destroy, :action_name}` - the record is destroyed using the specified action on the destination resource. The action should be:
    * `many_to_many` - a destroy action on the join record
    * `has_many` - a destroy action on the destination resource
    * `has_one` - a destroy action on the destination resource
    * `belongs_to` - a destroy action on the destination resource
  * `:error`  - an error is returned indicating that a record would have been updated
  * `:no_match` - follows the `on_no_match` instructions with these records
  * `:missing` - follows the `on_missing` instructions with these records
  * `:unrelate` - the related item is not destroyed, but the data is "unrelated", making this behave like `remove_from_relationship/3`. The action should be:
    * `many_to_many` - the join resource row is destroyed
    * `has_many` - the `destination_attribute` (on the related record) is set to `nil`
    * `has_one` - the `destination_attribute` (on the related record) is set to `nil`
    * `belongs_to` - the `source_attribute` (on this record) is set to `nil`
  * `{:unrelate, :action_name}` - the record is unrelated using the provided update action. The action should be:
    * `many_to_many` - a destroy action on the join resource
    * `has_many` - an update action on the destination resource
    * `has_one` - an update action on the destination resource
    * `belongs_to` - an update action on the source resource The default value is `:ignore`.

* `:on_missing` (`t:term/0`) - Instructions for handling records that existed in the current relationship but not in the input.  
  * `:ignore` (default) - those inputs are ignored
  * `:destroy` - the record is destroyed using the destination's primary destroy action
  * `{:destroy, :action_name}` - the record is destroyed using the specified action on the destination resource
  * `{:destroy, :action_name, :join_resource_action_name}` - the record is destroyed using the specified action on the destination resource,
    but first the join resource is destroyed with its specified action
  * `:error`  - an error is returned indicating that a record would have been updated
  * `:unrelate` - the related item is not destroyed, but the data is "unrelated", making this behave like `remove_from_relationship/3`. The action should be:
    * `many_to_many` - the join resource row is destroyed
    * `has_many` - the `destination_attribute` (on the related record) is set to `nil`
    * `has_one` - the `destination_attribute` (on the related record) is set to `nil`
    * `belongs_to` - the `source_attribute` (on this record) is set to `nil`
  * `{:unrelate, :action_name}` - the record is unrelated using the provided update action. The action should be:
    * `many_to_many` - a destroy action on the join resource
    * `has_many` - an update action on the destination resource
    * `has_one` - an update action on the destination resource
    * `belongs_to` - an update action on the source resource The default value is `:ignore`.

* `:error_path` (`t:term/0`) - By default, errors added to the changeset will use the path `[:relationship_name]`, or `[:relationship_name,  ]`.
  If you want to modify this path, you can specify `error_path`, e.g if had a `change` on an action that takes an argument
  and uses that argument data to call `manage_relationship`, you may want any generated errors to appear under the name of that
  argument, so you could specify `error_path: :argument_name` when calling `manage_relationship`.

* `:join_keys` (list of `t:atom/0`) - For many to many relationships specifies the parameters to pick from the input and pass into a join resource action.
  Applicable in cases like `on_no_match: :create`, `on_match: :update` and `on_lookup: :relate`.
  Can be overwritten by a full form instruction tuple which contains join parameters at the end.

* `:meta` (`t:term/0`) - Freeform data that will be retained along with the options, which can be used to track/manage the changes
  that are added to the `relationships` key. Use the `meta[:order]` option to specify the order in which multiple
  calls to `manage_relationship` should be executed.

* `:ignore?` (`t:term/0`) - This tells Ash to ignore the provided inputs when actually running the action. This can be useful for
  building up a set of instructions that you intend to handle manually. The default value is `false`.



Each call to this function adds new records that will be handled according to their options. For example,
if you tracked "tags to add" and "tags to remove" in separate fields, you could input them like so:

```elixir
changeset
|> Ash.Changeset.manage_relationship(
  :tags,
  [%{name: "backend"}],
  on_lookup: :relate, #relate that tag if it exists in the database
  on_no_match: :error # error if a tag with that name doesn't exist
)
|> Ash.Changeset.manage_relationship(
  :tags,
  [%{name: "frontend"}],
  on_no_match: :error, # error if a tag with that name doesn't exist in the relationship
  on_match: :unrelate # if a tag with that name is related, unrelate it
)
```

When calling this multiple times with the `on_missing` option set, the list of records that are considered missing are checked
after each set of inputs is processed. For example, if you manage the relationship once with `on_missing: :unrelate`, the records
missing from your input will be removed, and *then* your next call to `manage_relationship` will be resolved (with those records unrelated).
For this reason, it is suggested that you don't call this function multiple times with an `on_missing` instruction, as you may be
surprised by the result.

If you want the input to update existing entities, you need to ensure that the primary key (or unique identity) is provided as
part of the input. See the example below:

    changeset
    |> Ash.Changeset.manage_relationship(
      :comments,
      [%{rating: 10, contents: "foo"}],
      on_no_match: {:create, :create_action},
      on_missing: :ignore
    )
    |> Ash.Changeset.manage_relationship(
      :comments,
      [%{id: 10, rating: 10, contents: "foo"}],
      on_match: {:update, :update_action},
      on_no_match: {:create, :create_action})

This is a simple way to manage a relationship. If you need custom behavior, you can customize the action that is
called, which allows you to add arguments/changes. However, at some point you may want to forego this function
and make the changes yourself. For example:

    input = [%{id: 10, rating: 10, contents: "foo"}]

    changeset
    |> Ash.Changeset.after_action(fn _changeset, result ->
      # An example of updating comments based on a result of other changes
      for comment <- input do
        comment = Ash.get(Comment, comment.id)

        comment
        |> Map.update(:rating, 0, &(&1 * result.rating_weight))
        |> Ash.update!()
      end

      {:ok, result}
    end)

### Using records as input - Ash.Changeset.manage_relationship/4 (function)

Records can be supplied as the input values. If you do:

* if it would be looked up due to `on_lookup`, the record is used as-is
* if it would be created due to `on_no_match`, the record is used as-is
* Instead of specifying `join_keys`, those keys must go in `__metadata__.join_keys`. If `join_keys` is specified in the options, it is ignored.

For example:

```elixir
post1 =
  changeset
  |> Ash.create!()
  |> Ash.Resource.put_metadata(:join_keys, %{type: "a"})

post2 =
  changeset2
  |> Ash.create!()
  |> Ash.Resource.put_metadata(:join_keys, %{type: "b"})

author = Ash.create!(author_changeset)

Ash.Changeset.manage_relationship(
  author,
  :posts,
  [post1, post2],
  on_lookup: :relate
)
```

### Ash.Changeset.manage_relationship_type/0 (type)



### Ash.Changeset.new/1 (function)

Returns a new changeset over a resource.

*Warning*: You almost always want to use `for_action` or `for_create`, etc. over this function if possible.

You can use this to start a changeset and make changes prior to calling `for_action`. This is not typically
necessary, but can be useful as an escape hatch. For example:

```elixir
Resource
|> Ash.Changeset.new()
|> Ash.Changeset.change_attribute(:name, "foobar")
|> Ash.Changeset.for_action(...)
```

### Ash.Changeset.phase/0 (type)



### Ash.Changeset.prepare_changeset_for_action/3 (function)



### Ash.Changeset.present?/2 (function)

Checks if an argument is not nil or an attribute is not nil, either in the original data, or that it is not being changed to a `nil` value if it is changing.

This also accounts for the `accessing_from` context that is set when using `manage_relationship`, so it is aware that a particular value
*will* be set by `manage_relationship` even if it isn't currently being set.

### Ash.Changeset.put_context/3 (function)

Puts a key/value in the changeset context that can be used later.

Do not use the `private` key in your custom context, as that is reserved for internal use.

### Ash.Changeset.run_before_transaction_hooks/1 (function)



### Ash.Changeset.select/3 (function)

Ensure that only the specified attributes are present in the results.

The first call to `select/2` will replace the default behavior of selecting
all attributes. Subsequent calls to `select/2` will combine the provided
fields unless the `replace?` option is provided with a value of `true`.

If a field has been deselected, selecting it again will override that (because a single list of fields is tracked for selection)

Primary key attributes always selected and cannot be deselected.

When attempting to load a relationship (or manage it with `Ash.Changeset.manage_relationship/3`),
if the source field is not selected on the query/provided data an error will be produced. If loading
a relationship with a query, an error is produced if the query does not select the destination field
of the relationship.

Datalayers currently are not notified of the `select` for a changeset(unlike queries), and creates/updates select all fields when they are performed.
A select provided on a changeset sets the unselected fields to `nil` before returning the result.

Use `ensure_selected/2` if you wish to make sure a field has been selected, without deselecting any other fields.

### Ash.Changeset.selecting?/2 (function)



### Ash.Changeset.set_argument/3 (function)

Add an argument to the changeset, which will be provided to the action.

### Ash.Changeset.set_arguments/2 (function)

Merge a map of arguments to the arguments list.

### Ash.Changeset.set_context/2 (function)

Deep merges the provided map into the changeset context that can be used later.

Do not use the `private` key in your custom context, as that is reserved for internal use.

### Ash.Changeset.set_private_argument/3 (function)

Add a private argument to the changeset, which will be provided to the action.

### Ash.Changeset.set_result/2 (function)

Set the result of the action. This will prevent running the underlying datalayer behavior

### Ash.Changeset.set_tenant/2 (function)



### Ash.Changeset.t/0 (type)



### Ash.Changeset.timeout/3 (function)



### Ash.Changeset.update_change/3 (function)

Updates an existing attribute change by applying a function to it.

This is useful for applying some kind of normalization to the attribute.

```elixir
Ash.Changeset.update_change(changeset, :serial, &String.downcase/1)
```

The update function gets called with the value already cast to the correct type.

```elixir
changeset
|> Ash.Changeset.change_attribute(:integer_attribute, "3")
|> Ash.Changeset.update_change(:integer_attribute, fn x -> x + 1 end)
```

### Invalid value handling - Ash.Changeset.update_change/3 (function)

If `update_change` is called with a changeset that has not been validated yet, the update
function must handle potentially invalid and `nil` values.

To only deal with valid values, you can call `update_change` in a `before_action` hook.

### Ash.Changeset.with_hooks/3 (function)

Wraps a function in the before/after action hooks of a changeset.

The function takes a changeset and if it returns
`{:ok, result}`, the result will be passed through the after
action hooks.

### Ash.Domain (behaviour)

A domain allows you to interact with your resources, and holds domain-wide configuration.

For example, the json domain extension adds a domain extension that lets you toggle authorization on/off
for all resources in a given domain. You include resources in your domain like so:

```elixir
defmodule MyApp.MyDomain do
  use Ash.Domain

  resources do
    resource OneResource
    resource SecondResource
  end
end
```

### Options - Ash.Domain (behaviour)

* `:validate_config_inclusion?` (`t:boolean/0`) - Whether or not to validate that this domain is included in the configuration. The default value is `true`.

* `:backwards_compatible_interface?` (`t:boolean/0`) - Whether or not to include the 2.0 backwards compatible interface, which includes all of the interaction functions which are now defined on the `Ash` module The default value is `true`.

* `:extensions` (list of module that adopts `Spark.Dsl.Extension`) - A list of DSL extensions to add to the `Spark.Dsl`

* `:authorizers` (one or a list of module that adopts `Ash.Authorizer`) - authorizers extensions to add to the `Spark.Dsl` The default value is `[]`.

* `:otp_app` (`t:atom/0`) - The otp_app to use for any application configurable options

* `:fragments` (list of `t:module/0`) - Fragments to include in the `Spark.Dsl`. See the fragments guide for more.

### Ash.Domain.t/0 (type)



### Ash.Query (module)

A data structure for reading data from a resource.

Queries are run by calling `Ash.read/2`.

Examples:

```elixir
require Ash.Query

MyApp.Post
|> Ash.Query.filter(likes > 10)
|> Ash.Query.sort([:title])
|> Ash.read!()

MyApp.Author
|> Ash.Query.aggregate(:published_post_count, :posts, query: [filter: [published: true]])
|> Ash.Query.sort(published_post_count: :desc)
|> Ash.Query.limit(10)
|> Ash.read!()

MyApp.Author
|> Ash.Query.load([:post_count, :comment_count])
|> Ash.Query.load(posts: [:comments])
|> Ash.read!()
```

To see more examples of what you can do with `Ash.Query` and read actions in general,
see the [writing queries how-to guide](/documentation/how-to/write-queries.livemd).

### Capabilities & Limitations - Ash.Query (module)

Ash Framework provides a comprehensive suite of querying tools designed to address common application development needs. While powerful and flexible, these tools are focused on domain-driven design rather than serving as a general-purpose ORM.

Ash's query tools support:

- Filtering records based on complex conditions
- Sorting results using single or multiple criteria
- Setting result limits and offsets
- Pagination, with offset/limit and keysets
- Selecting distinct records to eliminate duplicates
- Computing dynamic properties at query time
- Aggregating data from related resources

While Ash's query tools often eliminate the need for direct database queries, Ash is not itself designed to be a comprehensive ORM or database query builder.

For specialized querying needs that fall outside Ash's standard capabilities, the framework provides escape hatches. These mechanisms allow developers to implement custom query logic when necessary. For detailed information about these escape hatches, refer to the `Ash.Query` module documentation.

### Important Considerations - Ash.Query (module)

1. Ash is primarily a domain modeling framework, not a database abstraction layer
2. While comprehensive, the tooling is intentionally constrained to resource-oriented access
3. Escape hatches exist for cases that require custom query logic

For complex queries that fall outside these tools, consider whether they represent domain concepts that could be modeled differently, or if they truly require custom implementation through escape hatches.

### Escape Hatches - Ash.Query (module)

Many of these tools are surprisingly deep and capable, covering everything you
need to build your domain logic. With that said, these tools are *not*
designed to encompass *every kind of query* that you could possibly want to
write over your data. `Ash` is *not* an ORM or a database query tool, despite
the fact that its query building tools often make those kinds of tools
unnecessary in all but the rarest of cases. Not every kind of query that you
could ever wish to write can be expressed with Ash.Query. Elixir has a
best-in-class library for working directly with databases, called
[Ecto](https://hexdocs.pm/ecto/Ecto.html), and if you end up building a
certain type of feature like analytics or reporting dashboards, you may find
yourself working directly with Ecto. Data layers like AshPostgres are built
on top of Ecto. In fact, every `Ash.Resource` is an `Ecto.Schema`!

>

### Choose escape hatches wisely - Ash.Query (module)

>
> You should choose to use Ash builtin functionality wherever possible.
> Barring that, you should choose the *least powerful* escape hatch that
> can solve your problem. The options below are presented in the order
> that you should prefer them, but you should only use *any of them*
> if no builtin tooling will suffice.

### Fragments - Ash.Query (module)

Fragments only barely count as an escape hatch. You will often find yourself
wanting to use a function or operator specific to your data layer, and fragments
are purpose built to this end. You can use data-layer-specific expressions in your
expressions for filters, calculations, etc. For example:

```elixir
Resource
|> Ash.Query.filter(expr(fragment("lower(?)", name) == "fred"))
|> Ash.Query.filter(expr(fragment("? @> ?", tags, ["important"])))
```

### Manual Read Actions - Ash.Query (module)

See [the manual read actions guide](/documentation/topics/actions/manual-actions.md).

### `d:Ash.Resource.Dsl|actions.read.modify_query`

When running read actions, you can modify the underlying data layer query directly,
which can solve for cases when you cannot express your query using the standard Ash query interface.

```elixir
actions do
  read :complex_search do
    argument
    modify_query {SearchMod, :modify, []}
  end
end
```

```elixir
defmodule SearchMod do
  def modify(ash_query, data_layer_query) do
    # Here you can modify the underlying data layer query directly
    # For example, with AshPostgres you get access to the Ecto query
    {:ok, Ecto.Query.where(data_layer_query, [p], fragment("? @@ plainto_tsquery(?)", p.search_vector, ^ash_query.arguments.search_text))}
  end
end
```

### Using Ecto directly - Ash.Query (module)

For data layers like `AshPostgres`, you can interact directly with `Ecto`. You can do this
by using the `Ash.Resource` as its corresponding `Ecto.Schema`, like so:

```elixir
import Ecto.Query

query =
  from p in MyApp.Post,
    where: p.likes > 100,
    select: p

 MyApp.Repo.all(query)
```

Or you can build an `Ash.Query`, and get the corresponding ecto query:

```elixir
MyApp.Post
|> Ash.Query.for_read(:read)
|> Ash.Query.data_layer_query()
|> case do
  {:ok, ecto_query} ->
    ecto_query
    |> Ecto.Query.where([p], p.likes > 100)
    |> MyApp.Repo.all()

  {:error, error} ->
    {:error, error}
end
```

### Ash.Query.accessing/3 (function)

Returns a list of attributes, aggregates, relationships, and calculations that are being loaded

Provide a list of field types to narrow down the returned results.

### Ash.Query.add_error/3 (function)

Add an error to the errors list and mark the query as invalid.

See `Ash.Error.to_ash_error/3` for more on supported values for `error`

### Inconsistencies - Ash.Query.add_error/3 (function)

The `path` argument is the second argument here, but the third argument
in `Ash.ActionInput.add_error/2` and `Ash.Changeset.add_error/2`.
This will be fixed in 4.0.

### Ash.Query.after_action/2 (function)



### Ash.Query.aggregate/4 (function)

Adds an aggregation to the query.

Aggregations are made available on the `aggregates` field of the records returned

The filter option accepts either a filter or a keyword list of options to supply to build a limiting query for that aggregate.
See the DSL docs for each aggregate type in the [Resource DSL docs](dsl-ash-resource.html#aggregates) for more information.

### Options - Ash.Query.aggregate/4 (function)

* query: The query over the destination resource to use as a base for aggregation
  * field: - The field to use for the aggregate. Not necessary for all aggregate types
  * default: The default value to use if the aggregate returns nil
  * filterable?: Whether or not this aggregate may be referenced in filters
  * type: The type of the aggregate
  * constraints: Type constraints for the aggregate's type
  * implementation: An implementation used when the aggregate kind is custom
  * read_action: The read action to use on the destination resource
  * authorize?: Whether or not to authorize access to this aggregate
  * join_filters: A map of relationship paths to filter expressions. See the aggregates guide for more

### Ash.Query.aggregate/5 (function)



### Ash.Query.apply_to/3 (function)



### Ash.Query.around_action_fun/0 (type)



### Ash.Query.around_callback/0 (type)



### Ash.Query.around_result/0 (type)



### Ash.Query.around_transaction/2 (function)

Adds an around_transaction hook to the query.

Your function will get the query, and a callback that must be called with a query (that may be modified).
The callback will return `{:ok, results}` or `{:error, error}`. You can modify these values, but the return value
must be one of those types.

The around_transaction calls happen first, and then (after they each resolve their callbacks) the `before_action`
hooks are called, followed by the `after_action` hooks being run. Then, the code that appeared *after* the callbacks were called is then run.

Warning: using this without understanding how it works can cause big problems.
You *must* call the callback function that is provided to your hook, and the return value must
contain the same structure that was given to you, i.e `{:ok, result_of_action}`.

### Ash.Query.around_transaction_fun/0 (type)



### Ash.Query.authorize_results/2 (function)



### Ash.Query.before_action/3 (function)

Adds a before_action hook to the query.

Provide the option `prepend?: true` to place the hook before all
other hooks instead of after.

### Ash.Query.build/3 (function)

Builds a query from a keyword list.

This is used by certain query constructs like aggregates. It can also be used to manipulate a data structure
before passing it to an ash query. It allows for building an entire query struct using only a keyword list.

For example:

```elixir
Ash.Query.build(MyResource, filter: [name: "fred"], sort: [name: :asc], load: [:foo, :bar], offset: 10)
```

If you want to use the expression style filters, you can use `expr/1`.

For example:

```elixir
import Ash.Expr, only: [expr: 1]

Ash.Query.build(Myresource, filter: expr(name == "marge"))
```

### Options - Ash.Query.build/3 (function)

* `:filter` (`t:term/0`) - A filter keyword, map or expression

* `:filter_input` (`t:term/0`) - A filter keyword or map, provided as input from an external source

* `:sort` (`t:term/0`) - A sort list or keyword

* `:sort_input` (`t:term/0`) - A sort list or keyword, provided as input from an external source

* `:default_sort` (`t:term/0`) - A sort list or keyword to apply only if no other sort is specified, So if you apply any `sort`, this will be ignored.

* `:distinct_sort` (`t:term/0`) - A distinct_sort list or keyword

* `:limit` (`t:integer/0`) - A limit to apply

* `:offset` (`t:integer/0`) - An offset to apply

* `:load` (`t:term/0`) - A load statement to add to the query

* `:select` (`t:term/0`) - A select statement to add to the query

* `:ensure_selected` (`t:term/0`) - An ensure_selected statement to add to the query

* `:aggregate` (`t:term/0`) - A custom aggregate to add to the query. Can be `{name, type, relationship}` or `{name, type, relationship, build_opts}`

* `:calculate` (`t:term/0`) - A custom calculation to add to the query. Can be `{name, module_and_opts}` or `{name, module_and_opts, context}`

* `:distinct` (list of `t:atom/0`) - A distinct clause to add to the query

* `:context` (`t:map/0`) - A map to merge into the query context

### Ash.Query.calculate/8 (function)

Adds a calculation to the query.

Calculations are made available on the `calculations` field of the records returned

The `module_and_opts` argument accepts either a `module` or a `{module, opts}`. For more information
on what that module should look like, see `Ash.Resource.Calculation`.

### Ash.Query.clear_result/1 (function)

Removes a result set previously with `set_result/2`

### Ash.Query.combination_calcs/2 (function)



### Ash.Query.combination_of/2 (function)

Produces a query that is the combination of multiple queries.

All aspects of the parent query are applied to the combination in total.

See `Ash.Query.Combination` for more on creating combination queries.

### Example - Ash.Query.combination_of/2 (function)

```elixir
# Top ten users not on a losing streak and top ten users who are not on a winning streak
User
|> Ash.Query.filter(active == true)
|> Ash.Query.combination_of([
  # must always begin with a base combination
  Ash.Query.Combination.base(
    sort: [score: :desc],
    filter: expr(not(on_a_losing_streak)),
    limit: 10
  ),
  Ash.Query.Combination.union(
    sort: [score: :asc],
    filter: expr(not(on_a_winning_streak)),
    limit: 10
  )
])
|> Ash.read!()
```

### Select and calculations - Ash.Query.combination_of/2 (function)

There is no `select` available for combinations, instead the select of the outer query
is used for each combination. However, you can use the `calculations` field in
`Ash.Query.Combination` to add expression calculations. Those calculations can "overwrite"
a selected attribute, or can introduce a new field. Note that, for SQL data layers, all
combinations will be required to have the same number of fields in their SELECT statement,
which means that if one combination adds a calculation, all of the others must also add
that calculation.

In this example, we compute separate match scores

```elixir
query = "fred"

User
|> Ash.Query.filter(active == true)
|> Ash.Query.combination_of([
  # must always begin with a base combination
  Ash.Query.Combination.base(
    filter: expr(trigram_similarity(user_name, ^query) >= 0.5),
    calculate: %{
      match_score: trigram_similarity(user_name, ^query)
    },
    sort: [
      calc(trigram_similarity(user_name, ^query), :desc)
    ],
    limit: 10
  ),
  Ash.Query.Combination.union(
    filter: expr(trigram_similarity(email, ^query) >= 0.5),
    calculate: %{
      match_score: trigram_similarity(email, ^query)
    },
    sort: [
      calc(trigram_similarity(email, ^query), :desc)
    ],
    limit: 10
  )
])
|> Ash.read!()
```

### Ash.Query.data_layer_query/2 (function)

Return the underlying data layer query for an ash query

### Ash.Query.default_sort/3 (function)

Apply a sort only if no sort has been specified yet.

This is useful for providing default sorts that can be overridden.

### Examples - Ash.Query.default_sort/3 (function)

```elixir
# This will sort by name if no sort has been specified
Ash.Query.default_sort(query, :name)

# This will sort by name descending if no sort has been specified
Ash.Query.default_sort(query, name: :desc)
```

### Ash.Query.delete_argument/2 (function)

Remove an argument from the query

### Ash.Query.deselect/2 (function)

Ensure the the specified attributes are `nil` in the query results.

### Ash.Query.distinct/2 (function)

Get results distinct on the provided fields.

Takes a list of fields to distinct on. Each call is additive, so to remove the `distinct` use
`unset/2`.

Examples:

```
Ash.Query.distinct(query, [:first_name, :last_name])

Ash.Query.distinct(query, :email)
```

### Ash.Query.distinct_sort/3 (function)

Set a sort to determine how distinct records are selected.

If none is set, any sort applied to the query will be used.

This is useful if you want to control how the `distinct` records
are selected without affecting (necessarily, it may affect it if
there is no sort applied) the overall sort of the query

### Ash.Query.ensure_selected/2 (function)

Ensures that the given attributes are selected.

The first call to `select/2` will *limit* the fields to only the provided fields.
Use `ensure_selected/2` to say "select this field (or these fields) without deselecting anything else".

See `select/2` for more.

### Ash.Query.equivalent_to/2 (macro)

Determines if the filter statement of a query is equivalent to the provided expression.

This uses the satisfiability solver that is used when solving for policy authorizations. In complex scenarios, or when using
custom database expressions, (like fragments in ash_postgres), this function may return `:maybe`. Use `supserset_of?` to always return
a boolean.

### Ash.Query.equivalent_to?/2 (macro)

Same as `equivalent_to/2` but always returns a boolean. `:maybe` returns `false`.

### Ash.Query.fetch_argument/2 (function)

fetches the value of an argument provided to the query or `:error`

### Ash.Query.filter/2 (macro)

Attach a filter statement to the query.

The filter is applied as an "and" to any filters currently on the query.
For more information on writing filters, see: `Ash.Filter`.

### Ash.Query.filter_input/2 (function)

Attach a filter statement to the query labelled as user input.

Filters added as user input (or filters constructed with `Ash.Filter.parse_input`)
will honor any field policies on resources by replacing any references to the field
with `nil` in cases where the actor should not be able to see the given field.

This function does not expect the expression style filter (because an external source
could never reasonably provide that). Instead, use the keyword/map style syntax. For
example:

`expr(name == "fred")`

could be any of

- map syntax: `%{"name" => %{"eq" => "fred"}}`
- keyword syntax: `[name: [eq: "fred"]]`

See `Ash.Filter` for more.

### Ash.Query.for_read/4 (function)

Creates a query for a given read action and prepares it.

Multitenancy is *not* validated until an action is called. This allows you to avoid specifying a tenant until just before calling
the domain action.

### Arguments - Ash.Query.for_read/4 (function)

Provide a map or keyword list of arguments for the read action

### Opts - Ash.Query.for_read/4 (function)

* `:actor` (`t:term/0`) - set the actor, which can be used in any `Ash.Resource.Change`s configured on the action. (in the `context` argument)

* `:authorize?` (`t:boolean/0`) - set authorize?, which can be used in any `Ash.Resource.Change`s configured on the action. (in the `context` argument)

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer to use. Will be carried over to the action. For more information see `Ash.Tracer`.

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - set the tenant on the query

* `:load` (`t:term/0`) - A load statement to apply to the query

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:context` (`t:map/0`) - A map of context to set on the query. This will be merged with any context set on the query itself.

### Ash.Query.get_argument/2 (function)

Gets the value of an argument provided to the query

### Ash.Query.limit/2 (function)

Limit the results returned from the query

### Ash.Query.load/3 (function)

Loads relationships, calculations, or aggregates on the resource.

By default, loading attributes has no effects, as all attributes are returned.

```elixir
# Loading nested relationships
Ash.Query.load(query, [comments: [:author, :ratings]])

# Loading relationships with a query
Ash.Query.load(query, [comments: [author: author_query]])
```

By passing the `strict?: true` option, only specified attributes will be loaded when passing
a list of fields to fetch on a relationship, which allows for more optimized data-fetching.

The select statement of any queries inside the load statement will not be affected.

Example:
```elixir
Ash.load(category, [:name, posts: [:title, :published_at]], strict?: true)
```

Here, the only fields that will be loaded on the `posts` relationship are `title` and
`published_at`, in addition to any other fields that are required to be loaded, like the
primary and relevant foreign keys.
This entails that when using `strict?: true` and loading nested relationships, you will also
always have to specify all the attributes you want to load alongside the nested relationships.

Example:
```elixir
Ash.load(post, [:title, :published_at, :other_needed_attribute, category: [:name]], strict?: true)
```

If no fields are specified on a relationship when using `strict?: true`, all attributes will be
loaded by default.

Example:
```elixir
Ash.load(category, [:name, :posts], strict?: true)
```

### Ash.Query.load_calculation_as/5 (function)

Adds a resource calculation to the query as a custom calculation with the provided name.

Example:

    Ash.Query.load_calculation_as(query, :calculation, :some_name, args: %{}, load_through: [:foo])

### Ash.Query.load_through/4 (function)

Adds a load statement to the result of an attribute or calculation.

Uses `Ash.Type.load/5` to request that the type load nested data.

### Ash.Query.loading?/2 (function)

Returns true if the field/relationship or path to field/relationship is being loaded.

It accepts an atom or a list of atoms, which is treated for as a "path", i.e:

    Resource |> Ash.Query.load(friends: [enemies: [:score]]) |> Ash.Query.loading?([:friends, :enemies, :score])
    iex> true

    Resource |> Ash.Query.load(friends: [enemies: [:score]]) |> Ash.Query.loading?([:friends, :score])
    iex> false

    Resource |> Ash.Query.load(friends: [enemies: [:score]]) |> Ash.Query.loading?(:friends)
    iex> true

### Ash.Query.lock/2 (function)

Lock the query results.

This must be run while in a transaction, and is not supported by all data layers.

### Ash.Query.merge_query_load/3 (function)

Merges two query's load statements, for the purpose of handling calculation requirements.

This should only be used if you are writing a custom type that is loadable.
See the callback documentation for `c:Ash.Type.merge_load/4` for more.

### Ash.Query.new/2 (function)

Create a new query

### Ash.Query.offset/2 (function)

Skip the first n records

### Ash.Query.page/2 (function)

Sets the pagination options of the query.

Pass `nil` to disable pagination.

### Limit/offset pagination - Ash.Query.page/2 (function)

* `:offset` (`t:non_neg_integer/0`) - The number of records to skip from the beginning of the query

* `:limit` (`t:pos_integer/0`) - The number of records to include in the page

* `:filter` (`t:term/0`) - A filter to apply for pagination purposes, that should not be considered in the full count.  
  This is used by the liveview paginator to only fetch the records that were *already* on the
  page when refreshing data, to avoid pages jittering.

* `:count` (`t:boolean/0`) - Whether or not to return the page with a full count of all records

### Keyset pagination - Ash.Query.page/2 (function)

* `:before` (`t:String.t/0`) - Get records that appear before the provided keyset (mutually exclusive with `after`)

* `:after` (`t:String.t/0`) - Get records that appear after the provided keyset (mutually exclusive with `before`)

* `:limit` (`t:pos_integer/0`) - How many records to include in the page

* `:filter` (`t:term/0`) - See the `filter` option for offset pagination, this behaves the same.

* `:count` (`t:boolean/0`) - Whether or not to return the page with a full count of all records

### Ash.Query.put_context/3 (function)

Sets a specific context key to a specific value

See `set_context/2` for more information.

### Ash.Query.select/3 (function)

Ensure that only the specified *attributes* are present in the results.

The first call to `select/2` will replace the default behavior of selecting
all attributes. Subsequent calls to `select/2` will combine the provided
fields unless the `replace?` option is provided with a value of `true`.

If a field has been deselected, selecting it again will override that (because a single list of fields is tracked for selection)

Primary key attributes are always selected and cannot be deselected.

When attempting to load a relationship (or manage it with `Ash.Changeset.manage_relationship/3`),
if the source field is not selected on the query/provided data an error will be produced. If loading
a relationship with a query, an error is produced if the query does not select the destination field
of the relationship.

Use `ensure_selected/2` if you wish to make sure a field has been selected, without deselecting any other fields.

### Ash.Query.selecting?/2 (function)



### Ash.Query.set_argument/3 (function)

Add an argument to the query, which can be used in filter templates on actions

### Ash.Query.set_arguments/2 (function)

Merge a map of arguments to the arguments list

### Ash.Query.set_context/2 (function)

Merge a map of values into the query context

### Ash.Query.set_domain/2 (function)

Set the query's domain, and any loaded query's domain

### Ash.Query.set_result/2 (function)

Set the result of the action. This will prevent running the underlying datalayer behavior

### Ash.Query.set_tenant/2 (function)



### Ash.Query.sort/3 (function)

Sort the results based on attributes, aggregates or calculations.

### Format - Ash.Query.sort/3 (function)

Your sort can be an atom, list of atoms, a keyword list, or a string. When an order is not specified,
`:asc` is the default. See Sort Orders below for more on the available orders.

```elixir
# sort by name ascending
Ash.Query.sort(query, :name)

# sort by name descending
Ash.Query.sort(query, name: :desc)

# sort by name descending with nils at the end
Ash.Query.sort(query, name: :desc_nils_last)

# sort by name descending, and title ascending
Ash.Query.sort(query, name: :desc, title: :asc)

# sort by name ascending
Ash.Query.sort(query, "name")

# sort by name descending, and title ascending
Ash.Query.sort(query, "-name,title")

# sort by name descending with nils at the end
Ash.Query.sort(query, "--name")
```

### Related Fields - Ash.Query.sort/3 (function)

You can refer to related fields using the shorthand of `"rel1.rel2.field"`. For example:

```elixir
# sort by the username of the comment's author.
Ash.Query.sort(query, "comment.author.username")

# Use as an atom for keyword lists
Ash.Query.sort(query, "comment.author.username": :desc)
```

### Expression Sorts - Ash.Query.sort/3 (function)

You can use the `Ash.Expr.calc/2` macro to sort on expressions:

```elixir
import Ash.Expr

# Sort on an expression
Ash.Query.sort(query, calc(count(friends), :desc))

# Specify a type (required in some cases when we can't determine a type)
Ash.Query.sort(query, [{calc(fragment("some_sql(?)", field, type: :string), :desc}])
```

### Sort Strings - Ash.Query.sort/3 (function)

A comma separated list of fields to sort on, each with an optional prefix.

The prefixes are:

* "+" - Same as no prefix. Sorts `:asc`.
* "++" - Sorts `:asc_nils_first`
* "-" - Sorts `:desc`
* "--" - Sorts `:desc_nils_last`

For example

    "foo,-bar,++baz,--buz"

### A list of sort strings - Ash.Query.sort/3 (function)

Same prefix rules as above, but provided as a list.

For example:

    ["foo", "-bar", "++baz", "--buz"]

### Calculations - Ash.Query.sort/3 (function)

Calculation inputs can be provided by providing a map. To provide both inputs and an order,
use a tuple with the first element being the inputs, and the second element being the order.

```elixir
Ash.Query.sort(query, full_name: %{separator: " "})

Ash.Query.sort(query, full_name: {%{separator: " "}, :asc})
```

### Sort Orders - Ash.Query.sort/3 (function)

The available orders are:

- `:asc` - Sort values ascending, with lowest first and highest last, and `nil` values at the end
- `:desc` - Sort values descending, with highest first and lowest last, and `nil` values at the beginning
- `:asc_nils_first` - Sort values ascending, with lowest first and highest last, and `nil` values at the beginning
- `:desc_nils_last` - Sort values descending, with highest first and lowest last, and `nil` values at the end

### Examples - Ash.Query.sort/3 (function)

```elixir
Ash.Query.sort(query, [:foo, :bar])

Ash.Query.sort(query, [:foo, bar: :desc])

Ash.Query.sort(query, [foo: :desc, bar: :asc])
```

See the guide on calculations for more.

### Options - Ash.Query.sort/3 (function)

- `prepend?` - set to `true` to put your sort at the front of the list of a sort is already specified

### Ash.Query.sort_input/3 (function)

Attach a sort statement to the query labelled as user input.

Sorts added as user input (or filters constructed with `Ash.Filter.parse_input`)
will honor any field policies on resources by replacing any references to the field
with `nil` in cases where the actor should not be able to see the given field.

See `Ash.Query.sort/3` for more information on accepted formats.

### Ash.Query.struct?/1 (function)



### Ash.Query.subset_of/2 (macro)

Determines if the provided expression would return data that is a suprset of the data returned by the filter on the query.

This uses the satisfiability solver that is used when solving for policy authorizations. In complex scenarios, or when using
custom database expressions, (like fragments in ash_postgres), this function may return `:maybe`. Use `subset_of?` to always return
a boolean.

### Ash.Query.subset_of?/2 (macro)

Same as `subset_of/2` but always returns a boolean. `:maybe` returns `false`.

### Ash.Query.superset_of/2 (macro)

Determines if the provided expression would return data that is a subset of the data returned by the filter on the query.

This uses the satisfiability solver that is used when solving for policy authorizations. In complex scenarios, or when using
custom database expressions, (like fragments in ash_postgres), this function may return `:maybe`. Use `supserset_of?` to always return
a boolean.

### Ash.Query.superset_of?/2 (macro)

Same as `superset_of/2` but always returns a boolean. `:maybe` returns `false`.

### Ash.Query.t/0 (type)



### Ash.Query.timeout/2 (function)



### Ash.Query.unload/2 (function)

Removes a field from the list of fields to load

### Ash.Query.unset/2 (function)



### Ash.Query.Aggregate (module)

Represents an aggregated association value

### Ash.Query.Aggregate.default_value/1 (function)



### Ash.Query.Aggregate.kind/0 (type)



### Ash.Query.Aggregate.new/4 (function)

Create a new aggregate, used with `Query.aggregate` or `Ash.aggregate`

### Options - Ash.Query.Aggregate.new/4 (function)

* `:path` (list of `t:atom/0`) - The relationship path to aggregate over. Only used when adding aggregates to a query. The default value is `[]`.

* `:query` (`t:term/0`) - A base query to use for the aggregate, or a keyword list to be passed to `Ash.Query.build/2`

* `:field` - The field to use for the aggregate. Not necessary for all aggregate types.

* `:expr` (`t:term/0`) - An expression to aggregate, cannot be used with `field`.

* `:expr_type` - The type of the expression, required if `expr` is used.

* `:arguments` (`t:map/0`) - Arguments to pass to the field, if field is a calculation.

* `:default` (`t:term/0`) - A default value to use for the aggregate if it returns `nil`.

* `:filterable?` (`t:boolean/0`) - Whether or not this aggregate may be used in filters. The default value is `true`.

* `:sortable?` (`t:boolean/0`) - Whether or not this aggregate may be used in sorts. The default value is `true`.

* `:type` (`t:term/0`) - A type to use for the aggregate.

* `:constraints` (`t:term/0`) - Type constraints to use for the aggregate. The default value is `[]`.

* `:implementation` (`t:term/0`) - The implementation for any custom aggregates.

* `:read_action` (`t:atom/0`) - The read action to use for the aggregate, defaults to the primary read action.

* `:uniq?` (`t:boolean/0`) - Whether or not to only consider unique values. Only relevant for `count` and `list` aggregates. The default value is `false`.

* `:include_nil?` (`t:boolean/0`) - Whether or not to include `nil` values in the aggregate. Only relevant for `list` and `first` aggregates. The default value is `false`.

* `:join_filters` (map of one or a list of `t:atom/0` keys and `t:term/0` values) - A map of relationship paths (an atom or list of atoms), to an expression to apply when fetching the aggregate data. See the aggregates guide for more. The default value is `%{}`.

* `:sensitive?` (`t:boolean/0`) - Whether or not references to this aggregate will be considered sensitive The default value is `false`.

* `:tenant` (`t:term/0`) - The tenant to use for the aggregate, if applicable. The default value is `nil`.

* `:authorize?` (`t:boolean/0`) - Whether or not the aggregate query should authorize based on the target action.  
  See `d:Ash.Resource.Dsl.aggregates|count` for more information. The default value is `true`.

### Ash.Query.Aggregate.new!/4 (function)



### Ash.Query.Aggregate.t/0 (type)



### Ash.Query.Calculation (module)

Represents a calculated attribute requested on a query

### Ash.Query.Calculation.from_resource_calculation/3 (function)

Creates a new query calculation from a resource calculation.

### Options - Ash.Query.Calculation.from_resource_calculation/3 (function)

* `:args` (`t:map/0`) - Arguments to pass to the calculation The default value is `%{}`.

* `:source_context` (`t:map/0`) - Context from the source query or changeset. The default value is `%{}`.

### Ash.Query.Calculation.from_resource_calculation!/3 (function)

Creates a new query calculation from a resource calculation, raising any errors.

See `from_resource_calculation/3` for more.

### Ash.Query.Calculation.new/6 (function)

Creates a new query calculation.

### Options - Ash.Query.Calculation.new/6 (function)

* `:arguments` (`t:map/0`) - Arguments to pass to the calculation The default value is `%{}`.

* `:async?` (`t:boolean/0`) - Whether or not this calculation should be run asynchronously The default value is `false`.

* `:filterable?` (`t:boolean/0`) - Whether or not this calculation can be filtered on The default value is `true`.

* `:sortable?` (`t:boolean/0`) - Whether or not this calculation can be sorted on The default value is `true`.

* `:sensitive?` (`t:boolean/0`) - Whether or not references to this calculation will be considered sensitive The default value is `false`.

* `:load` (`t:term/0`) - Loads that are required for the calculation.

* `:actor` (`t:term/0`) - The actor performing the calculation.

* `:tenant` (`t:term/0`) - The tenant performing the calculation.

* `:authorize?` (`t:boolean/0`) - Whether or not authorization is being performed

* `:tracer` (`t:term/0`) - The tracer or tracers used in the calculation.

* `:source_context` (`t:map/0`) - Context from the source query or changeset. The default value is `%{}`.

### Ash.Query.Calculation.t/0 (type)



### Ash.Resource.Preparation (behaviour)

The behaviour for an action-specific query preparation.

`c:init/1` is defined automatically by `use Ash.Resource.Preparation`, but can be implemented if you want to validate/transform any
options passed to the module.

The main function is `c:prepare/3`. It takes the query, any options that were provided
when this preparation was configured on a resource, and the context, which currently only has
the actor.

To access any query arguments from within a preparation, make sure you are using `Ash.Query.get_argument/2`
as the argument keys may be strings or atoms.

### Ash.Resource.Preparation.init/1 (callback)



### Ash.Resource.Preparation.prepare/3 (callback)



### Ash.Resource.Preparation.ref/0 (type)



### Ash.Resource.Preparation.t/0 (type)



### Ash.Resource.Preparation.Builtins (module)

Builtin query preparations

### Ash.Resource.Preparation.Builtins.after_action/1 (macro)

Directly attach an `after_action` function to the query.

This function will be called by `Ash.Query.after_action/2`,
with an additional `context` argument.

### Example - Ash.Resource.Preparation.Builtins.after_action/1 (macro)

prepare after_action(fn query, records, _context ->
      Logger.debug("Query for #{query.action.name} on resource #{inspect(query.resource)} returned #{length(records)} records")

      {:ok, records}
    end)

### Ash.Resource.Preparation.Builtins.before_action/1 (macro)

Directly attach a `before_action` function to the query.

This function will be called by `Ash.Query.before_action/2`,
with an additional `context` argument.

### Example - Ash.Resource.Preparation.Builtins.before_action/1 (macro)

prepare before_action(fn query, _context ->
      Logger.debug("About to execute query for #{query.action.name} on #{inspect(query.resource)}")

      query
    end)

### Ash.Resource.Preparation.Builtins.build/1 (function)

Passes the given keyword list to `Ash.Query.build/2` with the query being prepared.

This allows declaring simple query modifications in-line.

To see the available options, see `Ash.Query.build/2`

### Examples - Ash.Resource.Preparation.Builtins.build/1 (function)

prepare build(sort: [song_rank: :desc], limit: 10)
    prepare build(load: [:friends])

### Ash.Resource.Preparation.Builtins.set_context/1 (function)

Merges the given query context.

If an MFA is provided, it will be called with the changeset.
The MFA should return `{:ok, context_to_be_merged}` or `{:error, term}`

### Examples - Ash.Resource.Preparation.Builtins.set_context/1 (function)

change set_context(%{something_used_internally: true})
    change set_context({MyApp.Context, :set_context, []})

### Ash.Resource.Change (behaviour)

The behaviour for an action-specific resource change.

`c:init/1` is defined automatically by `use Ash.Resource.Change`, but can be implemented if you want to validate/transform any
options passed to the module.

The main function is `c:change/3`. It takes the changeset, any options that were provided
when this change was configured on a resource, and the context, which currently only has
the actor.

### Ash.Resource.Change.after_batch/3 (callback)

Runs on each batch result after it is dispatched to the data layer.

### Ash.Resource.Change.atomic/3 (callback)



### Ash.Resource.Change.atomic?/0 (callback)



### Ash.Resource.Change.batch_callbacks?/3 (callback)

Whether or not batch callbacks should be run (if they are defined). Defaults to `true`.

### Ash.Resource.Change.batch_change/3 (callback)

Replaces `change/3` for batch actions, allowing to optimize changes for bulk actions.

You can define only `batch_change/3`, and it will be used for both single and batch actions.
It cannot, however, be used in place of the `atomic/3` callback.

### Ash.Resource.Change.before_batch/3 (callback)

Runs on each batch before it is dispatched to the data layer.

### Ash.Resource.Change.change/3 (callback)



### Ash.Resource.Change.context/0 (type)



### Ash.Resource.Change.has_after_batch?/0 (callback)



### Ash.Resource.Change.has_batch_change?/0 (callback)



### Ash.Resource.Change.has_before_batch?/0 (callback)



### Ash.Resource.Change.has_change?/0 (callback)



### Ash.Resource.Change.init/1 (callback)



### Ash.Resource.Change.ref/0 (type)



### Ash.Resource.Change.t/0 (type)



### Ash.Resource.Change.Builtins (module)

Built in changes that are available to all resources

The functions in this module are imported by default in the actions section.

### Ash.Resource.Change.Builtins.after_action/2 (macro)

Directly attach an `after_action` function to the current change.

See `Ash.Changeset.after_action/3` for more information.

Provide the option `prepend?: true` to place the hook before all other hooks instead of after.

### Example - Ash.Resource.Change.Builtins.after_action/2 (macro)

change after_action(fn changeset, record, _context ->
      Logger.debug("Successfully executed action #{changeset.action.name} on #{inspect(changeset.resource)}")
      {:ok, record}
    end)

### Ash.Resource.Change.Builtins.after_transaction/2 (macro)

Directly attach an `after_transaction` function to the current change.

See `Ash.Changeset.after_transaction/3` for more information.

Provide the option `prepend?: true` to place the hook before all other hooks instead of after.

### Example - Ash.Resource.Change.Builtins.after_transaction/2 (macro)

change after_transaction(fn
      changeset, {:ok, record}, _context ->
        Logger.debug("Successfully executed transaction for action #{changeset.action.name} on #{inspect(changeset.resource)}")
        {:ok, record}
      changeset, {:error, reason}, _context ->
        Logger.debug("Failed to execute transaction for action #{changeset.action.name} on #{inspect(changeset.resource)}, reason: #{inspect(reason)}")
        {:error, reason}
    end)

### Ash.Resource.Change.Builtins.atomic_update/3 (function)

Updates an attribute using an expression. See `Ash.Changeset.atomic_update/3` for more.

Options:

* `:cast_atomic?` - set to `false` to ignore atomic type casting logic. Defaults to `true`.

### Ash.Resource.Change.Builtins.before_action/2 (macro)

Directly attach a `before_action` function to the current change.

See `Ash.Changeset.before_action/3` for more information.

Provide the option `prepend?: true` to place the hook before all other hooks instead of after.

### Example - Ash.Resource.Change.Builtins.before_action/2 (macro)

change before_action(fn changeset, _context ->
      Logger.debug("About to execute #{changeset.action.name} on #{inspect(changeset.resource)}")

      changeset
    end)

### Ash.Resource.Change.Builtins.before_transaction/2 (macro)

Directly attach a `before_transaction` function to the current change.

See `Ash.Changeset.before_transaction/3` for more information.

Provide the option `prepend?: true` to place the hook before all other hooks instead of after.

### Example - Ash.Resource.Change.Builtins.before_transaction/2 (macro)

change before_transaction(fn changeset, _context ->
      Logger.debug("About to execute transaction for #{changeset.action.name} on #{inspect(changeset.resource)}")

      changeset
    end)

### Ash.Resource.Change.Builtins.cascade_destroy/2 (function)

Cascade this resource's destroy action to a related resource's destroy action.

Adds an after-action hook that explicitly calls destroy on any records related
via the named relationship.  It will optimise for bulk destroys where
possible.

> #### Beware database constraints {: .warning}
>
> Think carefully before using this change with data layers which enforce
> referential integrity (ie PostgreSQL and SQLite) and you may need to defer
> constraints for the relationship in question.
>
> See also:
>   1. [`postgres.references.reference.deferrable` DSL](https://hexdocs.pm/ash_postgres/dsl-ashpostgres-datalayer.html#postgres-references-reference-deferrable)
>   2. [`sqlite.references.reference.deferrable` DSL](https://hexdocs.pm/ash_sqlite/dsl-ashsqlite-datalayer.html#sqlite-references-reference-deferrable)
>   3. [PostgreSQL's `SET CONSTRAINTS` documentation](https://www.postgresql.org/docs/current/sql-set-constraints.html)
>   4. [SQLite's `PRAGMA defer_foreign_keys` documentation](https://www.sqlite.org/pragma.html#pragma_defer_foreign_keys)

> #### Cascading notifications {: .tip}
>
> By default notifications are disabled for the related destroy. This is to avoid potentially sending a **lot** of notifications for high-cardinality relationships.

### Options - Ash.Resource.Change.Builtins.cascade_destroy/2 (function)

* `:relationship` (`t:atom/0`) - Required. The name of the relationship to work on

* `:action` (`t:atom/0`) - The name of the destroy action to call on the related resource. Uses the primary destroy by default.

* `:read_action` (`t:atom/0`) - The name of the read action to call on the related resource to find results to be destroyed

* `:return_notifications?` (`t:boolean/0`) - Return notifications for all destroyed records? The default value is `false`.

* `:after_action?` (`t:boolean/0`) - If true all the cascade destroys are done in after_action hooks. This makes it safe to use in atomic actions The default value is `true`.

* `:domain` (`Ash.Domain`) -

### Example - Ash.Resource.Change.Builtins.cascade_destroy/2 (function)

change cascade_destroy(:relationship)

### Ash.Resource.Change.Builtins.cascade_update/2 (function)

Cascade a resource's update action to a related resource's update action.

  Adds an after-action hook that explicitly calls update on any records related
  via the named relationship.  It will optimise for bulk updates where
  possible.

  Allows you to copy fields from the arguments or changes to the destination,
  this way you can cascade a bunch of changes downstream.

> #### Beware database constraints {: .warning}
>
> Think carefully before using this change with data layers which enforce
> referential integrity (ie PostgreSQL and SQLite) and you may need to defer
> constraints for the relationship in question.
>
> See also:
>   1. [`postgres.references.reference.deferrable` DSL](https://hexdocs.pm/ash_postgres/dsl-ashpostgres-datalayer.html#postgres-references-reference-deferrable)
>   2. [`sqlite.references.reference.deferrable` DSL](https://hexdocs.pm/ash_sqlite/dsl-ashsqlite-datalayer.html#sqlite-references-reference-deferrable)
>   3. [PostgreSQL's `SET CONSTRAINTS` documentation](https://www.postgresql.org/docs/current/sql-set-constraints.html)
>   4. [SQLite's `PRAGMA defer_foreign_keys` documentation](https://www.sqlite.org/pragma.html#pragma_defer_foreign_keys)

> #### Cascading notifications {: .tip}
>
> By default notifications are disabled for the related updates. This is to avoid potentially sending a **lot** of notifications for high-cardinality relationships.

### Options - Ash.Resource.Change.Builtins.cascade_update/2 (function)

* `:relationship` (`t:atom/0`) - Required. The name of the relationship to work on

* `:action` (`t:atom/0`) - The name of the update action to call on the related resource. Uses the primary update by default.

* `:copy_inputs` (list of `t:atom/0`) - A list of fields to copy & pass on to the downstream update. The source action cannot be atomic. The default value is `[]`.

* `:read_action` (`t:atom/0`) - The name of the read action to call on the related resource to find results to be updated

* `:return_notifications?` (`t:boolean/0`) - Return notifications for all updated records? The default value is `false`.

* `:domain` (`Ash.Domain`) -

### Example - Ash.Resource.Change.Builtins.cascade_update/2 (function)

change cascade_update(:relationship1)
    change cascade_update(:relationship2, copy_inputs: [:field1, :field2])

### Ash.Resource.Change.Builtins.debug_log/1 (function)



### Ash.Resource.Change.Builtins.ensure_selected/1 (function)

Passes the provided value into `Ash.Changeset.ensure_selected/2`

If the value is not already selected, this makes sure it is. Does not deselect anything else.

### Example - Ash.Resource.Change.Builtins.ensure_selected/1 (function)

change ensure_selected([:necessary_field])

### Ash.Resource.Change.Builtins.filter/1 (function)

Applies a filter to the changeset. Has no effect for create actions.

This ensures that only things matching the provided filter are updated or destroyed.

### Ash.Resource.Change.Builtins.get_and_lock/2 (function)

Re-fetches the record being updated and locks it with the given type.

This happens in a `before_action` hook (so that it is done as part of the transaction).

If your resource has global validations (in the top level `validations` block), you may
want to add `delay_global_validations? true` to your action to ensure they happen on the
locked record.

### Options - Ash.Resource.Change.Builtins.get_and_lock/2 (function)

- `:skip_atomic?` - set to `true` to skip in the case that the update is done atomically. Defaults to `false`.

### Ash.Resource.Change.Builtins.get_and_lock_for_update/1 (function)

Re-fetches the record being updated and locks it for update.

Only usable with data layers that support locking `:for_update`.

This happens in a `before_action` hook (so that it is done as part of the transaction).

If your resource has global validations (in the top level `validations` block), you may
want to add `delay_global_validations? true` to your action to ensure they happen on the
locked record.

### Options - Ash.Resource.Change.Builtins.get_and_lock_for_update/1 (function)

- `:skip_atomic?` - set to `true` to skip in the case that the update is done atomically. Defaults to `false`.

### Ash.Resource.Change.Builtins.increment/2 (function)

Increments an attribute's value by the amount specified, which defaults to 1.

Options:

* `:amount` - Defaults to 1
* `:overflow_limit` - Defaults to `nil`. If the value is over the overflow limit it will roll-over to the amount being incremented by (for common database limit support)

### Ash.Resource.Change.Builtins.load/1 (function)

Passes the provided value into `Ash.load` after the action has completed.

### Example - Ash.Resource.Change.Builtins.load/1 (function)

change load(:comments)
    change load([:friend_count, :friends])

### Ash.Resource.Change.Builtins.manage_relationship/3 (function)

Calls `Ash.Changeset.manage_relationship/4` with the changeset and relationship provided, using the value provided for the named argument.

If relationship_name is not specified, it is assumed to be the same as the argument.

For information on the available options, see `Ash.Changeset.manage_relationship/4`.

### Examples - Ash.Resource.Change.Builtins.manage_relationship/3 (function)

change manage_relationship(:comments, type: :append)
    change manage_relationship(:remove_comments, :comments, type: :remove)

### Ash.Resource.Change.Builtins.optimistic_lock/1 (function)

Apply an "optimistic lock" on a record being updated or destroyed.

See `Ash.Resource.Change.OptimisticLock` for more.

### Ash.Resource.Change.Builtins.prevent_change/1 (function)

Clears a change off of the changeset before the action runs.

Does not fail if it is being changed, but ensures it is cleared just before the action.

Can be useful if a change is only used in validations but shouldn't ultimately be written to the data layer.

### Examples - Ash.Resource.Change.Builtins.prevent_change/1 (function)

change prevent_change(:email)

### Ash.Resource.Change.Builtins.relate_actor/2 (function)

Relates the actor to the data being changed, as the provided relationship.

### Options - Ash.Resource.Change.Builtins.relate_actor/2 (function)

* `:allow_nil?` (`t:boolean/0`) - Whether or not to allow the actor to be nil, in which case nothing will happen. The default value is `false`.

* `:field` (`t:atom/0`) - The field of the actor to set the relationship to

### Examples - Ash.Resource.Change.Builtins.relate_actor/2 (function)

change relate_actor(:owner, allow_nil?: true)

### Ash.Resource.Change.Builtins.select/1 (function)

Passes the provided value into `Ash.Changeset.select/3`

Keep in mind, this will *limit* the fields that are selected. You may want `ensure_selected/1` if you
want to make sure that something is selected, without deselecting anything else.

Selecting in changesets does not actually do a select in the data layer. It nils out any
fields that were not selected after completing the action. This can be useful if you are writing
policies that have to do with specific fields being selected.

### Example - Ash.Resource.Change.Builtins.select/1 (function)

change select([:name])

### Ash.Resource.Change.Builtins.set_attribute/3 (function)

Sets the attribute to the value provided.

If a zero argument function is provided, it is called to determine the value.

Use `arg(:argument_name)` to use the value of the given argument. If the argument is not supplied then nothing happens.

### Options - Ash.Resource.Change.Builtins.set_attribute/3 (function)

* `:set_when_nil?` (`t:boolean/0`) - When false, decline setting the attribute if it is nil. The default value is `true`.

* `:new?` (`t:boolean/0`) - When true, sets the attribute to the value provided if the attribute is not already being changed. The default value is `false`.

### Examples - Ash.Resource.Change.Builtins.set_attribute/3 (function)

change set_attribute(:active, false)
    change set_attribute(:opened_at, &DateTime.utc_now/0)
    change set_attribute(:status, arg(:status))
    change set_attribute(:encrypted_data, arg(:data), set_when_nil?: false)

### Ash.Resource.Change.Builtins.set_context/1 (function)

Merges the given query context.

If an MFA is provided, it will be called with the changeset.
The MFA should return `{:ok, context_to_be_merged}` or `{:error, term}`

### Examples - Ash.Resource.Change.Builtins.set_context/1 (function)

change set_context(%{something_used_internally: true})
    change set_context({MyApp.Context, :set_context, []})

### Ash.Resource.Change.Builtins.set_new_attribute/2 (function)

Sets the attribute to the value provided if the attribute is not already being changed.

If a zero argument function is provided, it is called to determine the value.

Use `arg(:argument_name)` to use the value of the given argument. If the argument is not supplied then nothing happens.

### Examples - Ash.Resource.Change.Builtins.set_new_attribute/2 (function)

change set_new_attribute(:active, false)
    change set_new_attribute(:opened_at, &DateTime.utc_now/0)
    change set_new_attribute(:status, arg(:status))

### Ash.Resource.Change.Builtins.update_change/2 (macro)

Updates an existing attribute change by applying a function to it.

The update function gets called with the value already cast to the correct type, and only gets called
on valid changesets, so the value is guaranteed to have passed validations and constraints.

### Ash.Resource.Validation (behaviour)

Represents a validation in Ash.

See `Ash.Resource.Validation.Builtins` for a list of builtin validations.

To write your own validation, define a module that implements the `c:init/1` callback
to validate options at compile time, and `c:validate/3` callback to do the validation.

Then, in a resource, you can say:

```
validations do
  validate {MyValidation, [foo: :bar]}
end
```

### Ash.Resource.Validation.action_schema/0 (function)



### Ash.Resource.Validation.atomic/3 (callback)



### Ash.Resource.Validation.atomic?/0 (callback)



### Ash.Resource.Validation.describe/1 (callback)



### Ash.Resource.Validation.has_validate?/0 (callback)



### Ash.Resource.Validation.init/1 (callback)



### Ash.Resource.Validation.opt_schema/0 (function)



### Ash.Resource.Validation.path/0 (type)



### Ash.Resource.Validation.ref/0 (type)



### Ash.Resource.Validation.t/0 (type)



### Ash.Resource.Validation.validate/3 (callback)



### Ash.Resource.Validation.validation_type/0 (function)



### Ash.Resource.Validation.Builtins (module)

Built in validations that are available to all resources

The functions in this module are imported by default in the validations section.

### Ash.Resource.Validation.Builtins.absent/2 (function)

Validates that the given attribute or argument or list of attributes or arguments are `nil`.

This is the inverse of `present/2`.

Use options to specify how many must be `nil`. If no options are provided, validates that they are all absent.

Keep in mind that some types cast certain values to `nil`, and validations are
applied after all inputs have been cast. For example, a `:string` type attribute
with the default constraints will cast `""` as `nil`, meaning an input of
`""` would pass the `absent` validation.

### Options - Ash.Resource.Validation.Builtins.absent/2 (function)

* `:at_least` (`t:non_neg_integer/0`) - At least this many must be absent. Defaults to the number of attributes provided

* `:at_most` (`t:non_neg_integer/0`) - At most this many must be absent. Defaults to the number of attributes provided

* `:exactly` (`t:non_neg_integer/0`) - Exactly this many must be absent

### Examples - Ash.Resource.Validation.Builtins.absent/2 (function)

validate absent(:unsettable_option)

    validate absent([:first_name, :last_name]), where: [present(:full_name)]

    validate absent([:is_admin, :is_normal_user], at_least: 1)

### Ash.Resource.Validation.Builtins.action_is/1 (function)

Validates that the action name matches the provided action name or names. Primarily meant for use in `where`.

### Examples - Ash.Resource.Validation.Builtins.action_is/1 (function)

validate present(:foo), where: [action_is(:bar)]

    validate present(:foo), where: action_is([:bar, :baz])

### Ash.Resource.Validation.Builtins.argument_does_not_equal/2 (function)

Validates that an argument is not being changed to a specific value, or does not equal the given value if it is not being changed.

### Examples - Ash.Resource.Validation.Builtins.argument_does_not_equal/2 (function)

validate argument_does_not_equal(:admin, true)

    # Or to only check for changing to a given value
    validate argument_does_not_equal(:admin, true), where: [changing(:admin)]

### Ash.Resource.Validation.Builtins.argument_equals/2 (function)

Validates that an argument is being changed to a specific value, or equals the given value if it is not being changed.

### Examples - Ash.Resource.Validation.Builtins.argument_equals/2 (function)

validate argument_equals(:admin, true)

    # Or to only check for changing to a given value
    validate argument_equals(:admin, true), where: [changing(:admin)]

### Ash.Resource.Validation.Builtins.argument_in/2 (function)

Validates that an argument is being changed to one of a set of specific values, or is in the the given list if it is not being changed.

### Examples - Ash.Resource.Validation.Builtins.argument_in/2 (function)

validate argument_in(:state, [1, 2, 3])

    # Or to only check for changing to a something in a given list
    validate argument_in(:state, [1, 2, 3]), where: [changing(:state)]

### Ash.Resource.Validation.Builtins.attribute_does_not_equal/2 (function)

Validates that an attribute is not being changed to a specific value, or does not equal the given value if it is not being changed.

### Examples - Ash.Resource.Validation.Builtins.attribute_does_not_equal/2 (function)

validate attribute_does_not_equal(:admin, true)

    # Or to only check for changing to a given value
    validate attribute_does_not_equal(:admin, true), where: [changing(:admin)]

### Ash.Resource.Validation.Builtins.attribute_equals/2 (function)

Validates that an attribute is being changed to a specific value, or equals the given value if it is not being changed.

### Examples - Ash.Resource.Validation.Builtins.attribute_equals/2 (function)

validate attribute_equals(:admin, true)

    # Or to only check for changing to a given value
    validate attribute_equals(:admin, true), where: [changing(:admin)]

### Ash.Resource.Validation.Builtins.attribute_in/2 (function)

Validates that an attribute is being changed to one of a set of specific values, or is in the the given list if it is not being changed.

### Examples - Ash.Resource.Validation.Builtins.attribute_in/2 (function)

validate attribute_in(:state, [1, 2, 3])

    # Or to only check for changing to a something in a given list
    validate attribute_in(:state, [1, 2, 3]), where: [changing(:state)]

### Ash.Resource.Validation.Builtins.attributes_absent/2 (function)

Validates that the attribute or list of attributes are `nil`. See `absent/2` for more information.

### Options - Ash.Resource.Validation.Builtins.attributes_absent/2 (function)

* `:at_least` (`t:non_neg_integer/0`) - At least this many must be absent. Defaults to the number of attributes provided

* `:at_most` (`t:non_neg_integer/0`) - At most this many must be absent. Defaults to the number of attributes provided

* `:exactly` (`t:non_neg_integer/0`) - Exactly this many must be absent

### Ash.Resource.Validation.Builtins.attributes_present/2 (function)

Validates that the attribute or list of attributes are not `nil`. See `present/2` for more information.

### Options - Ash.Resource.Validation.Builtins.attributes_present/2 (function)

* `:at_least` (`t:non_neg_integer/0`) - At least this many must be present. Defaults to the number of attributes provided

* `:at_most` (`t:non_neg_integer/0`) - At most this many must be present. Defaults to the number of attributes provided

* `:exactly` (`t:non_neg_integer/0`) - Exactly this many must be present

### Ash.Resource.Validation.Builtins.changing/2 (function)

Validates that an attribute or relationship is being changed

### Examples - Ash.Resource.Validation.Builtins.changing/2 (function)

validate changing(:first_name)
    validate changing(:comments)
    validate changing(:comments, touching?: true)

### Options - Ash.Resource.Validation.Builtins.changing/2 (function)

* `:field` (`t:atom/0`) - Required. The attribute or relationship to check for changes. Using a relationship does not compare old and new value, returning `true` if the value is being touched)

* `:touching?` (`t:atom/0`) - Whether to consider a field as changing if it is just being touched (i.e consider it changed even if it is being changed to its current value) The default value is `false`.

### Ash.Resource.Validation.Builtins.compare/2 (function)

Validates that an attribute or argument meets the given comparison criteria.

The values provided for each option may be a literal value, attribute, argument, or a zero argument function.

### Options - Ash.Resource.Validation.Builtins.compare/2 (function)

* `:greater_than` - The value that the attribute should be greater than.

* `:greater_than_or_equal_to` - The value that the attribute should be greater than or equal to

* `:less_than` - The value that the attribute should be less than

* `:less_than_or_equal_to` - The value that the attribute should be less than or equal to

* `:is_equal` - The value that the attribute should be equal to

* `:is_not_equal` - The value that the attribute should not be equal to

* `:is_nil` (`t:boolean/0`) - Whether the attribute should be nil (true) or not nil (false)

### Examples - Ash.Resource.Validation.Builtins.compare/2 (function)

validate compare(:age, greater_than_or_equal_to: 18),
      where: [attribute_equals(:show_adult_content, true)],
      message: "must be over %{greater_than_or_equal_to} to enable adult content."

    validate compare(:points, greater_than: 0, less_than_or_equal_to: 100)

### Ash.Resource.Validation.Builtins.confirm/2 (function)

Validates that a field or argument matches another field or argument

### Examples - Ash.Resource.Validation.Builtins.confirm/2 (function)

validate confirm(:password, :password_confirmation)
    validate confirm(:email, :email_confirmation)

### Ash.Resource.Validation.Builtins.match/2 (function)

Validates that an attribute's value matches a given regex.

`String.match?/2` is used to determine if the value matches.

### Examples - Ash.Resource.Validation.Builtins.match/2 (function)

validate match(:slug, ~r/^[0-9a-z-_]+$/)

### Ash.Resource.Validation.Builtins.negate/1 (function)

Validates that other validation does not pass

### Examples - Ash.Resource.Validation.Builtins.negate/1 (function)

validate negate(one_of(:status, [:closed, :finished]))

### Ash.Resource.Validation.Builtins.numericality/2 (function)

Validates that an attribute or argument meets the given comparison criteria.

The values provided for each option may be a literal value, attribute, argument, or a zero argument function.

### Options - Ash.Resource.Validation.Builtins.numericality/2 (function)

* `:greater_than` - The value that the attribute should be greater than.

* `:greater_than_or_equal_to` - The value that the attribute should be greater than or equal to

* `:less_than` - The value that the attribute should be less than

* `:less_than_or_equal_to` - The value that the attribute should be less than or equal to

* `:is_equal` - The value that the attribute should be equal to

* `:is_not_equal` - The value that the attribute should not be equal to

* `:is_nil` (`t:boolean/0`) - Whether the attribute should be nil (true) or not nil (false)

### Examples - Ash.Resource.Validation.Builtins.numericality/2 (function)

validate numericality(:age, greater_than_or_equal_to: 18),
      where: [attribute_equals(:show_adult_content, true)],
      message: "must be over %{greater_than_or_equal_to} to enable adult content."

    validate numericality(:points, greater_than: 0, less_than_or_equal_to: 100)

### Ash.Resource.Validation.Builtins.one_of/2 (function)

Validates that an attribute's value is in a given list

### Examples - Ash.Resource.Validation.Builtins.one_of/2 (function)

validate one_of(:status, [:closed_won, :closed_lost])

### Ash.Resource.Validation.Builtins.present/2 (function)

Validates that the given attribute or argument or list of attributes or arguments are not `nil`.

Use options to specify how many must not be `nil`. If no options are provided, validates that they are all present.

Keep in mind that some types cast certain values to `nil`, and validations are
applied after all inputs have been cast. For example, a `:string` type attribute
with the default constraints will cast `""` as `nil`, meaning an input of
`""` would fail the `present` validation.

### Options - Ash.Resource.Validation.Builtins.present/2 (function)

* `:at_least` (`t:non_neg_integer/0`) - At least this many must be present. Defaults to the number of attributes provided

* `:at_most` (`t:non_neg_integer/0`) - At most this many must be present. Defaults to the number of attributes provided

* `:exactly` (`t:non_neg_integer/0`) - Exactly this many must be present

### Examples - Ash.Resource.Validation.Builtins.present/2 (function)

validate present(:name)

    validate present([:first_name, :last_name]), where: [absent(:full_name)]

    validate present([:is_admin, :is_normal_user], at_most: 1)

### Ash.Resource.Validation.Builtins.string_length/2 (function)

Validates that an attribute on the original record meets the given length criteria

### Options - Ash.Resource.Validation.Builtins.string_length/2 (function)

* `:min` (`t:non_neg_integer/0`) - String must be this length at least

* `:max` (`t:non_neg_integer/0`) - String must be this length at most

* `:exact` (`t:non_neg_integer/0`) - String must be this length exactly

### Examples - Ash.Resource.Validation.Builtins.string_length/2 (function)

validate string_length(:slug, exact: 8)
    validate string_length(:password, min: 6)
    validate string_length(:secret, min: 4, max: 12)

### Ash.Authorizer (behaviour)

The interface for an ash authorizer

These will typically be implemented by an extension, but a custom
one can be implemented by defining an extension that also adopts this behaviour.

Then you can extend a resource with `authorizers: [YourAuthorizer]`

### Ash.Authorizer.add_calculations/3 (callback)



### Ash.Authorizer.add_calculations/4 (function)



### Ash.Authorizer.alter_filter/3 (callback)



### Ash.Authorizer.alter_filter/4 (function)



### Ash.Authorizer.alter_results/3 (callback)



### Ash.Authorizer.alter_results/4 (function)



### Ash.Authorizer.alter_sort/4 (function)



### Ash.Authorizer.check/2 (callback)



### Ash.Authorizer.check/3 (function)



### Ash.Authorizer.check_context/1 (callback)



### Ash.Authorizer.check_context/2 (function)



### Ash.Authorizer.context/0 (type)



### Ash.Authorizer.exception/2 (callback)



### Ash.Authorizer.exception/3 (function)



### Ash.Authorizer.initial_state/4 (callback)



### Ash.Authorizer.initial_state/5 (function)



### Ash.Authorizer.state/0 (type)



### Ash.Authorizer.strict_check/2 (callback)



### Ash.Authorizer.strict_check/3 (function)



### Ash.Authorizer.strict_check_context/1 (callback)



### Ash.Authorizer.strict_check_context/2 (function)



### Ash.Policy.Check (behaviour)

A behaviour for declaring checks, which can be used to easily construct
authorization rules.

If a check can be expressed simply, i.e as a function of the actor, or the context of the request,
see `Ash.Policy.SimpleCheck` for an easy way to write that check.
If a check can be expressed with a filter statement, see `Ash.Policy.FilterCheck`
for an easy way to write that check.

### Ash.Policy.Check.actor/0 (type)



### Ash.Policy.Check.authorizer/0 (type)



### Ash.Policy.Check.auto_filter/3 (callback)

An optional callback, that allows the check to work with policies set to `access_type :filter`

Return a keyword list filter that will be applied to the query being made, and will scope the results to match the rule

### Ash.Policy.Check.check/4 (callback)

An optional callback, that allows the check to work with policies set to `access_type :runtime`

Takes a list of records, and returns the subset of authorized records.

### Ash.Policy.Check.check_type/0 (type)



### Ash.Policy.Check.defines_auto_filter?/1 (function)



### Ash.Policy.Check.defines_check?/1 (function)



### Ash.Policy.Check.describe/1 (callback)

Describe the check in human readable format, given the options

### Ash.Policy.Check.eager_evaluate?/0 (callback)



### Ash.Policy.Check.expand_description/3 (callback)

Expands the description of the check, given the actor and subject

### Ash.Policy.Check.options/0 (type)



### Ash.Policy.Check.prefer_expanded_description?/0 (callback)

Whether or not the expanded description should replace the basic description in breakdowns

### Ash.Policy.Check.ref/0 (type)



### Ash.Policy.Check.requires_original_data?/2 (callback)

Whether or not your check requires the original data of a changeset (if applicable)

### Ash.Policy.Check.strict_check/3 (callback)

Strict checks should be cheap, and should never result in external calls (like database or domain)

It should return `{:ok, true}` if it can tell that the request is authorized, and `{:ok, false}` if
it can tell that it is not. If unsure, it should return `{:ok, :unknown}`

### Ash.Policy.Check.t/0 (type)



### Ash.Policy.Check.type/0 (callback)

The type of the check

`:manual` checks must be written by hand as standard check modules
`:filter` checks can use `Ash.Policy.FilterCheck` for simplicity
`:simple` checks can use `Ash.Policy.SimpleCheck` for simplicity

### Ash.Policy.FilterCheck (behaviour)

A type of check that is represented by a filter statement

You can customize what the "negative" filter looks like by defining `c:reject/3`. This is important for
filters over related data. For example, given an `owner` relationship and a data layer like `ash_postgres`
where `column != NULL` does *not* evaluate to true (see postgres docs on NULL for more):

    # The opposite of
    `owner.id == 1`
    # in most cases is not
    `not(owner.id == 1)`
    # because in postgres that would be `NOT (owner.id = NULL)` in cases where there was no owner
    # A better opposite would be
    `owner.id != 1 or is_nil(owner.id)`
    # alternatively
    `not(owner.id == 1) or is_nil(owner.id)`

By being able to customize the `reject` filter, you can use related filters in your policies. Without it,
they will likely have undesired effects.

### Ash.Policy.FilterCheck.context/0 (type)



### Ash.Policy.FilterCheck.filter/3 (callback)



### Ash.Policy.FilterCheck.is_filter_check?/1 (function)



### Ash.Policy.FilterCheck.options/0 (type)



### Ash.Policy.FilterCheck.reject/3 (callback)



### Ash.Policy.SimpleCheck (behaviour)

A type of check that operates only on request context, never on the data

Define `c:match?/3`, which gets the actor, request context, and opts, and returns true or false

### Example - Ash.Policy.SimpleCheck (behaviour)

This is a simple check that checks if the user is changing anything other than the
provided list.

```elixir
defmodule ChangingNothingExcept do
  use Ash.Policy.SimpleCheck

  def match?(_actor, %{subject: %Ash.Changeset{} = changeset}, opts) do
    allowed = opts[:attributes]
    {:ok, Enum.all?(Map.keys(changeset.attributes), &(&1 in allowed))}
  end

  def match?(_, _, _), do: {:ok, true}
end
```

You could then use this like

```elixir
policy actor_attribute_equals(:role, :foobar) do
  authorize_if {ChangingNothingExcept, attributes: [:foo, :bar]}
end
```

### Ash.Policy.SimpleCheck.actor/0 (type)



### Ash.Policy.SimpleCheck.context/0 (type)



### Ash.Policy.SimpleCheck.match?/3 (callback)

Whether or not the request matches the check

### Ash.Policy.SimpleCheck.options/0 (type)



### Ash.Policy.Check.Builtins (module)

The global authorization checks built into ash

### Ash.Policy.Check.Builtins.accessing_from/2 (function)

This check is true when the current action is being run "through" a relationship.

Cases where this happens:

1. Loading related data
2. Managing relationships
3. Aggregating data
4. Filtering on relationships

### Ash.Policy.Check.Builtins.action/1 (function)

This check is true when the action name matches the provided action name or names.

This is a very common pattern, allowing action-specific policies.

### Ash.Policy.Check.Builtins.action_type/1 (function)

This check is true when the action type matches the provided type

This is useful for writing policies that apply to all actions of a given type.

For example:

```elixir
policy action_type(:read) do
  authorize_if relates_to_actor_via(:owner)
end
```

### Ash.Policy.Check.Builtins.actor_absent/0 (function)

This check is false when there is an actor specified, and true when the actor is `nil`.

### Ash.Policy.Check.Builtins.actor_attribute_equals/2 (function)

This check is true when the value of the specified attribute of the actor equals the specified value.

This check will *never* pass if the actor does not have the specified key. For example,
`actor_attribute_equals(:missing_key, nil)`

### Ash.Policy.Check.Builtins.actor_present/0 (function)

This check is true when there is an actor specified, and false when the actor is `nil`.

### Ash.Policy.Check.Builtins.always/0 (function)

This check always passes.

Can be useful for "deny-list" style authorization. For example:

```elixir
policy action_type(:read) do
  forbid_if actor_attribute_equals(:disabled, true)
  forbid_if actor_attribute_equals(:active, false)
  authorize_if always()
end
```

Without that last clause, the policy would never pass.

### Ash.Policy.Check.Builtins.changing_attributes/1 (function)

This check is true when attribute changes correspond to the provided options.

Provide a keyword list of options or just an atom representing the attribute.

For example:

```elixir
# if you are changing both first name and last name
changing_attributes([:first_name, :last_name])

# if you are changing first name to fred
changing_attributes(first_name: [to: "fred"])

# if you are changing last name from bob
changing_attributes(last_name: [from: "bob"])

# if you are changing :first_name at all, last_name from "bob" and middle name from "tom" to "george"
changing_attributes([:first_name, last_name: [from: "bob"], middle_name: [from: "tom", to: "george]])
```

### Ash.Policy.Check.Builtins.changing_relationship/1 (function)

This check is true when the specified relationship is changing

### Ash.Policy.Check.Builtins.changing_relationships/1 (function)

This check is true when the specified relationships are changing

### Ash.Policy.Check.Builtins.context_equals/2 (function)

This check is true when the value of the specified key or path in the changeset or query context equals the specified value.

Note that the context is not shared with other queries (e.g. loads).

For example:
```elixir
# Given this check on Profile
authorize_if context_equals(:allow_this?, true)

# This load will not have the context and will not be authorized
Ash.load!(user, :profile, context: %{allow_this?: true})

# But this will have the context and will be authorized
Ash.load!(user, [profile: Ash.Query.set_context(Profile, %{allow_this?: true})])
```

### Ash.Policy.Check.Builtins.filtering_on/2 (function)

This check is true when the field provided is being referenced anywhere in a filter statement.

This applies to related filters as well. For example:

```elixir
policy actor_attribute_equals(:is_admin, false) do
  forbid_if filtering_on(:email)
  # a path can be provided as well
  forbid_if filtering_on([:owner], :email)
end
```

The first will return true in situations like:

```elixir
Ash.Query.filter(User, email == "blah")
Ash.Query.filter(Tweet, author.email == "blah")
```

The second will return true on queries like:

```elixir
Ash.Query.filter(Post, owner.email == "blah")
Ash.Query.filter(Comment, post.owner.email == "blah")
```

### Ash.Policy.Check.Builtins.just_created_with_action/1 (function)



### Ash.Policy.Check.Builtins.loading/1 (function)

This check is true when the field or relationship, or path to field, is being loaded and false when it is not.

This is always false for `create`/`update`/`destroy` actions, because you cannot load fields on those action types.

### Ash.Policy.Check.Builtins.matches/2 (macro)

This check is true when the specified function returns true

### Ash.Policy.Check.Builtins.never/0 (function)

This check never passes.

There is, generally speaking, no reason to use this, but it exists for
completeness sake.

### Ash.Policy.Check.Builtins.relates_to_actor_via/2 (function)

This check passes if the data relates to the actor via the specified relationship or path of relationships.

For `update` & `destroy` actions, this check will apply to *the original data* before the changes are applied.

For `create` actions this check is very unlikely to pass. This is because relationships are modified *after* authorization
happens, not before.

For example:

```elixir
policy action_type(:read) do
  authorize_if relates_to_actor_via(:owner)

  # Path of relationships:
  authorize_if relates_to_actor_via([:account, :user])

  # When the resource relates to a field of the actor:
  authorize_if relates_to_actor_via(:roles, field: :role)
end
```

### Ash.Policy.Check.Builtins.relating_to_actor/1 (function)

This check is true when the specified relationship is being changed to the current actor.

This only supports `belongs_to` relationships at the moment, and will detect two cases:

1. the `source_attribute` is being changed directly
2. the relationship is being changed with `on_lookup?: :relate`, and a single input is being provided.

### Ash.Policy.Check.Builtins.resource/1 (function)

This check is true when the resource name matches the provided resource name or names.

### Ash.Policy.Check.Builtins.selecting/1 (function)

This check is true when the field is being selected and false when it is not.

This won't affect filters placed on this resource, so you may also want to either:

- Mark the given field as `filterable? false`
- Add another check for `filtering_on(:field)`

For example:

```elixir
policy action_type(:read) do
  # The actor can read and filter on their own email
  authorize_if expr(id == ^actor(:id))

  # No one else can select or filter on their email
  forbid_if selecting(:email)
  forbid_if filtering_on(:email)

  # Otherwise, the policy passes
  authorize_if always()
end
```

### Ash.DataLayer.Ets (module)

An ETS (Erlang Term Storage) backed Ash Datalayer, for testing and lightweight usage.

Remember, this does not have support for transactions! This is not recommended for production
use, especially in multi-user applications. It can, however, be great for prototyping.

### Ash.DataLayer.Ets.do_add_calculations/4 (function)



### Ash.DataLayer.Ets.ets/1 (macro)



### Ash.DataLayer.Ets.stop/2 (function)

Stops the storage for a given resource/tenant (deleting all of the data)

### Ash.DataLayer.Mnesia (module)

An Mnesia backed Ash Datalayer.

In your application initialization, you will need to call `Mnesia.create_schema([node()])`.

Additionally, you will want to create your mnesia tables there.

This data layer is *unoptimized*, fetching all records from a table and filtering them
in memory. For that reason, it is not recommended to use it with large amounts of data. It can be
great for prototyping or light usage, though.

### Ash.DataLayer.Mnesia.mnesia/1 (macro)



### Ash.DataLayer.Mnesia.start/2 (function)

Creates the table for each mnesia resource in a domain

### Ash.DataLayer.Simple (module)

A data layer that returns structs.

This is the data layer that is used under the hood
by embedded resources, and resources without data layers.

### Ash.DataLayer.Simple.bulk_create/3 (function)

Callback implementation for  Ash.DataLayer.bulk_create/3 .

### Ash.DataLayer.Simple.set_data/2 (function)

Sets the data for a query against a data-layer-less resource

### Ash.Notifier.PubSub (module)

A builtin notifier to help you publish events over any kind of pub-sub tooling.

This is plug and play with `Phoenix.PubSub`, but could be used with any pubsub system.

You configure a module that defines a `broadcast/3` function, and then add some "publications"
which configure under what conditions an event should be sent and what the topic should be.

### Example - Ash.Notifier.PubSub (module)

```elixir
defmodule MyApp.User do
  use Ash.Resource,
    # ...
    notifiers: [Ash.Notifier.PubSub]

  # ...

  pub_sub do
    module MyAppWeb.Endpoint

    prefix "user"
    publish :update, ["updated", :_pkey]
  end
end
```

### Debugging PubSub - Ash.Notifier.PubSub (module)

It can be quite frustrating when setting up pub_sub when everything appears to be set up properly, but
you aren't receiving events. This usually means some kind of mismatch between the event names produced
by the resource/config of your publications, and you can use the following flag to display debug
information about all pub sub events.

```elixir
config :ash, :pub_sub, debug?: true
```

### Topic Templates - Ash.Notifier.PubSub (module)

Often you want to include some piece of data in the thing being changed, like the `:id` attribute. This
is done by providing a list as the topic, and using atoms which will be replaced by their corresponding
values. They will ultimately be joined with `:`.

For example:

```elixir
prefix "user"

publish :create, ["created", :user_id]
```

This might publish a message to "user:created:1" for example.

For updates, if the field in the template is being changed, a message is sent
to *both* values. So if you change `user 1` to `user 2`, the same message would
be published to `user:updated:1` and `user:updated:2`. If there are multiple
attributes in the template, and they are all being changed, a message is sent for
every combination of substitutions.

### Important - Ash.Notifier.PubSub (module)

If the previous value was `nil` or the field was not selected on the data passed into the action, then a
notification is not sent for the previous value.

If the new value is `nil` then a notification is not sent for the new value.

### Template parts - Ash.Notifier.PubSub (module)

Templates may contain lists, in which case all combinations of values in the list will be used. Add
`nil` to the list if you want to produce a pattern where that entry is omitted.

The atom `:_tenant` may be used. If the changeset has a tenant set on it, that
value will be used, otherwise that combination of values is ignored.

The atom `:_pkey` may be used. It will be a stringified, concatenation of the primary key fields,
or just the primary key if there is only one primary key field.

The atom `nil` may be used. It only makes sense to use it in the context of a list of alternatives,
and adds a pattern where that part is skipped.

```elixir
publish :updated, [[:team_id, :_tenant], "updated", [:id, nil]]
```

Would produce the following messages, given a `team_id` of 1, a `tenant` of `org_1`, and an `id` of `50`:

```elixir
"1:updated:50"
"1:updated"
"org_1:updated:50"
"org_1:updated"
```

### Custom Delimiters - Ash.Notifier.PubSub (module)

It's possible to change the default delimiter used when generating topics. This is useful when working with message brokers
like RabbitMQ, which rely on a different set of delimiters for routing.


```elixir
pub_sub do
  delimiter "."
end
```

### Named Pubsub modules - Ash.Notifier.PubSub (module)

If you are using a phoenix `Endpoint` module for pubsub then this is unnecessary. If you want to use a custom pub sub started
with something like `{Phoenix.PubSub, name: MyName}`, then you can provide `MyName` to here.

### Broadcast Types - Ash.Notifier.PubSub (module)

Configured with `broadcast_type`.

- `:notification` just sends the notification
- `:phoenix_broadcast` sends a `%Phoenix.Socket.Broadcast{}` (see above)
- `:broadcast` sends `%{topic: (topic), event: (event), payload: (notification)}`

### Ash.Notifier.PubSub.pub_sub/1 (macro)



### Ash.Notifier.PubSub.to_payload/4 (function)



### Ash.Policy.Authorizer (module)

An authorization extension for ash resources.

To add this extension to a resource, add it to the list of `authorizers` like so:

```elixir
use Ash.Resource,
  ...,
  authorizers: [
    Ash.Policy.Authorizer
  ]
```

A resource can be given a set of policies, which are enforced on each call to a resource action.

For reads, policies can be configured to filter out data that the actor shouldn't see, as opposed to
resulting in a forbidden error.

See the [policies guide](/documentation/topics/security/policies.md) for practical examples.

Policies are solved/managed via a boolean satisfiability solver. To read more about boolean satisfiability,
see this page: https://en.wikipedia.org/wiki/Boolean_satisfiability_problem. At the end of
the day, however, it is not necessary to understand exactly how Ash takes your
authorization requirements and determines if a request is allowed. The
important thing to understand is that Ash may or may not run any/all of your
authorization rules as they may be deemed unnecessary. As such, authorization
checks should have no side effects. Ideally, the checks built-in to ash should
cover the bulk of your needs.

### Ash.Policy.Authorizer.alter_sort/3 (function)



### Ash.Policy.Authorizer.expr_check/1 (function)



### Ash.Policy.Authorizer.field_policies/1 (macro)



### Ash.Policy.Authorizer.install/5 (function)



### Ash.Policy.Authorizer.policies/1 (macro)



### Ash.Policy.Authorizer.print_tuple_boolean/1 (function)



### Ash.Policy.Authorizer.t/0 (type)



### Ash.Policy.Authorizer.template_var/1 (function)



### Ash.Reactor (module)

`Ash.Reactor` is a [`Reactor`](https://hex.pm/packages/reactor) extension
which provides steps for working with Ash resources and actions.

See the [Ash Reactor Guide](https://hexdocs.pm/ash/reactor.html) for more
information.

### Ash.Reactor.action/0 (type)



### Ash.Reactor.ash/1 (macro)



### Ash.Resource (module)

A resource is a static definition of an entity in your system.

[Resource DSL documentation](dsl-ash-resource.html)

### Options - Ash.Resource (module)

* `:simple_notifiers` (list of module that adopts `Ash.Notifier`) - Notifiers with no DSL.

* `:validate_domain_inclusion?` (`t:boolean/0`) - Whether or not to validate that this resource is included in a domain. The default value is `true`.

* `:primary_read_warning?` (`t:boolean/0`) - Set to `false` to silence warnings about arguments, preparations and filters on the primary read action. The default value is `true`.

* `:domain` (module that adopts `Ash.Domain`) - The domain to use when interacting with this resource. Also sets defaults for various options that ask for a domain.

* `:embed_nil_values?` (`t:boolean/0`) - Whether or not to include keys with `nil` values in an embedded representation. Has no effect unless resource is an embedded resource. The default value is `true`.

* `:extensions` (list of module that adopts `Spark.Dsl.Extension`) - A list of DSL extensions to add to the `Spark.Dsl`

* `:data_layer` (module that adopts `Ash.DataLayer`) - data_layer extensions to add to the `Spark.Dsl` The default value is `Ash.DataLayer.Simple`.

* `:authorizers` (one or a list of module that adopts `Ash.Authorizer`) - authorizers extensions to add to the `Spark.Dsl` The default value is `[]`.

* `:notifiers` (one or a list of module that adopts `Ash.Notifier`) - notifiers extensions to add to the `Spark.Dsl` The default value is `[]`.

* `:otp_app` (`t:atom/0`) - The otp_app to use for any application configurable options

* `:fragments` (list of `t:module/0`) - Fragments to include in the `Spark.Dsl`. See the fragments guide for more.

### Ash.Resource.get_metadata/2 (function)



### Ash.Resource.loaded?/3 (function)

Returns true if the load or path to load has been loaded

### Options - Ash.Resource.loaded?/3 (function)

- `lists`: set to `:any` to have this return true if any record in a list that appears has the value loaded. Default is `:all`.
- `unknown`: set to `true` to have unknown paths (like nil values or non-resources) return true. Defaults to `false`
- `strict?`: set to `true` to return false if a calculation with arguments is being checked

### Ash.Resource.put_metadata/3 (function)



### Ash.Resource.record/0 (type)



### Ash.Resource.selected?/3 (function)

Returns true if the given field has been selected on a record

### Options - Ash.Resource.selected?/3 (function)

- `forbidden_means_selected?`: set to `true` to return `true` if the field is marked as forbidden

### Ash.Resource.set_metadata/2 (function)



### Ash.Resource.t/0 (type)



### Ash.Resource.unload/2 (function)

Sets a loaded key or path to a key back to its original unloaded stated

### Ash.Resource.unload_many/2 (function)

Sets a list of loaded key or paths to a key back to their original unloaded stated

### Ash.DataLayer.Ets.Info (module)

Introspection helpers for the Ets data layer

### Ash.DataLayer.Ets.Info.private?/1 (function)

Whether or not the ets table for the resource should be private

### Ash.DataLayer.Ets.Info.table/1 (function)

The ets table name for a resource

### Ash.DataLayer.Mnesia.Info (module)

Introspection helpers for Ash.DataLayer.Mnesia

### Ash.DataLayer.Mnesia.Info.table/1 (function)

The mnesia table for a resource

### Ash.Domain.Dsl.ResourceReference (module)

A resource reference in a domain

### Ash.Domain.Dsl.ResourceReference.t/0 (type)



### Ash.Domain.Info (module)

Introspection tools for Ash.Domain

### Ash.Domain.Info.allow/1 (function)

The allow MFA for a domain

### Ash.Domain.Info.allow_unregistered?/1 (function)

Whether or not the domain allows unregistered resources to be used with it

### Ash.Domain.Info.authorize/1 (function)

When authorization should happen for a given domain

### Ash.Domain.Info.depend_on_resources/1 (macro)

Gets the resources of a domain module. Can be used at compile time.

Liberal use of this can greatly increase compile times, or even cause compiler deadlocks.
Use with care.

### Ash.Domain.Info.description/1 (function)

The description of the domain

### Ash.Domain.Info.find_manage_relationships_with_identity_not_configured/1 (function)



### Ash.Domain.Info.related_domain/3 (function)

Determine what domain to use when interacting with a related resource.

We choose the first domain found in the following order:

* `relationship.domain`, i.e an explicitly configured domain for a relationship
* `resource.domain`, i.e. the domain the resource declares
* `subject.domain`, i.e. the domain of the query, changeset or action input (if it has one)
* `default`, the default domain provided as the third argument

### Ash.Domain.Info.require_actor?/1 (function)

Whether or not the actor is always required for a domain

### Ash.Domain.Info.resource/2 (function)

Returns `{:ok, resource}` if the resource can be used by the domain, or `{:error, error}`.

### Ash.Domain.Info.resource_references/1 (function)

Gets the resource references of a domain module. DO NOT USE AT COMPILE TIME.

If you need the resource list at compile time, use `depend_on_resources/1`

### Ash.Domain.Info.resources/1 (function)

Gets the resources of a domain module.

### Ash.Domain.Info.short_name/1 (function)

The short name for a domain

### Ash.Domain.Info.span_name/3 (function)

The span_name for a domain and resource combination

### Ash.Domain.Info.telemetry_event_name/2 (function)

Names a telemetry event for a given domain/resource combo

### Ash.Domain.Info.timeout/1 (function)

The execution timeout for a domain

### Ash.Domain.Info.trace_name/1 (function)

The trace name for a domain

### Ash.Notifier.PubSub.Info (module)

Introspection helpers for Ash.Notifier.PubSub

### Ash.Notifier.PubSub.Info.broadcast_type/1 (function)

The broadcast type for a resource

### Ash.Notifier.PubSub.Info.delimiter/1 (function)

The delimiter to use when generating message topics

### Ash.Notifier.PubSub.Info.filter/1 (function)

The pubsub filter for a resource

### Ash.Notifier.PubSub.Info.module/1 (function)

The pubsub module for a resource

### Ash.Notifier.PubSub.Info.name/1 (function)

The pubsub name for a resource

### Ash.Notifier.PubSub.Info.prefix/1 (function)

The topic prefix for a resource

### Ash.Notifier.PubSub.Info.publications/1 (function)

The list of publications for a resource

### Ash.Notifier.PubSub.Info.transform/1 (function)

The transform for a resource

### Ash.Notifier.PubSub.Publication (module)

Represents a configured publication from the pubsub notifier on an Ash.Resource

### Ash.Notifier.PubSub.Publication.publish_all_schema/0 (function)



### Ash.Notifier.PubSub.Publication.schema/0 (function)



### Ash.Policy.FieldPolicy (module)

Represents a field policy in an Ash.Resource

### Ash.Policy.FieldPolicy.t/0 (type)



### Ash.Policy.Info (module)

An authorization extension for ash resources.

For more information, see `Ash.Policy.Authorizer`

### Ash.Policy.Info.default_access_type/1 (function)



### Ash.Policy.Info.describe_resource/2 (function)



### Ash.Policy.Info.field_policies/1 (function)



### Ash.Policy.Info.field_policies_for_field/2 (function)

Gets the field policies relevant to a given field

### Ash.Policy.Info.log_policy_breakdowns/0 (function)

The log level at which Ash policy authorizer logs policy breakdowns. Defaults to none.

### Ash.Policy.Info.log_successful_policy_breakdowns/0 (function)

The log level at which Ash policy authorizer logs successful policy breakdowns. Defaults to none.

### Ash.Policy.Info.policies/2 (function)



### Ash.Policy.Info.private_fields_policy/1 (function)



### Ash.Policy.Info.show_policy_breakdowns?/0 (function)

Whether or not Ash policy authorizer is configured to show policy breakdowns in error messages

### Ash.Policy.Info.strict_check/3 (function)

A utility to determine if a given query/changeset would pass authorization.

*This is still experimental.*

### Ash.Policy.Policy (module)

Represents a policy on an Ash.Resource

### Ash.Policy.Policy.at_least_one_policy_expression/1 (function)



### Ash.Policy.Policy.fetch_fact/2 (function)



### Ash.Policy.Policy.fetch_or_strict_check_fact/2 (function)



### Ash.Policy.Policy.solve/1 (function)



### Ash.Policy.Policy.t/0 (type)



### Ash.Resource.Actions (module)

Types for Ash actions

### Ash.Resource.Actions.action/0 (type)



### Ash.Resource.Actions.action_type/0 (type)



### Ash.Resource.Actions.Action (module)

Represents a custom action on a resource.

### Ash.Resource.Actions.Action.t/0 (type)



### Ash.Resource.Actions.Action.transform/1 (function)



### Ash.Resource.Actions.Argument (module)

Represents an argument to an action

### Ash.Resource.Actions.Argument.schema/0 (function)



### Ash.Resource.Actions.Argument.t/0 (type)



### Ash.Resource.Actions.Create (module)

Represents a create action on a resource.

### Ash.Resource.Actions.Create.t/0 (type)



### Ash.Resource.Actions.Destroy (module)

Represents a destroy action on a resource.

### Ash.Resource.Actions.Destroy.t/0 (type)



### Ash.Resource.Actions.Destroy.transform/1 (function)



### Ash.Resource.Actions.Implementation (behaviour)

An implementation of a [generic action](generic-actions.md).

### Example - Ash.Resource.Actions.Implementation (behaviour)

```
defmodule YourModule do
  use Ash.Resource.Actions.Implementation

  def run(input, opts, context) do
    {:ok, "Hello"}
  end
end
```

### Ash.Resource.Actions.Implementation.run/3 (callback)



### Ash.Resource.Actions.Implementation.Context (module)

The context passed into generic action functions

### Ash.Resource.Actions.Implementation.Context.t/0 (type)



### Ash.Resource.Actions.Metadata (module)

Represents metadata from an action

### Ash.Resource.Actions.Metadata.schema/0 (function)



### Ash.Resource.Actions.Metadata.t/0 (type)



### Ash.Resource.Actions.Read (module)

Represents a read action on a resource.

### Ash.Resource.Actions.Read.pagination_schema/0 (function)



### Ash.Resource.Actions.Read.t/0 (type)



### Ash.Resource.Actions.Read.transform/1 (function)



### Ash.Resource.Actions.Read.Pagination (module)

Represents the pagination configuration of a read action

### Ash.Resource.Actions.Read.Pagination.t/0 (type)



### Ash.Resource.Actions.Read.Pagination.transform/1 (function)



### Ash.Resource.Actions.Update (module)

Represents a update action on a resource.

### Ash.Resource.Actions.Update.t/0 (type)



### Ash.Resource.Actions.Update.transform/1 (function)



### Ash.Resource.Aggregate (module)

Represents a named aggregate on the resource that can be loaded

### Ash.Resource.Aggregate.t/0 (type)



### Ash.Resource.Aggregate.CustomAggregate (behaviour)

The root behavior for a custom aggregate.

See data layers for their implementation of custom aggregates.

### Ash.Resource.Aggregate.CustomAggregate.describe/1 (callback)



### Ash.Resource.Aggregate.CustomAggregate.t/0 (type)



### Ash.Resource.Aggregate.JoinFilter (module)

Represents a join filter on a resource aggregate

### Ash.Resource.Attribute (module)

Represents an attribute on a resource

### Ash.Resource.Attribute.create_timestamp_schema/0 (function)



### Ash.Resource.Attribute.integer_primary_key_schema/0 (function)



### Ash.Resource.Attribute.t/0 (type)



### Ash.Resource.Attribute.transform/1 (function)



### Ash.Resource.Attribute.update_timestamp_schema/0 (function)



### Ash.Resource.Attribute.uuid_primary_key_schema/0 (function)



### Ash.Resource.Attribute.uuid_v7_primary_key_schema/0 (function)



### Ash.Resource.Calculation.Argument (module)

An argument to a calculation

### Ash.Resource.Calculation.Argument.schema/0 (function)



### Ash.Resource.Calculation.Argument.t/0 (type)



### Ash.Resource.Calculation.Context (module)

The context and arguments of a calculation

### Ash.Resource.Calculation.Context.t/0 (type)



### Ash.Resource.Calculation.LoadAttribute (module)

Loads an attribute as a calculation.

Can be used to load the same attribute with different load statements applied.

### Ash.Resource.Calculation.LoadAttribute.calculate/3 (function)

Callback implementation for  Ash.Resource.Calculation.calculate/3 .

### Ash.Resource.Calculation.LoadAttribute.describe/1 (function)

Callback implementation for  Ash.Resource.Calculation.describe/1 .

### Ash.Resource.Calculation.LoadAttribute.has_calculate?/0 (function)



### Ash.Resource.Calculation.LoadAttribute.has_expression?/0 (function)

Callback implementation for  Ash.Resource.Calculation.has_expression?/0 .

### Ash.Resource.Calculation.LoadAttribute.init/1 (function)

Callback implementation for  Ash.Resource.Calculation.init/1 .

### Ash.Resource.Calculation.LoadAttribute.load/3 (function)

Callback implementation for  Ash.Resource.Calculation.load/3 .

### Ash.Resource.Calculation.LoadAttribute.strict_loads?/0 (function)

Callback implementation for  Ash.Resource.Calculation.strict_loads?/0 .

### Ash.Resource.Calculation.LoadRelationship (module)

Loads a relationship as a calculation.

Can be used to load the same relationship with a different query.

### Ash.Resource.Calculation.LoadRelationship.calculate/3 (function)

Callback implementation for  Ash.Resource.Calculation.calculate/3 .

### Ash.Resource.Calculation.LoadRelationship.describe/1 (function)

Callback implementation for  Ash.Resource.Calculation.describe/1 .

### Ash.Resource.Calculation.LoadRelationship.has_calculate?/0 (function)



### Ash.Resource.Calculation.LoadRelationship.has_expression?/0 (function)

Callback implementation for  Ash.Resource.Calculation.has_expression?/0 .

### Ash.Resource.Calculation.LoadRelationship.init/1 (function)

Callback implementation for  Ash.Resource.Calculation.init/1 .

### Ash.Resource.Calculation.LoadRelationship.load/3 (function)

Callback implementation for  Ash.Resource.Calculation.load/3 .

### Ash.Resource.Calculation.LoadRelationship.strict_loads?/0 (function)

Callback implementation for  Ash.Resource.Calculation.strict_loads?/0 .

### Ash.Resource.CalculationInterface (module)

Represents a function that evaluates a calculation in a resource's code interface

### Ash.Resource.CalculationInterface.schema/0 (function)



### Ash.Resource.CalculationInterface.t/0 (type)



### Ash.Resource.CalculationInterface.transform/1 (function)



### Ash.Resource.Identity (module)

Represents a unique constraint on a resource

Data layers should (and all built in ones do), discount `nil` or `null` (in the case of postgres) values
when determining if a unique constraint matches. This often means that you should
prefer to use identities with non-nullable columns.

Eventually, features could be added to support including `nil` or `null` values, but they would
need to include a corresponding feature for data layers.

### Ash.Resource.Identity.schema/0 (function)



### Ash.Resource.Identity.t/0 (type)



### Ash.Resource.Info (module)

Introspection for resources

### Ash.Resource.Info.action/3 (function)

Returns the action with the matching name and type on the resource

### Ash.Resource.Info.action_input?/3 (function)

Returns true or false if the input is accepted by the action, as an argument or an attribute

### Ash.Resource.Info.action_inputs/2 (function)

Returns the list of possible accepted keys by an action

### Ash.Resource.Info.action_select/2 (function)

Returns the list of attributes that must be selected for an action invocation

### Ash.Resource.Info.actions/1 (function)

Returns all actions of a resource

### Ash.Resource.Info.aggregate/2 (function)

Get an aggregate by name

### Ash.Resource.Info.aggregate_type/2 (function)

Gets the type of an aggregate for a given resource.

### Ash.Resource.Info.aggregates/1 (function)

Returns all aggregates of a resource

### Ash.Resource.Info.always_selected_attribute_names/1 (function)



### Ash.Resource.Info.attribute/2 (function)

Get an attribute name from the resource

### Ash.Resource.Info.attribute_names/1 (function)



### Ash.Resource.Info.attributes/1 (function)

Returns all attributes of a resource

### Ash.Resource.Info.attributes_to_require/1 (function)



### Ash.Resource.Info.attributes_to_require/2 (function)



### Ash.Resource.Info.authorizers/1 (function)

A list of authorizers to be used when accessing

### Ash.Resource.Info.base_filter/1 (function)

The base filter of the resource

### Ash.Resource.Info.calculation/2 (function)

Get a calculation by name

### Ash.Resource.Info.calculation_interface/2 (function)

Get an calculation interface by name from the resource

### Ash.Resource.Info.calculation_interfaces/1 (function)

The list of code interface calculation definitions.

### Ash.Resource.Info.calculations/1 (function)

Returns all calculations of a resource

### Ash.Resource.Info.changes/1 (function)

A list of all changes for the resource

### Ash.Resource.Info.changes/2 (function)

A list of all changes for the resource for a given action type

### Ash.Resource.Info.code_interface_domain/1 (function)

The domain to define the interface for, when defining it in the resource

### Ash.Resource.Info.data_layer/1 (function)

The data layer of the resource, or nil if it does not have one

### Ash.Resource.Info.default_actions/1 (function)

Returns the configured default actions

### Ash.Resource.Info.default_context/1 (function)

The default context of the resource

### Ash.Resource.Info.define_interface?/1 (function)

Whether or not to define the interface on the resource

### Ash.Resource.Info.description/1 (function)

The description of the resource

### Ash.Resource.Info.domain/1 (function)

Returns the statically configured domain for the resource.

### Ash.Resource.Info.embedded?/1 (function)

Whether or not the resource is an embedded resource

### Ash.Resource.Info.field/2 (function)

Get a field from a resource by name

### Ash.Resource.Info.fields/2 (function)

Returns all attributes, aggregates, calculations and relationships of a resource

### Ash.Resource.Info.hide_inspect_fields/1 (function)

A deny-list of fields to hide from the inspect output.
Takes precedence over `show_inspect_fields`.

### Ash.Resource.Info.identities/1 (function)

A list of identities for the resource

### Ash.Resource.Info.identity/2 (function)

Get an identity by name from the resource

### Ash.Resource.Info.inspect_private_fields?/1 (function)

Whether to include private fields in the inspect output.
`show_inspect_fields` takes precedence over this option.

### Ash.Resource.Info.interface/2 (function)

Get an interface by name from the resource

### Ash.Resource.Info.interfaces/1 (function)

The list of code interface definitions.

### Ash.Resource.Info.lazy_matching_default_attributes/2 (function)

Returns all attributes of a resource with lazy matching defaults

### Ash.Resource.Info.lazy_non_matching_default_attributes/2 (function)

Returns all attributes of a resource with lazy non-matching-defaults

### Ash.Resource.Info.multitenancy_attribute/1 (function)

The multitenancy attribute for a resource

### Ash.Resource.Info.multitenancy_global?/1 (function)

The MFA to parse the tenant from the attribute

### Ash.Resource.Info.multitenancy_parse_attribute/1 (function)

The function to parse the tenant from the attribute

### Ash.Resource.Info.multitenancy_strategy/1 (function)

The multitenancy strategy for a resource

### Ash.Resource.Info.multitenancy_template/1 (function)

The template for creating the tenant name

### Ash.Resource.Info.notifiers/1 (function)

A list of notifiers to be used when accessing

### Ash.Resource.Info.plural_name/1 (function)

The plural_name of the resource

### Ash.Resource.Info.preparations/1 (function)



### Ash.Resource.Info.primary_action/2 (function)

Returns the primary action of a given type

### Ash.Resource.Info.primary_action!/2 (function)

Returns the primary action of the given type

### Ash.Resource.Info.primary_key/1 (function)

A list of field names corresponding to the primary key

### Ash.Resource.Info.primary_key_simple_equality?/1 (function)

Whether or not all primary key attributes can be compared with simple_equality

### Ash.Resource.Info.public_aggregate/2 (function)

Get an aggregate by name

### Ash.Resource.Info.public_aggregates/1 (function)

Returns all public aggregates of a resource

### Ash.Resource.Info.public_attribute/2 (function)

Get a public attribute name from the resource

### Ash.Resource.Info.public_attributes/1 (function)

Returns all public attributes of a resource

### Ash.Resource.Info.public_calculation/2 (function)

Get a public calculation by name

### Ash.Resource.Info.public_calculations/1 (function)

Returns all public calculations of a resource

### Ash.Resource.Info.public_field/2 (function)

Get a public field from a resource by name

### Ash.Resource.Info.public_fields/1 (function)

Returns all public attributes, aggregates, calculations and relationships of a resource

### Ash.Resource.Info.public_relationship/2 (function)

Get a public relationship by name or path

### Ash.Resource.Info.public_relationships/1 (function)

Returns all public relationships of a resource

### Ash.Resource.Info.related/2 (function)



### Ash.Resource.Info.relationship/2 (function)

Get a relationship by name or path

### Ash.Resource.Info.relationships/1 (function)

Returns all relationships of a resource

### Ash.Resource.Info.required_belongs_to_relationships/1 (function)

The required belongs_to relationships

### Ash.Resource.Info.resource?/1 (function)

Whether or not a given module is a resource module

### Ash.Resource.Info.reverse_relationship/3 (function)

Retrieves a relationship path from the resource related by path, to the provided resource.

### Ash.Resource.Info.selected_by_default_attribute_names/1 (function)



### Ash.Resource.Info.short_name/1 (function)

The short_name of the resource

### Ash.Resource.Info.show_inspect_fields/1 (function)

An allow-list of fields to show in the inspect output.

### Ash.Resource.Info.simple_notifiers/1 (function)

A list of simple notifiers (require no DSL, used to avoid compile time dependencies)

### Ash.Resource.Info.sortable?/3 (function)

Determine if a field is sortable by name

### Ash.Resource.Info.static_default_attributes/2 (function)

Returns all attributes of a resource with static defaults

### Ash.Resource.Info.trace_name/1 (function)

The trace_name of the resource

### Ash.Resource.Info.unique_keys/1 (function)

A list of unique keys and information for a resource

### Ash.Resource.Info.validations/1 (function)

A list of all validations for the resource

### Ash.Resource.Info.validations/2 (function)

A list of all validations for the resource for a given action type

### Ash.Resource.Interface (module)

Represents a function in a resource's code interface

See the functions defined in this module for specifications of the options
that each type of code interface function supports in its options list.

### Ash.Resource.Interface.calculate_opts/0 (function)

Options supported by code interfaces for calculations

### Options - Ash.Resource.Interface.calculate_opts/0 (function)

* `:actor` (`t:term/0`) - The actor for handling `^actor/1` templates, supplied to calculation context.

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - The tenant, supplied to calculation context.

* `:authorize?` (`t:boolean/0`) - Whether or not the request is being authorized, provided to calculation context. The default value is `true`.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer, provided to the calculation context.

* `:data_layer?` (`t:boolean/0`) - Set to `true` to require that the value be computed within the data layer. Only works for calculations that define an expression.

* `:reuse_values?` (`t:boolean/0`) - Set to `true` to reuse existing values on any provided record. Only necessary if providing a record as the basis for calculation. The default value is `false`.

### Ash.Resource.Interface.create_opts/0 (function)

Options supported by code interfaces for create actions

### Options - Ash.Resource.Interface.create_opts/0 (function)

* `:upsert?` (`t:boolean/0`) - If a conflict is found based on the primary key, the record is updated in the database (requires upsert support) The default value is `false`.

* `:return_skipped_upsert?` (`t:boolean/0`) - If `true`, and a record was *not* upserted because its filter prevented the upsert, the original record (which was *not* upserted) will be returned. The default value is `false`.

* `:upsert_identity` (`t:atom/0`) - The identity to use when detecting conflicts for `upsert?`, e.g. `upsert_identity: :full_name`. By default, the primary key is used. Has no effect if `upsert?: true` is not provided

* `:upsert_fields` - The fields to upsert. If not set, the action's upsert_fields is used, and if that is not set, then any fields not being set to defaults are written.

* `:upsert_condition` (`t:term/0`) - An expression to check if the record should be updated when there's a conflict.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

* `:return_notifications?` (`t:boolean/0`) - Use this if you're running ash actions in your own transaction and you want to manually handle sending notifications.  
  If a transaction is ongoing, and this is false, notifications will be discarded, otherwise
  the return value is `{:ok, result, notifications}` (or `{:ok, notifications}`)  
  To send notifications later, use `Ash.Notifier.notify(notifications)`. It sends any notifications
  that can be sent, and returns the rest. The default value is `false`.

* `:rollback_on_error?` (`t:boolean/0`) - Whether or not to rollback the transaction on error, if the resource is in a transaction.  
  If the action has `transaction? false` this option has no effect. If an error is returned from the
  data layer and the resource is in a transaction, the transaction is always rolled back, regardless. The default value is `true`.

* `:notification_metadata` (`t:term/0`) - Metadata to be merged into the metadata field for all notifications sent from this operation. The default value is `%{}`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:load` (`t:term/0`) - A load statement to add onto the changeset

* `:changeset` (`t:term/0`) - A changeset to seed the action with.

* `:bulk_options` (`t:keyword/0`) - Options passed to `Ash.bulk_create`, if a list or stream of inputs is provided.

  * `:select` (list of `t:atom/0`) - A select statement to apply to records. Ignored if `return_records?` is not true.

  * `:after_action` (function of arity 2) - An after_action hook to be added to each processed changeset

  * `:read_action` (`t:atom/0`) - The action to use when building the read query.

  * `:assume_casted?` (`t:boolean/0`) - Whether or not to cast attributes and arguments as input. This is an optimization for cases where the input is already casted and/or not in need of casting The default value is `false`.

  * `:select` (list of `t:atom/0`) - A select statement to apply to records. Ignored if `return_records?` is not true.

  * `:authorize_query_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. Uses `authorize_with` if not set.

  * `:authorize_changeset_with` - If set to `:error`, instead of filtering unauthorized changes, unauthorized changes will raise an appropriate forbidden error. Uses `authorize_with` if not set.

  * `:authorize_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. The default value is `:filter`.

  * `:sorted?` (`t:boolean/0`) - Whether or not to sort results by their input position, in cases where `return_records?: true` was provided. The default value is `false`.

  * `:return_records?` (`t:boolean/0`) - Whether or not to return all of the records that were inserted. Defaults to false to account for large inserts. The default value is `false`.

  * `:return_errors?` (`t:boolean/0`) - Whether or not to return all of the errors that occur. Defaults to false to account for large inserts. The default value is `true`.

  * `:batch_size` (`t:pos_integer/0`) - The number of records to include in each batch. Defaults to the `default_limit`
    or `max_page_size` of the action, or 100.

  * `:return_stream?` (`t:boolean/0`) - If set to `true`, instead of an `Ash.BulkResult`, a mixed stream is returned.

    Potential elements:

    `{:notification, notification}` - if `return_notifications?` is set to `true`
    `{:ok, record}` - if `return_records?` is set to `true`
    `{:error, error}` - an error that occurred. May be changeset or an individual error.

    The default value is `false`.

  * `:return_nothing?` (`t:boolean/0`) - Mutes warnings about returning nothing.

    Only relevant if `return_stream?` is set to `true` and all other
    `return_*?` options are set to `false`.

    The default value is `false`.

  * `:stop_on_error?` (`t:boolean/0`) - If true, the first encountered error will stop the action and be returned. Otherwise, errors
    will be skipped. The default value is `true`.

  * `:notify?` (`t:boolean/0`) - Whether or not to generate any notifications. If this is set to `true` then the data layer must return
    the results from each batch. This may be intensive for large bulk actions.

    Notifications will be automatically sent unless `return_notifications?` is set to `true`.

    The default value is `false`.

  * `:transaction` - Whether or not to wrap the entire execution in a transaction, each batch, or not at all.

    Keep in mind:

    `before_transaction` and `after_transaction` hooks attached to changesets will have to be run
    *inside* the transaction if you choose `transaction: :all`.

    The default value is `:batch`.

  * `:max_concurrency` (`t:non_neg_integer/0`) - If set to a value greater than 0, up to that many tasks will be started to run batches asynchronously The default value is `0`.

### Ash.Resource.Interface.destroy_opts/0 (function)

Options supported by code interfaces for destroy actions

### Options - Ash.Resource.Interface.destroy_opts/0 (function)

* `:return_destroyed?` (`t:boolean/0`) - If true, the destroyed record is included in the return result, e.g `{:ok, destroyed}` or `{:ok, destroyed, notifications}` The default value is `false`.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

* `:return_notifications?` (`t:boolean/0`) - Use this if you're running ash actions in your own transaction and you want to manually handle sending notifications.  
  If a transaction is ongoing, and this is false, notifications will be discarded, otherwise
  the return value is `{:ok, result, notifications}` (or `{:ok, notifications}`)  
  To send notifications later, use `Ash.Notifier.notify(notifications)`. It sends any notifications
  that can be sent, and returns the rest. The default value is `false`.

* `:rollback_on_error?` (`t:boolean/0`) - Whether or not to rollback the transaction on error, if the resource is in a transaction.  
  If the action has `transaction? false` this option has no effect. If an error is returned from the
  data layer and the resource is in a transaction, the transaction is always rolled back, regardless. The default value is `true`.

* `:notification_metadata` (`t:term/0`) - Metadata to be merged into the metadata field for all notifications sent from this operation. The default value is `%{}`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:load` (`t:term/0`) - A load statement to add onto the changeset

* `:bulk_options` (`t:keyword/0`) - Options passed to `Ash.bulk_destroy`, if a query, list, or stream of inputs is provided.

  * `:stream_batch_size` (`t:integer/0`) - Batch size to use if provided a query and the query must be streamed

  * `:allow_stream_with` - The 'worst' strategy allowed to be used to fetch records if the `:stream` strategy is chosen. See the `Ash.stream!/2` docs for more. The default value is `:keyset`.

  * `:authorize_query?` (`t:boolean/0`) - If a query is given, determines whether or not authorization is run on that query. The default value is `true`.

  * `:strategy` - The strategy or strategies to enable. :stream is used in all cases if the data layer does not support atomics. The default value is `:atomic`.

  * `:filter` (`t:term/0`) - A filter to apply to records. This is also applied to a stream of inputs.

  * `:allow_stream_with` - The 'worst' strategy allowed to be used to fetch records. See `Ash.stream!/2` docs for more. The default value is `:keyset`.

  * `:stream_with` - The specific strategy to use to fetch records. See `Ash.stream!/2` docs for more.

  * `:max_concurrency` (`t:non_neg_integer/0`) - The maximum number of processes allowed to be started for parallel loading of relationships and calculations. Defaults to `System.schedulers_online() * 2`

  * `:lock` (`t:term/0`) - A lock statement to add onto the query

  * `:return_query?` (`t:boolean/0`) - If `true`, the query that was ultimately used is returned as a third tuple element.

    The query goes through many potential changes during a request, potentially adding
    authorization filters, or replacing relationships for other data layers with their
    corresponding ids. This option can be used to get the true query that was sent to
    the data layer.

    The default value is `false`.

  * `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

  * `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
      a list of fields to fetch on a relationship, which allows for more
      optimized data-fetching.

      See `Ash.Query.load/2`.

    The default value is `false`.

  * `:authorize_with` - If set to `:error`, instead of applying authorization filters as a filter, any records not matching the authorization filter will cause an error to be returned. The default value is `:filter`.

  * `:read_action` (`t:atom/0`) - The action to use when building the read query.

  * `:assume_casted?` (`t:boolean/0`) - Whether or not to cast attributes and arguments as input. This is an optimization for cases where the input is already casted and/or not in need of casting The default value is `false`.

  * `:select` (list of `t:atom/0`) - A select statement to apply to records. Ignored if `return_records?` is not true.

  * `:authorize_query_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. Uses `authorize_with` if not set.

  * `:authorize_changeset_with` - If set to `:error`, instead of filtering unauthorized changes, unauthorized changes will raise an appropriate forbidden error. Uses `authorize_with` if not set.

  * `:authorize_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. The default value is `:filter`.

  * `:sorted?` (`t:boolean/0`) - Whether or not to sort results by their input position, in cases where `return_records?: true` was provided. The default value is `false`.

  * `:return_records?` (`t:boolean/0`) - Whether or not to return all of the records that were inserted. Defaults to false to account for large inserts. The default value is `false`.

  * `:return_errors?` (`t:boolean/0`) - Whether or not to return all of the errors that occur. Defaults to false to account for large inserts. The default value is `true`.

  * `:batch_size` (`t:pos_integer/0`) - The number of records to include in each batch. Defaults to the `default_limit`
    or `max_page_size` of the action, or 100.

  * `:return_stream?` (`t:boolean/0`) - If set to `true`, instead of an `Ash.BulkResult`, a mixed stream is returned.

    Potential elements:

    `{:notification, notification}` - if `return_notifications?` is set to `true`
    `{:ok, record}` - if `return_records?` is set to `true`
    `{:error, error}` - an error that occurred. May be changeset or an individual error.

    The default value is `false`.

  * `:return_nothing?` (`t:boolean/0`) - Mutes warnings about returning nothing.

    Only relevant if `return_stream?` is set to `true` and all other
    `return_*?` options are set to `false`.

    The default value is `false`.

  * `:stop_on_error?` (`t:boolean/0`) - If true, the first encountered error will stop the action and be returned. Otherwise, errors
    will be skipped. The default value is `true`.

  * `:notify?` (`t:boolean/0`) - Whether or not to generate any notifications. If this is set to `true` then the data layer must return
    the results from each batch. This may be intensive for large bulk actions.

    Notifications will be automatically sent unless `return_notifications?` is set to `true`.

    The default value is `false`.

  * `:transaction` - Whether or not to wrap the entire execution in a transaction, each batch, or not at all.

    Keep in mind:

    `before_transaction` and `after_transaction` hooks attached to changesets will have to be run
    *inside* the transaction if you choose `transaction: :all`.

    The default value is `:batch`.

  * `:max_concurrency` (`t:non_neg_integer/0`) - If set to a value greater than 0, up to that many tasks will be started to run batches asynchronously The default value is `0`.

### Ash.Resource.Interface.generic_action_opts/0 (function)

Options supported by code interfaces for generic actions

### Options - Ash.Resource.Interface.generic_action_opts/0 (function)

* `:actor` (`t:term/0`) - The actor for handling `^actor/1` templates, supplied to calculation context.

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - The tenant, supplied to calculation context.

* `:authorize?` (`t:boolean/0`) - Whether or not the request should be authorized.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer, provided to the calculation context.

* `:context` (`t:map/0`) - Context to set on the action input

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

### Ash.Resource.Interface.get_opts/0 (function)

Options supported by code interfaces for read actions with `get?` or `get_by` set.

### Options - Ash.Resource.Interface.get_opts/0 (function)

* `:page` - Pagination options, see `Ash.read/2` for more.

* `:load` (`t:term/0`) - A load statement to add onto the query

* `:max_concurrency` (`t:non_neg_integer/0`) - The maximum number of processes allowed to be started for parallel loading of relationships and calculations. Defaults to `System.schedulers_online() * 2`

* `:lock` (`t:term/0`) - A lock statement to add onto the query

* `:return_query?` (`t:boolean/0`) - If `true`, the query that was ultimately used is returned as a third tuple element.  
  The query goes through many potential changes during a request, potentially adding
  authorization filters, or replacing relationships for other data layers with their
  corresponding ids. This option can be used to get the true query that was sent to
  the data layer. The default value is `false`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

* `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
    a list of fields to fetch on a relationship, which allows for more
    optimized data-fetching.  
    See `Ash.Query.load/2`. The default value is `false`.

* `:authorize_with` - If set to `:error`, instead of applying authorization filters as a filter, any records not matching the authorization filter will cause an error to be returned. Valid values are :filter, :error The default value is `:filter`.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

* `:query` - A query to seed the action with.

* `:not_found_error?` (`t:boolean/0`) - Whether or not to return or raise a `NotFound` error or to return `nil` when a get? action/interface is called.

* `:stream?` (`t:boolean/0`) - If true, a stream of the results will be returned The default value is `false`.

* `:stream_options` (`t:keyword/0`) - Options passed to `Ash.stream!`, if `stream?: true` is given

  * `:batch_size` (`t:integer/0`) - How many records to request in each query run. Defaults to the pagination limits on the resource, or 250.

  * `:allow_stream_with` - The 'worst' strategy allowed to be used to fetch records. See `Ash.stream!/2` docs for more. The default value is `:keyset`.

  * `:stream_with` - The specific strategy to use to fetch records. See `Ash.stream!/2` docs for more.

### Ash.Resource.Interface.read_opts/0 (function)

Options supported by code interfaces for read actions

### Options - Ash.Resource.Interface.read_opts/0 (function)

* `:page` - Pagination options, see `Ash.read/2` for more.

* `:load` (`t:term/0`) - A load statement to add onto the query

* `:max_concurrency` (`t:non_neg_integer/0`) - The maximum number of processes allowed to be started for parallel loading of relationships and calculations. Defaults to `System.schedulers_online() * 2`

* `:lock` (`t:term/0`) - A lock statement to add onto the query

* `:return_query?` (`t:boolean/0`) - If `true`, the query that was ultimately used is returned as a third tuple element.  
  The query goes through many potential changes during a request, potentially adding
  authorization filters, or replacing relationships for other data layers with their
  corresponding ids. This option can be used to get the true query that was sent to
  the data layer. The default value is `false`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

* `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
    a list of fields to fetch on a relationship, which allows for more
    optimized data-fetching.  
    See `Ash.Query.load/2`. The default value is `false`.

* `:authorize_with` - If set to `:error`, instead of applying authorization filters as a filter, any records not matching the authorization filter will cause an error to be returned. Valid values are :filter, :error The default value is `:filter`.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

* `:query` - A query to seed the action with.

* `:not_found_error?` (`t:boolean/0`) - Whether or not to return or raise a `NotFound` error or to return `nil` when a get? action/interface is called.

* `:stream?` (`t:boolean/0`) - If true, a stream of the results will be returned The default value is `false`.

* `:stream_options` (`t:keyword/0`) - Options passed to `Ash.stream!`, if `stream?: true` is given

  * `:batch_size` (`t:integer/0`) - How many records to request in each query run. Defaults to the pagination limits on the resource, or 250.

  * `:allow_stream_with` - The 'worst' strategy allowed to be used to fetch records. See `Ash.stream!/2` docs for more. The default value is `:keyset`.

  * `:stream_with` - The specific strategy to use to fetch records. See `Ash.stream!/2` docs for more.

### Ash.Resource.Interface.t/0 (type)



### Ash.Resource.Interface.update_opts/0 (function)

Options supported by code interfaces for update actions

### Options - Ash.Resource.Interface.update_opts/0 (function)

* `:params` (`t:map/0`) - Parameters to supply, ignored if the input is a changeset, only used when an identifier is given.

* `:atomic_upgrade?` (`t:boolean/0`) - If true the action will be done atomically if it can (and is configured to do so), ignoring the in memory transformations and validations. You should not generally need to disable this. The default value is `true`.

* `:timeout` (`t:timeout/0`) - A positive integer, or `:infinity`. If none is provided, the timeout configured on the domain is used.

* `:tracer` (one or a list of module that adopts `Ash.Tracer`) - A tracer that implements the `Ash.Tracer` behaviour. See that module for more.

* `:action` (`t:term/0`) - The action to use, either an Action struct or the name of the action

* `:authorize?` - If an actor option is provided (even if it is `nil`), authorization happens automatically. If not, this flag can be used to authorize with no user. Valid values are true, false, nil

* `:context` (`t:map/0`) - Context to set on the query, changeset, or input

* `:tenant` (value that implements the `Ash.ToTenant` protocol) - A tenant to set on the query or changeset

* `:actor` (`t:term/0`) - If an actor is provided, it will be used in conjunction with the authorizers of a resource to authorize access

* `:return_notifications?` (`t:boolean/0`) - Use this if you're running ash actions in your own transaction and you want to manually handle sending notifications.  
  If a transaction is ongoing, and this is false, notifications will be discarded, otherwise
  the return value is `{:ok, result, notifications}` (or `{:ok, notifications}`)  
  To send notifications later, use `Ash.Notifier.notify(notifications)`. It sends any notifications
  that can be sent, and returns the rest. The default value is `false`.

* `:rollback_on_error?` (`t:boolean/0`) - Whether or not to rollback the transaction on error, if the resource is in a transaction.  
  If the action has `transaction? false` this option has no effect. If an error is returned from the
  data layer and the resource is in a transaction, the transaction is always rolled back, regardless. The default value is `true`.

* `:notification_metadata` (`t:term/0`) - Metadata to be merged into the metadata field for all notifications sent from this operation. The default value is `%{}`.

* `:skip_unknown_inputs` - A list of inputs that, if provided, will be ignored if they are not recognized by the action. Use `:*` to indicate all unknown keys.

* `:load` (`t:term/0`) - A load statement to add onto the changeset

* `:bulk_options` (`t:keyword/0`) - Options passed to `Ash.bulk_update`, if a query, list, or stream of inputs is provided.

  * `:atomic_update` (`t:map/0`) - A map of atomic updates to apply. See `Ash.Changeset.atomic_update/3` for more.

  * `:stream_batch_size` (`t:integer/0`) - Batch size to use if provided a query and the query must be streamed

  * `:allow_stream_with` - The 'worst' strategy allowed to be used to fetch records if the `:stream` strategy is chosen. See the `Ash.stream!/2` docs for more. The default value is `:keyset`.

  * `:authorize_query?` (`t:boolean/0`) - If a query is given, determines whether or not authorization is run on that query. The default value is `true`.

  * `:select` (list of `t:atom/0`) - A select statement to apply to records. Ignored if `return_records?` is not true.

  * `:filter` (`t:term/0`) - A filter to apply to records. This is also applied to a stream of inputs.

  * `:strategy` - The strategy or strategies to enable. :stream is used in all cases if the data layer does not support atomics. The default value is `[:atomic]`.

  * `:allow_stream_with` - The 'worst' strategy allowed to be used to fetch records. See `Ash.stream!/2` docs for more. The default value is `:keyset`.

  * `:stream_with` - The specific strategy to use to fetch records. See `Ash.stream!/2` docs for more.

  * `:max_concurrency` (`t:non_neg_integer/0`) - The maximum number of processes allowed to be started for parallel loading of relationships and calculations. Defaults to `System.schedulers_online() * 2`

  * `:lock` (`t:term/0`) - A lock statement to add onto the query

  * `:return_query?` (`t:boolean/0`) - If `true`, the query that was ultimately used is returned as a third tuple element.

    The query goes through many potential changes during a request, potentially adding
    authorization filters, or replacing relationships for other data layers with their
    corresponding ids. This option can be used to get the true query that was sent to
    the data layer.

    The default value is `false`.

  * `:reuse_values?` (`t:boolean/0`) - Whether calculations are allowed to reuse values that have already been loaded, or must refetch them from the data layer. The default value is `false`.

  * `:strict?` (`t:boolean/0`) - If set to true, only specified attributes will be loaded when passing
      a list of fields to fetch on a relationship, which allows for more
      optimized data-fetching.

      See `Ash.Query.load/2`.

    The default value is `false`.

  * `:authorize_with` - If set to `:error`, instead of applying authorization filters as a filter, any records not matching the authorization filter will cause an error to be returned. The default value is `:filter`.

  * `:read_action` (`t:atom/0`) - The action to use when building the read query.

  * `:assume_casted?` (`t:boolean/0`) - Whether or not to cast attributes and arguments as input. This is an optimization for cases where the input is already casted and/or not in need of casting The default value is `false`.

  * `:select` (list of `t:atom/0`) - A select statement to apply to records. Ignored if `return_records?` is not true.

  * `:authorize_query_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. Uses `authorize_with` if not set.

  * `:authorize_changeset_with` - If set to `:error`, instead of filtering unauthorized changes, unauthorized changes will raise an appropriate forbidden error. Uses `authorize_with` if not set.

  * `:authorize_with` - If set to `:error`, instead of filtering unauthorized query results, unauthorized query results will raise an appropriate forbidden error. The default value is `:filter`.

  * `:sorted?` (`t:boolean/0`) - Whether or not to sort results by their input position, in cases where `return_records?: true` was provided. The default value is `false`.

  * `:return_records?` (`t:boolean/0`) - Whether or not to return all of the records that were inserted. Defaults to false to account for large inserts. The default value is `false`.

  * `:return_errors?` (`t:boolean/0`) - Whether or not to return all of the errors that occur. Defaults to false to account for large inserts. The default value is `true`.

  * `:batch_size` (`t:pos_integer/0`) - The number of records to include in each batch. Defaults to the `default_limit`
    or `max_page_size` of the action, or 100.

  * `:return_stream?` (`t:boolean/0`) - If set to `true`, instead of an `Ash.BulkResult`, a mixed stream is returned.

    Potential elements:

    `{:notification, notification}` - if `return_notifications?` is set to `true`
    `{:ok, record}` - if `return_records?` is set to `true`
    `{:error, error}` - an error that occurred. May be changeset or an individual error.

    The default value is `false`.

  * `:return_nothing?` (`t:boolean/0`) - Mutes warnings about returning nothing.

    Only relevant if `return_stream?` is set to `true` and all other
    `return_*?` options are set to `false`.

    The default value is `false`.

  * `:stop_on_error?` (`t:boolean/0`) - If true, the first encountered error will stop the action and be returned. Otherwise, errors
    will be skipped. The default value is `true`.

  * `:notify?` (`t:boolean/0`) - Whether or not to generate any notifications. If this is set to `true` then the data layer must return
    the results from each batch. This may be intensive for large bulk actions.

    Notifications will be automatically sent unless `return_notifications?` is set to `true`.

    The default value is `false`.

  * `:transaction` - Whether or not to wrap the entire execution in a transaction, each batch, or not at all.

    Keep in mind:

    `before_transaction` and `after_transaction` hooks attached to changesets will have to be run
    *inside* the transaction if you choose `transaction: :all`.

    The default value is `:batch`.

  * `:max_concurrency` (`t:non_neg_integer/0`) - If set to a value greater than 0, up to that many tasks will be started to run batches asynchronously The default value is `0`.

### Ash.Resource.Interface.CustomInput (module)

Represents a custom input to a code interface

### Ash.Resource.Interface.CustomInput.schema/0 (function)



### Ash.Resource.Interface.CustomInput.t/0 (type)



### Ash.Resource.Interface.CustomInput.Transform (module)

Represents a transformation applied to a custom input

### Ash.Resource.Relationships (module)

Types Ash relationships

### Ash.Resource.Relationships.cardinality/0 (type)



### Ash.Resource.Relationships.relationship/0 (type)



### Ash.Resource.Relationships.type/0 (type)



### Ash.Resource.Relationships.BelongsTo (module)

Represents a belongs_to relationship on a resource

### Ash.Resource.Relationships.BelongsTo.t/0 (type)



### Ash.Resource.Relationships.HasMany (module)

Represents a has_many relationship on a resource

### Ash.Resource.Relationships.HasMany.manual/1 (function)



### Ash.Resource.Relationships.HasMany.t/0 (type)



### Ash.Resource.Relationships.HasMany.transform/1 (function)



### Ash.Resource.Relationships.HasOne (module)

Represents a has_one relationship on a resource

### Ash.Resource.Relationships.HasOne.t/0 (type)



### Ash.Resource.Relationships.HasOne.transform/1 (function)



### Ash.Resource.Relationships.ManyToMany (module)

Represents a many_to_many relationship on a resource

### Ash.Resource.Relationships.ManyToMany.t/0 (type)



### Ash.Changeset.ManagedRelationshipHelpers (module)

Tools for introspecting managed relationships.

Extensions can use this to look at an argument that will be passed
to a `manage_relationship` change and determine what their behavior
should be. For example, AshAdmin uses these to find out what kind of
nested form it should offer for each argument that manages a relationship.

### Ash.Changeset.ManagedRelationshipHelpers.could_create?/1 (function)



### Ash.Changeset.ManagedRelationshipHelpers.could_handle_missing?/1 (function)



### Ash.Changeset.ManagedRelationshipHelpers.could_lookup?/1 (function)



### Ash.Changeset.ManagedRelationshipHelpers.could_update?/1 (function)



### Ash.Changeset.ManagedRelationshipHelpers.must_load?/2 (function)



### Ash.Changeset.ManagedRelationshipHelpers.on_lookup_read_action/2 (function)



### Ash.Changeset.ManagedRelationshipHelpers.on_lookup_update_action/2 (function)



### Ash.Changeset.ManagedRelationshipHelpers.on_match_destination_actions/2 (function)



### Ash.Changeset.ManagedRelationshipHelpers.on_missing_destination_actions/2 (function)



### Ash.Changeset.ManagedRelationshipHelpers.on_no_match_destination_actions/2 (function)



### Ash.Changeset.ManagedRelationshipHelpers.sanitize_opts/2 (function)



### Ash.CiString (module)

Represents a case insensitive string

While some data layers are aware of case insensitive string types, in order for values
of this type to be used in other parts of Ash Framework, it has to be embedded in a module
this allows us to implement the `Comparable` protocol for it.

For the type implementation, see `Ash.Type.CiString`

### Ash.CiString.casing/0 (type)



### Ash.CiString.compare/2 (function)

Compares an Elixir String or Ash.CiString. It will return `:eq` if equal, `:lt`, if
the string is ordered alphabetically before the second string, and `:gt` if after.

### Ash.CiString.new/2 (function)

Returns a Ash.CiString from a String, or `nil` if the value is `nil`.

### Ash.CiString.sigil_i/2 (function)

Creates a case insensitive string

### Ash.CiString.string_type/0 (type)



### Ash.CiString.t/0 (type)



### Ash.CiString.to_comparable_string/1 (function)

Returns the downcased value, only downcasing if it hasn't already been done

### Ash.CiString.value/1 (function)

Converts a `Ash.CiString` into a normal Elixir String.

### Ash.Expr (module)

Tools to build Ash expressions

### Ash.Expr.actor/1 (function)

A template helper for using actor values in filter templates

### Ash.Expr.arg/1 (function)

A template helper for using action arguments in filter templates

### Ash.Expr.atomic_ref/1 (function)

A template helper for referring to the most recent atomic expression applied to an update field

### Ash.Expr.calc/2 (macro)

Creates an expression calculation for use in sort and distinct statements.

### Examples - Ash.Expr.calc/2 (macro)

```elixir
Ash.Query.sort(query, [
  {calc(string_upcase(name), :asc},
  {calc(count_nils([field1, field2]), type: :integer), :desc})
])
```

### Ash.Expr.can_return_nil?/1 (function)



### Ash.Expr.combinations/1 (function)

A template helper for creating a reference

### Ash.Expr.context/1 (function)

A template helper for using query context in filter templates

An atom will get the value for a key, and a list will be accessed via `get_in`.

### Ash.Expr.determine_type/1 (function)



### Ash.Expr.determine_types/4 (function)



### Ash.Expr.eval/2 (function)

Evaluate an expression. This function only works if you have no references, or if you provide the `record` option.

### Ash.Expr.eval!/2 (function)

Evaluate an expression. See `eval/2` for more.

### Ash.Expr.expr/1 (macro)

Creates an expression. See the [Expressions guide](/documentation/topics/reference/expressions.md) for more.

### Ash.Expr.expr?/1 (function)

Returns true if the value is or contains an expression

### Ash.Expr.or_where/2 (macro)



### Ash.Expr.parent/1 (function)

A template helper for creating a parent reference

### Ash.Expr.ref/1 (function)

A template helper for creating a reference

### Ash.Expr.ref/2 (function)

A template helper for creating a reference to a related path

### Ash.Expr.t/0 (type)



### Ash.Expr.template_references?/2 (function)

Whether or not a given template contains an actor reference

### Ash.Expr.template_references_argument?/1 (function)



### Ash.Expr.template_references_context?/1 (function)



### Ash.Expr.tenant/0 (function)

A template helper for using the tenant in filter templates

### Ash.Expr.where/2 (macro)



### Ash.Filter (module)

The representation of a filter in Ash.

### Security Concerns - Ash.Filter (module)

Do not pass user input directly to `Ash.Query.filter/2`, it will not be sanitised. Instead use
`Ash.Filter.parse_input/2` or `Ash.Query.filter_input/2`.

Refer to those functions for more information on how to safely work with user input.

### Writing a filter - Ash.Filter (module)



### Built In Predicates - Ash.Filter (module)

* `is_nil`
* `==`
* `!=`
* `in`
* `<`
* `>`
* `<=`
* `>=`
* `&&`
* `||`
* `<>`
* `/`
* `-`
* `*`
* `+`
* `equals` (alias
  for `==`)
* `not_equals` (alias
  for `!=`)
* `gt` (alias
  for `>`)
* `lt` (alias
  for `<`)
* `gte` (alias
  for `>=`)
* `lte` (alias
  for `<=`)
* `eq` (alias
  for `==`)
* `not_eq` (alias
  for `!=`)
* `less_than` (alias
  for `<`)
* `greater_than` (alias
  for `>`)
* `less_than_or_equal` (alias
  for `<=`)
* `greater_than_or_equal` (alias
  for `>=`)
* `and` (alias
  for `&&`)
* `or` (alias
  for `||`)
* `concat` (alias
  for `<>`)
* `div` (alias
  for `/`)
* `minus` (alias
  for `-`)
* `times` (alias
  for `*`)
* `plus` (alias
  for `+`)

### BooleanExpression syntax - Ash.Filter (module)

The expression syntax ultimately just builds the keyword list style filter,
but with lots of conveniences that would be very annoying to do manually.

Examples

```elixir
Ash.Query.filter(resource, name == "Zardoz")
Ash.Query.filter(resource, first_name == "Zar" and last_name == "Doz")
Ash.Query.filter(resource, first_name == "Zar" and last_name in ["Doz", "Daz"] and high_score > 10)
Ash.Query.filter(resource, first_name == "Zar" or last_name == "Doz" or (high_score > 10 and high_score < -10))
```

### Expressions - Ash.Filter (module)

More complex filters can be built using Ash Expressions.

Examples

```elixir
# Filter based on the contents of a string attribute
Ash.Query.filter(Helpdesk.Support.Ticket, contains(subject, "2"))
# Filter based on the attribute of a joined relationship:
Ash.Query.filter(Helpdesk.Support.Ticket, representative.name == ^name)
```

See the [Expressions guide](/documentation/topics/reference/expressions.md)
guide for more information.

### Keyword list syntax - Ash.Filter (module)

A filter is a nested keyword list (with some exceptions, like `true` for
everything and `false` for nothing).

The key is the "predicate" (or "condition") and the value is the parameter.
You can use `and` and `or` to create nested filters. Data layers can expose
custom predicates. Eventually, you will be able to define your own custom
predicates, which will be a mechanism for you to attach complex filters
supported by the data layer to your queries.

** Important ** In a given keyword list, all predicates are considered to be
"ands". So `[or: [first_name: "Tom", last_name: "Bombadil"]]` doesn't mean
'First name == "tom" or last_name == "bombadil"'. To say that, you want to
provide a list of filters, like so: `[or: [[first_name: "Tom"], [last_name:
"Bombadil"]]]`

Some example filters:

```elixir
Ash.Query.filter(resource, [name: "Zardoz"])
Ash.Query.filter(resource, [first_name: "Zar", last_name: "Doz"])
Ash.Query.filter(resource, [first_name: "Zar", last_name: [in: ["Doz", "Daz"]], high_score: [greater_than: 10]])
Ash.Query.filter(resource, [or: [
  [first_name: "Zar"],
  [last_name: "Doz"],
  [or: [
    [high_score: [greater_than: 10]]],
    [high_score: [less_than: -10]]
  ]
]])
```

### Other formats - Ash.Filter (module)

Maps are also accepted, as are maps with string keys. Technically, a list of
`[{"string_key", value}]` would also work.

### Ash.Filter.add_to_filter/6 (function)



### Ash.Filter.add_to_filter!/6 (function)



### Ash.Filter.builtin_functions/0 (function)



### Ash.Filter.builtin_operators/0 (function)



### Ash.Filter.builtin_predicate_operators/0 (function)



### Ash.Filter.builtins/0 (function)



### Ash.Filter.custom_expression/2 (function)



### Ash.Filter.do_hydrate_refs/2 (function)



### Ash.Filter.fetch_simple_equality_predicate/2 (function)

Can be used to find a simple equality predicate on an attribute

Use this when your attribute is configured with `filterable? :simple_equality`, and you want to
to find the value that it is being filtered on with (if any).

### Ash.Filter.find/5 (function)

Find an expression inside of a filter that matches the provided predicate

### Ash.Filter.find_simple_equality_predicate/2 (function)

Can be used to find a simple equality predicate on an attribute

Prefer `fetch_simple_equality_predicate/2`.

### Ash.Filter.find_value/2 (function)



### Ash.Filter.flat_map/2 (function)



### Ash.Filter.get_filter/2 (function)

Returns a filter statement that would find a single record based on the input.

For example:

    iex> get_filter(MyApp.Post, 1)
    {:ok, %{id: 1}} #using primary key
    iex> get_filter(MyApp.Post, id: 1)
    {:ok, %{id: 1}} #using primary key
    iex> get_filter(MyApp.Post, author_id: 1, publication_id: 2, first_name: "fred")
    {:ok, %{author_id: 1, publication_id: 1}} # using a unique identity
    iex> get_filter(MyApp.Post, first_name: "fred")
    :error # not enough information

### Ash.Filter.get_function/3 (function)



### Ash.Filter.get_operator/1 (function)



### Ash.Filter.get_predicate_function/3 (function)



### Ash.Filter.hydrate_refs/2 (function)



### Ash.Filter.list_predicates/1 (function)



### Ash.Filter.list_refs/5 (function)



### Ash.Filter.map/2 (function)



### Ash.Filter.move_exprs_to_relationship_path/2 (function)



### Ash.Filter.move_to_relationship_path/2 (function)



### Ash.Filter.parse/3 (function)

Parses a filter statement

See the module documentation for more information on the supported formats for filter
statements.

### Important - Ash.Filter.parse/3 (function)

If you are trying to validate a filter supplied from an external/untrusted source,
be sure to use `parse_input/2` instead!

### Ash.Filter.parse!/3 (function)

Parses a filter statement

See `parse/2` for more

### Ash.Filter.parse_input/2 (function)

Parses a filter statement, accepting *only public attributes/relationships* and
honoring field policies & related resource policies, raising on errors.

See `parse/2` for more on filter parsing, and the [policies guide](/documentation/topics/security/policies.md)
for more on input references.

### Ash.Filter.parse_input!/2 (function)

Parses a filter statement, accepting *only public attributes/relationships* and
honoring field policies & related resource policies, raising on errors.

See `parse_input/2` for more

### Ash.Filter.prefix_refs/2 (function)



### Ash.Filter.put_at_path/2 (function)



### Ash.Filter.relationship_paths/4 (function)



### Ash.Filter.run_other_data_layer_filters/4 (function)



### Ash.Filter.strict_subset_of/2 (function)

Returns true if the second argument is a strict subset (always returns the same or less data) of the first

### Ash.Filter.strict_subset_of?/2 (function)



### Ash.Filter.t/0 (type)



### Ash.Filter.to_simple_filter/2 (function)

Transform an expression based filter to a simple filter, which is just a list of predicates

Options:

* `:skip_invalid?` (`t:boolean/0`) - If an invalid filter expression is reached that can't be used with a simple filter (like an `or` statement, or a non-predicate expression), it will be ignored instead of raising an error. The default value is `false`.

### Ash.Filter.used_aggregates/3 (function)



### Ash.Filter.used_calculations/6 (function)



### Ash.Filter.Runtime (module)

Tools to checks a record to see if it matches a filter statement, or to
evalute expressions against records.

### Ash.Filter.Runtime.filter_matches/4 (function)

Removes any records that don't match the filter. Automatically loads
if necessary. If there are any ambiguous terms in the filter (e.g things
that could only be determined by data layer), it is assumed that they
are not matches.

### Ash.Filter.Runtime.old_get_related/6 (function)



### Ash.Filter.Simple (module)

Represents a simplified filter, with a simple list of predicates

### Ash.Filter.Simple.Not (module)

A negated predicate

### Ash.ForbiddenField (module)

Represents a field that was hidden due to authorization rules.

### Ash.ForbiddenField.field_type/0 (type)



### Ash.ForbiddenField.t/0 (type)



### Ash.Mix.Tasks.Helpers (module)

Helpers for Ash Mix tasks.

### Ash.Mix.Tasks.Helpers.domains!/1 (function)

Get all domains for the current project and ensure they are compiled.

### Ash.Mix.Tasks.Helpers.extensions!/2 (function)

Gets all extensions in use by the current project's domains and resources

### Ash.NotLoaded (module)

Used when a field hasn't been loaded or selected.

### Ash.NotLoaded.t/0 (type)



### Ash.OptionsHelpers (module)

Helpers for working with nimble options

### Ash.OptionsHelpers.ash_resource/0 (function)

Used to configure Spark to know that the type referenced is an Ash.Resource
also using Spark.

### Ash.OptionsHelpers.ash_type/0 (function)

Specifies Ash types that can be allowed when declaring a type for an
attribute, calculation, aggregate, etc.

### Ash.OptionsHelpers.hide_all_except/2 (function)

Used for marking an option as hidden so it doesn't show up as an option
with Spark.

### Ash.Page (module)

Types for Ash pages

### Ash.Page.page/0 (type)



### Ash.Page.type/0 (type)



### Ash.Page.Keyset (module)

A page of results from `keyset` based pagination.

The results are generated with a `keyset` metadata,
which can be used to fetch the next/previous pages.

### Ash.Page.Keyset.data_with_keyset/3 (function)

Appends keyset info to results.

### Ash.Page.Keyset.filter/4 (function)

Creates filters on the query using the query for the Keyset.

### Ash.Page.Keyset.new/6 (function)

Creates a new `Ash.Page.Keyset.t`.

### Ash.Page.Keyset.non_executable_binary_to_term/2 (function)

A restricted version of `:erlang.binary_to_term/2` that forbids
*executable* terms, such as anonymous functions.
The `opts` are given to the underlying `:erlang.binary_to_term/2`
call, with an empty list as a default.
By default this function does not restrict atoms, as an atom
interned in one node may not yet have been interned on another
(except for releases, which preload all code).
If you want to avoid atoms from being created, then you can pass
`[:safe]` as options, as that will also enable the safety mechanisms
from `:erlang.binary_to_term/2` itself.
Ripped from https://github.com/elixir-plug/plug_crypto/blob/v1.2.0/lib/plug/crypto.ex

### Ash.Page.Keyset.page_opts/0 (type)



### Ash.Page.Keyset.page_opts_opts/0 (type)



### Ash.Page.Keyset.page_opts_type/0 (type)



### Ash.Page.Keyset.t/0 (type)



### Ash.Page.Offset (module)

A page of results from `offset` based pagination.

If a resource supports `keyset` pagination as well,
it will also have the `keyset` metadata.

### Ash.Page.Offset.new/5 (function)

Creates a new `Ash.Page.Offset.t()`.

### Ash.Page.Offset.page_opts/0 (type)



### Ash.Page.Offset.page_opts_opts/0 (type)



### Ash.Page.Offset.page_opts_type/0 (type)



### Ash.Page.Offset.t/0 (type)



### Ash.PlugHelpers (module)

Helpers for working with the Plug connection.

### Ash.PlugHelpers.get_actor/1 (function)

Retrieves the actor from the Plug connection.

The actor is stored inside the [connection's private
fields](https://hexdocs.pm/plug/Plug.Conn.html#module-private-fields).

### Deprecation warning - Ash.PlugHelpers.get_actor/1 (function)

This function checks to see if the actor is already set in the `@actor`
assign, and if so will emit a deprecation warning.

This is to allow apps using the previous method a chance to update.

Rather than setting the actor in the assigns, please use the `set_actor/2`
method.

### Example - Ash.PlugHelpers.get_actor/1 (function)

iex> actor = build_actor(%{email: "marty@1985.retro"})
    ...> conn = build_conn() |> put_private(:ash, %{actor: actor})
    ...> actor = get_actor(conn)
    %{email: "marty@1985.retro"} = actor

    iex> actor = build_actor(%{email: "marty@1985.retro"})
    ...> conn = build_conn() |> assign(:actor, actor)
    ...> actor = get_actor(conn)
    %{email: "marty@1985.retro"} = actor

### Ash.PlugHelpers.get_context/1 (function)

Retrieves the context from the Plug connection.

The context is stored inside the [connection's private
fields](https://hexdocs.pm/plug/Plug.Conn.html#module-private-fields).

### Example - Ash.PlugHelpers.get_context/1 (function)

iex> context = %{fraud_score: 0.427}
    ...> conn = build_conn() |> put_private(:ash, %{context: context})
    ...> context = get_context(conn)
    %{fraud_score: 0.427}

### Ash.PlugHelpers.get_tenant/1 (function)

Retrieves the tenant from the Plug connection.

The tenant is stored inside the [connection's private
fields](https://hexdocs.pm/plug/Plug.Conn.html#module-private-fields).

### Deprecation warning - Ash.PlugHelpers.get_tenant/1 (function)

This function checks to see if the tenant is already set in the `@tenant`
assign, and if so will emit a deprecation warning.

This is to allow apps using the previous method a chance to update.

Rather than setting the tenant in the assigns, please use the `set_tenant/2`
method.

### Example - Ash.PlugHelpers.get_tenant/1 (function)

iex> conn = build_conn() |> put_private(:ash, %{tenant: "my-tenant"})
    ...> tenant = get_tenant(conn)
    "my_tenant" = tenant

    iex> conn = build_conn() |> assign(:tenant, "my-tenant")
    ...> tenant = get_tenant(conn)
    "my_tenant" = tenant

### Ash.PlugHelpers.set_actor/2 (function)

Sets the actor inside the Plug connection.

The actor is stored inside the [connection's private
fields](https://hexdocs.pm/plug/Plug.Conn.html#module-private-fields).

### Example - Ash.PlugHelpers.set_actor/2 (function)

iex> actor = build_actor(%{email: "marty@1985.retro"})
    ...> conn = build_conn() |> set_actor(actor)
    %Plug.Conn{private: %{ash: %{actor: %{email: "marty@1985.retro"}}}} = conn

### Ash.PlugHelpers.set_context/2 (function)

Sets the context inside the Plug connection.

Context can be used to store arbitrary data about the user, connection, or
anything else you like that doesn't belong as part of the actor or tenant.

The context is stored inside the [connection's private
fields](https://hexdocs.pm/plug/Plug.Conn.html#module-private-fields).

### Example - Ash.PlugHelpers.set_context/2 (function)

iex> context = %{fraud_score: 0.427}
    ...> conn = build_conn() |> set_context(context)
    %Plug.Conn{private: %{ash: %{context: %{fraud_score: 0.427}}}}

### Ash.PlugHelpers.set_tenant/2 (function)

Sets the tenant inside the Plug connection.

The tenant is stored inside the [connection's private
fields](https://hexdocs.pm/plug/Plug.Conn.html#module-private-fields).

### Example - Ash.PlugHelpers.set_tenant/2 (function)

iex> conn = build_conn() |> set_tenant("my-tenant")
    %Plug.Conn{private: %{ash: %{tenant: "my-tenant}}} = conn

### Ash.PlugHelpers.update_actor/2 (function)

Updates the actor inside the Plug connection.

The actor is stored inside the [connection's private
fields](https://hexdocs.pm/plug/Plug.Conn.html#module-private-fields).

### Example - Ash.PlugHelpers.update_actor/2 (function)

iex> actor = build_actor(%{email: "marty@1985.retro"})
    ...> conn = build_conn() |> put_private(:ash, %{actor: actor})
    ...> actor = get_actor(conn)
    %{email: "marty@1985.retro"} = actor
    ...> conn = update_actor(conn, fn actor -> Map.put(actor, :name, "Marty Retro") end)
    ...> actor = get_actor(conn)
    %{email: "marty@1985.retro", name: "Marty Retro"} = actor
    ...> conn = update_actor(conn, fn actor -> Map.delete(actor, :email) end)
    ...> actor = get_actor(conn)
    %{name: "Marty Retro"} = actor

### Ash.PlugHelpers.update_context/2 (function)

Updates the context inside the Plug connection.

The context is stored inside the [connection's private
fields](https://hexdocs.pm/plug/Plug.Conn.html#module-private-fields).

### Example - Ash.PlugHelpers.update_context/2 (function)

iex> context = %{species: "Fythetropozoat"}
    ...> conn = build_conn() |> put_private(:ash, %{context: context})
    ...> context = get_context(conn)
    %{fraud_score: 0.427}
    ...> conn = update_context(conn, fn context -> Map.put(context, :location, "Barnard's Loop") end)
    ...> context = get_context(conn)
    %{species: "Fythetropozoat", location: "Barnard's Loop"}
    ...> conn = update_context(conn, fn context -> Map.delete(context, :fraud_score) end)
    ...> context = get_context(conn)
    %{location: "Barnard's Loop"}

### Ash.ProcessHelpers (module)

Helpers for working with processes and Ash actions.

### Ash.ProcessHelpers.async/2 (function)

Creates a task that will properly transfer the ash context to the new process

### Ash.ProcessHelpers.get_context_for_transfer/1 (function)

Gets all of the ash context so it can be set into a new process.

Use `transfer_context/1` in the new process to set the context.

### Ash.ProcessHelpers.task_with_timeout/5 (function)

Creates a task that will properly transfer the ash context to the new process, and timeout if it takes longer than the given timeout

### Ash.ProcessHelpers.transfer_context/2 (function)



### Ash.Resource.Builder (module)

Tools for transforming resources in DSL Transformers.

### Ash.Resource.Builder.add_action/4 (function)

Builds and adds an action

### Ash.Resource.Builder.add_aggregate/5 (function)

Builds and adds an aggregate to a resource

### Ash.Resource.Builder.add_attribute/4 (function)

Builds and adds an attribute to a resource

### Ash.Resource.Builder.add_calculation/5 (function)

Builds and adds a calculation to a resource

### Ash.Resource.Builder.add_calculation_interface/3 (function)

Builds and adds an calculation interface to a resource

### Ash.Resource.Builder.add_change/3 (function)

Builds and adds a change

### Ash.Resource.Builder.add_create_timestamp/3 (function)

Builds and adds a create_timestamp to a resource

### Ash.Resource.Builder.add_identity/4 (function)

Builds and adds an identity

### Ash.Resource.Builder.add_interface/3 (function)

Builds and adds an interface to a resource

### Ash.Resource.Builder.add_new_action/4 (function)

Builds and adds a new action unless an action with that name already exists

### Ash.Resource.Builder.add_new_aggregate/5 (function)

Builds and adds an aggregate unless an aggregate with that name already exists

### Ash.Resource.Builder.add_new_attribute/4 (function)

Builds and adds an attribute unless an attribute with that name already exists

### Ash.Resource.Builder.add_new_calculation/5 (function)

Builds and adds a calculation unless a calculation with that name already exists

### Ash.Resource.Builder.add_new_calculation_interface/3 (function)

Builds and adds an calculation interface unless an calculation interface with that name already exists

### Ash.Resource.Builder.add_new_create_timestamp/3 (function)

Builds and adds a create_timestamp unless a create_timestamp with that name already exists

### Ash.Resource.Builder.add_new_identity/4 (function)

Builds and adds a new identity unless an identity with that name already exists

### Ash.Resource.Builder.add_new_interface/3 (function)

Builds and adds an interface unless an interface with that name already exists

### Ash.Resource.Builder.add_new_relationship/5 (function)

Builds and adds a new relationship unless a relationship with that name already exists

### Ash.Resource.Builder.add_new_update_timestamp/3 (function)

Builds and adds an update_timestamp unless an update_timestamp with that name already exists

### Ash.Resource.Builder.add_preparation/3 (function)

Builds and adds a preparation

### Ash.Resource.Builder.add_relationship/5 (function)

Builds and adds an action

### Ash.Resource.Builder.add_update_timestamp/3 (function)

Builds and adds an update_timestamp

### Ash.Resource.Builder.build_action/3 (function)

Builds an action

### Ash.Resource.Builder.build_action_argument/3 (function)

Builds an action argument

### Ash.Resource.Builder.build_action_change/2 (function)

Builds an action change

### Ash.Resource.Builder.build_action_metadata/3 (function)

Builds an action metadata

### Ash.Resource.Builder.build_action_validation/2 (function)

Builds an action validation

### Ash.Resource.Builder.build_aggregate/4 (function)

Builds a calculation with the given name, type, and options

### Ash.Resource.Builder.build_attribute/3 (function)

Builds an attribute with the given name, type, and options

### Ash.Resource.Builder.build_calculation/4 (function)

Builds a calculation with the given name, type, and options

### Ash.Resource.Builder.build_calculation_argument/3 (function)

Builds a calculation argument

### Ash.Resource.Builder.build_calculation_interface/2 (function)

Builds an calculation interface with the given name, type, and options

### Ash.Resource.Builder.build_change/2 (function)

Builds a change

### Ash.Resource.Builder.build_create_timestamp/2 (function)

Builds an create_timestamp with the given name, type, and options

### Ash.Resource.Builder.build_identity/3 (function)

Builds an action

### Ash.Resource.Builder.build_interface/2 (function)

Builds an interface with the given name, type, and options

### Ash.Resource.Builder.build_pagination/1 (function)

Builds a pagination object

### Ash.Resource.Builder.build_preparation/2 (function)

Builds a preparation

### Ash.Resource.Builder.build_relationship/4 (function)

Builds a relationship

### Ash.Resource.Builder.build_update_timestamp/2 (function)

Builds an update_timestamp with the given name, type, and options

### Ash.Resource.Builder.prepend_action/4 (function)

Builds and adds an action to the front of the actions list

### Ash.SatSolver (module)

Tools for working with the satsolver that drives filter subset checking (for authorization)

This is public as a very low level toolkit for writing authorizers, but you almost certainly
do not need to look at this module.

If you are looking for information about how authorization works, see the [policy guide](/documentation/topics/security/policies.md)

### Ash.SatSolver.b/1 (macro)

Creates tuples of a boolean statement.

i.e `b(1 and 2) #=> {:and, 1, 2}`

### Ash.SatSolver.left_excludes_right/2 (function)

Returns `b(not (left and right))`

### Ash.SatSolver.left_implies_right/2 (function)

Returns `b(not (left and not right))`

### Ash.SatSolver.mutually_exclusive/2 (function)

Returns a statement expressing that the predicates are mutually exclusive.

### Ash.SatSolver.mutually_exclusive_and_collectively_exhaustive/1 (function)

Returns a statement expressing that the predicates are mutually exclusive and collectively exhaustive.

### Ash.SatSolver.mutually_inclusive/2 (function)

Returns a statement expressing that the predicates are mutually inclusive

### Ash.SatSolver.right_excludes_left/2 (function)

Returns `b(not (right and left))`

### Ash.SatSolver.right_implies_left/2 (function)

Returns `b(not (right and not left))`

### Ash.SatSolver.strict_filter_subset/2 (function)

Returns true if the candidate filter returns the same or less data than the filter

### Ash.SatSolver.synonymous_relationship_paths?/4 (function)

Returns `true` if the relationship paths are synonymous from a data perspective

### Ash.SatSolver.to_cnf/1 (function)

Transforms a statement to Conjunctive Normal Form(CNF), as lists of lists of integers.

### Ash.SatSolver.transform/2 (function)

Prepares a filter for comparison

### Ash.SatSolver.transform_and_solve/2 (function)

Calls `transform/2` and solves the expression

### Ash.Sort (module)

Utilities and types for sorting.

### Ash.Sort.expr_sort/2 (macro)

Builds an expression to be used in a sort statement. Prefer to use `Ash.Expr.calc/2` instead.

For example:

```elixir
Ash.Query.sort(query, Ash.Sort.expr_sort(author.full_name, :string))

Ash.Query.sort(query, [{Ash.Sort.expr_sort(author.full_name, :string), :desc_nils_first}])
```

### Ash.Sort.parse_input/3 (function)

A utility for parsing sorts provided from external input. Only allows sorting on public fields.

See `Ash.Query.sort/3` for supported formats.

### Handling specific values - Ash.Sort.parse_input/3 (function)

A handler function may be provided that takes a string, and returns the relevant sort
It won't be given any prefixes, only the field. This allows for things like parsing the calculation values
out of the sort, or setting calculation values if they are not included in the sort string.

To return calculation parameters, return `{:field, %{param: :value}}`. This will end up as something
like `{:field, {%{param: :value}, :desc}}`, with the corresponding sort order.

This handler function will only be called if you pass in a string or list of strings for the sort.
Atoms will be assumed to have already been handled. The handler should return `nil` if it is not handling
the given field.

### Ash.Sort.parse_input!/3 (function)

Same as `parse_input/2` except raises any errors

See `parse_input/2` for more.

### Ash.Sort.parse_sort/4 (function)



### Ash.Sort.reverse/1 (function)

Reverses an Ash sort statement.

### Ash.Sort.runtime_sort/3 (function)

A utility for sorting a list of records at runtime.

For example:

    Ash.Sort.runtime_sort([record1, record2, record3], name: :asc, type: :desc_nils_last)

Keep in mind that it is unrealistic to expect this runtime sort to always
be exactly the same as a sort that may have been applied by your data layer.
This is especially true for strings. For example, `Postgres` strings have a
collation that affects their sorting, making it unpredictable from the perspective
of a tool using the database: https://www.postgresql.org/docs/current/collation.html

### Ash.Sort.sort_item/0 (type)



### Ash.Sort.sort_order/0 (type)



### Ash.Sort.t/0 (type)



### Ash.UUID (module)

Helpers for working with UUIDs

### Ash.UUID.generate/0 (function)

Generates a new uuid

### Ash.UUID.raw/0 (type)

A raw binary representation of a UUID.

### Ash.UUID.t/0 (type)

A hex-encoded UUID string.

### Ash.UUIDv7 (module)

Helpers for working with UUIDs version 7.

[RFC 9562](https://www.rfc-editor.org/rfc/rfc9562#name-uuid-version-7)

Used for generating UUIDs version 7 with increased clock precision for better monotonicity,
as described by method 3 of the [Section 6.2](https://www.rfc-editor.org/rfc/rfc9562#name-monotonicity-and-counters

Inspired by the work of [Ryan Winchester](https://github.com/ryanwinchester/) on [uuidv7](https://github.com/ryanwinchester/uuidv7)

### Examples - Ash.UUIDv7 (module)

iex> UUIDv7.generate()
    "018e90d8-06e8-7f9f-bfd7-6730ba98a51b"

    iex> UUIDv7.bingenerate()
    <<1, 142, 144, 216, 6, 232, 127, 159, 191, 215, 103, 48, 186, 152, 165, 27>>

### Ash.UUIDv7.bingenerate/0 (function)

Generates a version 7 UUID in the binary format.

### Example - Ash.UUIDv7.bingenerate/0 (function)

iex> UUIDv7.bingenerate()
    <<1, 142, 144, 216, 6, 232, 127, 159, 191, 215, 103, 48, 186, 152, 165, 27>>

### Ash.UUIDv7.decode/1 (function)

Decode a string representation of a UUID to the raw binary version.

### Example - Ash.UUIDv7.decode/1 (function)

iex> UUIDv7.decode("018e90d8-06e8-7f9f-bfd7-6730ba98a51b")
    <<1, 142, 144, 216, 6, 232, 127, 159, 191, 215, 103, 48, 186, 152, 165, 27>>

### Ash.UUIDv7.encode/1 (function)

Encode a raw UUID to the string representation.

### Example - Ash.UUIDv7.encode/1 (function)

iex> UUIDv7.encode(<<1, 142, 144, 216, 6, 232, 127, 159, 191, 215, 103, 48, 186, 152, 165, 27>>)
    "018e90d8-06e8-7f9f-bfd7-6730ba98a51b"

### Ash.UUIDv7.extract_timestamp/1 (function)

Extract the millisecond timestamp from the UUID.

### Example - Ash.UUIDv7.extract_timestamp/1 (function)

iex> UUIDv7.extract_timestamp("018ecb40-c457-73e6-a400-000398daddd9")
    1712807003223

### Ash.UUIDv7.generate/0 (function)

Generates a version 7 UUID using submilliseconds for increased clock precision.

### Example - Ash.UUIDv7.generate/0 (function)

iex> UUIDv7.generate()
    "018e90d8-06e8-7f9f-bfd7-6730ba98a51b"

### Ash.UUIDv7.raw/0 (type)

A raw binary representation of a UUID.

### Ash.UUIDv7.t/0 (type)

A hex-encoded UUID string.

### Ash.Union (module)

A wrapper for values that are sourced from `Ash.Type.Union`.

### Ash.Union.t/0 (type)



### Ash.Vector (module)

A vector struct for Ash.

Implementation based off of https://github.com/pgvector/pgvector-elixir/blob/v0.2.0/lib/pgvector.ex

### Ash.Vector.from_binary/1 (function)

Creates a new vector from its binary representation

### Ash.Vector.new/1 (function)

Creates a new vector from a list or tensor

### Ash.Vector.t/0 (type)



### Ash.Vector.to_binary/1 (function)

Converts the vector to its binary representation

### Ash.Vector.to_list/1 (function)

Converts the vector to a list

### Ash.Domain.Info.Diagram (module)

Generate Mermaid diagrams from a specified domain.

### Limitations - Ash.Domain.Info.Diagram (module)

We can't easily model Ash relationships with Mermaid diagrams
because they are unidirectional and could be asymmetric.
Mermaid assumes symmetrical, bidirectional relationships.
If we try to model all unidirectional relationships as separate
lines in the diagram it gets very hard to read very quickly.

### Ash.Domain.Info.Diagram.mermaid_class_diagram/2 (function)

Generates a Mermaid Class Diagram for a given domain.

Shows only public attributes, calculations, aggregates and actions.
Shows a connecting line for relationships with the type of relationship
indicated in the attribute list.

### Ash.Domain.Info.Diagram.mermaid_er_diagram/2 (function)

Generates a Mermaid Entity Relationship Diagram for a given domain or list of domains.

Shows only public attributes, calculations, aggregates and actions.
Shows a one-to-one line for relationships as enumerating all unidirectional
relationships is far too noisy.

### Ash.Domain.Info.Livebook (module)

Generate a Livebook from a specified domain.

### Ash.Domain.Info.Livebook.action_header/0 (function)



### Ash.Domain.Info.Livebook.action_input_section/2 (function)



### Ash.Domain.Info.Livebook.action_section/2 (function)



### Ash.Domain.Info.Livebook.attr_header/0 (function)



### Ash.Domain.Info.Livebook.attr_section/1 (function)



### Ash.Domain.Info.Livebook.domain_section/1 (function)



### Ash.Domain.Info.Livebook.overview/1 (function)



### Ash.Domain.Info.Livebook.resource_section/1 (function)



### Ash.Policy.Chart.Mermaid (module)

Generates policy mermaid charts

### Ash.Policy.Chart.Mermaid.chart/1 (function)



### Ash.Generator (module)

Tools for generating input to Ash resource actions and for generating seed data.

### Using Ash.Generator - Ash.Generator (module)

To define generators for your tests, `use Ash.Generator`, and define
functions that use `changeset_generator/3` and/or `seed_generator/2`.

```elixir
defmodule YourApp.Generator do
  use Ash.Generator

  # using `seed_generator`, bypasses the action and saves directly to the data layer
  def blog_post(opts \\ []) do
    seed_generator(
      %MyApp.Blog.Post{
        name: sequence(:title, &"My Blog Post #{&1}")
        text: StreamData.repeatedly(fn -> Faker.Lorem.paragraph() end)
      },
      overrides: opts
    )
  end

  # using `changeset_generator`, calls the action when passed to `generate`
  def blog_post_comment(opts \\ []) do
    blog_post_id = opts[:blog_post_id] || once(:default_blog_post_id, fn -> generate(blog_post()).id end)

    changeset_generator(
      MyApp.Blog.Comment,
      :create,
      defaults: [
        blog_post_id: blog_post_id
      ],
      overrides: opts
    )
  end
end
```

Then, in your tests, you can `import YourApp.Generator`, and use `generate/1` and `generate_many/1` to generate data.
For example:

```elixir
import YourApp.Generator

test "`comment_count` on blog_post shows the count of comments" do
  blog_post = generate(blog_post())
  assert Ash.load!(blog_post, :comment_count).comment_count == 0

  generate_many(blog_post_comment(blog_post_id: blog_post.id), 10)

  assert Ash.load!(blog_post, :comment_count).comment_count == 10
end
```

### About Generators - Ash.Generator (module)

These generators are backed by `StreamData`, and are ready for use with property testing via `ExUnitProperties`

Many functions in this module support "overrides", which allow passing down either constant values
or your own `StreamData` generators.

For example:

```elixir
# All generated posts will have text as `"text"`. Equivalent to providing `StreamData.constant("text")`.
Ash.Generator.seed_input(Post, %{text: "text"})
```

### Ash.Generator.action_input/3 (function)

Generate input meant to be passed into a resource action.

Arguments that are passed to a `manage_relationship` are not generated by default, and you will
have to generate them yourself by passing your own generators/values down. See the module documentation for more.

### Ash.Generator.changeset/4 (function)

Creates the input for the provided action with `action_input/3`, and creates a changeset for that action with that input.

See `action_input/3` and the module documentation for more.

### Ash.Generator.changeset_generator/3 (function)

A generator of changesets which call their specific actions when passed to `generate/1` or `generate_many/2`.

See `seed_generator/2` for the equivalent construct for cases when you want to seed directly to the data layer as opposed to calling resource
actions.

### Examples - Ash.Generator.changeset_generator/3 (function)

```elixir
iex> changeset_generator(MyApp.Blog.Post, :create, defaults: [title: sequence(:blog_post_title, &"My Blog Post #{&1}")]) |> generate()
%Ash.Changeset{...}
```

### Usage in tests - Ash.Generator.changeset_generator/3 (function)

This can be used to define generators in tests. A useful pattern is defining a function like so:

```elixir
def blog_post(opts \ []) do
  changeset_generator(
    MyApp.Blog.Post,
    :create,
    defaults: [
      name: sequence(:blog_post_title, &"My Blog Post #{&1}")
      text: StreamData.repeatedly(fn -> Faker.Lorem.paragraph() end)
    ],
    overrides: opts
  )
end
```

When you only allow child resource to be created through a managed relationship, e.g. an update action on a parent resource,
this pattern could be expanded, yielding a resource with a new child resource:

```elixir
def post_for(author, opts \ []) do
  changeset_generator(
    author,
    :new_post,
    uses: [
      post_input:
        action_input(
          MyApp.Blog.Post,
          :create,
          title: sequence(:title, &"Post #{&1}")
        )
    ],
    defaults: fn inputs ->
      [posts: [inputs.post_input]]
    end,
    overrides: opts
  )
end
```

See the `Ash.Generator` moduledocs for more information.

### Options - Ash.Generator.changeset_generator/3 (function)

* `:defaults` - A keyword list of values or generators, used as inputs. Can also be a function
  when using the `:uses` option.
* `:overrides` - A keyword list or map of `t:overrides()`
* `:actor` - Passed through to the changeset
* `:tenant` - Passed through to the changeset
* `:uses` - A map of generators that are passed into your `defaults`. `defaults` must be a
  function. This is useful when multiple things in your `defaults` need to use the same generated
  value.
* `:authorize?` - Passed through to the changeset
* `:context` - Passed through to the changeset
* `:after_action` - A one argument function that takes the result and returns
  a new result to run after the record is created.
* `:private_arguments` - A map of private arguments, whos values can also be generators. Can also
  be a function when using the `:uses` option.

### The uses option - Ash.Generator.changeset_generator/3 (function)

```elixir
def blog_post(opts \ []) do
  changeset_generator(
    MyApp.Blog.Post,
    :create,
    uses: [
      author: author() # A function using `changeset_generator` just like this one.
    ],
    defaults: fn %{author: author} ->
      author = generate(author)

      [
        name: sequence(:blog_post_title, &"My Blog Post #{&1}")
        author_name: author.name,
        text: StreamData.repeatedly(fn -> Faker.Lorem.paragraph() end)
      ]
    end
    overrides: opts
  )
end
```

### Ash.Generator.generate/1 (function)

Takes one value from a changeset or seed generator and calls `Ash.create!` or `Ash.update!` on it.

Passes through resource structs without doing anything.
Creates a changeset if given

### Ash.Generator.generate_many/2 (function)

Takes `count` values from a changeset or seed generator and passes their inputs into `Ash.bulk_create!` or `Ash.Seed.seed!` respectively.

### Ash.Generator.initialize_once/1 (function)

Starts and links an agent for a `once/2`, or returns the existing agent pid if it already exists.

See `once/2` for more.

### Ash.Generator.initialize_sequence/1 (function)

Starts and links an agent for a sequence, or returns the existing agent pid if it already exists.

See `sequence/3` for more.

### Ash.Generator.many_changesets/5 (function)

Generate `count` changesets and return them as a list.

### Ash.Generator.many_queries/5 (function)

Generate `count` queries and return them as a list.

### Ash.Generator.mixed_map/2 (function)

Creates a generator of maps where all keys are required except the list provided

### Example - Ash.Generator.mixed_map/2 (function)

```elixir
iex> mixed_map(%{a: StreamData.constant(1), b: StreamData.constant(2)}, [:b]) |> Enum.take(2)
[%{a: 1}, %{a: 1, b: 2}]
```

### Ash.Generator.next_in_sequence/3 (function)

Gets the next value for a given sequence identifier.

See `sequence/3` for more.

This is equivalent to `identifier |> Ash.Generator.sequence(fun, sequencer) |> Enum.at(0)`

### Ash.Generator.once/2 (function)

Run the provided function or enumerable (i.e generator) only once.

This is useful for ensuring that some piece of data is generated a single time during a test.

The lifecycle of this generator is tied to the process that initially starts it. In general,
that will be the test. In the rare case where you are running async processes that need to share a sequence
that is not created in the test process, you can initialize a sequence in the test using `initialize_once/1`.

Example:

    iex> Ash.Generator.once(:user, fn ->
           register_user(...)
         end) |> Enum.at(0)
    %User{id: 1} # created the user

    iex> Ash.Generator.once(:user, fn ->
           register_user(...)
         end) |> Enum.at(0)
    %User{id: 1} # reused the last user

### Ash.Generator.overrides/0 (type)

A map or keyword of data generators or constant values to use in place of defaults.

Many functions in `Ash.Generator` support `overrides`, allowing to customize the default
generated values.

### Ash.Generator.query/4 (function)

Creates the input for the provided action with `action_input/3`, and returns a query for that action with that input.

See `action_input/3` and the module documentation for more.

### Ash.Generator.seed!/2 (function)

Gets input using `seed_input/2` and passes it to `Ash.Seed.seed!/2`, returning the result

### Ash.Generator.seed_generator/2 (function)

A generator of seedable records, to be passed to `generate/1` or `generate_many/1`

See `changeset_generator/3` for the equivalent construct for cases when you want to call resource
actions as opposed to seed directly to the data layer.

When a struct is given, only exactly the given values/generators will be used. If you
pass a tuple, i.e `{Resource, %{field: :value}}`, all values not provided will be generated
automatically.

### Examples - Ash.Generator.seed_generator/2 (function)

```elixir
iex> seed_generator(%MyApp.Blog.Post{name: sequence(:blog_post_title, &"My Blog Post #{&1}")}) |> generate()
%Tunez.Music.Artist{name: "Artist 1"}

iex> seed_generator({MyApp.Blog.Post, %{}}) |> generate()
%Tunez.Music.Artist{name: "A random name"}
```

### Usage in tests - Ash.Generator.seed_generator/2 (function)

This can be used to define seed generators in tests. A useful pattern is defining a function like so:

```elixir
def blog_post(opts \ []) do
  seed_generator(
    %MyApp.Blog.Post{
      name: sequence(:blog_post_title, &"My Blog Post #{&1}")
      text: StreamData.repeatedly(fn -> Faker.Lorem.paragraph() end)
    },
    overrides: opts
  )
end
```

See the `Ash.Generator` moduledocs for more information.

### Options - Ash.Generator.seed_generator/2 (function)

* `:overrides` - A keyword list or map of `t:overrides()`
* `:actor` - Passed through to the changeset
* `:tenant` - Passed through to the changeset
* `:uses` - A map of generators that are passed into the first argument, if it is a function.
* `:authorize?` - Passed through to the changeset
* `:context` - Passed through to the changeset
* `:after_action` - A one argument function that takes the result and returns
  a new result to run after the record is created.

### Ash.Generator.seed_input/2 (function)

Generate input meant to be passed into `Ash.Seed.seed!/2`.

A map of custom `StreamData` generators can be provided to add to or overwrite the generated input,
for example: `Ash.Generator.seed_input(Post, %{text: StreamData.constant("Post")})`

### Ash.Generator.seed_many!/3 (function)

Generates an input `n` times, and passes them all to seed, returning the list of seeded items.

### Ash.Generator.sequence/3 (function)

Generate globally unique values.

This is useful for generating values that are unique within a given test or processes that it spawns, such as email addresses,
or for generating values that are unique across a single resource, such as identifiers. The values will be unique
for anything using the same sequence name, **within the same test**.

>

### Not Globally Unique - Ash.Generator.sequence/3 (function)

> The lifecycle of this generator is tied to the process that initially starts it. In general,
> that will be the test. In the rare case where you are running async processes that need to share a sequence
> that is not created in the test process, you can initialize a sequence in the test using `initialize_sequence/1`.
>
> If you need a globally unique value, use a value like `System.unique_integer([:positive])` in your values instead.
>
> For example:
>
> ```elixir
> StreamData.repeatedly(fn -> "email#{System.unique_integer([:positive])}@example.com" end)
> ```

Example:

    Ash.Generator.sequence(:unique_email, fn i -> "user#{i}@example.com" end) |> Enum.take(3)
    iex> ["user0@example.com", "user1@example.com", "user2@example.com"]

### Using a different sequencer - Ash.Generator.sequence/3 (function)

By default we use an incrementing integer starting at 0. However, if you want to use something else, you can provide
your own sequencer. The initial value will be `nil`, which you can use to detect that you are the start of the sequence.

Example:

    Ash.Generator.sequence(:unique_email, fn i -> "user#{i}@example.com" end, fn num -> (num || 1) - 1 end) |> Enum.take(3)
    iex> ["user0@example.com", "user-1@example.com", "user-2@example.com"]

### Ash.Generator.stop_once/1 (function)

Stops the agent for a `once/2`.

See `once/2` for more.

### Ash.Generator.stop_sequence/1 (function)

Stops the agent for a sequence.

See `sequence/3` for more.

### Ash.Generator.stream_data/0 (type)

An instance of `StreamData`, gotten from one of the functions in that module.

### Ash.Seed (module)

Helpers for seeding data, useful for quickly creating lots of data either for database seeding or testing.

Important: this bypasses resource actions, and goes straight to the data layer. No action changes or validations are run.
The only thing that it does at the moment is ensure that default values for attributes are set, it does not validate
that required attributes are set (although the data layer may do that for you, e.g with ash_postgres).

### Ash.Seed.keep_nil/0 (function)

Returns `:__keep_nil__`, allowing to ensure a default value is not used when you want the value to be `nil`.

### Ash.Seed.seed!/1 (function)

Seed using a record (instance of a resource) as input.

If the passed in struct was retrieved from the data layer already (i.e already seeded),
then it is returned and nothing is done. Otherwise, the attributes and relationships are
used as input to `seed/2`, after having any `%Ash.NotLoaded{}` values stripped out.

Any `nil` values will be overwritten with their default values. To avoid this, either use `seed/2`
in which providing the key will have it not set the default values.
If you want to force `nil` to be accepted and prevent the default value from being set, use the
`keep_nil/0` function provided here, which returns `:__keep_nil__`. Alternatively, use
`seed!(Post, %{text: nil})`.

See `seed!/2` for more information.

### Ash.Seed.seed!/3 (function)

Performs a direct call to the data layer of a resource with the provided input.

If a list is provided as input, then you will get back that many results.

To set a tenant, use the tenant option.

### Ash.Seed.skip/0 (function)

Returns `:__skip__`, allowing to ensure no value is generated for a given field when used with generators.

### Ash.Seed.update!/3 (function)

Usage is the same as `seed!/2`, but it will update an existing record.

For multitenant resources, tenant will be extracted from the record if
not provided in opts.

### Ash.Seed.upsert!/2 (function)

Performs an upsert operation on the data layer of a resource with the provided input and identities.
The usage is the same as `seed!/1`, but it will update the record if it already exists.

```elixir
Ash.Seed.upsert!(%User{email: 'test@gmail.com', name: 'Test'}, identity: :email)
```

### Ash.Seed.upsert!/3 (function)

Usage is the same as `seed!/2`, but it will update the record if it already exists based on the identities.

### Ash.Test (module)

Testing helpers for Ash.

### Ash.Test.assert_has_error/4 (function)

Assert that the given changeset, query, or action input has a matching error.

Use the optional second argument to assert that the errors (all together) are of a specific class.

### Ash.Test.refute_has_error/4 (function)

Refute that the given changeset, query, or action input has a matching error.

The `error_class` argument has been deprecated and should not be used.

### Ash.Test.strip_metadata/1 (function)

Clears the `__metadata__` field and the underlying ecto `__meta__` field

This allows for easier comparison of changeset/query results

### Ash.Tracer (behaviour)

A behaviour for implementing tracing for an Ash application.

### Ash.Tracer.get_span_context/0 (callback)



### Ash.Tracer.get_span_context/1 (function)



### Ash.Tracer.metadata/0 (type)



### Ash.Tracer.set_error/1 (callback)



### Ash.Tracer.set_error/2 (function)



### Ash.Tracer.set_error/2 (callback)



### Ash.Tracer.set_error/3 (function)



### Ash.Tracer.set_handled_error/2 (callback)



### Ash.Tracer.set_handled_error/3 (function)



### Ash.Tracer.set_metadata/2 (callback)

Set metadata for the current span.

This may be called multiple times per span, and should ideally merge with previous metadata.

### Ash.Tracer.set_metadata/3 (function)



### Ash.Tracer.set_span_context/1 (callback)



### Ash.Tracer.set_span_context/2 (function)



### Ash.Tracer.span/4 (macro)



### Ash.Tracer.span_type/0 (type)



### Ash.Tracer.start_span/2 (callback)



### Ash.Tracer.start_span/3 (function)



### Ash.Tracer.stop_span/0 (callback)



### Ash.Tracer.stop_span/1 (function)



### Ash.Tracer.t/0 (type)



### Ash.Tracer.telemetry_span/4 (macro)



### Ash.Tracer.trace_type?/1 (callback)



### Ash.Tracer.trace_type?/2 (function)



### Ash.Tracer.Simple (module)

A simple tracer that can send traces to the current process or call a module with the trace.

### Ash.Tracer.Simple.gather_spans/0 (function)



### Ash.Tracer.Simple.Span (module)

A span produced by `Ash.Tracer.Simple`

### Ash.Type (behaviour)

The `Ash.Type` behaviour is used to define a value type in Ash.

### Built in types - Ash.Type (behaviour)

* `:map` - `Ash.Type.Map`
* `:keyword` - `Ash.Type.Keyword`
* `:term` - `Ash.Type.Term`
* `:atom` - `Ash.Type.Atom`
* `:tuple` - `Ash.Type.Tuple`
* `:string` - `Ash.Type.String`
* `:integer` - `Ash.Type.Integer`
* `:file` - `Ash.Type.File`
* `:float` - `Ash.Type.Float`
* `:duration_name` - `Ash.Type.DurationName`
* `:function` - `Ash.Type.Function`
* `:boolean` - `Ash.Type.Boolean`
* `:struct` - `Ash.Type.Struct`
* `:uuid` - `Ash.Type.UUID`
* `:uuid_v7` - `Ash.Type.UUIDv7`
* `:binary` - `Ash.Type.Binary`
* `:date` - `Ash.Type.Date`
* `:time` - `Ash.Type.Time`
* `:time_usec` - `Ash.Type.TimeUsec`
* `:decimal` - `Ash.Type.Decimal`
* `:ci_string` - `Ash.Type.CiString`
* `:naive_datetime` - `Ash.Type.NaiveDatetime`
* `:utc_datetime` - `Ash.Type.UtcDatetime`
* `:utc_datetime_usec` - `Ash.Type.UtcDatetimeUsec`
* `:datetime` - `Ash.Type.DateTime`
* `:url_encoded_binary` - `Ash.Type.UrlEncodedBinary`
* `:union` - `Ash.Type.Union`
* `:module` - `Ash.Type.Module`
* `:vector` - `Ash.Type.Vector`

### Lists/Arrays - Ash.Type (behaviour)

To specify a list of values, use `{:array, Type}`. Arrays are special, and have special constraints:

* `:items` (`t:term/0`) - Constraints for the elements of the list. See the contained type's docs for more.

* `:min_length` (`t:non_neg_integer/0`) - A minimum length for the items.

* `:max_length` (`t:non_neg_integer/0`) - A maximum length for the items.

* `:nil_items?` (`t:boolean/0`) - Whether or not the list can contain nil items. The default value is `false`.

* `:remove_nil_items?` (`t:boolean/0`) - Whether or not to remove the nil items from the list instead of adding errors. The default value is `false`.

* `:empty_values` (list of `t:term/0`) - A set of values that, if encountered, will be considered an empty list. The default value is `[""]`.

### Defining Custom Types - Ash.Type (behaviour)

Generally you add `use Ash.Type` to your module (it is possible to add `@behaviour
Ash.Type` and define everything yourself, but this is more work and error-prone).

Another option is to use `Ash.Type.NewType`, which supports defining a new type that
is the combination of an existing type and custom constraints.
This can be helpful when defining a custom attribute (e.g. struct) for a resource.

Simple example of a float custom type

```elixir
defmodule GenTracker.AshFloat do
  use Ash.Type

  @impl Ash.Type
  def storage_type(_), do: :float

  @impl Ash.Type
  def cast_input(nil, _), do: {:ok, nil}
  def cast_input(value, _) do
    Ecto.Type.cast(:float, value)
  end

  @impl Ash.Type
  def cast_stored(nil, _), do: {:ok, nil}
  def cast_stored(value, _) do
    Ecto.Type.load(:float, value)
  end

  @impl Ash.Type
  def dump_to_native(nil, _), do: {:ok, nil}
  def dump_to_native(value, _) do
    Ecto.Type.dump(:float, value)
  end
end
```

### Overriding the {:array, type} behaviour - Ash.Type (behaviour)

By defining the `*_array` versions of `cast_input`, `cast_stored`, `dump_to_native` and `apply_constraints`, you can
override how your type behaves as a collection. This is how the features of embedded
resources are implemented. No need to implement them unless you wish to override the
default behaviour. Your type is responsible for handling nil values in each callback as well.

All the Ash built-in types are implemented with `use Ash.Type` so they are good
examples to look at to create your own `Ash.Type`.

### Short names - Ash.Type (behaviour)

You can define short `:atom_names` for your custom types by adding them to your Ash configuration:

```elixir
config :ash, :custom_types, [ash_float: GenTracker.AshFloat]
```

Doing this will require a recompilation of the `:ash` dependency which can be triggered by calling:

```bash
$ mix deps.compile ash --force
```

### Composite Types - Ash.Type (behaviour)

Composite types are composite *in the data layer*. Many data layers do not support this, but some (like AshPostgres),
do. To define a composite type, the following things should be true:

1. A casted value should be a map or struct, for example for a point: `%{x: 1, y: 2}`
2. The data layer must support composite types, and the data layer representation will be a tuple, i.e `{1, 2}`
3. Define `def composite?(_), do: true` in your composite type
4. Define the type & constraints of each item in the tuple, and its name in the map
   representation: `def composite_types(_), do: [{:x, :integer, []}, {:y, :integer, []}]`.
   You can also define a storage key for each item in the tuple, if the underlying type implementation
   has a different reference for an item, i.e `def composite_types(_), do: [{:x, :x_coord, :integer, []}, {:y, :y_coord, :integer, []}]`

With the above implemented, your composite type can be used in expressions, for example:

```elixir
Ash.Query.filter(expr(coordinates[:x] == 1))
```

And you can also *construct* composite types in expressions, for example:

```elixir
calculate :coordinates, :composite_point, expr(
  composite_type(%{x: some_value, y: some_other_value}, Point)
)
```

### Constraints - Ash.Type (behaviour)

Constraints are a way of validating an input type. This validation can be used in both attributes and arguments. The kinds of constraints you can apply depends on the type of data. You can find all types in `Ash.Type` . Each type has its own page on which the available constraints are listed. For example in `Ash.Type.String` you can find 5 constraints:

- `:max_length`
- `:min_length`
- `:match`
- `:trim?`
- `:allow_empty?`

You can also discover these constraints from iex:

```bash
$ iex -S mix
iex(1)> Ash.Type.String.constraints
[
  max_length: [
    type: :non_neg_integer,
    doc: "Enforces a maximum length on the value"
  ],
  min_length: [
    type: :non_neg_integer,
    doc: "Enforces a minimum length on the value"
  ],
  match: [
    type: {:custom, Ash.Type.String, :match, []},
    doc: "Enforces that the string matches a passed in regex"
  ],
  trim?: [type: :boolean, doc: "Trims the value.", default: true],
  allow_empty?: [
    type: :boolean,
    doc: "If false, the value is set to `nil` if it's empty.",
    default: false
  ]
]
```

### Attribute example - Ash.Type (behaviour)

To show how constraints can be used in a attribute, here is an example attribute describing a username:

```elixir
defmodule MyProject.MyDomain.Account do
  # ...

  code_interface do
    define :create, action: :create
  end

  actions do
    default [:create, :read, :update, :destroy]
  end

  attributes do
    uuid_primary_key :id

    attribute :username, :string do
      constraints [
        max_length: 20,
        min_length: 3,
        match: ~r/^[a-z_-]*$/,
        trim?: true,
        allow_empty?: false
      ]
    end
  end

  # ...
end
```

If, when creating or updating this attribute, one of the constraints are not met, an error will be given telling you which constraint was broken. See below:

```elixir
iex(1)> MyProject.MyDomain.Account.create!(%{username: "hi"})

** (Ash.Error.Invalid) Invalid Error

* Invalid value provided for username: length must be greater than or equal to 3.

"hi"

iex(2)> MyProject.MyDomain.Account.create!(%{username: "Hello there this is a long string"})

** (Ash.Error.Invalid) Invalid Error

* Invalid value provided for username: length must be less than or equal to 20.

"Hello there this is a long string"

iex(3)> MyProject.MyDomain.Account.create!(%{username: "hello there"})
** (Ash.Error.Invalid) Invalid Error

* Invalid value provided for username: must match the pattern ~r/^[a-z_-]*$/.

"hello there"

iex(4)> MyProject.MyDomain.Account.create!(%{username: ""})
** (Ash.Error.Invalid) Invalid Error

* attribute title is required
```

It will give you the resource as usual on successful requests:

```elixir
iex(5)> MyProject.MyDomain.Account.create!(%{username: "hello"})
#MyProject.MyDomain.Account<
  __meta__: #Ecto.Schema.Metadata<:loaded, "account">,
  id: "7ba467dd-277c-4916-88ae-f62c93fee7a3",
  username: "hello",
  ...
>
```

### Ash.Type.apply_atomic_constraints/2 (callback)

Applies type constraints within an expression.

### Ash.Type.apply_atomic_constraints/3 (function)

Applies a types constraints to an expression.

This delegates to the underlying types implementation of `c:apply_atomic_constraints/2`.

### Ash.Type.apply_atomic_constraints_array/2 (callback)

Applies type constraints to a list of values within an expression. See `c:apply_atomic_constraints/2` for more.

### Ash.Type.apply_constraints/2 (callback)

Called after casting, to apply additional constraints to the value.

### Ash.Type.apply_constraints/3 (function)

Confirms if a casted value matches the provided constraints.

### Ash.Type.apply_constraints_array/2 (callback)

Called after casting a list of values, to apply additional constraints to the value.

If not defined, `c:apply_constraints/2` is called for each item.

### Ash.Type.array_constraints/0 (callback)

Returns a `Spark.Options` spec for the additional constraints supported when used in a list.

### Ash.Type.array_constraints/1 (function)

Gets the array constraints for a type

### Ash.Type.ash_type?/1 (function)

Returns true if the value is a builtin type or adopts the `Ash.Type` behaviour

### Ash.Type.builtin?/1 (function)

Returns true if the type is an ash builtin type

### Ash.Type.can_load?/1 (callback)

Whether or not `c:load/4` can be used. Defined automatically

### Ash.Type.can_load?/2 (function)

Returns true if the type supports nested loads

### Ash.Type.cast_atomic/2 (callback)

Casts a value within an expression.

For instance, if you had a type like `:non_neg_integer`, you might do:

```elixir
def cast_atomic(value, _constraints)  do
  expr(
    if ^value < 0 do
      error(Ash.Error.Changes.InvalidChanges, %{message: "must be positive", value: ^value})
    else
      value
    end
  )
end
```

### Ash.Type.cast_atomic/3 (function)

Modifies an expression to apply a type's casting logic to the value it produces.

This delegates to the underlying types implementation of `c:cast_atomic/2`.

### Ash.Type.cast_atomic_array/2 (callback)

Casts a list of values within an expression. See `c:cast_atomic/2` for more.

### Ash.Type.cast_in_query?/1 (callback)

Whether or not data layers that build queries should attempt to type cast values of this type while doing so.

### Ash.Type.cast_in_query?/2 (function)

Returns `true` if the type should be cast in underlying queries

### Ash.Type.cast_input/2 (callback)

Attempt to cast unknown, potentially user-provided input, into a valid instance of the type.

### Ash.Type.cast_input/3 (function)

Casts input (e.g. unknown) data to an instance of the type, or errors

Maps to `Ecto.Type.cast/2`

### Ash.Type.cast_input_array/2 (callback)

Attempt to cast a list of unknown, potentially user-provided inputs, into a list of valid instances of type.

This callback allows to define types that are "collection-aware", i.e an integer that is unique whenever
it appears in a list.

If not defined, `c:cast_input/2` is called for each item.

### Ash.Type.cast_stored/2 (callback)

Attempt to load a stored value from the data layer into a valid instance of the type.

### Ash.Type.cast_stored/3 (function)

Casts a value from the data store to an instance of the type, or errors

Maps to `Ecto.Type.load/2`

### Ash.Type.cast_stored_array/2 (callback)

Attempt to load a list of stored values from the data layer into a list of valid instances of the type.

If not defined, `c:cast_stored/2` is called for each item.

### Ash.Type.coerce/2 (callback)

Attempt to coerce unknown, potentially user-provided input, into a valid instance of the type.

### Coercion vs Casting - Ash.Type.coerce/2 (callback)

Coercion can be summed up as a more "insistent" form of casting. It means "we really want to use
this value as this type, so please try to convert it to that type". This is used in expressions as
opposed to `cast_input`. For example, the value `10`, if passed into `Ash.Type.cast_input(:string, 10)`
would fail to cast. However, if used in the following expression: `expr(type(10, :string) <> " minutes")`
the `10` would be "coerced" (using `to_string/1`) into `"10"`.

By default, coercion uses `cast_input/2` unless

### Ash.Type.coerce/3 (function)

Coerces input (e.g. unknown) data to an instance of the type, or errors.

See `c:Ash.Type.coerce/2`

### Ash.Type.composite?/1 (callback)

Return true if the type is a composite type, meaning it is made up of one or more values. How this works is up to the data layer.

For example, `AshMoney` provides a type that is composite with a "currency" and an "amount".

### Ash.Type.composite?/2 (function)

Returns true if the type is a composite type

### Ash.Type.composite_types/1 (callback)

Information about each member of the composite type, if it is a composite type

An example given the `AshMoney` example listed above:

`[{:currency, :string, []}, {:amount, :decimal, []}]`

### Ash.Type.composite_types/2 (function)

Returns the wrapped composite types

### Ash.Type.constraints/0 (callback)

Returns a `Spark.Options` spec for the constraints supported by the type.

### Ash.Type.constraints/0 (type)

A keyword list of constraints for a type

### Ash.Type.constraints/1 (function)

Returns the constraint schema for a type

### Ash.Type.custom_apply_constraints_array?/0 (callback)

Whether or not an `c:apply_constraints_array/2` callback has been defined. This is defined automatically.

### Ash.Type.describe/1 (callback)

Describes a type given its constraints. Can be used to generate docs, for example.

### Ash.Type.describe/2 (function)

Calls the type's `describe` function with the given constraints

### Ash.Type.determine_types/2 (function)

Determine types for a given function or operator.

### Ash.Type.dump_to_embedded/2 (callback)

Transform a valid instance of the type into a format that can be JSON encoded.

### Ash.Type.dump_to_embedded/3 (function)

Casts a value from the Elixir type to a value that can be embedded in another data structure.

Embedded resources expect to be stored in JSON, so this allows things like UUIDs to be stored
as strings in embedded resources instead of binary.

### Ash.Type.dump_to_embedded_array/2 (callback)

Transform a list of valid instances of the type into a format that can be JSON encoded.

If not defined, `c:dump_to_embedded/2` is called for each item.

### Ash.Type.dump_to_native/2 (callback)

Transform a valid instance of the type into a format that the data layer can store.

### Ash.Type.dump_to_native/3 (function)

Casts a value from the Elixir type to a value that the data store can persist

Maps to `Ecto.Type.dump/2`

### Ash.Type.dump_to_native_array/2 (callback)

Transform a list of valid instance of the type into a format that the data layer can store.

If not defined, `c:dump_to_native/2` is called for each item.

### Ash.Type.ecto_type/0 (callback)

The underlying Ecto.Type.

### Ash.Type.ecto_type/1 (function)

Returns the ecto compatible type for an Ash.Type.

If you `use Ash.Type`, this is created for you. For builtin types
this may return a corresponding ecto builtin type (atom)

### Ash.Type.embedded?/0 (callback)

Whether or not the type is an embedded resource. This is defined by embedded resources, you should not define this.

### Ash.Type.embedded_type?/1 (function)

Returns true if the type is an embedded resource

### Ash.Type.equal?/2 (callback)

Determine if two valid instances of the type are equal.

*Do not define this* if `==` is sufficient for your type. See `c:simple_equality?/0` for more.

### Ash.Type.equal?/3 (function)

Determines if two values of a given type are equal.

Maps to `Ecto.Type.equal?/3`

### Ash.Type.error/0 (type)

An error value that can be returned from various callbacks

### Ash.Type.evaluate_operator/1 (callback)

The implementation for any overloaded implementations.

### Ash.Type.generator/1 (callback)

An Enumerable that produces valid instances of the type.

This can be used for property testing, or generating valid inputs for seeding.
Typically you would use `StreamData` for this.

### Ash.Type.generator/2 (function)

Returns the StreamData generator for a given type

### Ash.Type.get_rewrites/4 (callback)

Gets any "rewrites" necessary to apply a given load statement.

This is a low level tool used when types can contain instances of resources. You generally
should not need to know how this works. See `Ash.Type.Union` and `Ash.Type.Struct` for examples
if you are trying to write a similar type.

### Ash.Type.get_rewrites/5 (function)

Gets the load rewrites for a given type, load, calculation and path.

This is used for defining types that support a nested load statement.
See the embedded type and union type implementations for examples of how
to use this.

### Ash.Type.get_type/1 (function)

Gets the type module for a given short name or module

### Ash.Type.get_type!/1 (function)

Gets the type module for a given short name or module,
ensures that it is a valid `type`

### Raises - Ash.Type.get_type!/1 (function)

- `RuntimeError`: If the provided type module is not found or invalid.

### Ash.Type.handle_change/3 (callback)

React to a changing value. This could be used, for example, to have a type like `:strictly_increasing_integer`.

### Ash.Type.handle_change/4 (function)

Process the old casted values alongside the new casted values.

This is leveraged by embedded types to know if something is being updated
or destroyed. This is not called on creates.

### Ash.Type.handle_change_array/3 (callback)

React to a changing list of values. This could be used, for example, to have a type like `:unique_integer`, which when used in a list all items must be unique.

If not defined, `c:handle_change/3` is called for each item with a `nil` old value.

### Ash.Type.handle_change_array?/0 (callback)

Whether or not a custom `c:handle_change_array/3` has been defined by the type. Defined automatically.

### Ash.Type.handle_change_array?/1 (function)

Handles the change of a given array of values for an attribute change. Runs after casting.

### Ash.Type.include_source/2 (callback)

Add the source changeset to the constraints, in cases where it is needed for type casting logic

### Ash.Type.include_source/3 (function)

Provides the changeset, action_input or query to the type, to potentially store in its constraints.

This is used for embedded types to allow accessing the parent changeset in certain cases.

### Ash.Type.init/1 (callback)

Useful for typed data layers (like ash_postgres) to instruct them not to attempt to cast input values.

You generally won't need this, but it can be an escape hatch for certain cases.

### Ash.Type.init/2 (function)

Initializes the constraints according to the underlying type

### Ash.Type.load/4 (callback)

Applies a load statement through a list of values.

This allows types to support load statements, like `Ash.Type.Union`, embedded resources,
or the `Ash.Type.Struct` when it is an `instance_of` a resource.

### Ash.Type.load/5 (function)

Apply a load statement to a value.

This is used for types that can be "loaded through". For example, maps, unions and structs.
If they have keys that are embedded types, for example, we want to be able to apply a load
statements to their contents.

### Ash.Type.load_context/0 (type)

The context that is provided to the `c:load/4` callback.

### Ash.Type.loaded?/4 (callback)

Checks if the given path has been loaded on the type.

### Ash.Type.loaded?/5 (function)

Checks if a given path has been loaded on a type.

This is used to "load through" types. For more see `load/5`.

### Ash.Type.matches_type?/2 (callback)

Whether or not the value a valid instance of the type.

### Ash.Type.matches_type?/3 (function)

Detects as a best effort if an arbitrary value matches the given type

### Ash.Type.may_support_atomic_update?/1 (callback)

Whether or not a value with given constraints may support being cast atomic

Defaults to checking if `cast_atomic/2` is defined on the type.

### Ash.Type.merge_load/4 (callback)

Merges a load statement with an existing load statement for the type.

### Ash.Type.merge_load/5 (function)

Merges two load statements for a given type.

This is used to "load through" types. For more see `load/5`.

### Ash.Type.merge_load_context/0 (type)

The context that is provided to the `c:merge_load/4` callback.

### Ash.Type.operator_overloads/0 (callback)

A map of operators with overloaded implementations.

These will only be honored if the type is placed in `config :ash, :known_types, [...Type]`

A corresponding `evaluate_operator/1` clause should match.

### Ash.Type.prepare_change/3 (callback)

Prepare a change, given the old value and the new uncasted value.

### Ash.Type.prepare_change/4 (function)

Process the old casted values alongside the new *un*casted values.

This is leveraged by embedded types to know if something is being updated
or destroyed. This is not called on creates.

### Ash.Type.prepare_change_array/3 (callback)

Prepare a changing list of values, given the old value and the new uncasted value.

If not defined, `c:prepare_change/3` is called for each item with a `nil` old value.

### Ash.Type.prepare_change_array?/0 (callback)

Whether or not a custom `c:prepare_change_array/3` has been defined by the type. Defined automatically.

### Ash.Type.prepare_change_array?/1 (function)

Prepares a given array of values for an attribute change. Runs before casting.

### Ash.Type.rewrite/3 (callback)

Apply any "rewrites" necessary to provide the results of a load statement to calculations that depended on a given load.

This is a low level tool used when types can contain instances of resources. You generally
should not need to know how this works. See `Ash.Type.Union` and `Ash.Type.Struct` for examples
if you are trying to write a similar type.

### Ash.Type.rewrite/4 (function)

Applies rewrites to a given value.

This is used for defining types that support a nested load statement.
See the embedded type and union type implementations for examples of how
to use this.

### Ash.Type.short_names/0 (function)

Returns the list of available type short names

### Ash.Type.simple_equality?/0 (callback)

Whether or not `==` can be used to compare instances of the type.

This is defined automatically to return `false` if `c:equal?/2` is defined.

Types that cannot be compared using `==` incur significant runtime costs when used in certain ways.
For example, if a resource's primary key cannot be compared with `==`, we cannot do things like key
a list of records by their primary key. Implementing `c:equal?/2` will cause various code paths to be considerably
slower, so only do it when necessary.

### Ash.Type.simple_equality?/1 (function)

Determines if a type can be compared using the `==` operator.

### Ash.Type.storage_type/0 (callback)

The storage type, which should be known by a data layer supporting this type.

Use `c:storage_type/1`, as this will be deprecated in the future.

### Ash.Type.storage_type/1 (callback)

The storage type, which should be known by a data layer supporting this type.

### Ash.Type.storage_type/2 (function)

Returns the *underlying* storage type (the underlying type of the *ecto type* of the *ash type*)

### Ash.Type.t/0 (type)

A valid Ash.Type

### Ash.Type.Atom (module)

Stores an atom as a string in the database

A builtin type that can be referenced via `:atom`

### Constraints - Ash.Type.Atom (module)

* `:one_of` (`t:term/0`) - Allows constraining the value of an atom to a pre-defined list

* `:unsafe_to_atom?` (`t:boolean/0`) - Allows casting to atoms that don't yet exist in the system. See https://security.erlef.org/secure_coding_and_deployment_hardening/atom_exhaustion.html for more. The default value is `false`.

### Ash.Type.Atom.handle_change?/0 (function)



### Ash.Type.Atom.prepare_change?/0 (function)



### Ash.Type.Binary (module)

Represents a binary.

A builtin type that can be referenced via `:binary`

### Ash.Type.Binary.handle_change?/0 (function)



### Ash.Type.Binary.prepare_change?/0 (function)



### Ash.Type.Boolean (module)

Represents a boolean.

A builtin type that can be referenced via `:boolean`

### Ash.Type.Boolean.handle_change?/0 (function)



### Ash.Type.Boolean.prepare_change?/0 (function)



### Ash.Type.CiString (module)

Stores a case insensitive string in the database

See `Ash.CiString` for more information.

A builtin type that can be referenced via `:ci_string`

### Constraints - Ash.Type.CiString (module)

* `:max_length` (`t:non_neg_integer/0`) - Enforces a maximum length on the value

* `:min_length` (`t:non_neg_integer/0`) - Enforces a minimum length on the value

* `:match` - Enforces that the string matches a passed in regex

* `:trim?` (`t:boolean/0`) - Trims the value. The default value is `true`.

* `:allow_empty?` (`t:boolean/0`) - Sets the value to `nil` if it's empty. The default value is `false`.

* `:casing` - Lowercases or uppercases the value, fully discarding case information.  
  For example, if you don't set this, a value of `FrEd` could be saved to the data layer.
  `FrEd` and `fReD` would still compare as equal, but the original casing information  is retained.
  In many cases, this is what you want. In some cases, however, you want to remove all case information.
  For example, in an email, you may want to support a user inputting an upper case letter, but discard it
  when saved.
   Valid values are :upper, :lower, nil The default value is `nil`.

### Ash.Type.CiString.handle_change?/0 (function)



### Ash.Type.CiString.match/1 (function)



### Ash.Type.CiString.prepare_change?/0 (function)



### Ash.Type.Comparable (module)

Helpers for working with `Comparable`

### Ash.Type.Comparable.defcomparable/3 (macro)



### Ash.Type.Date (module)

Represents a date in the database

A builtin type that can be referenced via `:date`

### Ash.Type.Date.handle_change?/0 (function)



### Ash.Type.Date.prepare_change?/0 (function)



### Ash.Type.DateTime (module)

Represents a datetime, with configurable precision and timezone.

A builtin type that can be referenced via `:datetime`

### Constraints - Ash.Type.DateTime (module)

* `:precision` - Valid values are :microsecond, :second The default value is `:second`.

* `:cast_dates_as` - Valid values are :start_of_day, :error The default value is `:start_of_day`.

* `:timezone` - Valid values are :utc The default value is `:utc`.

### Ash.Type.DateTime.handle_change?/0 (function)



### Ash.Type.DateTime.prepare_change?/0 (function)



### Ash.Type.Decimal (module)

Represents a decimal.

A builtin type that can be referenced via `:decimal`

### Constraints - Ash.Type.Decimal (module)

* `:max` - Enforces a maximum on the value

* `:min` - Enforces a minimum on the value

* `:greater_than` - Enforces a minimum on the value (exclusive)

* `:less_than` - Enforces a maximum on the value (exclusive)

### Ash.Type.Decimal.handle_change?/0 (function)



### Ash.Type.Decimal.prepare_change?/0 (function)



### Ash.Type.DurationName (module)

An interval of time, primarily meant to be used in expression functions

Valid intervals are (as strings or atoms): [:year, :month, :week, :day, :hour, :minute, :second, :millisecond, :microsecond]

### Ash.Type.DurationName.handle_change?/0 (function)



### Ash.Type.DurationName.prepare_change?/0 (function)



### Ash.Type.DurationName.t/0 (type)



### Ash.Type.Enum (behaviour)

A type for abstracting enums into a single type.

For example, your existing attribute might look like:
```elixir
attribute :status, :atom, constraints: [one_of: [:open, :closed]]
```

But as that starts to spread around your system, you may find that you want
to centralize that logic. To do that, use this module to define an Ash type
easily:

```elixir
defmodule MyApp.TicketStatus do
  use Ash.Type.Enum, values: [:open, :closed]
end
```

Then, you can rewrite your original attribute as follows:

```elixir
attribute :status, MyApp.TicketStatus
```

Valid values are:

* The atom itself, e.g `:open`
* A string that matches the atom, e.g `"open"`
* A string that matches the atom after being downcased, e.g `"OPEN"` or `"oPeN"`
* A string that matches the stringified, downcased atom, after itself being downcased.
  This allows for enum values like `:Open`, `:SomeState` and `:Some_State`

### Custom input values - Ash.Type.Enum (behaviour)

If you need to accept inputs beyond those described above while still mapping them to one
of the enum values, you can override the `match/1` callback.

For example, if you want to map both the `:half_empty` and `:half_full` states to the same enum
value, you could implement it as follows:

```elixir
defmodule MyApp.GlassState do
  use Ash.Type.Enum, values: [:empty, :half_full, :full]

  def match(:half_empty), do: {:ok, :half_full}
  def match("half_empty"), do: {:ok, :half_full}
  def match(value), do: super(value)
end
```

In the provided example, if no additional value is matched, `super(value)` is called, invoking
the default implementation of `match/1`. This approach is typically suitable if you only aim to
extend default matching rather than completely reimplementing it.

### Caveats - Ash.Type.Enum (behaviour)

Additional input values are not exposed in derived interfaces. For example, `HALF_EMPTY` will not
be present as a possible enum value when using `ash_graphql`.

Moreover, only explicitly matched values are mapped to the enum value. For instance,
`"HaLf_emPty"` would not be accepted by the code provided earlier. If case normalization is
needed for additional values, it must be explicitly implemented.

### Value labels and descriptions - Ash.Type.Enum (behaviour)

It's possible to associate a label and/or description for each value.

```elixir
defmodule MyApp.TicketStatus do
  use Ash.Type.Enum,
    values: [
      open: "An open ticket", # <- description only,
      escalated: [description: gettext("An escalated ticket")],
      follow_up: [label: gettext("Follow up")],
      closed: [description: gettext("A closed ticket"), label: gettext("Closed")]
    ]
end
```

Adding labels and descriptions can be helpful when displaying the Enum values to users.

This can be used by extensions to provide detailed descriptions of enum values.

The description of a value can be retrieved with `description/1`:

```elixir
MyApp.TicketStatus.description(:open)
iex> "An open ticket"
```

The label of a value can be retrieved with `label/1`:

```elixir
MyApp.TicketStatus.label(:closed)
iex> "Closed"
```

Both the description and label can be retrieved with `details/1`

```elixir
MyApp.TicketStatus.details(:closed)
iex> %{description: "A closed ticket", label: "Closed"}
```

### Ash.Type.Enum.description/1 (callback)

The description of the value, if existing

### Ash.Type.Enum.details/1 (callback)

The value detail map, if existing

### Ash.Type.Enum.label/1 (callback)

The label of the value, if existing

### Ash.Type.Enum.match/1 (callback)

finds the valid value that matches a given input term

### Ash.Type.Enum.match?/1 (callback)

true if a given term matches a value

### Ash.Type.Enum.values/0 (callback)

The list of valid values (not all input types that match them)

### Ash.Type.File (module)

A type that represents a file on the filesystem.

> #### Persistence {: .warning}
>
> This type does not support persisting via `Ash.DataLayer`.
>
> It is mainly intended to be used in
> [arguments](dsl-ash-resource.html#actions-action-argument).

### Valid values to cast - Ash.Type.File (module)

This type can cast multiple types of values:

* itself
* `Plug.Upload`
* Any value that implements the `Ash.Type.File.Source` protocol.

### Ash.Type.File.from_io/1 (function)

Create a file from an `IO.device()`

### Example - Ash.Type.File.from_io/1 (function)

iex> path = "README.md"
    ...> {:ok, device} = File.open(path)
    ...> Ash.Type.File.from_io(device)
    %Ash.Type.File{source: device, implementation: Ash.Type.File.IO}

### Ash.Type.File.from_path/1 (function)

Create a file from a path.

### Example - Ash.Type.File.from_path/1 (function)

iex> path = "README.md"
    ...> Ash.Type.File.from_path(path)
    %Ash.Type.File{source: "README.md", implementation: Ash.Type.File.Path}

### Ash.Type.File.handle_change?/0 (function)



### Ash.Type.File.open/2 (function)

Open the file with the given `modes`.

This function will delegate to the `open/2` function on the `implementation`.

For details on the `modes` argument, see the `File.open/2` documentation.

### Example - Ash.Type.File.open/2 (function)

iex> path = "README.md"
    ...> file = Ash.Type.File.from_path(path)
    ...> Ash.Type.File.open(file, [:read])
    ...> # => {:ok, #PID<0.109.0>}

### Ash.Type.File.path/1 (function)

Returns the path to the file.

Not every implementation will support this operation. If the implementation
does not support this operation, then `{:error, :not_supported}` will be
returned. In this case, use the `open/2` function to access the file.

### Example - Ash.Type.File.path/1 (function)

iex> path = "README.md"
    ...> file = Ash.Type.File.from_path(path)
    ...> Ash.Type.File.path(file)
    {:ok, "README.md"}

### Ash.Type.File.prepare_change?/0 (function)



### Ash.Type.File.t/0 (type)



### Ash.Type.File.Implementation (behaviour)

Behaviour for file implementations that are compatible with `Ash.Type.File`.

### Ash.Type.File.Implementation.error/0 (type)

Errors returned by the implementation.

### Ash.Type.File.Implementation.open/2 (callback)

Open `IO.device()` for the file.

See `Ash.Type.File.open/2`

The return pid must point to a process following the
[Erlang I/O Protocol](https://www.erlang.org/doc/apps/stdlib/io_protocol.html)
like `StringIO` or `File`.

### Ash.Type.File.Implementation.path/1 (callback)

Return path of the file on disk.

See: `Ash.Type.File.path/1`

This callback is optional. If the file is not stored on disk, this callback
can be omitted.

### Ash.Type.File.Implementation.source/0 (type)

The source of the file the implementation operates on.

### Ash.Type.File.Implementation.t/0 (type)

Any `module()` implementing the `Ash.Type.File.Implementation` behaviour.

### Ash.Type.File.Source (protocol)

Protocol for allowing the casting of something into an `Ash.Type.File`.

### Usage - Ash.Type.File.Source (protocol)

```elixir
defmodule MyStruct do
  defstruct [:path]

  @behavior Ash.Type.File.Implementation

  @impl Ash.Type.File.Implementation
  def path(%__MODULE__{path: path}), do: {:ok, path}

  @impl Ash.Type.File.Implementation
  def open(%__MODULE__{path: path}, modes), do: File.open(path, modes)

  defimpl Ash.Type.File.Source do
    def implementation(%MyStruct{} = struct), do: {:ok, MyStruct}
  end
end
```

### Ash.Type.File.Source.implementation/1 (function)

Detect Implementation of the file.

Returns an `:ok` tuple with the implementation module if the file is supported
and `:error` otherwise.

### Ash.Type.File.Source.t/0 (type)

All the types that implement this protocol.

### Ash.Type.Float (module)

Represents a float (floating point number)

A builtin type that be referenced via `:float`

### Constraints - Ash.Type.Float (module)

* `:max` - Enforces a maximum on the value

* `:min` - Enforces a minimum on the value

* `:greater_than` - Enforces a minimum on the value (exclusive)

* `:less_than` - Enforces a maximum on the value (exclusive)

### Ash.Type.Float.handle_change?/0 (function)



### Ash.Type.Float.prepare_change?/0 (function)



### Ash.Type.Function (module)

Represents a function.

If the type would be dumped to a native format, `:erlang.term_to_binary(term, [:safe])` is used.

Please keep in mind, this is *NOT SAFE* to use with external input.

More information available here: https://erlang.org/doc/man/erlang.html#binary_to_term-2

### Constraints - Ash.Type.Function (module)

* `:arity` (`t:pos_integer/0`) - Enforces a specific arity on the provided function

### Ash.Type.Function.handle_change?/0 (function)



### Ash.Type.Function.prepare_change?/0 (function)



### Ash.Type.Integer (module)

Represents a simple integer

A builtin type that can be referenced via `:integer`

### Constraints - Ash.Type.Integer (module)

* `:max` - Enforces a maximum on the value

* `:min` - Enforces a minimum on the value

### Ash.Type.Integer.handle_change?/0 (function)



### Ash.Type.Integer.prepare_change?/0 (function)



### Ash.Type.Keyword (module)

Represents a keyword list, stored as a `:map` in the database.

A builtin type that can be referenced via `:keyword_list`

* `:fields` (`t:keyword/0`) - Required. The types of the fields in the keyword, and their constraints.  
  If constraints are specified, only those fields will be in the casted keyword.  
  For example:  
      fields:  [
        amount: [
          type: :integer,
          description: "The amount of the transaction",
          constraints: [
            max: 10
          ]
        ],
        currency: [
          type: :string,
          allow_nil?: false,
          description: "The currency code of the transaction",
          constraints: [
            max_length: 3
          ]
        ]
      ]  
  allow_nil? is true by default

  * `:type` (an `Ash.Type`) - Required.

  * `:description` (`t:String.t/0`)

  * `:allow_nil?` (`t:boolean/0`) - The default value is `true`.

  * `:constraints` (`t:keyword/0`) - The default value is `[]`.

### Ash.Type.Keyword.handle_change?/0 (function)



### Ash.Type.Keyword.prepare_change?/0 (function)



### Ash.Type.Map (module)

Represents a map stored in the database.

In postgres, for example, this represents binary encoded json

A builtin type that can be referenced via `:map`

* `:fields` (`t:keyword/0`) - The types of the fields in the map, and their constraints.  
  If constraints are specified, only those fields will be in the casted map.  
  For example:  
      fields:  [
        amount: [
          type: :integer,
          description: "The amount of the transaction",
          constraints: [
            max: 10
          ]
        ],
        currency: [
          type: :string,
          allow_nil?: false,
          description: "The currency code of the transaction",
          constraints: [
            max_length: 3
          ]
        ]
      ]  
  allow_nil? is true by default

  * `:type` (an `Ash.Type`) - Required.

  * `:allow_nil?` (`t:boolean/0`) - The default value is `true`.

  * `:description` (`t:String.t/0`)

  * `:constraints` (`t:keyword/0`) - The default value is `[]`.

### Ash.Type.Map.handle_change?/0 (function)



### Ash.Type.Map.prepare_change?/0 (function)



### Ash.Type.Module (module)

Stores a module as a string in the database.

A builtin type that can be referenced via `:module`.

### Constraints - Ash.Type.Module (module)

* `:behaviour` (`t:atom/0`) - Allows constraining the module a one which implements a behaviour

* `:protocol` (`t:atom/0`) - Allows constraining the module a one which implements a protocol

### Ash.Type.Module.handle_change?/0 (function)



### Ash.Type.Module.prepare_change?/0 (function)



### Ash.Type.NaiveDatetime (module)

Represents a Naive datetime

A builtin type that can be referenced via `:naive_datetime`

### Ash.Type.NaiveDatetime.handle_change?/0 (function)



### Ash.Type.NaiveDatetime.prepare_change?/0 (function)



### Ash.Type.NewType (behaviour)

Allows defining a new type that is the combination of an existing type and custom constraints

A subtle difference between this type and its supertype (one that will almost certainly not matter
in any case) is that we use the `apply_constraints` logic of the underlying type in the same step
as `cast_input`. We do this because new types like these are, generally speaking, considering the constraint
application as part of the core type. Other types, if you simply do `Ash.Type.cast_input/3` you will not be
also applying their constraints.

### Options - Ash.Type.NewType (behaviour)

- `:subtype_of` - The type that this new type is a subtype of.
- `:constraints` - The constraints that this new type uses for the underlying type.
- `:lazy_init?` - If true, the `init/1` function will be called at runtime instead of compile time.
  Allows for recursive types.

For Example:

```elixir
defmodule MyApp.Types.SSN do
  use Ash.Type.NewType, subtype_of: :string, constraints: [match: ~r/regex for ssn/]
end

defmodule MyApp.Types.Metadata do
  use Ash.Type.NewType, subtype_of: :union, constraints: [types: [
    foo: [...],
    bar: [...]
  ]]
end
```

### Ash.Type.NewType.constraints/2 (function)

Returns the constraints schema.

### Ash.Type.NewType.lazy_init?/0 (callback)

Whether or not the type is lazy initialized (so needs to be initialized when fetching constraints)

### Ash.Type.NewType.new_type?/1 (function)

Returns true if the corresponding type is an Ash.Type.NewType

### Ash.Type.NewType.subtype_constraints/0 (callback)

Returns the underlying subtype constraints

### Ash.Type.NewType.subtype_of/0 (callback)

Returns the type that the NewType is a subtype of.

### Ash.Type.NewType.subtype_of/1 (function)

Returns the type that the given newtype is a subtype of

### Ash.Type.NewType.t/0 (type)



### Ash.Type.NewType.type_constraints/2 (callback)

Returns the modified NewType constraints

### Ash.Type.String (module)

Stores a string in the database.

A built-in type that can be referenced via `:string`.

By default, values are trimmed and empty values are set to `nil`.
You can use the `allow_empty?` and `trim?` constraints to change these behaviors.

### Constraints - Ash.Type.String (module)

* `:max_length` (`t:non_neg_integer/0`) - Enforces a maximum length on the value

* `:min_length` (`t:non_neg_integer/0`) - Enforces a minimum length on the value

* `:match` - Enforces that the string matches a passed in regex

* `:trim?` (`t:boolean/0`) - Trims the value. The default value is `true`.

* `:allow_empty?` (`t:boolean/0`) - If false, the value is set to `nil` if it's empty. The default value is `false`.

### Ash.Type.String.handle_change?/0 (function)



### Ash.Type.String.prepare_change?/0 (function)



### Ash.Type.Struct (module)

Represents a struct.

Use the `instance_of` constraint to specify that it must be an instance of a specific struct.

This cannot be loaded from a database unless the `instance_of` constraint is provided.
If not, it can only be used to cast input, i.e for arguments.

### Constraints - Ash.Type.Struct (module)

* `:instance_of` (`t:atom/0`) - The module the struct should be an instance of

* `:preserve_nil_values?` (`t:boolean/0`) - If set to true, when storing, nil values will be kept. Otherwise, nil values will be omitted. The default value is `false`.

* `:fields` (`t:keyword/0`) - The types of the fields in the struct, and their constraints.  
  For example:  
      fields:  [
        amount: [
          type: :integer,
          description: "The amount of the transaction",
          constraints: [
            max: 10
          ]
        ],
        currency: [
          type: :string,
          allow_nil?: false,
          description: "The currency code of the transaction",
          constraints: [
            max_length: 3
          ]
        ]
      ]  
  allow_nil? is true by default

  * `:type` (an `Ash.Type`) - Required.

  * `:allow_nil?` (`t:boolean/0`) - The default value is `true`.

  * `:description` (`t:String.t/0`)

  * `:constraints` (`t:keyword/0`) - The default value is `[]`.

### Ash.Type.Struct.handle_change?/0 (function)



### Ash.Type.Struct.prepare_change?/0 (function)



### Ash.Type.Term (module)

Represents a raw elixir term in the database

A builtin type that can be referenced via `:binary`

### Ash.Type.Term.handle_change?/0 (function)



### Ash.Type.Term.prepare_change?/0 (function)



### Ash.Type.Time (module)

Represents a time in the database, with a 'second' precision

A builtin type that can be referenced via `:time`

### Constraints - Ash.Type.Time (module)

* `:precision` - Valid values are :microsecond, :second The default value is `:second`.

### Ash.Type.Time.handle_change?/0 (function)



### Ash.Type.Time.prepare_change?/0 (function)



### Ash.Type.TimeUsec (module)

Represents a time with `microsecond` precision.

A builtin type that can be referenced via `:time_usec`

### Ash.Type.TimeUsec.handle_change?/0 (function)



### Ash.Type.TimeUsec.prepare_change?/0 (function)



### Ash.Type.Tuple (module)

Represents a tuple stored in the data layer as a map.

A builtin type that can be referenced via `:tuple`

* `:fields` (`t:keyword/0`) - Required. The types of the fields in the tuple, and their constraints.  
  This type is stored as a map under the hood, keyed by the field name,
  and is represented in memory as a tuple.  
  For example:  
      fields:  [
        amount: [
          type: :integer,
          description: "The amount of the transaction",
          constraints: [
            max: 10
          ]
        ],
        currency: [
          type: :string,
          allow_nil?: false,
          description: "The currency code of the transaction",
          constraints: [
            max_length: 3
          ]
        ]
      ]  
  allow_nil? is true by default

  * `:type` (an `Ash.Type`) - Required.

  * `:allow_nil?` (`t:boolean/0`) - The default value is `true`.

  * `:description` (`t:String.t/0`)

  * `:constraints` (`t:keyword/0`) - The default value is `[]`.

### Ash.Type.Tuple.handle_change?/0 (function)



### Ash.Type.Tuple.prepare_change?/0 (function)



### Ash.Type.UUID (module)

Represents a UUID.

A builtin type that can be referenced via `:uuid`

### Ash.Type.UUID.handle_change?/0 (function)



### Ash.Type.UUID.prepare_change?/0 (function)



### Ash.Type.UUIDv7 (module)

Represents a UUID.

A builtin type that can be referenced via `:uuid_v7`

### Ash.Type.UUIDv7.handle_change?/0 (function)



### Ash.Type.UUIDv7.prepare_change?/0 (function)



### Ash.Type.Union (module)

A union between multiple types, distinguished with a tag or by attempting to validate.

### Constraints - Ash.Type.Union (module)

* `:storage` - How the value will be stored when persisted.  
  `:type_and_value` will store the type and value in a map like so `{type: :type_name, value: the_value}`
  `:map_with_tag` will store the value directly. This only works if all types have a `tag` and `tag_value` configured.
   Valid values are :type_and_value, :map_with_tag The default value is `:type_and_value`.

* `:types` - The types to be unioned, a map of an identifier for the enum value to its configuration.  
  When using `tag` and `tag_value` we are referring to a map key that must equal a certain value
  in order for the value to be considered an instance of that type.  
  For example:  
      types:  [
        int: [
          type: :integer,
          constraints: [
            max: 10
          ]
        ],
        object: [
          type: MyObjectType,
          # The default value is `true`
          # this passes the tag key/value to the nested type
          # when casting input
          cast_tag?: true,
          tag: :type,
          tag_value: "my_object"
        ],
        other_object: [
          type: MyOtherObjectType,
          cast_tag?: true,
          tag: :type,
          tag_value: "my_other_object"
        ],
        other_object_without_type: [
          type: MyOtherObjectTypeWithoutType,
          cast_tag?: false,
          tag: :type,
          tag_value: nil
        ]
      ]  
  IMPORTANT:  
  This is stored as a map under the hood. Filters over the data will need to take this into account.  
  Additionally, if you are not using a tag, a value will be considered to be of the given type if it successfully casts.
  This means that, for example, if you try to cast `"10"` as a union of a string and an integer, it will end up as `"10"` because
  it is a string. If you put the integer type ahead of the string type, it will cast first and `10` will be the value.

### Ash.Type.Union.handle_change?/0 (function)



### Ash.Type.Union.prepare_change?/0 (function)



### Ash.Type.UrlEncodedBinary (module)

Represents a binary that attempts to decode input strings as a url encoded base64 string.

A builtin type that can be referenced via `:url_encoded_binary`

### Ash.Type.UrlEncodedBinary.handle_change?/0 (function)



### Ash.Type.UrlEncodedBinary.prepare_change?/0 (function)



### Ash.Type.UtcDatetime (module)

Represents a utc datetime, with 'second' precision. A wrapper around `:datetime` for backwards compatibility.

A builtin type that can be referenced via `:utc_datetime`

### Ash.Type.UtcDatetime.handle_change?/0 (function)



### Ash.Type.UtcDatetime.prepare_change?/0 (function)



### Ash.Type.UtcDatetimeUsec (module)

Represents a utc datetime with `microsecond` precision. A wrapper around `:datetime` for backwards compatibility.

A builtin type that can be referenced via `:utc_datetime_usec`

### Ash.Type.UtcDatetimeUsec.handle_change?/0 (function)



### Ash.Type.UtcDatetimeUsec.prepare_change?/0 (function)



### Ash.Type.Vector (module)

Represents a vector.

A builtin type that can be referenced via `:vector`.

### Constraints - Ash.Type.Vector (module)

* `:dimensions` (`t:integer/0`) - The dimensions of the vector

### Ash.Type.Vector.handle_change?/0 (function)



### Ash.Type.Vector.prepare_change?/0 (function)



### Ash.Error (module)

Tools and utilities used by Ash to manage and conform errors

### Ash.Error.ash_error/0 (type)



### Ash.Error.ash_error?/1 (function)

Returns whether or not a term is an Ash.Error type.

### Ash.Error.ash_error_subject/0 (type)



### Ash.Error.class/0 (type)



### Ash.Error.class_module/0 (type)



### Ash.Error.error_class/0 (type)



### Ash.Error.error_descriptions/1 (function)

Converts errors into a single `String.t`.

### Ash.Error.error_input/0 (type)



### Ash.Error.error_keyword/0 (type)



### Ash.Error.error_keyword_option/0 (type)



### Ash.Error.path/0 (type)



### Ash.Error.path_input/0 (type)



### Ash.Error.set_path/2 (function)

This function prepends the provided path to any existing path on the errors.

### Ash.Error.splode_error?/2 (function)



### Ash.Error.t/0 (type)



### Ash.Error.to_ash_error/3 (function)

Converts a value to an Ash exception.

The supported inputs to this function can be provided to various places,
like `Ash.Query.add_error/2`, `Ash.Changeset.add_error/2` and `Ash.ActionInput.add_error/2`.

Additionally, any place that you can *return* an error you can return instead a valid
error input.

See [the error handling guide](/documentation/development/error-handling.md) for more.

### Ash.Error.to_error_class/2 (function)

Converts a value to an Ash.Error type.

### Ash.Error.unwrap!/2 (function)

Raises an error if the result is an error, otherwise returns the result

Alternatively, you can use the `defsplode` macro, which does this automatically.

### Options - Ash.Error.unwrap!/2 (function)

- `:error_opts` - Options to pass to `to_error/2` when converting the returned error
- `:unknown_error_opts` - Options to pass to the unknown error if the function returns only `:error`.
  not necessary if your function always returns `{:error, error}`.

### Examples - Ash.Error.unwrap!/2 (function)

def function(arg) do
    case do_something(arg) do
      :success -> :ok
      {:success, result} -> {:ok, result}
      {:error, error} -> {:error, error}
    end
  end

  def function!(arg) do
    YourErrors.unwrap!(function(arg))
  end

### Ash.Error.Action.InvalidArgument.exception/1 (function)

Create an `Elixir.Ash.Error.Action.InvalidArgument` without raising it.

### Keys - Ash.Error.Action.InvalidArgument.exception/1 (function)

- :field
- :message
- :value

### Ash.Error.Changes.ActionRequiresActor.exception/1 (function)

Create an `Elixir.Ash.Error.Changes.ActionRequiresActor` without raising it.

### Keys - Ash.Error.Changes.ActionRequiresActor.exception/1 (function)



### Ash.Error.Changes.InvalidArgument.exception/1 (function)

Create an `Elixir.Ash.Error.Changes.InvalidArgument` without raising it.

### Keys - Ash.Error.Changes.InvalidArgument.exception/1 (function)

- :field
- :message
- :value

### Ash.Error.Changes.InvalidAttribute.exception/1 (function)

Create an `Elixir.Ash.Error.Changes.InvalidAttribute` without raising it.

### Keys - Ash.Error.Changes.InvalidAttribute.exception/1 (function)

- :field
- :message
- :private_vars
- :value

### Ash.Error.Changes.InvalidChanges.exception/1 (function)

Create an `Elixir.Ash.Error.Changes.InvalidChanges` without raising it.

### Keys - Ash.Error.Changes.InvalidChanges.exception/1 (function)

- :fields
- :message
- :validation
- :value

### Ash.Error.Changes.InvalidRelationship.exception/1 (function)

Create an `Elixir.Ash.Error.Changes.InvalidRelationship` without raising it.

### Keys - Ash.Error.Changes.InvalidRelationship.exception/1 (function)

- :relationship
- :message

### Ash.Error.Changes.NoSuchAttribute.exception/1 (function)

Create an `Elixir.Ash.Error.Changes.NoSuchAttribute` without raising it.

### Keys - Ash.Error.Changes.NoSuchAttribute.exception/1 (function)

- :resource
- :attribute

### Ash.Error.Changes.NoSuchRelationship.exception/1 (function)

Create an `Elixir.Ash.Error.Changes.NoSuchRelationship` without raising it.

### Keys - Ash.Error.Changes.NoSuchRelationship.exception/1 (function)

- :resource
- :relationship

### Ash.Error.Changes.Required.exception/1 (function)

Create an `Elixir.Ash.Error.Changes.Required` without raising it.

### Keys - Ash.Error.Changes.Required.exception/1 (function)

- :field
- :type
- :resource

### Ash.Error.Changes.StaleRecord.exception/1 (function)

Create an `Elixir.Ash.Error.Changes.StaleRecord` without raising it.

### Keys - Ash.Error.Changes.StaleRecord.exception/1 (function)

- :resource
- :filter
- :field

### Ash.Error.Exception (module)

Tooling for creating an Ash exception

### Ash.Error.Exception.def_ash_error/2 (macro)



### Ash.Error.Forbidden.exception/1 (function)

Create an `Elixir.Ash.Error.Forbidden` without raising it.

### Keys - Ash.Error.Forbidden.exception/1 (function)

- :changeset
- :query
- :action_input
- :errors

### Ash.Error.Forbidden.message/1 (function)

Callback implementation for  Exception.message/1 .

### Ash.Error.Forbidden.t/0 (type)



### Ash.Error.Forbidden.CannotFilterCreates.exception/1 (function)

Create an `Elixir.Ash.Error.Forbidden.CannotFilterCreates` without raising it.

### Keys - Ash.Error.Forbidden.CannotFilterCreates.exception/1 (function)

- :filter

### Ash.Error.Forbidden.DomainRequiresActor.exception/1 (function)

Create an `Elixir.Ash.Error.Forbidden.DomainRequiresActor` without raising it.

### Keys - Ash.Error.Forbidden.DomainRequiresActor.exception/1 (function)

- :domain

### Ash.Error.Forbidden.DomainRequiresAuthorization.exception/1 (function)

Create an `Elixir.Ash.Error.Forbidden.DomainRequiresAuthorization` without raising it.

### Keys - Ash.Error.Forbidden.DomainRequiresAuthorization.exception/1 (function)

- :domain

### Ash.Error.Forbidden.ForbiddenField.exception/1 (function)

Create an `Elixir.Ash.Error.Forbidden.ForbiddenField` without raising it.

### Keys - Ash.Error.Forbidden.ForbiddenField.exception/1 (function)

- :resource
- :field

### Ash.Error.Forbidden.InitialDataRequired.exception/1 (function)

Create an `Elixir.Ash.Error.Forbidden.InitialDataRequired` without raising it.

### Keys - Ash.Error.Forbidden.InitialDataRequired.exception/1 (function)

- :source

### Ash.Error.Forbidden.MustPassStrictCheck.exception/1 (function)

Create an `Elixir.Ash.Error.Forbidden.MustPassStrictCheck` without raising it.

### Keys - Ash.Error.Forbidden.MustPassStrictCheck.exception/1 (function)



### Ash.Error.Forbidden.Placeholder.exception/1 (function)

Create an `Elixir.Ash.Error.Forbidden.Placeholder` without raising it.

### Keys - Ash.Error.Forbidden.Placeholder.exception/1 (function)

- :authorizer

### Ash.Error.Forbidden.Policy.exception/1 (function)

Create an `Elixir.Ash.Error.Forbidden.Policy` without raising it.

### Keys - Ash.Error.Forbidden.Policy.exception/1 (function)

- :scenarios
- :facts
- :filter
- :actor
- :policy_breakdown?
- :must_pass_strict_check?
- :for_fields
- :subject
- :context_description
- :policies
- :resource
- :solver_statement
- :domain
- :action
- :changeset_doesnt_match_filter

### Ash.Error.Forbidden.Policy.get_breakdown/4 (function)

Print a report of an authorization failure from authorization information.

Options:

- `:help_text?`: Defaults to true. Displays help text at the top of the policy breakdown.
- `:success?`: Defaults to false. Changes the messaging/graphics around to indicate successful policy authorization.
- `:must_pass_strict_check?`: Defaults to false. Adds a message about this authorization requiring passing strict check.

### Ash.Error.Forbidden.Policy.report/1 (function)

Print a report of an authorization failure from a forbidden error

Options:

- `:help_text?`: Defaults to true. Displays help text at the top of the policy breakdown.

### Ash.Error.Forbidden.Policy.report/2 (function)



### Ash.Error.Framework.exception/1 (function)

Create an `Elixir.Ash.Error.Framework` without raising it.

### Keys - Ash.Error.Framework.exception/1 (function)

- :changeset
- :query
- :action_input
- :errors

### Ash.Error.Framework.message/1 (function)

Callback implementation for  Exception.message/1 .

### Ash.Error.Framework.t/0 (type)



### Ash.Error.Framework.AssumptionFailed.exception/1 (function)

Create an `Elixir.Ash.Error.Framework.AssumptionFailed` without raising it.

### Keys - Ash.Error.Framework.AssumptionFailed.exception/1 (function)

- :message

### Ash.Error.Framework.CanNotBeAtomic.exception/1 (function)

Create an `Elixir.Ash.Error.Framework.CanNotBeAtomic` without raising it.

### Keys - Ash.Error.Framework.CanNotBeAtomic.exception/1 (function)

- :resource
- :change
- :reason

### Ash.Error.Framework.FlagAssertionFailed.exception/1 (function)

Create an `Elixir.Ash.Error.Framework.FlagAssertionFailed` without raising it.

### Keys - Ash.Error.Framework.FlagAssertionFailed.exception/1 (function)

- :flag
- :heading

### Ash.Error.Framework.InvalidReturnType.exception/1 (function)

Create an `Elixir.Ash.Error.Framework.InvalidReturnType` without raising it.

### Keys - Ash.Error.Framework.InvalidReturnType.exception/1 (function)

- :message

### Ash.Error.Framework.MustBeAtomic.exception/1 (function)

Create an `Elixir.Ash.Error.Framework.MustBeAtomic` without raising it.

### Keys - Ash.Error.Framework.MustBeAtomic.exception/1 (function)

- :resource
- :action
- :reason

### Ash.Error.Framework.SynchronousEngineStuck.exception/1 (function)

Create an `Elixir.Ash.Error.Framework.SynchronousEngineStuck` without raising it.

### Keys - Ash.Error.Framework.SynchronousEngineStuck.exception/1 (function)



### Ash.Error.Invalid.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid` without raising it.

### Keys - Ash.Error.Invalid.exception/1 (function)

- :changeset
- :query
- :action_input
- :errors

### Ash.Error.Invalid.message/1 (function)

Callback implementation for  Exception.message/1 .

### Ash.Error.Invalid.t/0 (type)



### Ash.Error.Invalid.ActionRequiresPagination.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.ActionRequiresPagination` without raising it.

### Keys - Ash.Error.Invalid.ActionRequiresPagination.exception/1 (function)

- :resource
- :action

### Ash.Error.Invalid.AtomicsNotSupported.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.AtomicsNotSupported` without raising it.

### Keys - Ash.Error.Invalid.AtomicsNotSupported.exception/1 (function)

- :resource
- :action_type

### Ash.Error.Invalid.InvalidActionType.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.InvalidActionType` without raising it.

### Keys - Ash.Error.Invalid.InvalidActionType.exception/1 (function)

- :message
- :type
- :expectation

### Ash.Error.Invalid.InvalidCustomInput.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.InvalidCustomInput` without raising it.

### Keys - Ash.Error.Invalid.InvalidCustomInput.exception/1 (function)

- :field
- :message
- :value

### Ash.Error.Invalid.InvalidPrimaryKey.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.InvalidPrimaryKey` without raising it.

### Keys - Ash.Error.Invalid.InvalidPrimaryKey.exception/1 (function)

- :resource
- :value

### Ash.Error.Invalid.LimitRequired.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.LimitRequired` without raising it.

### Keys - Ash.Error.Invalid.LimitRequired.exception/1 (function)



### Ash.Error.Invalid.MultipleResults.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.MultipleResults` without raising it.

### Keys - Ash.Error.Invalid.MultipleResults.exception/1 (function)

- :count
- :at_least?
- :query

### Ash.Error.Invalid.NoIdentityFound.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.NoIdentityFound` without raising it.

### Keys - Ash.Error.Invalid.NoIdentityFound.exception/1 (function)

- :resource
- :identity

### Ash.Error.Invalid.NoMatchingBulkStrategy.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.NoMatchingBulkStrategy` without raising it.

### Keys - Ash.Error.Invalid.NoMatchingBulkStrategy.exception/1 (function)

- :resource
- :action
- :requested_strategies
- :not_stream_reason
- :not_atomic_batches_reason
- :not_atomic_reason
- :footer

### Ash.Error.Invalid.NoPrimaryAction.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.NoPrimaryAction` without raising it.

### Keys - Ash.Error.Invalid.NoPrimaryAction.exception/1 (function)

- :resource
- :type

### Ash.Error.Invalid.NoSuchAction.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.NoSuchAction` without raising it.

### Keys - Ash.Error.Invalid.NoSuchAction.exception/1 (function)

- :resource
- :action
- :type

### Ash.Error.Invalid.NoSuchInput.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.NoSuchInput` without raising it.

### Keys - Ash.Error.Invalid.NoSuchInput.exception/1 (function)

- :calculation
- :resource
- :action
- :input
- :inputs
- :did_you_mean

### Ash.Error.Invalid.NoSuchResource.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.NoSuchResource` without raising it.

### Keys - Ash.Error.Invalid.NoSuchResource.exception/1 (function)

- :resource
- :message

### Ash.Error.Invalid.NonCountableAction.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.NonCountableAction` without raising it.

### Keys - Ash.Error.Invalid.NonCountableAction.exception/1 (function)

- :resource
- :action

### Ash.Error.Invalid.NonStreamableAction.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.NonStreamableAction` without raising it.

### Keys - Ash.Error.Invalid.NonStreamableAction.exception/1 (function)

- :resource
- :action
- :for_bulk_update
- :for_bulk_destroy
- :types

### Ash.Error.Invalid.PaginationRequired.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.PaginationRequired` without raising it.

### Keys - Ash.Error.Invalid.PaginationRequired.exception/1 (function)



### Ash.Error.Invalid.ResourceNotAllowed.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.ResourceNotAllowed` without raising it.

### Keys - Ash.Error.Invalid.ResourceNotAllowed.exception/1 (function)

- :resource
- :domain

### Ash.Error.Invalid.TenantRequired.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.TenantRequired` without raising it.

### Keys - Ash.Error.Invalid.TenantRequired.exception/1 (function)

- :resource

### Ash.Error.Invalid.Timeout.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.Timeout` without raising it.

### Keys - Ash.Error.Invalid.Timeout.exception/1 (function)

- :name
- :timeout

### Ash.Error.Invalid.TimeoutNotSupported.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.TimeoutNotSupported` without raising it.

### Keys - Ash.Error.Invalid.TimeoutNotSupported.exception/1 (function)

- :resource

### Ash.Error.Invalid.Unavailable.exception/1 (function)

Create an `Elixir.Ash.Error.Invalid.Unavailable` without raising it.

### Keys - Ash.Error.Invalid.Unavailable.exception/1 (function)

- :resource
- :source
- :reason

### Ash.Error.Load.InvalidQuery.exception/1 (function)

Create an `Elixir.Ash.Error.Load.InvalidQuery` without raising it.

### Keys - Ash.Error.Load.InvalidQuery.exception/1 (function)

- :resource
- :relationship
- :query
- :load_path

### Ash.Error.Load.NoSuchRelationship.exception/1 (function)

Create an `Elixir.Ash.Error.Load.NoSuchRelationship` without raising it.

### Keys - Ash.Error.Load.NoSuchRelationship.exception/1 (function)

- :resource
- :relationship
- :load_path

### Ash.Error.Page.InvalidKeyset.exception/1 (function)

Create an `Elixir.Ash.Error.Page.InvalidKeyset` without raising it.

### Keys - Ash.Error.Page.InvalidKeyset.exception/1 (function)

- :value
- :key

### Ash.Error.Query.AggregatesNotSupported.exception/1 (function)

Create an `Elixir.Ash.Error.Query.AggregatesNotSupported` without raising it.

### Keys - Ash.Error.Query.AggregatesNotSupported.exception/1 (function)

- :resource
- :feature
- :type

### Ash.Error.Query.CalculationRequiresPrimaryKey.exception/1 (function)

Create an `Elixir.Ash.Error.Query.CalculationRequiresPrimaryKey` without raising it.

### Keys - Ash.Error.Query.CalculationRequiresPrimaryKey.exception/1 (function)

- :resource
- :calculation

### Ash.Error.Query.CalculationsNotSupported.exception/1 (function)

Create an `Elixir.Ash.Error.Query.CalculationsNotSupported` without raising it.

### Keys - Ash.Error.Query.CalculationsNotSupported.exception/1 (function)

- :resource
- :feature

### Ash.Error.Query.InvalidArgument.exception/1 (function)

Create an `Elixir.Ash.Error.Query.InvalidArgument` without raising it.

### Keys - Ash.Error.Query.InvalidArgument.exception/1 (function)

- :field
- :message
- :value

### Ash.Error.Query.InvalidCalculationArgument.exception/1 (function)

Create an `Elixir.Ash.Error.Query.InvalidCalculationArgument` without raising it.

### Keys - Ash.Error.Query.InvalidCalculationArgument.exception/1 (function)

- :calculation
- :field
- :message
- :value

### Ash.Error.Query.InvalidExpression.exception/1 (function)

Create an `Elixir.Ash.Error.Query.InvalidExpression` without raising it.

### Keys - Ash.Error.Query.InvalidExpression.exception/1 (function)

- :expression
- :message

### Ash.Error.Query.InvalidFilterReference.exception/1 (function)

Create an `Elixir.Ash.Error.Query.InvalidFilterReference` without raising it.

### Keys - Ash.Error.Query.InvalidFilterReference.exception/1 (function)

- :field
- :simple_equality?

### Ash.Error.Query.InvalidFilterValue.exception/1 (function)

Create an `Elixir.Ash.Error.Query.InvalidFilterValue` without raising it.

### Keys - Ash.Error.Query.InvalidFilterValue.exception/1 (function)

- :message
- :value
- :context

### Ash.Error.Query.InvalidLimit.exception/1 (function)

Create an `Elixir.Ash.Error.Query.InvalidLimit` without raising it.

### Keys - Ash.Error.Query.InvalidLimit.exception/1 (function)

- :limit

### Ash.Error.Query.InvalidLoad.exception/1 (function)

Create an `Elixir.Ash.Error.Query.InvalidLoad` without raising it.

### Keys - Ash.Error.Query.InvalidLoad.exception/1 (function)

- :load

### Ash.Error.Query.InvalidOffset.exception/1 (function)

Create an `Elixir.Ash.Error.Query.InvalidOffset` without raising it.

### Keys - Ash.Error.Query.InvalidOffset.exception/1 (function)

- :offset

### Ash.Error.Query.InvalidPage.exception/1 (function)

Create an `Elixir.Ash.Error.Query.InvalidPage` without raising it.

### Keys - Ash.Error.Query.InvalidPage.exception/1 (function)

- :page

### Ash.Error.Query.InvalidQuery.exception/1 (function)

Create an `Elixir.Ash.Error.Query.InvalidQuery` without raising it.

### Keys - Ash.Error.Query.InvalidQuery.exception/1 (function)

- :field
- :fields
- :message
- :value

### Ash.Error.Query.InvalidSortOrder.exception/1 (function)

Create an `Elixir.Ash.Error.Query.InvalidSortOrder` without raising it.

### Keys - Ash.Error.Query.InvalidSortOrder.exception/1 (function)

- :order

### Ash.Error.Query.LockNotSupported.exception/1 (function)

Create an `Elixir.Ash.Error.Query.LockNotSupported` without raising it.

### Keys - Ash.Error.Query.LockNotSupported.exception/1 (function)

- :resource
- :lock_type

### Ash.Error.Query.NoComplexSortsWithKeysetPagination.exception/1 (function)

Create an `Elixir.Ash.Error.Query.NoComplexSortsWithKeysetPagination` without raising it.

### Keys - Ash.Error.Query.NoComplexSortsWithKeysetPagination.exception/1 (function)

- :resource
- :sort

### Ash.Error.Query.NoReadAction.exception/1 (function)

Create an `Elixir.Ash.Error.Query.NoReadAction` without raising it.

### Keys - Ash.Error.Query.NoReadAction.exception/1 (function)

- :resource
- :when

### Ash.Error.Query.NoSuchAttribute.exception/1 (function)

Create an `Elixir.Ash.Error.Query.NoSuchAttribute` without raising it.

### Keys - Ash.Error.Query.NoSuchAttribute.exception/1 (function)

- :resource
- :attribute

### Ash.Error.Query.NoSuchField.exception/1 (function)

Create an `Elixir.Ash.Error.Query.NoSuchField` without raising it.

### Keys - Ash.Error.Query.NoSuchField.exception/1 (function)

- :resource
- :field

### Ash.Error.Query.NoSuchFilterPredicate.exception/1 (function)

Create an `Elixir.Ash.Error.Query.NoSuchFilterPredicate` without raising it.

### Keys - Ash.Error.Query.NoSuchFilterPredicate.exception/1 (function)

- :message
- :value
- :key
- :resource

### Ash.Error.Query.NoSuchFunction.exception/1 (function)

Create an `Elixir.Ash.Error.Query.NoSuchFunction` without raising it.

### Keys - Ash.Error.Query.NoSuchFunction.exception/1 (function)

- :function
- :arity
- :resource
- :could_be_calculation?

### Ash.Error.Query.NoSuchOperator.exception/1 (function)

Create an `Elixir.Ash.Error.Query.NoSuchOperator` without raising it.

### Keys - Ash.Error.Query.NoSuchOperator.exception/1 (function)

- :operator

### Ash.Error.Query.NoSuchRelationship.exception/1 (function)

Create an `Elixir.Ash.Error.Query.NoSuchRelationship` without raising it.

### Keys - Ash.Error.Query.NoSuchRelationship.exception/1 (function)

- :resource
- :relationship

### Ash.Error.Query.NotFound.exception/1 (function)

Create an `Elixir.Ash.Error.Query.NotFound` without raising it.

### Keys - Ash.Error.Query.NotFound.exception/1 (function)

- :primary_key
- :resource

### Ash.Error.Query.ReadActionRequired.exception/1 (function)

Create an `Elixir.Ash.Error.Query.ReadActionRequired` without raising it.

### Keys - Ash.Error.Query.ReadActionRequired.exception/1 (function)

- :resource

### Ash.Error.Query.ReadActionRequiresActor.exception/1 (function)

Create an `Elixir.Ash.Error.Query.ReadActionRequiresActor` without raising it.

### Keys - Ash.Error.Query.ReadActionRequiresActor.exception/1 (function)



### Ash.Error.Query.Required.exception/1 (function)

Create an `Elixir.Ash.Error.Query.Required` without raising it.

### Keys - Ash.Error.Query.Required.exception/1 (function)

- :field
- :type
- :resource

### Ash.Error.Query.UnsortableField.exception/1 (function)

Create an `Elixir.Ash.Error.Query.UnsortableField` without raising it.

### Keys - Ash.Error.Query.UnsortableField.exception/1 (function)

- :resource
- :field
- :reason

### Ash.Error.Query.UnsupportedPredicate.exception/1 (function)

Create an `Elixir.Ash.Error.Query.UnsupportedPredicate` without raising it.

### Keys - Ash.Error.Query.UnsupportedPredicate.exception/1 (function)

- :resource
- :predicate
- :type

### Ash.Error.SimpleDataLayer.NoDataProvided.exception/1 (function)

Create an `Elixir.Ash.Error.SimpleDataLayer.NoDataProvided` without raising it.

### Keys - Ash.Error.SimpleDataLayer.NoDataProvided.exception/1 (function)

- :resource
- :message

### Ash.Error.Stacktrace (module)

A placeholder for a stacktrace so that we can avoid printing it everywhere

### Ash.Error.Stacktrace.t/0 (type)



### Ash.Error.Unknown.exception/1 (function)

Construction an exception using the arguments passed in. You can see
Elixir's doc on `Exception/1` for more information.

### Ash.Error.Unknown.message/1 (function)

Callback implementation for  Exception.message/1 .

### Ash.Error.Unknown.t/0 (type)



### Ash.Error.Unknown.UnknownError.exception/1 (function)

Create an `Elixir.Ash.Error.Unknown.UnknownError` without raising it.

### Keys - Ash.Error.Unknown.UnknownError.exception/1 (function)

- :error
- :field
- :value

### Ash.Error.Unknown.UnknownError.t/0 (type)



### Ash.DataLayer.Verifiers.RequirePreCheckWith (module)

Ensures that all identities have a `pre_check_with` configured, or raises.

### Ash.Notifier.PubSub.Verifiers.VerifyActionNames (module)

Verifies action names in configured publications

### Ash.Notifier.PubSub.Verifiers.VerifyActionNames.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Ash.Domain.Verifiers.EnsureNoEmbeds (module)

Ensures that all resources for a given domain are not embeds.

### Ash.Domain.Verifiers.ValidateArgumentsToCodeInterface (module)

Validate the arguments defined in the code interface
and reject arguments that are not action attributes/arguments

### Ash.Domain.Verifiers.ValidateRelatedResourceInclusion (module)

Ensures that all related resources are included in a domain.

### Ash.Policy.Authorizer.Transformers.AddMissingFieldPolicies (module)

Adds field policies for any missing fields

### Ash.Policy.Authorizer.Transformers.AddMissingFieldPolicies.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Policy.Authorizer.Transformers.AddMissingFieldPolicies.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Policy.Authorizer.Transformers.AddMissingFieldPolicies.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Policy.Authorizer.Transformers.AddMissingFieldPolicies.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Policy.Authorizer.Transformers.CacheFieldPolicies (module)

Cache field policies for each field

### Ash.Policy.Authorizer.Transformers.CacheFieldPolicies.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Policy.Authorizer.Transformers.CacheFieldPolicies.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Policy.Authorizer.Transformers.CacheFieldPolicies.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Policy.Authorizer.Transformers.CacheFieldPolicies.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.AttributesByName (module)

Persists attribute_names and attributes_by_name.

### Ash.Resource.Transformers.AttributesByName.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.AttributesByName.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.AttributesByName.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.AttributesByName.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.BelongsToAttribute (module)

Creates the attribute for belongs_to relationships that have `define_attribute?: true`

### Ash.Resource.Transformers.BelongsToAttribute.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.BelongsToAttribute.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.BelongsToAttribute.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.BelongsToAttribute.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.CacheActionInputs (module)

Stores the set of valid input keys for each action

### Ash.Resource.Transformers.CacheActionInputs.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.CacheActionInputs.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.CacheActionInputs.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.CacheActionInputs.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.CacheCalculations (module)

Persists commonly used calculation information.

### Ash.Resource.Transformers.CacheCalculations.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.CacheCalculations.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.CacheCalculations.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.CacheCalculations.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.CachePrimaryKey (module)

Validates and caches the primary key of a resource

### Ash.Resource.Transformers.CachePrimaryKey.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.CachePrimaryKey.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.CachePrimaryKey.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.CachePrimaryKey.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.CacheRelationships (module)

Persists commonly used relationship information.

### Ash.Resource.Transformers.CacheRelationships.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.CacheRelationships.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.CacheRelationships.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.CacheRelationships.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.CacheUniqueKeys (module)

Stores the set of unique keys for a resource

### Ash.Resource.Transformers.CacheUniqueKeys.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.CacheUniqueKeys.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.CacheUniqueKeys.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.CacheUniqueKeys.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.CreateJoinRelationship (module)

Creates an automatically named `has_many` relationship for each many_to_many.

### Ash.Resource.Transformers.CreateJoinRelationship.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.CreateJoinRelationship.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.CreateJoinRelationship.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.CreateJoinRelationship.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.DefaultAccept (module)

Sets the default `accept` for each action

### Ash.Resource.Transformers.DefaultAccept.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.DefaultAccept.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.DefaultAccept.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.DefaultAccept.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.GetByReadActions (module)

Transform any read actions which contain a `get_by` option.

### Ash.Resource.Transformers.GetByReadActions.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.HasDestinationField (module)

Guesses the `destination_attribute` for has many and has one relationships unless provided

### Ash.Resource.Transformers.HasDestinationField.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.HasDestinationField.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.HasDestinationField.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.HasDestinationField.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.ManyToManyDestinationAttributeOnJoinResource (module)

Guesses the `destination_attribute_on_join_resource` for many to many relationships unless provided.

### Ash.Resource.Transformers.ManyToManyDestinationAttributeOnJoinResource.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.ManyToManyDestinationAttributeOnJoinResource.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.ManyToManyDestinationAttributeOnJoinResource.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.ManyToManyDestinationAttributeOnJoinResource.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.ManyToManySourceAttributeOnJoinResource (module)

Guesses the `source_attribute_on_join_resource` for many to many relationships unless provided.

### Ash.Resource.Transformers.ManyToManySourceAttributeOnJoinResource.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.ManyToManySourceAttributeOnJoinResource.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.ManyToManySourceAttributeOnJoinResource.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.ManyToManySourceAttributeOnJoinResource.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.RequireUniqueActionNames (module)

Ensures that all actions have unique names.

### Ash.Resource.Transformers.RequireUniqueActionNames.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.RequireUniqueActionNames.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.RequireUniqueActionNames.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.RequireUniqueActionNames.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.RequireUniqueFieldNames (module)

Confirms that a resource does not have multiple fields(attributes, calculations, aggregates, and relationships) with the same name.

### Ash.Resource.Transformers.RequireUniqueFieldNames.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.RequireUniqueFieldNames.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.RequireUniqueFieldNames.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.RequireUniqueFieldNames.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.SetPrimaryActions (module)

Validates the primary action configuration

If multiple primary actions exist this results in an error.

### Ash.Resource.Transformers.SetPrimaryActions.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.SetPrimaryActions.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.SetPrimaryActions.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.SetPrimaryActions.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.SetRelationshipSource (module)

Sets the `source` key on relationships to be the resource they were defined on

### Ash.Resource.Transformers.SetRelationshipSource.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.SetRelationshipSource.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.SetRelationshipSource.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.SetRelationshipSource.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Transformers.ValidationsAndChangesForType (module)

Persists global changes/validations and what type they go on.

### Ash.Resource.Transformers.ValidationsAndChangesForType.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Resource.Transformers.ValidationsAndChangesForType.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Resource.Transformers.ValidationsAndChangesForType.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### Ash.Resource.Transformers.ValidationsAndChangesForType.transform/1 (function)

Callback implementation for  Spark.Dsl.Transformer.transform/1 .

### Ash.Resource.Verifiers.EnsureAggregateFieldIsAttributeOrCalculation (module)

Ensures that the field at the end of the path is an attribute or calculation.

### Ash.Resource.Verifiers.EnsureAggregateFieldIsAttributeOrCalculation.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Ash.Resource.Verifiers.NoReservedFieldNames (module)

Confirms that a resource does not use reserved names for field names.

Reserved field names are: [:__struct__, :__meta__, :__metadata__, :__order__, :__lateral_join_source__, :*, :calculations, :aggregates, :relationships, :as].

### Ash.Resource.Verifiers.NoReservedFieldNames.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Ash.Resource.Verifiers.ValidateAccept (module)

Validates that accept and reject lists only contain valid attributes

### Ash.Resource.Verifiers.ValidateActionTypesSupported (module)

Confirms that all action types declared on a resource are supported by its data layer

### Ash.Resource.Verifiers.ValidateAggregatesSupported (module)

Confirms that all aggregates are supported by the data layer

### Ash.Resource.Verifiers.ValidateArgumentsToCodeInterface (module)

Validate the arguments defined in the code interface
and reject arguments that are not action attributes/arguments

### Ash.Resource.Verifiers.ValidateArgumentsToCodeInterface.verify_interface!/4 (function)



### Ash.Resource.Verifiers.ValidateEagerIdentities (module)

Confirms that eager identities are not declared on a resource with no primary read.

### Ash.Resource.Verifiers.ValidateManagedRelationshipOpts (module)

Confirms that all action types declared on a resource are supported by its data layer

### Ash.Resource.Verifiers.ValidateMultitenancy (module)

Ensures that the multitenancy configuration is valid for the given resource

### Ash.Resource.Verifiers.ValidatePrimaryKey (module)

Validates and caches the primary key of a resource

### Ash.Resource.Verifiers.ValidateRelationshipAttributes (module)

Validates that all relationships point to valid fields

### Ash.Resource.Verifiers.ValidateRelationshipAttributesMatch (module)

Shows a warning on potentially incompatible relationship attributes.

### Ash.Resource.Verifiers.ValidateRelationshipAttributesMatch.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Ash.Resource.Verifiers.VerifyActionsAtomic (module)

Raises an error on update or destroy actions with `require_atomic?` set to
true when it is known at compile time that they will not be atomic.

### Ash.Resource.Verifiers.VerifyActionsAtomic.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Ash.Resource.Verifiers.VerifyGenericActionReactorInputs (module)

Returns an error if a generic action calls a Reactor module without specifying
an argument for all expected inputs.

### Ash.Resource.Verifiers.VerifyGenericActionReactorInputs.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Ash.Resource.Verifiers.VerifyIdentityFields (module)

Raises an error on potentially incompatible identity attributes.

### Ash.Resource.Verifiers.VerifyIdentityFields.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Ash.Resource.Verifiers.VerifyPrimaryKeyPresent (module)

Raises an error when a required primary key is missing

### Ash.Resource.Verifiers.VerifyPrimaryKeyPresent.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Ash.Resource.Verifiers.VerifyPrimaryReadActionHasNoArguments (module)

Verifies that primary read actions do not have any arguments

### Ash.Resource.Verifiers.VerifyPrimaryReadActionHasNoArguments.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Ash.Resource.Verifiers.VerifyReservedCalculationArguments (module)

Verifies that standard context keys are not used as calculation arguments

### Ash.Resource.Verifiers.VerifyReservedCalculationArguments.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Ash.Resource.Verifiers.VerifySelectedByDefault (module)

Raises an error when a required primary key is missing

### Ash.Resource.Verifiers.VerifySelectedByDefault.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Ash.Filter.Predicate (behaviour)

Represents a predicate which can be simplified and/or compared with other predicates

Simplification and comparison will need more documentation, but ultimately it
is the logic that allows us to have a flexible and powerful authorization
system.

### Ash.Filter.Predicate.bulk_compare/1 (callback)

As long as at least one predicate of the type defined in your module,
(and this callback is implemented), it will be called with all of the
other predicates present in a filter. The return value is relatively
complex, but it should be a list of boolean statements. E.g.
`{op, left, right}` and `{:not, predicate}` (nested as deep as necessary).

The best way to do it is to find lists of predicates that are mutually
exclusive or mutually inclusive, and pass those lists into
`Ash.SatSolver.mutually_exclusive/1` and `Ash.SatSolver.mutually_inclusive/1`

### Ash.Filter.Predicate.compare/2 (function)

Checks with each predicate module to see if it has a comparison
with

### Ash.Filter.Predicate.compare/2 (callback)

Compare two predicates. If possible, use `c:bulk_compare/1` instead

### Ash.Filter.Predicate.comparison/0 (type)



### Ash.Filter.Predicate.predicate/0 (type)



### Ash.Filter.Predicate.simplify/1 (callback)

Simplify to a more primitive statement.

For example, `x in [1, 2]` simplifies to `x == 1 or x == 2`.
Simplifying to filter expressions that already have comparisons
lets you avoid writing that logic for a given predicate.

### Ash.Query.BooleanExpression (module)

Represents a boolean expression

### Ash.Query.BooleanExpression.new/3 (function)



### Ash.Query.BooleanExpression.optimized_new/3 (function)



### Ash.Query.Call (module)

Represents a function call/AST node in an Ash query expression

### Ash.Query.Exists (module)

Determines if a given related entity exists.

### Ash.Query.Exists.can_return_nil?/1 (function)



### Ash.Query.Exists.new/3 (function)



### Ash.Query.Function (behaviour)

A function is a predicate with an arguments list.

For more information on being a predicate, see `Ash.Filter.Predicate`. Most of the complexities
are there. A function must meet both behaviours.

### Ash.Query.Function.arg/0 (type)



### Ash.Query.Function.args/0 (callback)

The number and types of arguments supported.

### Ash.Query.Function.can_return_nil?/1 (callback)

Whether or not the function return nil.

### Ash.Query.Function.eager_evaluate?/0 (callback)

Whether or not the function can be evaluated eagerly. For example, `now()` cannot be.

### Ash.Query.Function.evaluate/1 (function)

Evaluate the operator with provided inputs

### Ash.Query.Function.evaluate/1 (callback)

Evaluate a function when all arguments are known valid values

### Ash.Query.Function.evaluate_nil_inputs?/0 (callback)

If `true`, will be allowed to evaluate `nil` inputs.

If `false` (the default), any `nil` inputs will cause a `nil` return.

### Ash.Query.Function.name/0 (callback)

The name of the function

### Ash.Query.Function.new/1 (callback)

Instantiate a new function with the provided arguments

### Ash.Query.Function.new/2 (function)



### Ash.Query.Function.ordinal/1 (function)

Attaches the appropriate suffix to refer to an ordinal number, e.g 1 -> "1st"

### Ash.Query.Function.partial_evaluate/1 (callback)

Evaluate a function when some or no arguments are known valid values

### Ash.Query.Function.predicate?/0 (callback)

Whether or not the function is a predicate (takes a reference as the first argument, a value as the second, and returns a boolean)

### Ash.Query.Function.private?/0 (callback)

Whether or not the function should be usable when parsing input.

### Ash.Query.Function.returns/0 (callback)

The return type for each corresponding set of args.

### Ash.Query.Function.try_cast_arguments/2 (function)



### Ash.Query.Not (module)

Represents the negation of the contained expression

### Ash.Query.Not.new/1 (function)



### Ash.Query.Operator (behaviour)

An operator is a predicate with a `left` and a `right`

For more information on being a predicate, see `Ash.Filter.Predicate`. Most of the complexities
are there. An operator must meet both behaviours.

### Ash.Query.Operator.can_return_nil?/1 (callback)

Whether or not the operator can evaluate to nil.

### Ash.Query.Operator.evaluate/1 (function)

Evaluate the operator with provided inputs

### Ash.Query.Operator.evaluate/1 (callback)

Evaluates the operator in Elixir

### Ash.Query.Operator.evaluate_nil_inputs?/0 (callback)

If `true`, will be allowed to evaluate `nil` inputs.

If `false` (the default), any `nil` inputs will cause a `nil` return.

### Ash.Query.Operator.new/2 (callback)

Create a new predicate. There are various return types possible:

  * `{:ok, left, right}` - Return the left/right values of the operator
  * `{:ok, operator}` - Return the operator itself, this or the one above are acceptable
  * `{:known, boolean}` - If the value is already known, e.g `1 == 1`
  * `{:error, error}` - If there was an error creating the operator

### Ash.Query.Operator.new/3 (function)

Create a new operator. Pass the module and the left and right values

### Ash.Query.Operator.operator_overloads/1 (function)

Get type overloads for the given operator

### Ash.Query.Operator.operator_symbols/0 (function)



### Ash.Query.Operator.operators/0 (function)



### Ash.Query.Operator.predicate?/0 (callback)



### Ash.Query.Operator.returns/0 (callback)

The types that the expression can return. Should be one entry in the list for each entry in `types`.

### Ash.Query.Operator.to_string/2 (callback)

The implementation of the inspect protocol.

If not defined, it will be inferred

### Ash.Query.Operator.types/0 (callback)

The types accepted by the operator. Defaults to `[:same, :any]`, which is any values of the same type.

### Ash.Query.Parent (module)

Used to access values from the "source" of a given expression.

This is used in cases where expressions are given for some relationship path, for example:any()

```elixir
 has_many :foo, Foo do
   filter expr(priority == :foo and type == parent(foo_type))
 end
```

This is supported on a case by case basis by a given data layer and in specific usages.

### Ash.Query.Parent.new/1 (function)



### Ash.Query.Ref (module)

Represents a relation/attribute reference

### Ash.Query.Ref.name/1 (function)

Returns the referenced field

### Ash.Query.Function.Ago (module)

Subtracts the given interval from the current time in UTC.

For example:
   deleted_at > ago(7, :day)

Documentation + available intervals inspired by the corresponding ecto interval implementation

### Ash.Query.Function.Ago.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.At (module)

Gets an element in the list by index

### Ash.Query.Function.At.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.CompositeType (module)

Constructs a composite type in a way that is natively understood by the data layer

To do this, provide a tuple matching the format expected by the type in question.
Check that type's documentation for this information.

### Ash.Query.Function.CompositeType.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Contains (module)

Returns true if the first string contains the second.

Case insensitive strings are accounted for on either side.

   contains("foo", "fo")
   true

   contains(%Ash.CiString{:string "foo"}, "FoO")
   true

   contains("foo", %Ash.CiString{:string "FOO"})
   true

### Ash.Query.Function.Contains.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.CountNils (module)

Returns the count of nil.

    count_nil([nil, 1, nil]) # 2

### Ash.Query.Function.CountNils.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.DateAdd (module)

Adds the given interval to the current time in UTC

For example:
   activates_at < date_add(today(), 7, :day)

Documentation + available intervals inspired by the corresponding ecto interval implementation

### Ash.Query.Function.DateAdd.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.DateTimeAdd (module)

Adds the given interval to the current time in UTC

For example:
   activates_at < datetime_add(now(), 7, :day)

Documentation + available intervals inspired by the corresponding ecto interval implementation

### Ash.Query.Function.DateTimeAdd.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Error (module)

If the predicate is truthy, the provided exception is raised with the provided values.

This exception is not "raised" in the Elixir sense, but the entire expression fails to
evaluate with the given error. Various data layers will handle this differently.

### Ash.Query.Function.Error.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Fragment (module)

Adds the given interval from the current time in UTC.

For example:
   expires_at < from_now(7, :day)

Documentation + available intervals inspired by the corresponding ecto interval implementation

### Ash.Query.Function.Fragment.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Fragment.casted_new/1 (function)



### Ash.Query.Function.FromNow (module)

Adds the given interval from the current time in UTC.

For example:
   expires_at < from_now(7, :day)

Documentation + available intervals inspired by the corresponding ecto interval implementation

### Ash.Query.Function.FromNow.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.GetPath (module)

Gets the value at the provided path in the value, which must be a map or embed.

If you are using a datalayer that provides a `type` function (like AshPostgres), it is a good idea to
wrap your call in that function, e.g `type(author[:bio][:title], :string)`, since data layers that depend
on knowing types may not be able to infer the type from the path. Ash may eventually be able to figure out
the type, in the case that the path consists of only embedded attributes.

If an atom key is provided, access is *indiscriminate* of atoms vs strings. The atom key is checked first.
If a string key is provided, that is the only thing that is checked. If the value will or may be a struct, be sure to use atoms.

The data layer may handle this differently, for example, AshPostgres only checks
strings at the data layer (because thats all it can be in the database anyway).

Available in query expressions using bracket syntax, e.g `foo[:bar][:baz]`.

### Ash.Query.Function.GetPath.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.If (module)

If predicate is truthy, then the second argument is returned, otherwise the third.

### Ash.Query.Function.If.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.If.partial_evaluate/1 (function)

Callback implementation for  Ash.Query.Function.partial_evaluate/1 .

### Ash.Query.Function.IsNil (module)

true if the provided field is nil

### Ash.Query.Function.IsNil.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Lazy (module)

Runs the provided MFA and returns the result as a known value.

Evaluated just before running the query.

### Ash.Query.Function.Lazy.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Length (module)

Returns the length of a list attribute defined by the composite type `{:array, Type}`.

    length(roles)

If the attribute allows nils:

    length(roles || [])

### Ash.Query.Function.Length.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Minus (module)

Multiplies the value by negative one

### Ash.Query.Function.Minus.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Now (module)

Returns the current datetime

### Ash.Query.Function.Now.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Rem (module)

Rounds a float, decimal or integer to the given number of points

### Ash.Query.Function.Rem.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Round (module)

Rounds a float, decimal or integer to the given number of points

### Ash.Query.Function.Round.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.StartOfDay (module)

Converts a date or datetime into the start of day

Accepts an optional time zone, in the same format that can be passed to
`DateTime.new/3`.

For example:
   start_of_day(now()) < a_datetime()
   start_of_day(now(), "Europe/Copenhagen") < a_datetime()

### Ash.Query.Function.StartOfDay.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.StringDowncase (module)

Downcase a string

### Ash.Query.Function.StringDowncase.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.StringJoin (module)

Joins a list of values.

Ignores `nil` values and concatenates the remaining non-nil values. An optional
joiner can be provided.

    string_join([first_name, last_name], " ")

    string_join([item_a, item_b])

### Ash.Query.Function.StringJoin.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.StringLength (module)

Trims whitespace from a string

### Ash.Query.Function.StringLength.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.StringPosition (module)

Returns the zero-based position of a substring within a string, nil if the string does not contain the substring.

Case insensitive strings are accounted for on either side.

   string_position("foo", "fo")
   0

   string_position(%Ash.CiString{string: "foo"}, "FoO")
   0

   string_position("foo", %Ash.CiString{string: "FOO"})
   0

### Ash.Query.Function.StringPosition.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.StringSplit (module)

Split a string into a list of strings

Splits a string on the given delimiter. The delimiter defaults to a single space. Also supports options.

Keep in mind, this function does *not* support regexes the way that `String.split/3` does, only raw strings.

    string_split(employee_code)
    string_split(full_name, "foo")
    string_split(full_name, "foo", trim?: true)

### Options - Ash.Query.Function.StringSplit (module)

* `:trim?` (`t:boolean/0`) - Whether or not to trim empty strings from the beginning or end of the result. Equivalent to the `trim` option to `String.split/3` The default value is `false`.

### Ash.Query.Function.StringSplit.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.StringTrim (module)

Trims whitespace from a string

### Ash.Query.Function.StringTrim.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Today (module)

Returns the current date.

### Ash.Query.Function.Today.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Function.Type (module)

Casts the value to a given type. Can also be used to provide type hints to data layers, where appropriate.

### Ash.Query.Function.Type.args/0 (function)

Callback implementation for  Ash.Query.Function.args/0 .

### Ash.Query.Operator.Eq (module)

left == right

The simplest operator, matches if the left and right are equal.

For comparison, this compares as mutually exclusive with other equality
and `is_nil` checks that have the same reference on the left side

### Ash.Query.Operator.Eq.evaluate/1 (function)

Callback implementation for  Ash.Query.Operator.evaluate/1 .

### Ash.Query.Operator.Eq.name/0 (function)



### Ash.Query.Operator.Eq.operator/0 (function)



### Ash.Query.Operator.GreaterThan (module)

left > right

In comparison, simplifies to `not(left < right + 1)`, so it will never need to be compared against.

### Ash.Query.Operator.GreaterThan.evaluate/1 (function)

Callback implementation for  Ash.Query.Operator.evaluate/1 .

### Ash.Query.Operator.GreaterThan.name/0 (function)



### Ash.Query.Operator.GreaterThan.operator/0 (function)



### Ash.Query.Operator.GreaterThanOrEqual (module)

left >= right

In comparison, simplifies to `not(left < right)`, so it will never need to be compared against.

### Ash.Query.Operator.GreaterThanOrEqual.evaluate/1 (function)

Callback implementation for  Ash.Query.Operator.evaluate/1 .

### Ash.Query.Operator.GreaterThanOrEqual.name/0 (function)



### Ash.Query.Operator.GreaterThanOrEqual.operator/0 (function)



### Ash.Query.Operator.In (module)

left in [1, 2, 3]

this predicate matches if the left is in the list on the right

For comparison, this simplifies to a set of "or equals", e.g
`{:or, {:or, {:or, left == 1}, left == 2}, left == 3}`

### Ash.Query.Operator.In.evaluate/1 (function)

Callback implementation for  Ash.Query.Operator.evaluate/1 .

### Ash.Query.Operator.In.name/0 (function)



### Ash.Query.Operator.In.operator/0 (function)



### Ash.Query.Operator.IsNil (module)

left is_nil true/false

This predicate matches if the left is nil when the right is `true` or if the
left is not nil when the right is `false`

### Ash.Query.Operator.IsNil.name/0 (function)



### Ash.Query.Operator.IsNil.operator/0 (function)



### Ash.Query.Operator.LessThan (module)

left < right

Does not simplify, but is used as the simplification value for
`Ash.Query.Operator.LessThanOrEqual`, `Ash.Query.Operator.GreaterThan` and
`Ash.Query.Operator.GreaterThanOrEqual`.

When comparing predicates, it is mutually exclusive with `Ash.Query.Operator.IsNil`.
Additionally, it compares as mutually inclusive with any `Ash.Query.Operator.Eq` and
any `Ash.Query.Operator.LessThan` who's right sides are less than it, and mutually
exclusive with any `Ash.Query.Operator.Eq` or `Ash.Query.Operator.GreaterThan` who's
right side's are greater than or equal to it.

### Ash.Query.Operator.LessThan.evaluate/1 (function)

Callback implementation for  Ash.Query.Operator.evaluate/1 .

### Ash.Query.Operator.LessThan.name/0 (function)



### Ash.Query.Operator.LessThan.operator/0 (function)



### Ash.Query.Operator.LessThanOrEqual (module)

left <= right

In comparison, simplifies to `left < right + 1`, so it will never need to be compared against.

### Ash.Query.Operator.LessThanOrEqual.evaluate/1 (function)

Callback implementation for  Ash.Query.Operator.evaluate/1 .

### Ash.Query.Operator.LessThanOrEqual.name/0 (function)



### Ash.Query.Operator.LessThanOrEqual.operator/0 (function)



### Ash.Query.Operator.NotEq (module)

left != right

In comparison, simplifies to `not(left == right)`

### Ash.Query.Operator.NotEq.evaluate/1 (function)

Callback implementation for  Ash.Query.Operator.evaluate/1 .

### Ash.Query.Operator.NotEq.name/0 (function)



### Ash.Query.Operator.NotEq.operator/0 (function)



### Ash.Policy.Check.AccessingFrom (module)

This check is true when the current action is being run "through" a relationship.

### Ash.Policy.Check.AccessingFrom.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.AccessingFrom.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.AccessingFrom.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.AccessingFrom.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.AccessingFrom.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.Action (module)

This check is true when the action name matches the provided action name.

### Ash.Policy.Check.Action.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.Action.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.Action.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.Action.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.Action.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.ActionType (module)

This check is true when the action type matches the provided type

### Ash.Policy.Check.ActionType.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.ActionType.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.ActionType.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.ActionType.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.ActionType.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.ActorAbsent (module)

This check is true when the actor is `nil`, and false when the actor is specified.

### Ash.Policy.Check.ActorAbsent.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.ActorAbsent.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.ActorAbsent.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.ActorAbsent.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.ActorAbsent.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.ActorAttributeEquals (module)

This check is true when the value of the specified attribute of the actor equals the specified value.

### Ash.Policy.Check.ActorAttributeEquals.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.ActorAttributeEquals.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.ActorAttributeEquals.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.ActorAttributeEquals.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.ActorAttributeEquals.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.ActorPresent (module)

This check is true when there is an actor specified, and false when the actor is `nil`.

### Ash.Policy.Check.ActorPresent.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.ActorPresent.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.ActorPresent.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.ActorPresent.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.ActorPresent.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.ChangingAttributes (module)

This check is true when attribute changes correspond to the provided options.

### Ash.Policy.Check.ChangingAttributes.auto_filter/3 (function)

Callback implementation for  Ash.Policy.Check.auto_filter/3 .

### Ash.Policy.Check.ChangingAttributes.auto_filter_not/3 (function)



### Ash.Policy.Check.ChangingAttributes.check/4 (function)

Callback implementation for  Ash.Policy.Check.check/4 .

### Ash.Policy.Check.ChangingAttributes.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.ChangingAttributes.expand_description/3 (function)

Callback implementation for  Ash.Policy.Check.expand_description/3 .

### Ash.Policy.Check.ChangingAttributes.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.ChangingAttributes.reject/3 (function)

Callback implementation for  Ash.Policy.FilterCheck.reject/3 .

### Ash.Policy.Check.ChangingAttributes.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.ChangingAttributes.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.ChangingAttributes.strict_check_context/1 (function)



### Ash.Policy.Check.ChangingAttributes.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.ChangingRelationships (module)

This check is true when the specified relationship is changing

### Ash.Policy.Check.ChangingRelationships.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.ChangingRelationships.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.ChangingRelationships.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.ChangingRelationships.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.ChangingRelationships.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.ContextEquals (module)

This check is true when the value of the specified key or path in the changeset or query context equals the specified value.

### Ash.Policy.Check.ContextEquals.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.ContextEquals.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.ContextEquals.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.ContextEquals.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.ContextEquals.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.Expression (module)

The check module used for `expr`s in policies

### Ash.Policy.Check.Expression.auto_filter/3 (function)

Callback implementation for  Ash.Policy.Check.auto_filter/3 .

### Ash.Policy.Check.Expression.auto_filter_not/3 (function)



### Ash.Policy.Check.Expression.check/4 (function)

Callback implementation for  Ash.Policy.Check.check/4 .

### Ash.Policy.Check.Expression.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.Expression.expand_description/3 (function)

Callback implementation for  Ash.Policy.Check.expand_description/3 .

### Ash.Policy.Check.Expression.reject/3 (function)

Callback implementation for  Ash.Policy.FilterCheck.reject/3 .

### Ash.Policy.Check.Expression.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.Expression.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.Expression.strict_check_context/1 (function)



### Ash.Policy.Check.Expression.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.FilteringOn (module)

This check is true when the field provided is being referenced anywhere in a filter statement.

### Ash.Policy.Check.FilteringOn.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.FilteringOn.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.FilteringOn.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.FilteringOn.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.FilteringOn.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.Loading (module)

This check is true when the field or relationship, or path to field, is being loaded and false when it is not.

### Ash.Policy.Check.Loading.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.Loading.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.Loading.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.Loading.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.Loading.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.Matches (module)

This check is true when the specified function returns true

### Ash.Policy.Check.Matches.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.Matches.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.Matches.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.Matches.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.Matches.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.RelatesToActorVia (module)

This check passes if the data relates to the actor via the specified relationship or path of relationships.

### Ash.Policy.Check.RelatesToActorVia.auto_filter/3 (function)

Callback implementation for  Ash.Policy.Check.auto_filter/3 .

### Ash.Policy.Check.RelatesToActorVia.auto_filter_not/3 (function)



### Ash.Policy.Check.RelatesToActorVia.check/4 (function)

Callback implementation for  Ash.Policy.Check.check/4 .

### Ash.Policy.Check.RelatesToActorVia.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.RelatesToActorVia.expand_description/3 (function)

Callback implementation for  Ash.Policy.Check.expand_description/3 .

### Ash.Policy.Check.RelatesToActorVia.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.RelatesToActorVia.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.RelatesToActorVia.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.RelatesToActorVia.strict_check_context/1 (function)



### Ash.Policy.Check.RelatesToActorVia.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.RelatingToActor (module)

This check is true when the specified relationship is being changed to the current actor.

### Ash.Policy.Check.RelatingToActor.auto_filter/3 (function)

Callback implementation for  Ash.Policy.Check.auto_filter/3 .

### Ash.Policy.Check.RelatingToActor.auto_filter_not/3 (function)



### Ash.Policy.Check.RelatingToActor.check/4 (function)

Callback implementation for  Ash.Policy.Check.check/4 .

### Ash.Policy.Check.RelatingToActor.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.RelatingToActor.expand_description/3 (function)

Callback implementation for  Ash.Policy.Check.expand_description/3 .

### Ash.Policy.Check.RelatingToActor.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.RelatingToActor.reject/3 (function)

Callback implementation for  Ash.Policy.FilterCheck.reject/3 .

### Ash.Policy.Check.RelatingToActor.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.RelatingToActor.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.RelatingToActor.strict_check_context/1 (function)



### Ash.Policy.Check.RelatingToActor.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.Resource (module)

This check is true when the resource matches the provided resource name or names.

### Ash.Policy.Check.Resource.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.Resource.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.Resource.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.Resource.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.Resource.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.Selecting (module)

This check is true when the field is being selected and false when it is not.

### Ash.Policy.Check.Selecting.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.Selecting.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.Selecting.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.Selecting.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.Selecting.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Policy.Check.Static (module)

This check is always the result provided

### Ash.Policy.Check.Static.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### Ash.Policy.Check.Static.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### Ash.Policy.Check.Static.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### Ash.Policy.Check.Static.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### Ash.Policy.Check.Static.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### Ash.Resource.Change.CascadeDestroy (module)

Cascade a resource's destroy action to a related resource's destroy action.

If after_action? is true this change adds an after-action hook that explicitly
calls destroy on any records related via the named relationship.  It will optimise
for bulk destroys where possible. This makes it safe to use in atomic actions, but
might not be possible depending on the data layer setup (see warning below).

If after_action? is false this change will add a before-action hook for relationships
where the child record points to the parent (has_many, has_one, many_to_many).

> #### Beware database constraints {: .warning}
>
> Think carefully before using this change with data layers which enforce
> referential integrity (ie PostgreSQL and SQLite) and you may need to defer
> constraints for the relationship in question.
>
> See also:
>   1. [`postgres.references.reference.deferrable` DSL](https://hexdocs.pm/ash_postgres/dsl-ashpostgres-datalayer.html#postgres-references-reference-deferrable)
>   2. [`sqlite.references.reference.deferrable` DSL](https://hexdocs.pm/ash_sqlite/dsl-ashsqlite-datalayer.html#sqlite-references-reference-deferrable)
>   3. [PostgreSQL's `SET CONSTRAINTS` documentation](https://www.postgresql.org/docs/current/sql-set-constraints.html)
>   4. [SQLite's `PRAGMA defer_foreign_keys` documentation](https://www.sqlite.org/pragma.html#pragma_defer_foreign_keys)

> #### Cascading notifications {: .tip}
>
> By default notifications are disabled for the related destroy. This is to avoid potentially sending a **lot** of notifications for high-cardinality relationships.

### Options - Ash.Resource.Change.CascadeDestroy (module)

* `:relationship` (`t:atom/0`) - Required. The name of the relationship to work on

* `:action` (`t:atom/0`) - The name of the destroy action to call on the related resource. Uses the primary destroy by default.

* `:read_action` (`t:atom/0`) - The name of the read action to call on the related resource to find results to be destroyed

* `:return_notifications?` (`t:boolean/0`) - Return notifications for all destroyed records? The default value is `false`.

* `:after_action?` (`t:boolean/0`) - If true all the cascade destroys are done in after_action hooks. This makes it safe to use in atomic actions The default value is `true`.

### Example - Ash.Resource.Change.CascadeDestroy (module)

change {Ash.Resource.Change.CascadeDestroy, relationship: :comments, action: :destroy}

  or, equivalently using `Ash.Resource.Change.Builtins.cascade_destroy/2`:

    change cascade_destroy(:comments, action: :destroy)

### Ash.Resource.Change.CascadeUpdate (module)

Cascade a resource's update action to a related resource's update action.

Adds an after-action hook that explicitly calls update on any records related
via the named relationship.  It will optimise for bulk updates where
possible.

Allows you to copy fields from the arguments or changes to the destination,
this way you can cascade a bunch of changes downstream.


> #### Beware database constraints {: .warning}
>
> Think carefully before using this change with data layers which enforce
> referential integrity (ie PostgreSQL and SQLite) and you may need to defer
> constraints for the relationship in question.
>
> See also:
>   1. [`postgres.references.reference.deferrable` DSL](https://hexdocs.pm/ash_postgres/dsl-ashpostgres-datalayer.html#postgres-references-reference-deferrable)
>   2. [`sqlite.references.reference.deferrable` DSL](https://hexdocs.pm/ash_sqlite/dsl-ashsqlite-datalayer.html#sqlite-references-reference-deferrable)
>   3. [PostgreSQL's `SET CONSTRAINTS` documentation](https://www.postgresql.org/docs/current/sql-set-constraints.html)
>   4. [SQLite's `PRAGMA defer_foreign_keys` documentation](https://www.sqlite.org/pragma.html#pragma_defer_foreign_keys)

> #### Cascading notifications {: .tip}
>
> By default notifications are disabled for the related updates. This is to avoid potentially sending a **lot** of notifications for high-cardinality relationships.

### Options - Ash.Resource.Change.CascadeUpdate (module)

* `:relationship` (`t:atom/0`) - Required. The name of the relationship to work on

* `:action` (`t:atom/0`) - The name of the update action to call on the related resource. Uses the primary update by default.

* `:copy_inputs` (list of `t:atom/0`) - A list of fields to copy & pass on to the downstream update. The source action cannot be atomic. The default value is `[]`.

* `:read_action` (`t:atom/0`) - The name of the read action to call on the related resource to find results to be updated

* `:return_notifications?` (`t:boolean/0`) - Return notifications for all updated records? The default value is `false`.

### Example - Ash.Resource.Change.CascadeUpdate (module)

change {Ash.Resource.Change.CascadeUpdate, relationship: :comments, action: :update_all, copy_inputs: [:name]}

    or, equivalently using `Ash.Resource.Change.Builtins.cascade_update/2`:

    change cascade_update(:comments, action: :update_all, copy_inputs: [:name])

### Ash.Resource.Change.Context (module)

The context for a change.

This is passed into various callbacks for `Ash.Resource.Change`.

### Ash.Resource.Change.Context.t/0 (type)



### Ash.Resource.Change.GetAndLock (module)

Refetches the record being updated or destroyed, and locks it with the given type.

### Ash.Resource.Change.GetAndLockForUpdate (module)

Refetches the record being updated or destroyed, and locks it for update.

### Ash.Resource.Change.Increment (module)

Increments an attribute's value by the amount specified, which defaults to 1.

### Ash.Resource.Change.OptimisticLock (module)

Apply an "optimistic lock" on a record being updated or destroyed.

### What is Optimistic Locking? - Ash.Resource.Change.OptimisticLock (module)

Optimistic Locking is the process of only allowing an update to occur if the version of a record that you have in memory is the same as the version in the database.
Otherwise, an error is returned. On success, it increments the version while performing the action.

Optimistic locking may used for two primary purposes:

### User Experience - Ash.Resource.Change.OptimisticLock (module)

For example, if a user is editing a form that contains `State` and `County` fields, and they change the `County`, while another user has used the form to change the `State`, you could end up with a mismatch between `State` and `County`.

With optimistic locking, the user will instead get an error message that the record has been changed since they last looked.

### Concurrency Safety - Ash.Resource.Change.OptimisticLock (module)

Optimistic locking can make actions safe to run concurrently even if they can't be performed in a single query (atomically), by returning an error if the resource in the data layer does not have the same version as the one being edited.

This tells the user that they need to reload and try again.

### Ash.Resource.Validation.ActionIs (module)

Validates that the action is the specified action.

### Ash.Resource.Validation.Context (module)

Context for a validation.

### Ash.Resource.Validation.Context.t/0 (type)



### Ash.Actions.BulkManualActionHelpers (module)

Helper functions used for handling manual actions when used in bulk operations.

### Ash.Actions.BulkManualActionHelpers.process_bulk_results/7 (function)

Processes the results of a manual action's bulk function.

### Ash.Actions.BulkManualActionHelpers.process_non_bulk_result/3 (function)

Used when a manual action does not export a bulk version of the action.

### Ash.Actions.Read.AsyncLimiter (module)

A utility for limiting the number of concurrent async operations

Because this is an optimization, we opt to run something synchronously
if there is no async task available in the slot. The idea here is that
the *vast* majority of things we do async will be fast enough not to
warrant always waiting for an async slot to be free. We may add in some
smarter heuristics later (i.e choosing to wait for a task instead of
doing the work sync), but for now this is a good start.

### Ash.Actions.Read.AsyncLimiter.async_or_inline/4 (function)



### Ash.Actions.Read.AsyncLimiter.await_all/1 (function)



### Ash.Actions.Read.AsyncLimiter.await_at_least_one/1 (function)



### Ash.Actions.Read.AsyncLimiter.child_spec/1 (function)

Returns a specification to start this module under a supervisor.

See `Supervisor`.

### Ash.Actions.Read.AsyncLimiter.start_link/1 (function)



### Ash.Can (module)

Contains the Ash.can function logic.

### Ash.Can.can/4 (function)

Returns a an ok tuple if the actor can perform the action, query, or changeset,
an error tuple if an error happens, and a ok tuple with maybe if maybe is set to true
or not set.

You should prefer to use `Ash.can/3` over this module, directly.

Note: `is_maybe` is set to `true`, if not set.

### Ash.Can.can?/4 (function)

Returns whether an actor can perform an action, query, or changeset.

You should prefer to use `Ash.can?/3` over this module, directly.

Can raise an exception if return_forbidden_error is truthy in opts or there's an error.

### Ash.Can.subject/0 (type)



### Ash.Changeset.OriginalDataNotAvailable (module)

A value placed in changeset.data to indicate that the original data is not available

### Ash.Changeset.OriginalDataNotAvailable.t/0 (type)



### Ash.Context (module)

Functions for working with the context provided to various callbacks in Ash.

### Ash.Context.context_keyword_list/0 (type)



### Ash.Context.to_opts/2 (function)

Copies keys from the given context map into a keyword list. Does *not* copy the `:domain` key.

Keys copied:

* `:actor`
* `:authorize?`
* `:tracer`
* `:tenant`

### Ash.CustomExpression (behaviour)

A module for defining custom functions that can be called in Ash expressions.

For example:

```elixir
defmodule MyApp.Expressions.LevenshteinDistance do
  use Ash.CustomExpression,
    name: :levenshtein,
    arguments: [
      [:string, :string]
    ]

  def expression(AshPostgres.DataLayer, [left, right]) do
    {:ok, expr(fragment("levenshtein(?, ?)", ^left, ^right))}
  end

  # It is good practice to always define an expression for `Ash.DataLayer.Simple`,
  # as that is what Ash will use to run your custom expression in Elixir.
  # This allows us to completely avoid communicating with the database in some cases.

  # Always use a fragment like this to evaluate code in simple data layers. The value you
  # get here for arguments may be expressions at this point.
  def expression(data_layer, [left, right]) when data_layer in [
    Ash.DataLayer.Ets,
    Ash.DataLayer.Simple
  ] do
    {:ok, expr(fragment(&__MODULE__.levenshtein/2, ^left, ^right))}
  end

  # always define this fallback clause as well
  def expression(_data_layer, _args), do: :unknown

  @doc "Computes the levenshtein distance of two strings"
  def levenshtein(left, right) do
    # ......
  end
end
```

### Options - Ash.CustomExpression (behaviour)

- `name` - The name of the custom expression. This is the name that will be used in Ash expressions.
- `arguments` - A list of lists of types that the custom expression accepts. Each list represents a set of arguments that the custom expression can accept.
- `predicate?` - Whether this expression can be exposed as a predicate in filter interfaces. Defaults to `false`.

### Registering Your Expression - Ash.CustomExpression (behaviour)

Use compile-time configuration to register your custom expressions

```elixir
config :ash, :custom_expressions, [MyApp.Expressions.LevenshteinDistance]
```

### Ash.CustomExpression.arguments/0 (callback)



### Ash.CustomExpression.expression/2 (callback)



### Ash.CustomExpression.name/0 (callback)



### Ash.Domain.Igniter (module)

Codemods for working with Ash.Domain modules

### Ash.Domain.Igniter.add_new_code_interface/5 (function)

Adds a code interface if not present to the given resource on the given domain

### Ash.Domain.Igniter.add_resource_reference/3 (function)

Adds a resource reference to a domain's `resources` block

### Ash.Domain.Igniter.list_domains/1 (function)

List all domain modules found in the project

### Ash.Domain.Igniter.remove_resource_reference/3 (function)

Removes a resource reference from a domain's `resources` block

### Ash.Extension (behaviour)

A behavior of additional callbacks that extensions can implement, specific to Ash.

It is not necessary to adopt this behavior, but it is recommended to do so if you want to define these
functions on your extension. These functions are invoked when their relevant Mix task is run.

### Ash.Extension.argv/0 (type)



### Ash.Extension.codegen/1 (callback)



### Ash.Extension.igniter/0 (type)



### Ash.Extension.install/5 (callback)



### Ash.Extension.migrate/1 (callback)



### Ash.Extension.reset/1 (callback)



### Ash.Extension.rollback/1 (callback)



### Ash.Extension.setup/1 (callback)



### Ash.Extension.tear_down/1 (callback)



### Ash.Igniter (module)

Codemods and utilities for working with Ash & Igniter

### Ash.Igniter.codegen/2 (function)

Adds a codegen task, or updates the name to be ` _and_name`

### Ash.Info (module)

General introspection helpers for Ash applications.

Use `Ash.Info.mermaid_overview(otp_app)` to generate a mermaid chart of the application's domains and resources.
This offers a high level view, but will not include information from extensions. Use `resource_report/2`
for a detailed report of a resource.

Use `Ash.Info.mermaid_overview(otp_app, type: :entity_relationship)` to get a simplified entity relationship diagram.

Use `Ash.Info.domains_and_resources(otp_app)` to get a map where the keys are the domains, and the value is the list
of resources for that domain.

### Ash.Info.domains/1 (function)



### Ash.Info.domains_and_resources/1 (function)

Returns a map where the keys are the domains, and the value is the list of resources for that domain.

### Ash.Info.mermaid_overview/2 (function)

Generate a mermaid chart of the application's domains and resources.

This offers a high level view, but will not include information from extensions.

### Ash.Policy.PolicyGroup (module)

Represents a policy group on an Ash.Resource

### Ash.Query.Combination (module)

Represents one combination in a combination of queries.

### Ash.Query.Combination.base/1 (function)

The initial combination of a combined query.

### Ash.Query.Combination.except/1 (function)

Removes all rows that are present in the previous combinations *and* this one.

### Ash.Query.Combination.intersect/1 (function)

Intersects the query with the previous combinations, keeping only rows that are present in the previous combinations and this one.

### Ash.Query.Combination.t/0 (type)



### Ash.Query.Combination.union/1 (function)

Unions the query with the previous combinations, discarding duplicates when all fields are equal.

### Ash.Query.Combination.union_all/1 (function)

Unions the query with the previous combinations, keeping all rows.

### Ash.Query.UpsertConflict (module)

Returns the conflicting new information.

### Ash.Query.UpsertConflict.new/1 (function)



### Ash.Reactor.ActionStep (module)

The Reactor step which is used to execute generic actions.

### Ash.Reactor.AshStep (module)

A reactor step which runs a step-module or an anonymous function, and enqueues any returned
notifications before returning.

The following return values are supported: `{:ok, result}`, `{:ok, result, notifications}`,
`{:ok, result, notifications, new_steps}`

Example:

```elixir
ash_step :maybe_update_post do
  run fn %{post: post, new_amount_of_likes: new_amount_of_likes}, ctx ->
    opts = Ash.Context.to_opts(ctx, return_notifications?: true)
    if post.amount_of_likes != new_amount_of_likes do
      Post.update(post, %{amount_of_likes: new_amount_of_likes}, opts)
    else
      {:ok, post}
    end
end
```

### Options - Ash.Reactor.AshStep (module)

* `run` - a one or two arity function or MFA which will be called as the run
  function of the step.
* `compensate` - a one to three arity function or MFA which will be called as
  the compensate function of the step.  Optional.
* `undo` - a one to three arity function or MFA which will be called as the
  undo function of this step.  Optional.

### Ash.Reactor.BulkCreateStep (module)

The Reactor stop which is used to execute create actions in bulk.

### Ash.Reactor.BulkUpdateStep (module)

The Reactor stop which is used to execute create actions in bulk.

### Ash.Reactor.ChangeStep (module)

The Reactor step which is used to execute change steps.

### Ash.Reactor.CreateStep (module)

The Reactor step which is used to execute create actions.

### Ash.Reactor.DestroyStep (module)

The Reactor step which is used to execute update actions.

### Ash.Reactor.Dsl.Action (module)

The `action` entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.Action.t/0 (type)



### Ash.Reactor.Dsl.ActionLoad (module)

Add a load statement to an action.

### Ash.Reactor.Dsl.ActionLoad.t/0 (type)



### Ash.Reactor.Dsl.ActionTransformer (module)

Responsible for transforming actions.

### Ash.Reactor.Dsl.ActionTransformer.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Reactor.Dsl.ActionTransformer.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Reactor.Dsl.Actor (module)

Specify the actor used to execute an action.

### Ash.Reactor.Dsl.Actor.t/0 (type)



### Ash.Reactor.Dsl.AshStep (module)

The ash_step DSL module.

See `d:Reactor.step`.

### Ash.Reactor.Dsl.AshStep.t/0 (type)



### Ash.Reactor.Dsl.BulkCreate (module)

The `bulk_create` entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.BulkCreate.t/0 (type)



### Ash.Reactor.Dsl.BulkUpdate (module)

The `bulk_update` entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.BulkUpdate.t/0 (type)



### Ash.Reactor.Dsl.Change (module)

The `change` entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.Change.t/0 (type)



### Ash.Reactor.Dsl.Context (module)

Specify context to merge into an action's context.

### Ash.Reactor.Dsl.Context.t/0 (type)



### Ash.Reactor.Dsl.Create (module)

The `create` entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.Create.t/0 (type)



### Ash.Reactor.Dsl.Destroy (module)

The `destroy` entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.Destroy.t/0 (type)



### Ash.Reactor.Dsl.Inputs (module)

The `inputs` entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.Inputs.t/0 (type)



### Ash.Reactor.Dsl.Load (module)

The `load` step entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.Load.t/0 (type)



### Ash.Reactor.Dsl.MiddlewareTransformer (module)

Ensures that the required middlewares are added to the Reactor.

### Ash.Reactor.Dsl.MiddlewareTransformer.after?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.after?/1 .

### Ash.Reactor.Dsl.MiddlewareTransformer.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### Ash.Reactor.Dsl.Read (module)

The `read` entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.Read.t/0 (type)



### Ash.Reactor.Dsl.ReadOne (module)

The `read_one` entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.ReadOne.t/0 (type)



### Ash.Reactor.Dsl.Tenant (module)

Specify the tenant used to execute an action.

### Ash.Reactor.Dsl.Tenant.t/0 (type)



### Ash.Reactor.Dsl.Transaction (module)

The `transaction` entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.Transaction.t/0 (type)



### Ash.Reactor.Dsl.Update (module)

The `update` entity for the `Ash.Reactor` reactor extension.

### Ash.Reactor.Dsl.Update.t/0 (type)



### Ash.Reactor.LoadStep (module)

The Reactor step which is used to execute load steps.

### Ash.Reactor.LoadStep.run/3 (function)

Callback implementation for  Reactor.Step.run/3 .

### Ash.Reactor.MergeInputsStep (module)

A custom step which merges any number of `inputs` results into a single map.

### Ash.Reactor.Notifications (module)

Reactor middleware used to collect and emit notifications upon successful
completion of the Reactor.

### Ash.Reactor.Notifications.complete/2 (function)

When the reactor completes successfully, publish any queued notifications.

### Ash.Reactor.Notifications.enqueue_notifications/2 (function)

Add notifications to the queue to be published on reactor success.

### Ash.Reactor.Notifications.error/2 (function)

When the reactor fails, discard any queued notifications.

### Ash.Reactor.Notifications.halt/1 (function)

When halting the reactor, store any queued notifications in the context for
eventual resumption.

### Ash.Reactor.Notifications.init/1 (function)

When starting a reactor, start an agent to act as a temporary store of
notifications.

### Ash.Reactor.Notifications.publish/2 (function)

Dispatch notifications.

### Ash.Reactor.ReadOneStep (module)

The Reactor step which is used to execute get actions.

### Ash.Reactor.ReadOneStep.run/3 (function)

Callback implementation for  Reactor.Step.run/3 .

### Ash.Reactor.ReadStep (module)

The Reactor step which is used to execute read actions.

### Ash.Reactor.ReadStep.run/3 (function)

Callback implementation for  Reactor.Step.run/3 .

### Ash.Reactor.Tracer (module)

Reactor middleware which threads Ash's tracing information through to new
processes spawned by Reactor.

### Ash.Reactor.TransactionStep (module)

The Reactor step which is used to wrap other steps in an Ash data layer
transaction.

### Ash.Reactor.TransactionStep.run/3 (function)

Callback implementation for  Reactor.Step.run/3 .

### Ash.Reactor.UpdateStep (module)

The Reactor step which is used to execute update actions.

### Ash.Resource.Dsl.Filter (module)

Introspection target for a filter for read actions and relationships

### Ash.Resource.Igniter (module)

Codemods for working with Ash.Resource modules

### Important Details - Ash.Resource.Igniter (module)

This interrogates *the source code* of a resource, not its ultimate compiled state.
What this means, is that things like `defines_attribute` will not return `true` if
the attribute is added by an extension. Only if it appears literally in the source code
of the resource or one of its `Spark.Dsl.Fragment`s.

### Ash.Resource.Igniter.add_action/3 (function)

Adds the given code block to the resource's `actions` block

### Ash.Resource.Igniter.add_attribute/3 (function)

Adds the given code block to the resource's `attributes` block

### Ash.Resource.Igniter.add_block/4 (function)

Adds the given code block to the block of the resource specified

### Ash.Resource.Igniter.add_bypass/4 (function)

Adds a bypass to the top of the resource's `policies` block

### Ash.Resource.Igniter.add_calculation/3 (function)

Adds the given code block to the resource's `calculations` block

### Ash.Resource.Igniter.add_identity/3 (function)

Adds the given code block to the resource's `identities` block

### Ash.Resource.Igniter.add_new_action/4 (function)

Adds an action if it doesn't already exist

### Ash.Resource.Igniter.add_new_attribute/4 (function)

Adds the given code block to the resource's `attributes` block if there is no existing attribute with the given name

### Ash.Resource.Igniter.add_new_calculation/4 (function)

Adds the given code block to the resource's `calculations` block if there is no existing calculation with the given name

### Ash.Resource.Igniter.add_new_identity/4 (function)

Adds the given code block to the resource's `identities` block if there is no existing identity with the given name

### Ash.Resource.Igniter.add_new_relationship/4 (function)

Adds the given code block to the resource's `relationships` block

### Ash.Resource.Igniter.add_policy/4 (function)

Adds a policy to the bottom of the resource's `policies` block

### Ash.Resource.Igniter.add_relationship/3 (function)

Adds the given code block to the resource's `relationships` block

### Ash.Resource.Igniter.add_resource_configuration/3 (function)

Adds the given code block to the resource's `resource` block

### Ash.Resource.Igniter.defines_action/3 (function)

Returns true if the given resource defines an action with the provided name

### Ash.Resource.Igniter.defines_attribute/3 (function)

Returns true if the given resource defines an attribute with the provided name

### Ash.Resource.Igniter.defines_calculation/3 (function)

Returns true if the given resource defines a calculation with the provided name

### Ash.Resource.Igniter.defines_identity/3 (function)

Returns true if the given resource defines an identity with the provided name

### Ash.Resource.Igniter.defines_relationship/3 (function)

Returns true if the given resource defines a relationship with the provided name

### Ash.Resource.Igniter.domain/2 (function)

Gets the domain from the given resource module

### Ash.Resource.Igniter.ensure_primary_action/3 (function)



### Ash.Resource.Igniter.ensure_timestamps/2 (function)

Ensures that created_at and updated_at timestamps exist on the resource

### Ash.Resource.Igniter.has_action_with_primary/3 (function)



### Ash.Resource.Igniter.list_resources/1 (function)

List all resource modules found in the project

### Ash.Resource.Igniter.resource_mods/1 (function)



### Ash.Resource.ManualCreate.BulkContext (module)

The context passed into manual bulk_create action functions

### Ash.Resource.ManualCreate.BulkContext.t/0 (type)



### Ash.Resource.ManualCreate.Context (module)

The context passed into manual create action functions

### Ash.Resource.ManualCreate.Context.t/0 (type)



### Ash.Resource.ManualDestroy.BulkContext (module)

The context passed into manual bulk_update action functions

### Ash.Resource.ManualDestroy.BulkContext.t/0 (type)



### Ash.Resource.ManualDestroy.Context (module)

The context passed into manual update action functions

### Ash.Resource.ManualDestroy.Context.t/0 (type)



### Ash.Resource.ManualRelationship.Context (module)

The context passed into manual relationship functions

### Ash.Resource.ManualRelationship.Context.t/0 (type)



### Ash.Resource.ManualUpdate.BulkContext (module)

The context passed into manual update action functions

### Ash.Resource.ManualUpdate.BulkContext.t/0 (type)



### Ash.Resource.ManualUpdate.Context (module)

The context passed into manual update action functions

### Ash.Resource.ManualUpdate.Context.t/0 (type)



### Ash.Resource.Preparation.Context (module)

The context for a preparation.

### Ash.Resource.Preparation.Context.t/0 (type)



### Ash.ToTenant (protocol)

Converts a value to a tenant. To add this to a resource, implement the protocol like so:application

What this should do is entirely dependent on how you've set up your tenants. This example assumes
that you want the tenant to be `org_#{organization_id}`, but it could also be something like
`organization.schema`.

```elixir
defmodule MyApp.Organization do
  use Ash.Resource, ...

  ...

  defimpl Ash.ToTenant do
    def to_tenant(%{id: id}, _resource), do: "org_#{id}"
  end
end
```

### Ash.ToTenant.t/0 (type)



### Ash.ToTenant.to_tenant/2 (function)



### Comp (module)

Provides utilities to implement and work with `Comparable` types

### Comp.compare/2 (function)

Compare left and right term

### Examples - Comp.compare/2 (function)

iex> Comp.compare(1, 2)
    :lt
    iex> Comp.compare(2, 1)
    :gt
    iex> Comp.compare(1, 1)
    :eq

### Comp.defcomparable/3 (macro)

Helper to define ordering relation for pair of types,
accepts two `term :: type` pairs
and block of code where relation is described.

### Examples - Comp.defcomparable/3 (macro)

iex> quote do
    ...>   use Comp
    ...>   defmodule Foo do
    ...>     defstruct [:value, :meta]
    ...>   end
    ...>   defmodule Bar do
    ...>     defstruct [:value, :meta]
    ...>   end
    ...>   defcomparable %Foo{value: left} :: Foo, %Foo{value: right} :: Foo do
    ...>     Comp.compare(left, right)
    ...>   end
    ...>   defcomparable %Foo{value: left} :: Foo, %Bar{value: right} :: Bar do
    ...>     Comp.compare(left, right)
    ...>   end
    ...>   defcomparable %Foo{value: left} :: Foo, right :: Integer do
    ...>     Comp.compare(left, right)
    ...>   end
    ...> end
    ...> |> Code.compile_quoted
    iex> quote do
    ...>   x = %Foo{value: 1, meta: 1}
    ...>   y = %Foo{value: 1, meta: 2}
    ...>   Comp.equal?(x, y) && Comp.equal?(y, x)
    ...> end
    ...> |> Code.eval_quoted
    ...> |> elem(0)
    true
    iex> quote do
    ...>   x = %Foo{value: 1, meta: 1}
    ...>   y = %Bar{value: 1, meta: 2}
    ...>   Comp.equal?(x, y) && Comp.equal?(y, x)
    ...> end
    ...> |> Code.eval_quoted
    ...> |> elem(0)
    true
    iex> quote do
    ...>   x = %Foo{value: 1, meta: 1}
    ...>   y = 1
    ...>   Comp.equal?(x, y) && Comp.equal?(y, x)
    ...> end
    ...> |> Code.eval_quoted
    ...> |> elem(0)
    true

### Comp.eq/0 (macro)



### Comp.equal?/2 (function)

Is left term equal to right term?

### Examples - Comp.equal?/2 (function)

iex> Comp.equal?(1, 1)
    true
    iex> Comp.equal?(1, :hello)
    false

### Comp.greater_or_equal?/2 (function)

Is left term greater or equal to right term?

### Examples - Comp.greater_or_equal?/2 (function)

iex> Comp.greater_or_equal?(1, 1)
    true
    iex> Comp.greater_or_equal?(1, 2)
    false
    iex> Comp.greater_or_equal?(2, 1)
    true

### Comp.greater_than?/2 (function)

Is left term greater than right term?

### Examples - Comp.greater_than?/2 (function)

iex> Comp.greater_than?(1, 1)
    false
    iex> Comp.greater_than?(1, 2)
    false
    iex> Comp.greater_than?(2, 1)
    true

### Comp.gt/0 (macro)



### Comp.left/0 (type)



### Comp.less_or_equal?/2 (function)

Is left term less or equal to right term?

### Examples - Comp.less_or_equal?/2 (function)

iex> Comp.less_or_equal?(1, 1)
    true
    iex> Comp.less_or_equal?(1, 2)
    true
    iex> Comp.less_or_equal?(2, 1)
    false

### Comp.less_than?/2 (function)

Is left term less than right term?

### Examples - Comp.less_than?/2 (function)

iex> Comp.less_than?(1, 1)
    false
    iex> Comp.less_than?(1, 2)
    true
    iex> Comp.less_than?(2, 1)
    false

### Comp.lt/0 (macro)



### Comp.max/2 (function)

Returns the biggest of the two given terms, if terms are equal - then the first one is returned

### Examples - Comp.max/2 (function)

iex> Comp.max(1, 1)
    1
    iex> Comp.max(1, 2)
    2
    iex> Comp.max(2, 1)
    2

### Comp.min/2 (function)

Returns the smallest of the two given terms, if terms are equal - then the first one is returned

### Examples - Comp.min/2 (function)

iex> Comp.min(1, 1)
    1
    iex> Comp.min(1, 2)
    1
    iex> Comp.min(2, 1)
    1

### Comp.not_equal?/2 (function)

Is left term not equal to right term?

### Examples - Comp.not_equal?/2 (function)

iex> Comp.not_equal?(1, 1)
    false
    iex> Comp.not_equal?(1, :hello)
    true

### Comp.right/0 (type)



### Comp.type_of/1 (function)



### Comparable (protocol)

Protocol which describes ordering relation for pair of types

### Comparable.compare/1 (function)

Accepts struct with fields :left and :right and returns ord value

### Comparable.ord/0 (type)



### Comparable.t/0 (type)



### Comparable.Type.Any.To.Any (module)



### Comparable.Type.Ash.CiString.To.Ash.CiString (module)



### Comparable.Type.Ash.CiString.To.BitString (module)



### Comparable.Type.Atom.To.BitString (module)



### Comparable.Type.BitString.To.Ash.CiString (module)



### Comparable.Type.BitString.To.Atom (module)



### Comparable.Type.BitString.To.Decimal (module)



### Comparable.Type.Date.To.Date (module)



### Comparable.Type.DateTime.To.DateTime (module)



### Comparable.Type.Decimal.To.BitString (module)



### Comparable.Type.Decimal.To.Decimal (module)



### Comparable.Type.Decimal.To.Float (module)



### Comparable.Type.Decimal.To.Integer (module)



### Comparable.Type.Float.To.Decimal (module)



### Comparable.Type.Integer.To.Decimal (module)



### Comparable.Type.List.To.List (module)



### Comparable.Type.Map.To.Map (module)



### Comparable.Type.NaiveDateTime.To.NaiveDateTime (module)



### Comparable.Type.Time.To.Time (module)



### Comparable.Type.Tuple.To.Tuple (module)



### Mix.Tasks.Ash.Codegen.run/1 (function)

Runs all codegen tasks for any extension on any resource/domain in your application.

### Mix.Tasks.Ash.GenerateLivebook.run/1 (function)

Generates a Livebook for each Ash domain

### Mix.Tasks.Ash.GeneratePolicyCharts.run/1 (function)

Generates a Mermaid Flow Chart for a given resource's policies.

### Mix.Tasks.Ash.GenerateResourceDiagrams.run/1 (function)

Generates Mermaid Resource Diagrams for each Ash domain

### Mix.Tasks.Ash.Migrate.run/1 (function)

Runs all migration tasks for any extension on any resource/domain in your application.

### Mix.Tasks.Ash.Reset.run/1 (function)

Runs all tear down & setup tasks for any extension on any resource/domain in your application.

### Mix.Tasks.Ash.Rollback.run/1 (function)

Runs all rollback tasks for any extension on any resource/domain in your application.

### Mix.Tasks.Ash.Setup.run/1 (function)

Runs all setup tasks for any extension on any resource/domain in your application.

### Mix.Tasks.Ash.TearDown.run/1 (function)

Runs all tear_down tasks for any extension on any resource/domain in your application.

## Links

- [Online documentation](https://hexdocs.pm/ash)# reactor

> An asynchronous, graph-based execution engine

## Docs

### Reactor (module)

Reactor is a dynamic, concurrent, dependency resolving saga orchestrator.

### Usage - Reactor (module)

You can construct a reactor using the `Reactor` Spark DSL:

```elixir
defmodule HelloWorldReactor do
  @moduledoc false
  use Reactor

  input :whom

  step :greet, Greeter do
    argument :whom, input(:whom)
  end

  return :greet
end
```

    iex> Reactor.run(HelloWorldReactor, %{whom: "Dear Reader"})
    {:ok, "Hello, Dear Reader!"}

or you can build it programmatically:

    iex> reactor = Builder.new()
    ...> {:ok, reactor} = Builder.add_input(reactor, :whom)
    ...> {:ok, reactor} = Builder.add_step(reactor, :greet, Greeter, whom: {:input, :whom})
    ...> {:ok, reactor} = Builder.return(reactor, :greet)
    ...> Reactor.run(reactor, %{whom: nil})
    {:ok, "Hello, World!"}

### Options - Reactor (module)

* `:extensions` (list of module that adopts `Spark.Dsl.Extension`) - A list of DSL extensions to add to the `Spark.Dsl`

* `:otp_app` (`t:atom/0`) - The otp_app to use for any application configurable options

* `:fragments` (list of `t:module/0`) - Fragments to include in the `Spark.Dsl`. See the fragments guide for more.

### Reactor.async_option/0 (type)

When set to `false` forces the Reactor to run every step synchronously,
regardless of the step configuration.

Defaults to `true`.

### Reactor.concurrency_key_option/0 (type)

Use a `Reactor.Executor.ConcurrencyTracker.pool_key` to allow this Reactor to
share it's concurrency pool with other Reactor instances.

If you do not specify one then the Reactor will initialise a new pool and
place it in it's context for any child Reactors to re-use.

Only used if `async?` is set to `true`.

### Reactor.context/0 (type)



### Reactor.context_arg/0 (type)



### Reactor.halt_timeout_option/0 (type)

How long to wait for asynchronous steps to complete when halting.

Defaults to 5000ms.

### Reactor.inputs/0 (type)



### Reactor.is_reactor/1 (macro)

A guard which returns true if the value is a Reactor struct

### Reactor.max_concurrency_option/0 (type)

Specify the maximum number of asynchronous steps which can be run in parallel.

Defaults to the result of `System.schedulers_online/0`.  Only used if
`async?` is set to `true`.

### Reactor.max_iterations_option/0 (type)

The maximum number of iterations which after which the Reactor will halt.

Defaults to `:infinity`.

### Reactor.options/0 (type)



### Reactor.run/4 (function)

Attempt to run a Reactor.

### Arguments - Reactor.run/4 (function)

* `reactor` - The Reactor to run, either a Reactor DSL module, or a Reactor
  struct.
* `inputs` - A map of values passed in to satisfy the Reactor's expected
  inputs.
* `context` - An arbitrary map that will be merged into the Reactor context
  and passed into each step.

### Options - Reactor.run/4 (function)

* `:max_concurrency` (`t:pos_integer/0`) - The maximum number of processes to use to run the Reactor

* `:timeout` - How long to allow the Reactor to run for The default value is `:infinity`.

* `:max_iterations` - The maximum number of times to allow the Reactor to loop The default value is `:infinity`.

* `:async?` (`t:boolean/0`) - Whether to allow the Reactor to start processes The default value is `true`.

* `:run_id` (`t:term/0`) - A unique identifier for the Reactor run

### Reactor.run!/4 (function)

Raising version of `run/4`.

### Reactor.state/0 (type)



### Reactor.t/0 (type)



### Reactor.timeout_option/0 (type)

Specify the amount of execution time after which to halt processing.

Note that this is not a hard limit. The Reactor will stop when the first step
completes _after_ the timeout has expired.

Defaults to `:infinity`.

### Reactor.Dsl.Argument (module)

The struct used to store `argument` DSL entities.

See `d:Reactor.step.argument`.

### Reactor.Dsl.Argument.element/2 (function)

The `element` template helper for the Reactor DSL.

### Example - Reactor.Dsl.Argument.element/2 (function)

```elixir
defmodule ExampleReactor do
  use Reactor

  input :numbers

  map :double_numbers do
    source input(:numbers)

    step :double do
      argument :number, element(:double_numbers)

      run fn args, _ ->
        {:ok, args.number * 2}
      end
    end

    return :double
  end
end
```

### Reactor.Dsl.Argument.input/2 (function)

The `input` template helper for the Reactor DSL.

### Example - Reactor.Dsl.Argument.input/2 (function)

```elixir
defmodule ExampleReactor do
  use Reactor

  input :name

  step :greet do
    # here: --------↓↓↓↓↓
    argument :name, input(:name)
    run fn
      %{name: nil}, _, _ -> {:ok, "Hello, World!"}
      %{name: name}, _, _ -> {:ok, "Hello, #{name}!"}
    end
  end
end
```

### Extracting nested values - Reactor.Dsl.Argument.input/2 (function)

You can provide a list of keys to extract from a data structure, similar to
`Kernel.get_in/2` with the condition that the input value is either a struct
or implements the `Access` protocol.

### Reactor.Dsl.Argument.result/2 (function)

The `result` template helper for the Reactor DSL.

### Example - Reactor.Dsl.Argument.result/2 (function)

```elixir
defmodule ExampleReactor do
  use Reactor

  step :whom do
    run fn _, _ ->
      {:ok, Enum.random(["Marty", "Doc", "Jennifer", "Lorraine", "George", nil])}
    end
  end

  step :greet do
    # here: --------↓↓↓↓↓↓
    argument :name, result(:whom)
    run fn
      %{name: nil}, _, _ -> {:ok, "Hello, World!"}
      %{name: name}, _, _ -> {:ok, "Hello, #{name}!"}
    end
  end
end
```

### Extracting nested values - Reactor.Dsl.Argument.result/2 (function)

You can provide a list of keys to extract from a data structure, similar to
`Kernel.get_in/2` with the condition that the result is either a struct or
implements the `Access` protocol.

### Reactor.Dsl.Argument.t/0 (type)



### Reactor.Dsl.Argument.value/1 (function)

The `value` template helper for the Reactor DSL.

### Example - Reactor.Dsl.Argument.value/1 (function)

```elixir
defmodule ExampleReactor do
  use Reactor

  input :number

  step :times_three do
    argument :lhs, input(:number)
    # here: -------↓↓↓↓↓
    argument :rhs, value(3)

    run fn args, _ ->
      {:ok, args.lhs * args.rhs}
    end
  end
end
```

### Reactor.Dsl.Around (module)

The `around` DSL entity struct.

See `d:Reactor.around`.

### Reactor.Dsl.Around.t/0 (type)



### Reactor.Dsl.Build (protocol)

A protocol which DSL entities must implement.

### Reactor.Dsl.Build.build/2 (function)

Build an entity into a Reactor.

This function is called during conversion of a DSL module into a Reactor
struct.  This allows extensions to specify the behaviour of how they want
to alter the structure of the Reactor.

### Reactor.Dsl.Build.t/0 (type)

All the types that implement this protocol.

### Reactor.Dsl.Build.verify/2 (function)

Perform any after-compilation verification that is needed to make the entity
work.

See `Spark.Dsl.Verifier` for more information.

### Reactor.Dsl.Collect (module)

The struct used to store collect DSL entities.

See `d:Reactor.collect`.

### Reactor.Dsl.Collect.t/0 (type)



### Reactor.Dsl.Compose (module)

The `compose` DSL entity struct.

See the `d:Reactor.compose`.

### Reactor.Dsl.Compose.t/0 (type)



### Reactor.Dsl.Debug (module)

The `debug` DSL entity struct.

See `d:Reactor.debug`.

### Reactor.Dsl.Debug.t/0 (type)



### Reactor.Dsl.Flunk (module)

The struct used to store flunk DSL entities.

See `d:Reactor.flunk`.

### Reactor.Dsl.Flunk.t/0 (type)



### Reactor.Dsl.Group (module)

The `group` DSL entity struct.

See `d:Reactor.group`.

### Reactor.Dsl.Group.t/0 (type)



### Reactor.Dsl.Guard (module)

A struct used to store the `guard` DSL entity.

See `d:Reactor.step.guard`

### Reactor.Dsl.Guard.t/0 (type)



### Reactor.Dsl.Info (module)

Introspection for the Reactor DSL.

### Reactor.Dsl.Info.reactor/1 (function)

reactor DSL entities

### Reactor.Dsl.Info.reactor_middlewares/1 (function)

reactor.middlewares DSL entities

### Reactor.Dsl.Info.reactor_options/1 (function)

reactor DSL options

Returns a map containing the and any configured or default values.

### Reactor.Dsl.Info.reactor_return/1 (function)

Specify which step result to return upon completion.

### Reactor.Dsl.Info.reactor_return!/1 (function)

Specify which step result to return upon completion.

### Reactor.Dsl.Info.to_struct/1 (function)

Convert a reactor DSL module into a reactor struct.

### Reactor.Dsl.Info.to_struct!/1 (function)

Raising version of `to_struct/1`.

### Reactor.Dsl.Input (module)

The struct used to store input DSL entities.

See `d:Reactor.input`.

### Reactor.Dsl.Input.t/0 (type)



### Reactor.Dsl.Map (module)

The `map` DSL entity struct.

See `d:Reactor.map`.

### Reactor.Dsl.Map.t/0 (type)



### Reactor.Dsl.Middleware (module)

The `middleware` DSL entity struct.

See `d:Reactor.middleware.middleware`.

### Reactor.Dsl.Middleware.t/0 (type)



### Reactor.Dsl.Step (module)

The struct used to store step DSL entities.

See `d:Reactor.step`.

### Reactor.Dsl.Step.t/0 (type)



### Reactor.Dsl.Switch (module)

The `switch` DSL entity struct.

See `d:Reactor.switch`.

### Reactor.Dsl.Switch.t/0 (type)



### Reactor.Dsl.Switch.Default (module)

The `default` DSL entity struct.

See `d:Reactor.switch.default`.

### Reactor.Dsl.Switch.Default.t/0 (type)



### Reactor.Dsl.Switch.Match (module)

The `matches?` DSL entity struct.

See `d:Reactor.switch.matches?`.

### Reactor.Dsl.Switch.Match.t/0 (type)



### Reactor.Dsl.Template (module)

The `template` DSL entity struct.

See `d:Reactor.template`.

### Reactor.Dsl.Template.t/0 (type)



### Reactor.Dsl.Verifier (module)

Runs `Reactor.Dsl.Build.verify/2` for all the entities in the reactor.

### Reactor.Dsl.WaitFor (module)

The struct used to store `wait_for` DSL entities.

See `d:Reactor.step.wait_for`.

### Reactor.Dsl.WaitFor.t/0 (type)



### Reactor.Dsl.Where (module)

A struct used to store the `where` DSL entity.

See `d:Reactor.step.where`.

### Reactor.Dsl.Where.t/0 (type)



### Reactor.Step (behaviour)

The Step behaviour and struct.

Implement this behaviour to make steps for your Reactor.

### Reactor.Step.arguments/0 (type)



### Reactor.Step.async?/1 (function)

Is the step able to be run asynchronously?

### Reactor.Step.async?/1 (callback)

Detect if the step can be run asynchronously at runtime.

> This callback is automatically defined by `use Reactor.Step` however you're
> free to override it if you need a specific behaviour.

This callback is called when Reactor is deciding whether to run a step
asynchronously.

The default implementation of this callback checks returns the the value of
the steps's `async?` key if it is boolean, or calls it with the steps's
options if it is a function.

### Reactor.Step.can?/2 (function)

Find out of a step has a capability.

### Reactor.Step.can?/2 (callback)

Detect the capabilities of the step at runtime.

> This callback is automatically defined by `use Reactor.Step` however you're
> free to override it if you need specific behaviour.

Whenever Reactor would like to either undo a change made by the step, or
compensate a step failure this callback is called to detect whether the step
module is capable of the desired action.

The default implementation of this callback checks to see if the optional
callback is defined on the current module.

### Reactor.Step.capability/0 (type)

Optional capabilities which may be implemented by the step module.

This allows us to optimise out calls steps which cannot be undone, etc.

### Reactor.Step.compensate/4 (function)

Compensate a step

### Reactor.Step.compensate/4 (callback)

Compensate for the failure of the step.

> Do not implement this callback if your step doesn't support compensation.

If `run/3` returned an error then this callback will be called the error
reason and the original arguments.

This provides you the opportunity to handle the error in a number of ways and
direct the reactor as to what to do next.

### Arguments - Reactor.Step.compensate/4 (callback)

- `reason` - the error reason returned from `c:run/3`.
  - `arguments` - the arguments passed to the step.
  - `context` - the reactor context.
  - `options` - a keyword list of options provided to the step (if any).

### Return values - Reactor.Step.compensate/4 (callback)

- `{:continue, value}` if you're able to provide a valid result for the step
    (perhaps by re-running the original computation) then return that within a
    `:continue` tuple and execution will continue as planned.
  - `:ok` the step was successfully compensated and the reactor should
    continue undoing upstream changes.
  - `:retry` or `{:retry, reason}` if you would like the reactor to attempt to
    re-run the step. You can optionally supply an error reason which will be
    used in the event that the step runs out of retries, otherwise a
    `Reactor.Error.Invalid.RetriesExceededError` will be used.
  - `{:error, reason}` if compensation was unsuccessful.

### Reactor.Step.compensate_result/0 (type)

Possible valid return values for the `c:compensate/4` callback.

### Reactor.Step.context/0 (type)



### Reactor.Step.run/3 (function)

Execute a step.

### Reactor.Step.run/3 (callback)

Execute the step.

This is the function that implements the behaviour you wish to execute.  You
will receive arguments as per the `t:Step.t` definition along with their
corresponding values as a map and a copy of the current reactor context.

### Arguments - Reactor.Step.run/3 (callback)

- `arguments` - A map of arguments as per the `t:Step.t` definition we're
    called from.
  - `context` - The reactor context.
  - `options` - A keyword list of options provided to the step (if any).

### Return values - Reactor.Step.run/3 (callback)

- `{:ok, value}` the step completed successfully it returns the value in an
    ok tuple.
  - `{:ok, value, [step]}` the step completed successfully and wants to add
    new steps to the reactor.
  - `{:error, reason}` the if step failed, return an error tuple.
  - `:retry` or `{:retry, reason}` the step failed, but is retryable.  You can
    optionally supply an error reason which will be used in the event that the
    step runs out of retries, otherwise a `Reactor.Error.RetriesExceededError`
    will be used.
  - `{:halt, reason}` terminate (or pause) reactor execution.  If there are
    actively running steps the reactor will wait for them to finish and then
    return the incomplete state for later resumption.

### Reactor.Step.run_result/0 (type)

Possible valid return values for the `c:run/3` callback.

### Reactor.Step.step/0 (type)



### Reactor.Step.t/0 (type)



### Reactor.Step.undo/4 (function)

Undo a step

### Reactor.Step.undo/4 (callback)

Undo a previously successful execution of the step.

> Do not implement this callback if your step doesn't support undoing.

This callback is called when the reactor encounters an unhandled error later
in it's execution run and must undo the work previously done.

### Arguments - Reactor.Step.undo/4 (callback)

- `value` - the return value of the previously successful call to `c:run/3`.
  - `arguments` - the arguments passed to the step.
  - `context` - the reactor context.
  - `options` - a keyword list of options provided to the step (if any).

### Return values - Reactor.Step.undo/4 (callback)

- `:ok` the step was successfully undo and the reactor should continue
    rolling back.
  - `{:error, reason}` there was an error while attempting to compensate.  The
    reactor will collect the error and continue rolling back.
  - `:retry` if you would like the reactor to attempt to undo the again later
    - possibly in the case of a network failure for example.

### Reactor.Step.undo_result/0 (type)

Possible valid return values for the `c:undo/4` callback.

### Reactor.Step.AnonFn (module)

The built-in step for executing in-line DSL anonymous functions.

### Options - Reactor.Step.AnonFn (module)

* `run` - a one or two arity function or MFA which will be called as the run
  function of the step.
* `compensate` - a one to three arity function or MFA which will be called as
  the compensate function of the step.  Optional.
* `undo` - a one to three arity function or MFA which will be called as the
  undo function of this step.  Optional.

### Reactor.Step.AnonFn.Mermaid (module)

Mermaid rendering for `AnonFn` steps.

### Reactor.Step.Around (module)

Wrap the execution of a number of steps in a function.

This allows you to provide custom context and filter the provided steps as
needed.

### Options - Reactor.Step.Around (module)

* `fun` - a four-arity function that will be called when executing this step.
* `steps` - a list of steps which are will be provided to the above mentioned
  function.
* `allow_async?` - a boolean indicating whether the nested steps can be
  executed asynchronously or must remain within the current process.

### Wrapper function - Reactor.Step.Around (module)

Your around function will be called by this step and will be passed the
following arguments:

* `arguments` - the arguments passed to the step.
* `context` - the context passed to the step.
* `steps` - the list of steps passed in the options.
* `callback` - a 3 arity function that you can call to execute steps.

This provides you the opportunity to modify the arguments, context and list of
steps to be executed.  You then can call the callback with the modified
arguments, context and steps and they will be executed in a Reactor of their
own.  The callback will return `{:ok, results}` where results is a map of all
of the step results by name, or an error tuple.

You can then modify the result in any way before returning it as the return of
the around step.

### Callback function - Reactor.Step.Around (module)

The callback function will spawn a separate Reactor and run provided steps to
completion using `arguments` as input.

It expects the following three arguments to be passed:

1. `arguments` - a map of arguments to be used as input to the nested Reactor.
2. `context` - the context passed to the nested Reactor.
3. `steps` - the list of steps which will be executed in the nested Reactor.

### Example - Reactor.Step.Around (module)

You could use a function like that below to cause some steps to be executed
inside an Ecto database transaction.

```elixir
def in_transaction(arguments, context, steps, callback) do
  MyApp.Repo.transaction(fn ->
    case callback.(arguments, context, steps) do
      {:ok, results} -> result
      {:error, reason} -> raise reason
    end
  end)
end
```

### Reactor.Step.Around.allow_async_option/0 (type)

Should the inner Reactor be allowed to run tasks asynchronously?

Optional. Defaults to `true`.

### Reactor.Step.Around.around_fun/0 (type)

The type signature for the "around" function.

### Reactor.Step.Around.callback/0 (type)

The type signature for the provided callback function.

### Reactor.Step.Around.function_option/0 (type)

The MFA or 4-arity function which this step will call.

### Reactor.Step.Around.options/0 (type)



### Reactor.Step.Around.steps_option/0 (type)

The initial steps to pass into the "around" function.

Optional.

### Reactor.Step.Around.Mermaid (module)

Mermaid rendering for `around` steps.

### Reactor.Step.Compose (module)

A built-in step which can embed one reactor inside another.

This step calls `Reactor.run/3` on the inner reactor and returns it's result.
Reactor will correctly share the concurrency availability over both the parent
and child Reactors.

### Reactor.Step.Compose.Mermaid (module)

Mermaid rendering for `compose` steps.

### Reactor.Step.Debug (module)

A very simple step which sends debug information to `Logger`.

### Options - Reactor.Step.Debug (module)

* `level` - the log level to use.

### Reactor.Step.Debug.level_option/0 (type)



### Reactor.Step.Debug.options/0 (type)



### Reactor.Step.Fail (module)

A very simple step which immediately returns an error.

### Reactor.Step.Group (module)

Wrap the execution of a number of steps with before/after functions.

Unlike `Reactor.Step.Around`, this step doesn't need to run a nested Reactor
instance, but instead can emit the steps directly into the parent Reactor.

### Options - Reactor.Step.Group (module)

* `before` - a three-arity function that will be called before running any
  child steps.
* `after` - a three-arity function that will be called after running any
  emitted steps.
* `allow_async?` - a boolean indicating whether the emitted steps can be
  executed asynchronously or must remain within the current process.

### Before function - Reactor.Step.Group (module)

The before function will be passed the following arguments:

1. `arguments` - the values of any step arguments needed by the group.
2. `context` - the Reactor context.
3. `steps` - the list of steps passed in the options.

This provides you the opportunity to modify the arguments, context and list of
steps to be executed.

The successful return value should be `{:ok, arguments, context, steps}`.  The
returned arguments will be used to provide any `input` arguments to nested
steps.

### Example - Reactor.Step.Group (module)

```elixir
def no_time_travel(arguments, context, steps) do
  steps = steps
    |> Enum.filter(&(&1.name == :program_time_circuits))

  arguments = arguments
    |> Map.delete(:destination_time)

  {:ok, arguments, context, steps}
end
```

### After function - Reactor.Step.Group (module)

The after function will be called with a single argument; a map of the nested
step results.

The successful return value should be `{:ok, any}` where `any` will be treated
as the result of the group.

```elixir
def find_current_year(results) do
  case Map.fetch(results, :time_circuits) do
    {:ok, %{present_time: present_time}} -> {:ok, present_time.year}
    _ -> {:error, "Unable to read the present time from the time circuits"}
  end
end
```

### Reactor.Step.Group.after_fun/0 (type)

The after function.

### Reactor.Step.Group.after_option/0 (type)

The MFA or 1-arity function which this step will call after successfully
running the steps.

### Reactor.Step.Group.allow_async_option/0 (type)

Should the emitted steps be allowed to run asynchronously?

Optional. Defaults to `true`.

### Reactor.Step.Group.before_fun/0 (type)

The before function.

### Reactor.Step.Group.before_option/0 (type)

The MFA or 3-arity function which this step will call before running any
steps.

### Reactor.Step.Group.options/0 (type)



### Reactor.Step.Group.steps_option/0 (type)

The initial steps to pass into the "before" function.

Optional.

### Reactor.Step.Group.Mermaid (module)

Mermaid rendering for `group` steps.

### Reactor.Step.Map (module)

Given an iterable input run the provided steps for each element and collect
the results into a new value.

> #### A note on ordering {: .tip}
>
> If your application doesn't need the results back in the same order that
> they were provided then setting `strict_ordering?` to `false` will increase
> performance - especially on large input sets.

### Options - Reactor.Step.Map (module)

* `:state` - Required. The current execution state of the map.  This is required because it's recursive.
   Valid values are :init, :iterating

* `:batch_size` (`t:pos_integer/0`) - The number of elements to consume off the source when emitting steps. The default value is `100`.

* `:steps` (list of struct of type `Reactor.Step`) - Required. The steps to use when mapping source elements.

* `:return` (`t:atom/0`) - Required. The name of the step whose result will be used as the new value for each element.

* `:strict_ordering?` (`t:boolean/0`) - Whether the mapped values must be returned in the same order that they were provided. The default value is `true`.

* `:allow_async?` (`t:boolean/0`) - Whether the emitted steps should be allowed to run asynchronously. The default value is `true`.

* `:descendant_step_names` (struct of type `MapSet`) - The cached names of all descendant steps to aid rewriting. You don't need to provide this value - it is calculated by the init pass.

* `:extra_arguments` (list of struct of type `Reactor.Argument`) - Extra arguments to be passed by to every nested step.

### Reactor.Step.Map.Mermaid (module)

Mermaid rendering for `map` steps.

### Reactor.Step.ReturnAllArguments (module)

A very simple step which simply returns all it's arguments unchanged.

### Reactor.Step.ReturnArgument (module)

A very simple step which simply returns the named argument, if provided.

### Options. - Reactor.Step.ReturnArgument (module)

* `argument` - the name of the argument to return.

### Reactor.Step.Switch (module)

Conditionally decide which steps should be run at runtime.

### Options - Reactor.Step.Switch (module)

* `matches` - a list of match consisting of predicates and a list of steps to
  execute if the predicate returns a truthy value.  See `t:matches` for more
  information.  Required.
* `default` - a list of steps to execute if none of the predicates match.
  Optional.
* `allow_async?` - a boolean indicating whether to allow the steps to be
  executed asynchronously.  Optional.  Defaults to `true`.
* `on` - the name of the argument to pass into the predicates.  If this
  argument is not provided to this step, then an error will be returned.

### Branching behaviour - Reactor.Step.Switch (module)

Each of the predicates in `matches` are tried in order, until either one
returns a truthy value, or all the matches are exhausted.

If there is a match, then the matching steps are emitted into the parent
running Reactor.

In the case that no match is found, then the steps provided in the `default`
option are emitted.  If no default is provided, then an error is returned.

> #### Tip {: .tip}
>
> Execution of predicates stops once the first match is found.  This means
> that if multiple predicates potentially match, the subsequent ones will
> never be called.

### Returning - Reactor.Step.Switch (module)

By default the step returns `nil` as it's result.

You can have the step return the result of a branch by adding a step to the
branch with the same name as the switch which returns the expected value.
This will be handled by normal Reactor step emission rules.

### Reactor.Step.Switch.allow_async_option/0 (type)



### Reactor.Step.Switch.default_option/0 (type)



### Reactor.Step.Switch.match_option/0 (type)



### Reactor.Step.Switch.matches/0 (type)

A list of predicates and steps to execute if the predicate returns a truthy
value.

### Reactor.Step.Switch.on_option/0 (type)



### Reactor.Step.Switch.options/0 (type)



### Reactor.Step.Switch.predicate/0 (type)

A predicate is a 1-arity function.  It can return anything.  Any result which
is not `nil` or `false` is considered true.

### Reactor.Step.Switch.Mermaid (module)

Mermaid rendering for `switch` steps.

### Reactor.Step.Template (module)

A step which renders an `EEx` template using it's arguments as the assigns.

### Options - Reactor.Step.Template (module)

* `:template` (`t:String.t/0`) - Required. The EEx template

* `:trim` (`t:boolean/0`) - Whether to trim whitespace before and after the template. See `EEx#options` The default value is `false`.

### Reactor.Step.Transform (module)

The built-in step for executing input and argument transformations.

Expects a single argument named `value` which contains the value to be
transformed.

### Options - Reactor.Step.Transform (module)

* `fun` - a one or two arity function or MFA to use to modify the `value`
  argument.

> #### Tip {: .tip}
>
> This step is emitted by the builder when an argument needs to be transformed
> before being passed into a step.
>
> Most likely you will never need to use this step directly.

### Reactor.Step.Transform.Mermaid (module)

Mermaid rendering for transform steps.

### Reactor.Step.TransformAll (module)

A built-in step which applies a transformation function to all it's arguments.

The returned map is used as the arguments to the step, instead of the step's
defined arguments.


> #### Tip {: .tip}
>
> This step will be emitted by the builder when a step wants to transform all
> it's arguments.
>
> Most likely you will never need to use this step directly.

### Reactor.Middleware (behaviour)

The Middleware behaviour.

By implementing this behaviour you can modify the internal state of the
Reactor during startup, execution and shutdown.

Middlewares can be added to the reactor either with the `middlewares` DSL
section or by the `add_middleware/2`, etc, functions in `Reactor.Builder`.

All callbacks in this behaviour are optional so you can define only the parts
you need for your feature.

### Reactor.Middleware.complete/2 (callback)

The complete callback will be called with the successful result of the
Reactor.

This gives you the opportunity to modify the return value or to perform clean
up of any non-reactor-managed resources (eg notifications).

Note that these callbacks are called in an arbitrary order meaning that the
result value passed may have already been altered by another callback.

If any callback returns an error then any remaining callbacks will not
be called.

### Reactor.Middleware.context/0 (type)



### Reactor.Middleware.error/2 (callback)

The error callback will be called the final error value(s) of the Reactor.

This gives you the opportunity to modify the return value or to perform clean
up of any non-reactor-managed resources (eg notifications).

Note that these callbacks are called in an arbitrary order meaning that the
error value passed may have already been altered by another callback.

Here a return value of `:ok` will continue calls to other callbacks without
modifying the error value.

### Reactor.Middleware.error_or_errors/0 (type)



### Reactor.Middleware.event/3 (callback)

Receive events about the execution of the Reactor.

This callback will block the Reactor, so it's encouraged that you do anything
expensive in another process.

### Reactor.Middleware.get_process_context/0 (callback)

Called before starting an asynchronous step in order to retrieve any context
information that needs to be passed into the new process.

This is most likely used by tracers to copy span information from the parent
process to the child process.

### Reactor.Middleware.halt/1 (callback)

The halt callback will be called with the Reactor context when halting.

This allows you to clean up any non-reactor-managed resources or modify the
context for later re-use by a future `init/1` callback.

### Reactor.Middleware.init/1 (callback)

The init callback will be called with the Reactor context when starting up.

This gives you the opportunity to modify the context or to perform any
initialisation of any non-reactor-managed resources (eg notifications).

### Reactor.Middleware.result/0 (type)



### Reactor.Middleware.set_process_context/1 (callback)

Called inside a new asynchronous step in order to set context information into
the new process.

This is most likely used by tracers to copy span information from the parent
process to the child process.

### Reactor.Middleware.step_event/0 (type)



### Reactor.Middleware.t/0 (type)



### Reactor.Middleware.Telemetry (module)

A Reactor middleware that emits telemetry events.

The following events are emitted:

* `[:reactor, :run, :start]`
* `[:reactor, :run, :stop]`
* `[:reactor, :step, :run, :start]`
* `[:reactor, :step, :run, :stop]`
* `[:reactor, :step, :process, :start]`
* `[:reactor, :step, :process, :stop]`
* `[:reactor, :step, :compensate, :start]`
* `[:reactor, :step, :compensate, :stop]`
* `[:reactor, :step, :undo, :start]`
* `[:reactor, :step, :undo, :stop]`

You can provide additional metadata by placing a map under the `telemetry_metadata` context key.

### Reactor.Error (module)

Uses `splode` to manage various classes of error.

### Reactor.Error.__using__/1 (macro)

Convenience wrapper around `use Splode.Error`

### Reactor.Error.class/0 (type)



### Reactor.Error.class_module/0 (type)



### Reactor.Error.error_class/0 (type)



### Reactor.Error.fetch_error/2 (function)

Recursively searches through nested reactor errors for the first instance of
the provided module.

### Reactor.Error.find_errors/2 (function)

Recursively searches through nested reactor errors and returns any errors
which match the provided module name.

### Reactor.Error.splode_error?/2 (function)



### Reactor.Error.t/0 (type)



### Reactor.Error.unwrap!/2 (function)

Raises an error if the result is an error, otherwise returns the result

Alternatively, you can use the `defsplode` macro, which does this automatically.

### Options - Reactor.Error.unwrap!/2 (function)

- `:error_opts` - Options to pass to `to_error/2` when converting the returned error
- `:unknown_error_opts` - Options to pass to the unknown error if the function returns only `:error`.
  not necessary if your function always returns `{:error, error}`.

### Examples - Reactor.Error.unwrap!/2 (function)

def function(arg) do
    case do_something(arg) do
      :success -> :ok
      {:success, result} -> {:ok, result}
      {:error, error} -> {:error, error}
    end
  end

  def function!(arg) do
    YourErrors.unwrap!(function(arg))
  end

### Reactor.Error.Internal.exception/1 (function)

Create an `Elixir.Reactor.Error.Internal` without raising it.

### Keys - Reactor.Error.Internal.exception/1 (function)

- :errors

### Reactor.Error.Internal.ComposeError.exception/1 (function)

Create an `Elixir.Reactor.Error.Internal.ComposeError` without raising it.

### Keys - Reactor.Error.Internal.ComposeError.exception/1 (function)

- :arguments
- :inner_reactor
- :message
- :outer_reactor

### Reactor.Error.Internal.MissingReturnResultError.exception/1 (function)

Create an `Elixir.Reactor.Error.Internal.MissingReturnResultError` without raising it.

### Keys - Reactor.Error.Internal.MissingReturnResultError.exception/1 (function)

- :reactor

### Reactor.Error.Internal.PlanError.exception/1 (function)

Create an `Elixir.Reactor.Error.Internal.PlanError` without raising it.

### Keys - Reactor.Error.Internal.PlanError.exception/1 (function)

- :graph
- :message
- :reactor
- :step

### Reactor.Error.Internal.UnreachableError.exception/1 (function)

Create an `Elixir.Reactor.Error.Internal.UnreachableError` without raising it.

### Keys - Reactor.Error.Internal.UnreachableError.exception/1 (function)

- :bindings
- :message
- :file
- :line

### Reactor.Error.Internal.UnreachableError.unreachable/1 (macro)

Create an unreachable error.

### Reactor.Error.Internal.UnreachableError.unreachable!/1 (macro)

Bang version of `unreachable/1`.

### Reactor.Error.Invalid.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid` without raising it.

### Keys - Reactor.Error.Invalid.exception/1 (function)

- :errors

### Reactor.Error.Invalid.ArgumentSubpathError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.ArgumentSubpathError` without raising it.

### Keys - Reactor.Error.Invalid.ArgumentSubpathError.exception/1 (function)

- :argument
- :culprit
- :culprit_key
- :culprit_path
- :message
- :step
- :value

### Reactor.Error.Invalid.CompensateStepError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.CompensateStepError` without raising it.

### Keys - Reactor.Error.Invalid.CompensateStepError.exception/1 (function)

- :error
- :reactor
- :step

### Reactor.Error.Invalid.ForcedFailureError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.ForcedFailureError` without raising it.

### Keys - Reactor.Error.Invalid.ForcedFailureError.exception/1 (function)

- :arguments
- :step_name
- :message
- :context
- :options

### Reactor.Error.Invalid.ForcedFailureError.t/0 (type)



### Reactor.Error.Invalid.InvalidResultError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.InvalidResultError` without raising it.

### Keys - Reactor.Error.Invalid.InvalidResultError.exception/1 (function)

- :reactor
- :step
- :result
- :arguments

### Reactor.Error.Invalid.MissingArgumentError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.MissingArgumentError` without raising it.

### Keys - Reactor.Error.Invalid.MissingArgumentError.exception/1 (function)

- :argument
- :arguments
- :step

### Reactor.Error.Invalid.MissingInputError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.MissingInputError` without raising it.

### Keys - Reactor.Error.Invalid.MissingInputError.exception/1 (function)

- :argument
- :reactor
- :step

### Reactor.Error.Invalid.MissingResultError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.MissingResultError` without raising it.

### Keys - Reactor.Error.Invalid.MissingResultError.exception/1 (function)

- :argument
- :reactor
- :step

### Reactor.Error.Invalid.RetriesExceededError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.RetriesExceededError` without raising it.

### Keys - Reactor.Error.Invalid.RetriesExceededError.exception/1 (function)

- :retry_count
- :step

### Reactor.Error.Invalid.RunStepError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.RunStepError` without raising it.

### Keys - Reactor.Error.Invalid.RunStepError.exception/1 (function)

- :error
- :step

### Reactor.Error.Invalid.TransformError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.TransformError` without raising it.

### Keys - Reactor.Error.Invalid.TransformError.exception/1 (function)

- :input
- :output
- :error

### Reactor.Error.Invalid.UndoRetriesExceededError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.UndoRetriesExceededError` without raising it.

### Keys - Reactor.Error.Invalid.UndoRetriesExceededError.exception/1 (function)

- :step
- :retry_count

### Reactor.Error.Invalid.UndoStepError.exception/1 (function)

Create an `Elixir.Reactor.Error.Invalid.UndoStepError` without raising it.

### Keys - Reactor.Error.Invalid.UndoStepError.exception/1 (function)

- :step
- :error

### Reactor.Error.Unknown.exception/1 (function)

Create an `Elixir.Reactor.Error.Unknown` without raising it.

### Keys - Reactor.Error.Unknown.exception/1 (function)

- :errors

### Reactor.Error.Unknown.UnknownError.exception/1 (function)

Create an `Elixir.Reactor.Error.Unknown.UnknownError` without raising it.

### Keys - Reactor.Error.Unknown.UnknownError.exception/1 (function)

- :error

### Reactor.Error.Validation.exception/1 (function)

Create an `Elixir.Reactor.Error.Validation` without raising it.

### Keys - Reactor.Error.Validation.exception/1 (function)

- :errors

### Reactor.Error.Validation.MissingReturnError.exception/1 (function)

Create an `Elixir.Reactor.Error.Validation.MissingReturnError` without raising it.

### Keys - Reactor.Error.Validation.MissingReturnError.exception/1 (function)

- :reactor

### Reactor.Error.Validation.StateError.exception/1 (function)

Create an `Elixir.Reactor.Error.Validation.StateError` without raising it.

### Keys - Reactor.Error.Validation.StateError.exception/1 (function)

- :reactor
- :state
- :expected

### Reactor.Builder (module)

Build a new Reactor programmatically.

You don't _have_ to use the Reactor DSL to create a Reactor.  The functions in
this module allow you to define a Reactor programmatically.  This is
especially useful if you need to create a reactor dynamically (maybe based on
a UI such as [React Flow](https://reactflow.dev/)).

### Example - Reactor.Builder (module)

```elixir
reactor = Builder.new()
{:ok, reactor} = Builder.add_input(reactor, :name)
argument = Argument.from_input(:name)
{:ok, reactor} = Builder.add_step(reactor, :greet, [argument])
{:ok, reactor} = Builder.return(reactor, :greet)
```

### Reactor.Builder.add_input/3 (function)

Add a named input to the Reactor.

This both places the input in the Reactor for later input validation and adds
steps to the Reactor which will emit and (possibly) transform the input.

### Reactor.Builder.add_input!/3 (function)

Raising version of `add_input/2..3`.

### Reactor.Builder.add_middleware/2 (function)

Add a middleware to the Reactor.

Returns an error if the middleware is already present on the Reactor.

### Reactor.Builder.add_middleware!/2 (function)

Raising version of `add_middleware/2`.

### Reactor.Builder.add_step/5 (function)

Add a step to the Reactor.

Add a new step to the Reactor.  Rewrites input arguments to use the result of
the input steps and injects transformation steps as required.

### Reactor.Builder.add_step!/5 (function)

Raising version of `add_step/3..5`.

### Reactor.Builder.arguments_transform/0 (type)

Optionally transform all the arguments into new arguments

### Reactor.Builder.async?/0 (type)

Should the step be run asynchronously?

### Reactor.Builder.compose/5 (function)

Compose another Reactor inside this one.

Whenever possible this function will extract the steps from inner Reactor and
place them inside the parent Reactor.  In order to achieve this the composer
will rename the steps to ensure that there are no conflicts.

If you're attempting to create a recursive Reactor (ie compose a Reactor
within itself) then this will be detected and runtime composition will be used
instead.  See `Reactor.Step.Compose` for more details.

### Reactor.Builder.compose!/5 (function)

Raising version of `compose/4`.

### Reactor.Builder.context/0 (type)

Optional context which will be merged with the reactor context when calling this step.

### Reactor.Builder.description/0 (type)

An optional step description

### Reactor.Builder.ensure_middleware/2 (function)

Ensure that a middleware is present on the Reactor.

### Reactor.Builder.ensure_middleware!/2 (function)

Raising version of `ensure_middleware/2`.

### Reactor.Builder.guards/0 (type)



### Reactor.Builder.impl/0 (type)



### Reactor.Builder.max_retries/0 (type)

How many times is the step allowed to retry?

### Reactor.Builder.new/1 (function)

Build a new, empty Reactor.

Optionally an identifier for the Reactor. This is primarily used for recursive
composition tracking.

### Reactor.Builder.new_step/4 (function)

Build a step which can be added to a reactor at runtime.

Note that the built step doesn't support transformations - you should add an
additional step to do the transformation needed (this is what `add_step/5`
does anyway).

### Reactor.Builder.new_step!/4 (function)

Raising version of `new_step/2..4`.

### Reactor.Builder.ref/0 (type)



### Reactor.Builder.return/2 (function)

Specify the return value of the Reactor.

The return value must be the name of a step.

### Reactor.Builder.return!/2 (function)

Raising version of `return/2`.

### Reactor.Builder.step_argument/0 (type)



### Reactor.Builder.step_options/0 (type)



### Reactor.Builder.Compose (module)

Handle composition of Reactors for the builder.

The composition logic was getting complicated enough that it seemed sensible
to extract it from the builder - if only to aid readability.

You should not use this module directly, but instead use
`Reactor.Builder.compose/4`.

### Reactor.Builder.Compose.compose/5 (function)

Compose another Reactor inside this one.

### Options - Reactor.Builder.Compose.compose/5 (function)

* `:guards` (list of value that implements the `Reactor.Guard.Build` protocol) - Any guards which need to be added to the generated step The default value is `[]`.

* `:async?` (`t:boolean/0`) - Whether the nested Reactor is allowed to run async or not The default value is `true`.

### Reactor.Builder.Compose.verify_arguments/2 (function)

Verify that the arguments and reactor inputs match

### Reactor.Builder.Input (module)

Handle adding inputs to Reactors for the builder.

You should not use this module directly, but instead use
`Reactor.Builder.add_input/3`.

### Reactor.Builder.Input.add_input/3 (function)

Add a named input to the reactor.

### Reactor.Builder.Input.options/0 (type)



### Reactor.Builder.Input.transform/0 (type)



### Reactor.Builder.Step (module)

Handle building and adding steps to Reactors for the builder.

You should not use this module directly, but instead use
`Reactor.Builder.new_step/4` and `Reactor.Builder.add_step/5`.

### Reactor.Builder.Step.add_step/5 (function)

Build and add a new step to a Reactor.

### Arguments - Reactor.Builder.Step.add_step/5 (function)

* `reactor` - An existing Reactor struct to add the step to.
* `name` - The proposed name of the new step.
* `impl` - A module implementing the `Reactor.Step` behaviour (or a tuple
  containing the module and options).
* `arguments` - A list of `Reactor.Argument` structs or shorthand keyword
  lists.

### Options - Reactor.Builder.Step.add_step/5 (function)

* `:async?` - Allow the step to be run asynchronously? The default value is `true`.

* `:max_retries` - The maximum number of times the step can ask to be retried The default value is `100`.

* `:transform` - A function which can modify all incoming arguments

* `:context` (`t:map/0`) - Context which will be merged with the reactor context when calling this step The default value is `%{}`.

* `:description` - An optional description for the step

* `:guards` (list of value that implements the `Reactor.Guard.Build` protocol) - Optional guards to add to the step The default value is `[]`.

* `:ref` - What sort of step reference to generate Valid values are :step_name, :make_ref The default value is `:make_ref`.

### Reactor.Builder.Step.new_step/4 (function)

Dynamically build a new step for later use.

You're most likely to use this when dynamically returning new steps from an
existing step.

### Arguments - Reactor.Builder.Step.new_step/4 (function)

* `name` - The name of the new step.
* `impl` - A module implementing the `Reactor.Step` behaviour (or a tuple
  containing the module and options).
* `arguments` - A list of `Reactor.Argument` structs or shorthand keyword
  lists.

### Options - Reactor.Builder.Step.new_step/4 (function)

* `:async?` - Allow the step to be run asynchronously? The default value is `true`.

* `:max_retries` - The maximum number of times the step can ask to be retried The default value is `100`.

* `:transform` - A function which can modify all incoming arguments

* `:context` (`t:map/0`) - Context which will be merged with the reactor context when calling this step The default value is `%{}`.

* `:description` - An optional description for the step

* `:guards` (list of value that implements the `Reactor.Guard.Build` protocol) - Optional guards to add to the step The default value is `[]`.

* `:ref` - What sort of step reference to generate Valid values are :step_name, :make_ref The default value is `:make_ref`.

### Reactor.Argument (module)

A step argument.

### Reactor.Argument.from_element/3 (function)

Build an argument which refers to to an element within a map step with an optional transformation applied.

### Example - Reactor.Argument.from_element/3 (function)

iex> Argument.from_element(:argument_name, &Atom.to_string/1)

### Reactor.Argument.from_input/3 (function)

Build an argument which refers to a reactor input with an optional
transformation applied.

### Options - Reactor.Argument.from_input/3 (function)

* `:transform` - An optional transformation function which can be used to modify the argument before it is passed to the step. The default value is `nil`.

* `:description` - An optional description for the argument. The default value is `nil`.

### Example - Reactor.Argument.from_input/3 (function)

iex> Argument.from_input(:argument_name, :input_name, transform: &String.to_integer/1)

### Reactor.Argument.from_result/3 (function)

Build an argument which refers to the result of another step with an optional
transformation applied.

### Example - Reactor.Argument.from_result/3 (function)

iex> Argument.from_result(:argument_name, :step_name, &Atom.to_string/1)

### Reactor.Argument.from_template/3 (function)

Build an argument directly from a template.

### Example - Reactor.Argument.from_template/3 (function)

iex> Argument.from_template(:argument_name, Reactor.Dsl.Argument.input(:input_name))

### Reactor.Argument.from_value/3 (function)

Build an argument which refers to a statically defined value.

### Example - Reactor.Argument.from_value/3 (function)

iex> Argument.from_value(:argument_name, 10)

### Reactor.Argument.has_sub_path/1 (macro)

Validate that the argument source has a sub_path

### Reactor.Argument.has_transform/1 (macro)

Validate that the argument has a transform.

### Reactor.Argument.is_argument/1 (macro)

Validate that the argument is an Argument struct.

### Reactor.Argument.is_from_element/1 (macro)

Validate that the argument contains an element.

### Reactor.Argument.is_from_input/1 (macro)

Validate that the argument refers to a reactor input.

### Reactor.Argument.is_from_result/1 (macro)

Validate that the argument refers to a step result.

### Reactor.Argument.is_from_value/1 (macro)

Validate that the argument contains a static value.

### Reactor.Argument.options/0 (type)



### Reactor.Argument.sub_path/2 (function)

Set a sub-path on the argument.

### Example - Reactor.Argument.sub_path/2 (function)

iex> Argument.from_value(:example, :value)
    ...> |> Argument.sub_path([:nested, :values])

### Reactor.Argument.t/0 (type)



### Reactor.Argument.transform/0 (type)



### Reactor.Argument.Build (protocol)

A protocol which can be used to convert something into an argument.

### Reactor.Argument.Build.build/1 (function)

Convert the input into one or more arguments.

### Reactor.Argument.Build.t/0 (type)

All the types that implement this protocol.

### Reactor.Executor (module)

The Reactor executor.

The executor handles the main loop of running a Reactor.

The algorithm is somewhat confusing, so here it is in pseudocode:

1. Find any async tasks (from a previous loop) which are completed. Either
   recurse or continue if none are found.
2. Find any async steps in the plan which are ready to run (they have no
   in-edges in the graph) and start as many as possible (given the constraints
   of `max_concurrency` and the state of the concurrency pool).  Either start
   over, or continue if none are found.
3. Find a single synchronous step which is ready to run and execute it. If
   there was one then recurse, otherwise continue.
4. Check if there are no more steps left in the plan (there are zero
   vertices).  If so, collect the return value and exit, otherwise recurse.

Whenever a step is run, whether run synchronously or asynchronously, the
following happens:

1. When the step is successful:
  a. If the step is undoable (ie `Step.can?(module, :undo)?` returns `true`)
     then the step and the result are stored in the Reactor's undo stack.
  b. If the result is depended upon by another step (the graph has out-edges
     for the step) _or_ the step is asking the reactor to halt then the
     result is stored in the Reactor's intermediate results.
  c. The step is removed from the graph (along with it's out-edges, freeing
     up it's dependents to run).
2. When the step is unsuccessful (returns an error tuple or raises):
  a. If the step can be compensated then compensation is attempted up to five
     times before giving up.
  b. The reactor iterates it's undo stack calling undo on each step.
3. When a step or compensation asks for a retry then the step is placed back
   in the graph to be run again next iteration.

### Reactor.Executor.run/4 (function)

Run a reactor.

Provided a Reactor which has been planned and the correct inputs, then run
the Reactor until completion, halting or failure.

You probably shouldn't call this directly, but use `Reactor.run/4` instead.

### Reactor.Executor.Async (module)

Handle the asynchronous execution of a batch of steps, along with any
mutations to the reactor or execution state.

### Reactor.Executor.Async.collect_remaining_tasks_for_shutdown/2 (function)

When the Reactor needs to shut down for any reason, we need to await all the
currently running asynchronous steps and delete any task vertices.

### Reactor.Executor.Async.handle_completed_steps/2 (function)

Handle zero or one completed async steps and then decide what to do.

### Reactor.Executor.Async.start_steps/4 (function)

Start as many of the provided steps as possible.

Takes into account he maximum concurrency and available work slots.

### Reactor.Executor.ConcurrencyTracker (module)

Manage shared concurrency pools for multiple Reactors.

When running a Reactor you can pass the `concurrency_key` option, which will
cause the Reactor to use the specified pool to ensure that the combined
Reactors never exceed the pool's available concurrency limit.

This avoids nested Reactors spawning too many workers and thrashing the
system.

The process calling `allocate_pool/1` is monitored, and when it terminates
it's allocation is removed.  Any processes which are using that pool will
not be able to allocate any new resources.

### Reactor.Executor.ConcurrencyTracker.acquire/2 (function)

Attempt to acquire a number of concurrency allocations from the pool.

Returns `{:ok, n}` where `n` was the number of slots that were actually
allocated.  It's important to note that whilst you may request `16` slots, if
there is only `3` available, then this function will return `{:ok, 3}` and you
must abide by it.

It is possible for this function to return `{:ok, 0}` if there is no slots
available.

### Reactor.Executor.ConcurrencyTracker.allocate_pool/1 (function)

Allocate a new concurrency pool and set the maximum limit.

### Reactor.Executor.ConcurrencyTracker.child_spec/1 (function)

Returns a specification to start this module under a supervisor.

See `Supervisor`.

### Reactor.Executor.ConcurrencyTracker.pool_key/0 (type)



### Reactor.Executor.ConcurrencyTracker.record/0 (type)



### Reactor.Executor.ConcurrencyTracker.release/2 (function)

Release concurrency allocation back to the pool.

### Reactor.Executor.ConcurrencyTracker.release_pool/1 (function)

Release the concurrency pool.

This deletes the pool, however doesn't affect any processes currently using
it.  No more resources can be acquired by users of the pool key.

### Reactor.Executor.ConcurrencyTracker.status/1 (function)

Report the available and maximum concurrency for a pool.

### Reactor.Executor.Hooks (module)

Handles the execution of reactor middleware hooks.

### Reactor.Executor.Hooks.complete/3 (function)

Run the completion hooks allowing the result to be replaced

### Reactor.Executor.Hooks.error/3 (function)

Run the error hooks allowing the error to be replaced

### Reactor.Executor.Hooks.event/4 (function)

Emit a step event.

### Reactor.Executor.Hooks.get_process_contexts/1 (function)

Run any get_process_context hooks

### Reactor.Executor.Hooks.halt/2 (function)

Run the halt hooks collecting the new context as it goes

### Reactor.Executor.Hooks.init/2 (function)

Run the init hooks collecting the new context as it goes

### Reactor.Executor.Hooks.set_process_contexts/1 (function)

Run set_process_context hooks given the result of `get_process_contexts/1`

### Reactor.Executor.Init (module)

Handle argument checking and state setup for a Reactor run.

### Reactor.Executor.State (module)

Contains the reactor execution state.

This is run-time only information.

### Reactor.Executor.State.t/0 (type)



### Reactor.Executor.StepRunner (module)

Run an individual step, including compensation if possible.

### Reactor.Executor.StepRunner.run/4 (function)

Collect the arguments and and run a step, with compensation if required.

### Reactor.Executor.StepRunner.run_async/5 (function)

Run a step inside a task.

This is a simple wrapper around `run/4` except that it emits more events.

### Reactor.Executor.StepRunner.undo/5 (function)

Undo a step if possible.

### Reactor.Executor.Sync (module)

Handle the synchronous execution of a single step, along with any mutations to
the reactor or execution state.

### Reactor.Executor.Sync.run/3 (function)

Try and run a step synchronously.

### Reactor.Guard (module)

A Reactor guard.

Guard types should implement the `Reactor.Guard.Build` protocol.

This struct contains a single two arity function, which when called with a
step's arguments and context returns one of the following:

- `:cont` - this guard has passed - continue evaluating any additional guards
  and if exhausted run the step.
- `{:halt, result}` - the guard has failed - use `result` as the steps result.

### Reactor.Guard.t/0 (type)



### Reactor.Guard.Build (protocol)

A protocol which can be used to convert something into a guard.

### Reactor.Guard.Build.build/1 (function)

Convert the input into one or more guards.

### Reactor.Guard.Build.t/0 (type)

All the types that implement this protocol.

### Reactor.Info (module)

Introspection for the Reactor DSL.

### Reactor.Info.reactor/1 (function)

reactor DSL entities

### Reactor.Info.reactor_middlewares/1 (function)

reactor.middlewares DSL entities

### Reactor.Info.reactor_options/1 (function)

reactor DSL options

Returns a map containing the and any configured or default values.

### Reactor.Info.reactor_return/1 (function)

Specify which step result to return upon completion.

### Reactor.Info.reactor_return!/1 (function)

Specify which step result to return upon completion.

### Reactor.Info.to_struct/1 (function)

Convert a reactor DSL module into a reactor struct.

### Reactor.Info.to_struct!/1 (function)

Raising version of `to_struct/1`.

### Reactor.Mermaid (behaviour)

Converts Reactors and their related entities into a Mermaid diagram.

See [Mermaid](https://mermaid.js.org/) for more information.

### Reactor.Mermaid.options/0 (type)



### Reactor.Mermaid.to_mermaid/2 (function)

Convert the Reactor into Mermaid.

### Options - Reactor.Mermaid.to_mermaid/2 (function)

* `:expand?` (`t:boolean/0`) - Whether or not to expand composed Reactors The default value is `false`.

* `:describe?` (`t:boolean/0`) - Whether or not to include descriptions, if available The default value is `false`.

* `:direction` - The direction to render the flowchart Valid values are :top_to_bottom, :bottom_to_top, :right_to_left, :left_to_right The default value is `:left_to_right`.

* `:indent` (`t:non_neg_integer/0`) - How much to indent the resulting mermaid The default value is `0`.

* `:output` - Specify the output format. `iodata` is more performant Valid values are :iodata, :binary The default value is `:iodata`.

### Reactor.Mermaid.to_mermaid/2 (callback)



### Reactor.Mermaid.to_mermaid!/2 (function)

Convert the Reactor into Mermaid

Raising version of `to_mermaid/2`

### Reactor.Mermaid.Node (module)

A node in the mermaid graph

### Reactor.Mermaid.Node.node_data/0 (type)



### Reactor.Mermaid.Node.node_list/0 (type)



### Reactor.Mermaid.Node.render/2 (function)

Render the node at the provided indent level.

### Reactor.Mermaid.Node.t/0 (type)



### Reactor.Mermaid.Utils (module)

Utilities for generating Mermaid.

### Reactor.Mermaid.Utils.direction/1 (function)

Convert the direction atom into a mermaid direction

### Reactor.Mermaid.Utils.md_escape/1 (function)

Escape markdown as needed

### Reactor.Mermaid.Utils.mermaid_id/2 (function)

Generate a mermaid ID for a term

### Reactor.Mermaid.Utils.name/1 (function)

Generate a name which can be used within a Mermaid node

### Reactor.Planner (module)

Build an execution plan for a Reactor.

Converts any unplanned steps into vertices in a graph with directed edges
between them representing their dependencies (arguments).

### Reactor.Planner.plan/1 (function)

Build an execution plan for a Reactor.

Builds a graph of the step dependencies, resolves them and then builds an execution plan.

### Reactor.Planner.plan!/1 (function)

Raising version of `plan/1`.

### Reactor.Template (module)

Templates used to refer to some sort of computed value.

### Reactor.Template.is_element_template/1 (macro)

A guard for element templates

### Reactor.Template.is_input_template/1 (macro)

A guard for input templates

### Reactor.Template.is_result_template/1 (macro)

A guard for result templates

### Reactor.Template.is_template/1 (macro)

A guard to detect all template types

### Reactor.Template.is_value_template/1 (macro)

A guard for value templates

### Reactor.Template.t/0 (type)



### Reactor.Template.type/0 (function)

The type for use in option schemas

### Reactor.Template.Element (module)

The `element` template.

### Reactor.Template.Element.t/0 (type)



### Reactor.Template.Input (module)

The `input` template.

### Reactor.Template.Input.t/0 (type)



### Reactor.Template.Result (module)

The `result` template.

### Reactor.Template.Result.t/0 (type)



### Reactor.Template.Value (module)

A statically `value` template.

### Reactor.Template.Value.t/0 (type)



## Links

- [Online documentation](https://hexdocs.pm/reactor)# ash_ai

> Integrated LLM features for your Ash application.

## Docs

### AshAi (module)

Documentation for `AshAi`.

### AshAi.class_to_status/1 (function)

Turns an error class into an HTTP status code

### AshAi.functions/1 (function)



### AshAi.has_vectorize_change?/1 (function)



### AshAi.iex_chat/2 (function)



### AshAi.setup_ash_ai/2 (function)

Adds the requisite context and tool calls to allow an agent to interact with your app.

### AshAi.to_json_api_errors/4 (function)



### AshAi.tools/1 (macro)



### AshAi.vectorize/1 (macro)



### AshAi.with_source_pointer/2 (function)



### AshAi.Actions (module)

Builtin generic action implementations

### AshAi.Actions.prompt/2 (macro)



### AshAi.Actions.Prompt (module)

A generic action impl that returns structured outputs from an LLM matching the action return.

Typically used via `prompt/2`, for example:

```elixir
action :analyze_sentiment, :atom do
  constraints one_of: [:positive, :negative]

  description """
  Analyzes the sentiment of a given piece of text to determine if it is overall positive or negative.

  Does not consider swear words as inherently negative.
  """

  argument :text, :string do
    allow_nil? false
    description "The text for analysis."
  end

  run prompt(
    LangChain.ChatModels.ChatOpenAI.new!(%{ model: "gpt-4o"}),
    # setting `tools: true` allows it to use all exposed tools in your app
    tools: true
    # alternatively you can restrict it to only a set of tools
    # tools: [:list, :of, :tool, :names]
    # provide an optional prompt, which is an EEx template
    # prompt: "Analyze the sentiment of the following text: <%= @input.arguments.description %>"
  )
end
```

The first argument to `prompt/2` is the `LangChain` model. It can also be a 2-arity function which will be invoked
with the input and the context, useful for dynamically selecting the model.

### Options - AshAi.Actions.Prompt (module)

- `:tools`: A list of tool names to expose to the agent call.
- `:verbose?`: Set to `true` for more output to be logged.
- `:prompt`: A custom prompt as an `EEx` template. See the prompt section below.

### Prompt - AshAi.Actions.Prompt (module)

The prompt by default is generated using the action and input descriptions. You can provide your own prompt
via the `prompt` option which will be able to reference `@input` and `@context`.

We have found that the "3rd party" style description writing paired with the format we provide by default to be
a good basis point for LLMs who are meant to accomplish a task. With this in mind, for refining your prompt,
first try describing via the action description that desired outcome or operating basis of the action, as well
as how the LLM is meant to use them. State these passively as facts. For example, above we used: "Does not consider swear
words as inherently negative" instead of instructing the LLM via "Do not consider swear words as inherently negative".

You are of course free to use any prompting pattern you prefer, but the end result of the above prompting pattern
leads to having a great description of your actual logic, acting both as documentation and instructions to the
LLM that executes the action.

The default prompt template is:

```elixir
"""
You are responsible for performing the `<%= @input.action.name %>` action.

<%= if @input.action.description do %>
# Description
<%= @input.action.description %>
<% end %>
<%= for argument <- @input.action.arguments,
    {:ok, value} = Ash.ActionInput.fetch_argument(@input, argument.name),
    {:ok, value} = Ash.Type.dump_to_embedded(argument.type, value, argument.constraints) do %>
## <%= argument.name %>
<%= if argument.description do %>

### Description - AshAi.Actions.Prompt (module)

<%= argument.description %>
<% end %>

### Value - AshAi.Actions.Prompt (module)

<%= Jason.encode!(value) %>
<% end %>

"""
```

### AshAi.Actions.Prompt.run/3 (function)



### AshAi.Changes.Vectorize (module)

A change that vectorizes the current values of attributes for a given record.
Used by the manual vectorization strategy, so you can decide
later when to run the vectorization action.

### AshAi.Changes.Vectorize.atomic/3 (function)



### AshAi.Changes.Vectorize.change/3 (function)



### AshAi.Changes.VectorizeAfterAction (module)

Vectorizes attributes inline immediately after they are changed

### AshAi.Changes.VectorizeAfterAction.atomic/3 (function)



### AshAi.Changes.VectorizeAfterAction.change/3 (function)



### AshAi.Changes.VectorizeAfterActionObanTrigger (module)

Run an ash_oban trigger when embeddings need to be regenerated.

### AshAi.Changes.VectorizeAfterActionObanTrigger.atomic/3 (function)



### AshAi.Changes.VectorizeAfterActionObanTrigger.change/3 (function)



### AshAi.Checks.ActorIsAshAi (module)

A check that is true when the actor is `%AshAi{}`

### AshAi.Checks.ActorIsAshAi.describe/1 (function)



### AshAi.Checks.ActorIsAshAi.eager_evaluate?/0 (function)



### AshAi.Checks.ActorIsAshAi.match?/3 (function)



### AshAi.Checks.ActorIsAshAi.prefer_expanded_description?/0 (function)



### AshAi.Checks.ActorIsAshAi.requires_original_data?/2 (function)



### AshAi.Checks.ActorIsAshAi.strict_check/3 (function)



### AshAi.Checks.ActorIsAshAi.type/0 (function)



### AshAi.EmbeddingModel (behaviour)

A behaviour that defines the dimensions of the vector, and how to generate the embedding

### AshAi.EmbeddingModel.dimensions/1 (callback)

The dimensions of generated embeddings

### AshAi.EmbeddingModel.generate/2 (callback)

Generate embeddings for the given list of strings

### AshAi.EmbeddingModel.opts/0 (type)



### AshAi.Info (module)

Introspection functions for the `AshAi` extension.

### AshAi.Info.tools/1 (function)

tools DSL entities

### AshAi.Info.vectorize_ash_oban_trigger_name/1 (function)

The name of the AshOban-trigger that will be run in order to update the record's embeddings. Defaults to `:ash_ai_update_embeddings`.

### AshAi.Info.vectorize_ash_oban_trigger_name!/1 (function)

The name of the AshOban-trigger that will be run in order to update the record's embeddings. Defaults to `:ash_ai_update_embeddings`.

### AshAi.Info.vectorize_attributes/1 (function)

A keyword list of attributes to vectorize, and the name of the attribute to store the vector in

### AshAi.Info.vectorize_attributes!/1 (function)

A keyword list of attributes to vectorize, and the name of the attribute to store the vector in

### AshAi.Info.vectorize_define_update_action_for_manual_strategy?/1 (function)

If true, an `ash_ai_update_embeddings` update action will be defined, which will automatically update the embeddings when run.

### AshAi.Info.vectorize_full_text_name/1 (function)

The name of the attribute to store the text vector in

### AshAi.Info.vectorize_full_text_name!/1 (function)

The name of the attribute to store the text vector in

### AshAi.Info.vectorize_full_text_options/1 (function)

vectorize.full_text DSL options

Returns a map containing the and any configured or default values.

### AshAi.Info.vectorize_full_text_text/1 (function)

A function or expr that takes a list of records and computes a full text string that will be vectorized. If given an expr, use `atomic_ref` to refer to new values, as this is set as an atomic update.

### AshAi.Info.vectorize_full_text_text!/1 (function)

A function or expr that takes a list of records and computes a full text string that will be vectorized. If given an expr, use `atomic_ref` to refer to new values, as this is set as an atomic update.

### AshAi.Info.vectorize_full_text_used_attributes/1 (function)

If set, a vector is only regenerated when these attributes are changed

### AshAi.Info.vectorize_full_text_used_attributes!/1 (function)

If set, a vector is only regenerated when these attributes are changed

### AshAi.Info.vectorize_options/1 (function)

vectorize DSL options

Returns a map containing the and any configured or default values.

### AshAi.Info.vectorize_strategy/1 (function)

How to compute the vector. Currently supported strategies are `:after_action`, `:manual`, and `:ash_oban`.

### AshAi.Info.vectorize_strategy!/1 (function)

How to compute the vector. Currently supported strategies are `:after_action`, `:manual`, and `:ash_oban`.

### AshAi.Mcp (module)

Model Context Protocol (MCP) implementation for Ash Framework.

This module implements a [Model Context Protocol (MCP)](https://modelcontextprotocol.io/) server
that integrates with Ash Framework, following the MCP [Streamable HTTP Transport](https://modelcontextprotocol.io/specification/2025-03-26/basic/transports#streamable-http) specification.

### Overview - AshAi.Mcp (module)

This MCP implementation provides:

* A fully compliant MCP server with JSON-RPC message processing
* Session management with unique session IDs
* Support for both JSON and Server-Sent Events (SSE) responses
* Batch request handling
* A foundation for integrating Ash resources with MCP clients
* Integration with AshAi tools for AI-assisted operations

### Current Features - AshAi.Mcp (module)

* `initialize` and `shutdown` method handlers
* Session management via GenServer processes
* Support for streaming responses
* Plug-compatible router for easy integration
* Tool support for AshAi functions

### Future Enhancements - AshAi.Mcp (module)

* OAuth integration with AshAuthentication
* Resource-specific method handlers
* Advanced streaming capabilities

### Integration - AshAi.Mcp (module)



### With Phoenix - AshAi.Mcp (module)

```elixir
# In your Phoenix router
forward "/mcp", AshAi.Mcp.router()

# With tools enabled
forward "/mcp", AshAi.Mcp.Router, tools: [:tool1, :tool2]
```

### With Any Plug-Based Application - AshAi.Mcp (module)

The MCP router is a standard Plug, so it can be integrated into any Plug-based application.
You are responsible for hosting the Plug however you prefer.

### AshAi.Mcp.child_spec/1 (function)

Returns a specification to start this module under a supervisor.

See `Supervisor`.

### AshAi.Mcp.start_link/1 (function)



### AshAi.Mcp.Dev (module)

Place in your endpoint's code_reloading section to expose Ash dev MCP at /mcp/ash

### AshAi.Mcp.Router (module)

MCP Router implementing the RPC functionality over HTTP.

This router handles HTTP requests according to the Model Context Protocol specification.

### Usage - AshAi.Mcp.Router (module)

```elixir
forward "/mcp", AshAi.Mcp.Router, tools: [:tool1, :tool2], otp_app: :my_app
```

### AshAi.Mcp.Router.call/2 (function)



### AshAi.Mcp.Router.init/1 (function)



### AshAi.Mcp.Server (module)

Implementation of the Model Context Protocol (MCP) RPC functionality.

This module handles HTTP requests and responses according to the MCP specification,
supporting both synchronous and streaming communication patterns.
It also handles the core JSON-RPC message processing for the protocol.

### AshAi.Mcp.Server.get_server_name/1 (function)

Get the MCP server name

### AshAi.Mcp.Server.get_server_version/1 (function)

Get the MCP server version

### AshAi.Mcp.Server.handle_delete/2 (function)

Handle HTTP DELETE request for session termination

### AshAi.Mcp.Server.handle_get/2 (function)

Process an HTTP GET request to open an SSE stream

### AshAi.Mcp.Server.handle_post/4 (function)

Process an HTTP POST request containing JSON-RPC messages

### AshAi.Mcp.Server.json_rpc_error_response/4 (function)

Create a standard JSON-RPC error response

### AshAi.Mcp.Server.parse_json_rpc/1 (function)

Parse the JSON-RPC request

### AshAi.Mcp.Server.process_message/3 (function)

Process a single JSON-RPC message

### AshAi.Mcp.Server.send_sse_event/4 (function)

Send an SSE event over the chunked connection

### AshAi.Tool (module)

An action exposed to LLM agents

### AshAi.Validations.ActorIsAshAi (module)

A validation that passes if the actor is `%AshAi{}`

## Links

- [Online documentation](https://hexdocs.pm/ash_ai)# igniter

> A code generation and project patching framework

## Docs

### Igniter (module)

Tools for generating and patching code into an Elixir project.

### Igniter.add_issue/2 (function)

Adds an issue to the issues list. Any issues will prevent writing and be displayed to the user.

### Igniter.add_notice/2 (function)

Adds a notice to the notices list. Notices are displayed to the user once the igniter finishes running.

### Igniter.add_task/3 (function)

Adds a task to the tasks list. Tasks will be run after all changes have been committed

### Igniter.add_warning/2 (function)

Adds a warning to the warnings list. Warnings will not prevent writing, but will be displayed to the user.

### Igniter.apply_and_fetch_dependencies/2 (function)

Applies the current changes to the `mix.exs` in the Igniter and fetches dependencies.

Returns the remaining changes in the Igniter if successful.

### Options - Igniter.apply_and_fetch_dependencies/2 (function)

* `:error_on_abort?` - If `true`, raises an error if the user aborts the operation. Returns the original igniter if not.
* `:yes` - If `true`, automatically applies the changes without prompting the user.

### Igniter.assign/2 (function)



### Igniter.assign/3 (function)

Stores the key/value pair in `igniter.assigns`

### Igniter.changed?/1 (function)

Returns true if the igniter or source provided has changed

### Igniter.changed?/2 (function)

Returns true if any of the files specified in `paths` have changed.

### Igniter.compose_task/4 (function)

Finds the `Igniter.Mix.Task` task by name and composes it with `igniter`.

If the task doesn't exist, a `fallback` function may be provided. This
function should accept and return the `igniter`.

### Argument handling - Igniter.compose_task/4 (function)

This function calls the task's `igniter/1` (or `igniter/2`) callback, setting
`igniter.args` using the current `igniter.args.argv_flags`. This prevents
composed tasks from accidentally consuming positional arguments. If you
wish the composed task to access additional arguments, you must explicitly
pass an `argv` list.

Additionally, you must declare other tasks you are composing with in your
task's `Igniter.Mix.Task.Info` struct using the `:composes` key. Without
this, you'll see unexpected argument errors if a flag that a composed task
uses is passed without you explicitly declaring it in your `:schema`.

### Example - Igniter.compose_task/4 (function)

def info(_argv, _parent) do
      %Igniter.Mix.Task.Info{
        ...,
        composes: [
          "other.task1",
          "other.task2"
        ]
      }

    def igniter(igniter) do
      igniter
      # other.task1 will see igniter.args.argv_flags as its args
      |> Igniter.compose_task("other.task1")
      # other.task2 will see an additional arg and flag
      |> Igniter.compose_task("other.task2", ["arg", "--flag"] ++ igniter.argv.argv_flags)
    end

### Igniter.copy_template/5 (function)

Copies an EEx template file from  the source path to the target path.

Accepts the same options as `create_new_file/4`.

### Igniter.create_new_elixir_file/4 (function)



### Igniter.create_new_file/4 (function)

Creates a new file in the project with the provided string contents. Adds an error if it already exists.

### Options - Igniter.create_new_file/4 (function)

- `:on_exists` - The action to take if the file already exists. Can be
  - `:error` (default) - Adds an error that prevents any eventual write.
  - `:warning` - Warns when writing but continues (without overwriting)
  - `:skip` - Skips writing the file without a warning
  - `:overwrite` - Warns when writing and overwrites the content with the new content

### Igniter.create_or_update_elixir_file/4 (function)

Creates the given file in the project with the provided string contents, or updates it with a function of type `zipper_updater()` if it already exists.

### Igniter.create_or_update_file/4 (function)

Creates the given file in the project with the provided string contents, or updates it with a function as in `update_file/3` (or with `zipper_updater()` for elixir files) if it already exists.

### Igniter.do_or_dry_run/2 (function)

Executes or dry-runs a given Igniter.

### Igniter.exists?/2 (function)

Checks if a file exists on the file system or in the igniter.

### Igniter.has_changes?/2 (function)

Returns whether the current Igniter has pending changes.

### Igniter.include_all_elixir_files/1 (function)

This function stores in the igniter if its been run before, so it is only run once, which is expensive.

### Igniter.include_existing_elixir_file/3 (function)



### Igniter.include_existing_file/3 (function)

Includes the given file in the project, expecting it to exist. Does nothing if its already been added.

### Igniter.include_glob/2 (function)

Includes all files matching the given glob, expecting them all (for now) to be elixir files.

### Igniter.include_or_create_elixir_file/3 (function)



### Igniter.include_or_create_file/3 (function)

Includes or creates the given file in the project with the provided contents. Does nothing if its already been added.

### Igniter.install/4 (function)

Installs a package as if calling `mix igniter.install`

See `mix igniter.install` for information on the package format.

### Options - Igniter.install/4 (function)

- `append?` - If `true`, appends the package to the existing list of packages instead of prepending. Defaults to `false`.

### Examples - Igniter.install/4 (function)

Igniter.install(igniter, "ash")

  Igniter.install(igniter, "ash_authentication@2.0", ["--authentication-strategies", "password,magic_link"])

### Igniter.mkdir/2 (function)

Creates a folder in the project.

### Igniter.move_file/4 (function)



### Igniter.new/0 (function)

Returns a new igniter

### Igniter.t/0 (type)



### Igniter.update_all_elixir_files/2 (function)

Runs an update over all elixir files

### Igniter.update_assign/4 (function)



### Igniter.update_elixir_file/3 (function)

Updates the source code of the given elixir file

### Igniter.update_file/4 (function)

Updates a given file's `Rewrite.Source`

### Igniter.update_glob/3 (function)

Updates all files matching the given glob with the given zipper function.

Adds any new files matching that glob to the igniter first.

### Igniter.zipper_updater/0 (type)



### Igniter.Test (module)

Tools for testing with igniter.

### Igniter.Test.apply_igniter/1 (function)

Fakes applying the changes of an igniter.

This function returns any tasks, errors, warnings.

### Igniter.Test.apply_igniter!/1 (function)

Applies an igniter, raising an error if there are any issues.

See `apply_igniter/1` for more.

### Igniter.Test.assert_content_equals/3 (macro)



### Igniter.Test.assert_creates/3 (macro)



### Igniter.Test.assert_has_issue/3 (macro)



### Igniter.Test.assert_has_notice/2 (macro)



### Igniter.Test.assert_has_patch/3 (macro)



### Igniter.Test.assert_has_task/3 (macro)



### Igniter.Test.assert_has_warning/2 (macro)



### Igniter.Test.assert_unchanged/1 (macro)



### Igniter.Test.assert_unchanged/2 (macro)



### Igniter.Test.diff/2 (function)

Return the current `igniter` diff.

### Options - Igniter.Test.diff/2 (function)

* `:only` - Only return the diff for this file or files

### Igniter.Test.phx_test_project/1 (function)

Sets up a test igniter that mimics a new phoenix project

### Igniter.Test.puts_diff/2 (function)

Print the current `igniter` diff, returning the `igniter`.

This is primarily used for debugging purposes.

### Options - Igniter.Test.puts_diff/2 (function)

* `:label` - A label to print before the diff
* `:only` - Only print the diff for this file or files

### Igniter.Test.test_project/1 (function)

Sets up a test igniter that has  only the files passed to it.

### Starting point - Igniter.Test.test_project/1 (function)

All of the files of an empty mix project are added by default.
You can specify more or overwrite files with the `:files` option.

### Limitations - Igniter.Test.test_project/1 (function)

You cannot install new dependencies, or use dependencies your own project does not have.
If you need to do that kind of thing, you will have to do a test that uses tools like
`System.cmd` in a temporary directory.

### Options - Igniter.Test.test_project/1 (function)

* `files` - A map of file paths to file contents. The file paths should be relative to the project root.
* `app_name` - The name of the application. Defaults to `:test`.

### Examples - Igniter.Test.test_project/1 (function)

test_project(files: %{
      "lib/foo.ex" => """
      defmodule MyApp.Foo do
        use Ash.Resource
      end
      """
    })

### Igniter.Upgrades (module)

Utilities for running upgrades.

### Igniter.Upgrades.run/5 (function)

Run all upgrades from `from` to `to`.

### Mix.Tasks.Igniter.AddExtension.igniter/1 (function)



### Mix.Tasks.Igniter.ApplyUpgrades.igniter/1 (function)



### Mix.Tasks.Igniter.Gen.Task.igniter/1 (function)



### Mix.Tasks.Igniter.MoveFiles.igniter/1 (function)



### Mix.Tasks.Igniter.Refactor.RenameFunction.igniter/1 (function)



### Mix.Tasks.Igniter.Refactor.RenameFunction.parse_fun/1 (function)



### Mix.Tasks.Igniter.Refactor.UnlessToIfNot.igniter/1 (function)



### Mix.Tasks.Igniter.Setup.igniter/1 (function)



### Mix.Tasks.Igniter.UpdateGettext.igniter/1 (function)



### Mix.Tasks.Igniter.Upgrade.igniter/1 (function)



### Igniter.Mix.Task (behaviour)

A behaviour for implementing a Mix task that is enriched to be composable with other Igniter tasks.

>

### Note {: .info} - Igniter.Mix.Task (behaviour)

>
> A default `run/1` is implemented so you can directly run the task. Igniter never uses this function, so it is overridable.
>
> This enables your library to make use of the task for its own purposes if needed. An example would be if you wanted to implement an Igniter installer, but also have an `install` task for end-user consumption (e.g. `mix tailwind.install`).

### Options and Arguments - Igniter.Mix.Task (behaviour)

Command line args are automatically parsed into `igniter.args` using the configuration returned
from `c:info/2`. See `Igniter.Mix.Task.Info` for more.

### Igniter.Mix.Task.igniter/1 (callback)

Main entrypoint for tasks. This callback accepts and returns an `Igniter` struct.

### Igniter.Mix.Task.igniter/2 (callback)

All the generator behavior happens here, you take an igniter and task arguments, and return an igniter.

### Igniter.Mix.Task.info/2 (callback)

Returns an `Igniter.Mix.Task.Info` struct, with information used when running the igniter task.

This info will be used to validate arguments in composed tasks.

Use the `positional_args!(argv)` to get your positional arguments according to your `info.positional`, and the remaining unused args.
Use the `options!(argv)` macro to get your parsed options according to your `info.schema`.

### Important Limitations - Igniter.Mix.Task.info/2 (callback)

* Each task still must parse its own argv in `igniter/2` and *must* ignore any unknown options.
  To accomplish this, use the automatically imported `options!(argv)` macro, which uses the `info/2`
  callback to validate args and return options
* You cannot use `composes` to list tasks unless they are in your library or in direct dependencies of your library.
  To validate their options, you must include their options in your own option schema.

### Igniter.Mix.Task.installer?/0 (callback)



### Igniter.Mix.Task.options!/1 (macro)

Parses the options for the task based on its info.

### Igniter.Mix.Task.parse_argv/1 (callback)

Returns an `Igniter.Mix.Task.Args` struct.

This callback can be implemented to private custom parsing and validation behavior for
command line arguments. By default, the options specified in `c:info/2` will be used
to inject a default implementation.

### Igniter.Mix.Task.positional_args!/1 (macro)



### Igniter.Mix.Task.supports_umbrella?/0 (callback)

Whether or not it supports being run in the root of an umbrella project

At the moment, this is still experimental and we suggest not turning it on.

### Igniter.Mix.Task.Args (module)

Command line arguments parsed when running an `Igniter.Mix.Task`.

These args will usually be accessed through `igniter.args` when the
`c:Igniter.Mix.Task.igniter/1` callback is run. To learn more about how
they are parsed, see `Igniter.Mix.Task.Info`.

### Igniter.Mix.Task.Args.t/0 (type)



### Igniter.Mix.Task.Info (module)

Info for an `Igniter.Mix.Task`, returned from the `info/2` callback

### Configurable Keys - Igniter.Mix.Task.Info (module)

* `schema` - The option schema for this task, in the format given to `OptionParser`, i.e `[name: :string]`. See the schema section for more.
* `defaults` - Default values for options in the schema.
* `required` - A list of flags that are required for this task to run.
* `positional` - A list of positional arguments that this task accepts. A list of atoms, or a keyword list with the option and config.
  See the positional arguments section for more.
* `aliases` - A map of aliases to the schema keys.
* `only` - For installers, a list of environments that the dependency should be installed to.
* `dep_opts` - For installers, dependency options that should be set, like `runtime: false`. Use the `only` key for `only` option.
* `composes` - A list of tasks that this task might compose.
* `installs` - A list of dependencies that should be installed before continuing.
* `adds_deps` - A list of dependencies that should be added to the `mix.exs`, but do not need to be installed before continuing.
* `extra_args?` - Whether or not to allow extra arguments. This forces all tasks that compose this task to allow extra args as well.
* `example` - An example usage of the task. This is used in the help output.

Your task should *always* use `switches` and not `strict` to validate provided options!

### Options and Arguments - Igniter.Mix.Task.Info (module)

Command line args are automatically parsed into `igniter.args` using this struct's configuration.

    @impl Igniter.Mix.Task
    def igniter(igniter) do
      positional = igniter.args.positional
      options = igniter.args.options
    end

If you need to do custom validation or parsing, you can implement `c:Igniter.Mix.Task.parse_argv/1`
and return an `Igniter.Mix.Task.Args` struct. If helpful, the `positional_args!/1` and
`options!/1` macros can be used to parse positional arguments and options/flags using your
info configuration.

    @impl Igniter.Mix.Task
    def parse_argv(argv) do
      {positional, argv_flags} = positional_args!(argv)
      options = options!(argv_flags)

      # custom validation or additional parsing

      %Igniter.Mix.Task.Args{
        argv: argv,
        argv_flags: argv_flags,
        positional: positional,
        options: options
      }
    end

### Options - Igniter.Mix.Task.Info (module)

The schema is an option parser schema, and `OptionParser` is used to parse the options, with
a few notable differences.

- The defaults from the `defaults` option in your task info are applied.
- The `:keep` type is automatically aggregated into a list.
- The `:csv` option automatically splits the value on commas, and allows it to be specified multiple times.
  This also raises an error if an option with a trailing comma is provided, suggesting that the user remove
  the comma or quote the value.

### Positional Arguments - Igniter.Mix.Task.Info (module)

Each positional argument can provide the following options:

* `:optional` - Whether or not the argument is optional. Defaults to `false`.
* `:rest` - Whether or not the argument consumes the rest of the positional arguments. Defaults to `false`.
            The value will be converted to a list automatically.

### Igniter.Mix.Task.Info.dep/0 (type)



### Igniter.Mix.Task.Info.global_options/0 (function)



### Igniter.Mix.Task.Info.t/0 (type)



### Igniter.Project.Application (module)

Codemods and tools for working with Application modules.

### Igniter.Project.Application.add_new_child/3 (function)

Adds a new child to the `children` list in the application file

To pass quoted code as the options, use the following format:

    {module, {:code, quoted_code}}

i.e

    {MyApp.Supervisor, {:code, quote do
      Application.fetch_env!(:app, :config)
    end}}

### Options - Igniter.Project.Application.add_new_child/3 (function)

- `:after` - A list of other modules that this supervisor should appear after,
   or a function that takes a module and returns `true` if this module should be placed after it.
- `:opts_updater` - A function that takes the current options (second element of the child tuple),
   and returns a new value. If the existing value of the module is not a tuple, the value passed into
   your function will be `[]`. Your function *must* return `{:ok, zipper}` or
   `{:error | :warning, "error_or_warning"}`.
- `:force?` - If `true`, forces adding a new child, even if an existing child uses the
  same child module. Defaults to `false`.

### Ordering - Igniter.Project.Application.add_new_child/3 (function)

We will put the new child as the earliest item in the list that we can, skipping any modules
in the `after` option.

### Examples - Igniter.Project.Application.add_new_child/3 (function)

Given an application `start/2` that looks like this:

    def start(_type, _args) do
      children = [
        ChildOne,
        {ChildTwo, opt: 1}
      ]

      Supervisor.start_link(children, strategy: :one_for_one)
    end

Add a new child that isn't currently present:

    Igniter.Project.Application.add_new_child(igniter, NewChild)
    # =>
    children = [
      NewChild,
      ChildOne,
      {ChildTwo, opt: 1}
    ]

Add a new child after some existing ones:

    Igniter.Project.Application.add_new_child(igniter, NewChild, after: [ChildOne, ChildTwo])
    # =>
    children = [
      ChildOne,
      {ChildTwo, opt: 1},
      NewChild
    ]

If the given child module is already present, `add_new_child/3` is a no-op by default:

    Igniter.Project.Application.add_new_child(igniter, {ChildOne, opt: 1})
    # =>
    children = [
      ChildOne,
      {ChildTwo, opt: 1}
    ]

You can explicitly handle module conflicts by passing an `:opts_updater`:

    Igniter.Project.Application.add_new_child(igniter, {ChildOne, opt: 1},
      opts_updater: fn opts ->
        {:ok, Sourceror.Zipper.replace(opts, [opt: 1])}
      end
    )
    # =>
    children = [
      {ChildOne, opt: 1},
      {ChildTwo, opt: 1}
    ]

Using `force?: true`, you can force a child to be added, even if the module
conflicts with an existing one:

    Igniter.Project.Application.add_new_child(igniter, {ChildOne, opt: 1}, force?: true)
    # =>
    children = [
      {ChildOne, opt: 1},
      ChildOne,
      {ChildTwo, opt: 1}
    ]

### Igniter.Project.Application.app_module/1 (function)

Returns the name of the application module.

### Igniter.Project.Application.app_name/0 (function)

Returns the name of the current application.

### Igniter.Project.Application.app_name/1 (function)

Returns the name of the application.

### Igniter.Project.Application.config_path/1 (function)

Returns the config_path of the application.

### Igniter.Project.Application.create_app/2 (function)



### Igniter.Project.Application.create_application_file/2 (function)



### Igniter.Project.Application.priv_dir/2 (function)

Returns the path of the application's priv directory.

### Igniter.Project.Application.skip_after/2 (function)



### Igniter.Project.Config (module)

Codemods and utilities for modifying Elixir config files.

### Igniter.Project.Config.after_predicate/0 (type)



### Igniter.Project.Config.config_group_item/0 (type)



### Igniter.Project.Config.configure/6 (function)

Sets a config value in the given configuration file, updating it with `updater` if it is already set.

If the value is source code, pass `{:code, value}`, otherwise pass just the value.

To produce this source code, we suggest using `Sourceror.parse_string!`. For example:

```elixir
|> Igniter.Project.Config.configure(
  "fake.exs",
  :tailwind,
  [:default, :args],
  {:code,
   Sourceror.parse_string!("""
   ~w(--config=tailwind.config.js --input=css/app.css --output=../output/assets/app.css)
   """)}
)
```

### Options - Igniter.Project.Config.configure/6 (function)

* `failure_message` - A message to display to the user if the configuration change is unsuccessful.
* `updater` - `t:updater/0`. A function that takes a zipper at a currently configured value and returns a new zipper with the value updated.
* `after` - `t:after_predicate/0`. Moves to the last node that matches the predicate. Useful to guarantee a `config` is placed after a specific node.

### Igniter.Project.Config.configure_group/6 (function)

Configures a "group" of configurations, which is multiple configurations set at one time.
If the app + the shared prefix is already configured, then each configuration is added individually,
and the `comment` for the group is ignored. The sub configurations use `configure`, so if you want to
not change the value if its already set, use `updater: &{:ok, &1}` in the item opts.

### Options - Igniter.Project.Config.configure_group/6 (function)

- `comment` - A comment string to add above the group when its added.

### Igniter.Project.Config.configure_new/6 (function)

Sets a config value in the given configuration file, if it is not already set.

See `configure/6` for more.

### Options - Igniter.Project.Config.configure_new/6 (function)

* `failure_message` - A message to display to the user if the configuration change is unsuccessful.
* `after` - `t:after_predicate/0`. Moves to the last node that matches the predicate.

### Igniter.Project.Config.configure_runtime_env/6 (function)



### Igniter.Project.Config.configures?/3 (function)



### Igniter.Project.Config.configures?/4 (function)

Returns `true` if the given configuration path is set somewhere after the provided zipper, or in the given configuration file.

### Igniter.Project.Config.configures_key?/3 (function)

Same as `configures_key?/4` but accepts a Zipper.

### Igniter.Project.Config.configures_key?/4 (function)

If the last argument is key, checks if either `config :root_key, :key, ...`
or `config :root_key, key: ...` is set.

If the last argument is a keyword path, checks if
`config :root_key, path_head, [...]` defines `path_rest` or if
`config :root_key, [...]` defines `path`, where `path_head` is the first
element of `path` and `path_rest` are the remaining elements.

Note: `config_file_name` should _not_ include the `config/` prefix.

### Igniter.Project.Config.configures_root_key?/2 (function)

Same as `configures_root_key?/3` but accepts a Zipper instead.

### Igniter.Project.Config.configures_root_key?/3 (function)

Checks if either `config :root_key, _` or `config :root_key, _, _` is present
in the provided config file.

Note: The config file name should _not_ include the `config/` prefix.

### Igniter.Project.Config.modify_configuration_code/5 (function)

Modifies elixir configuration code starting at the configured zipper.

If you want to set configuration, use `configure/6` or `configure_new/5` instead. This is a lower-level
tool for modifying configuration files when you need to adjust some specific part of them.

### Options - Igniter.Project.Config.modify_configuration_code/5 (function)

* `updater` - `t:updater/0`. A function that takes a zipper at a currently configured value and returns a new zipper with the value updated.
* `after` - `t:after_predicate/0`. Moves to the last node that matches the predicate.

### Igniter.Project.Config.updater/0 (type)



### Igniter.Project.Deps (module)

Codemods and utilities for managing dependencies declared in mix.exs

### Igniter.Project.Deps.add_dep/3 (function)

Adds a dependency to the mix.exs file.

```elixir
|> Igniter.Project.Deps.add_dep({:my_dependency, "~> X.Y.Z"})
```

# Options

- `:yes?` - Automatically answer yes to any prompts.
- `:append?` - Append to the dependency list instead of prepending.
- `:error?` - Returns an error instead of a notice on failure.

### Igniter.Project.Deps.add_dependency/4 (function)



### Igniter.Project.Deps.get_dep/2 (function)

Gets the current dependency declaration in mix.exs for a given dependency.

### Igniter.Project.Deps.get_dependency_declaration/2 (function)

Gets the current dependency declaration in mix.exs for a given dependency.

### Igniter.Project.Deps.has_dep?/2 (function)

Returns true if the given dependency is in `mix.exs`

### Igniter.Project.Deps.remove_dep/2 (function)

Removes a dependency from mix.exs

### Igniter.Project.Deps.set_dep_option/4 (function)

Sets a dependency option for an existing dependency

### Igniter.Project.Formatter (module)

Codemods and utilities for interacting with `.formatter.exs` files

### Igniter.Project.Formatter.add_formatter_plugin/2 (function)

Adds a new plugin to the list of plugins in the root `.formatter.exs`

### Igniter.Project.Formatter.import_dep/2 (function)

Adds a new dep to the list of imported deps in the root `.formatter.exs`

### Igniter.Project.Formatter.remove_formatter_plugin/2 (function)

REmoves a plugin to the list of plugins in the root `.formatter.exs`

### Igniter.Project.Formatter.remove_imported_dep/2 (function)

Removes an imported dep from the list of imported deps in the root `.formatter.exs`

### Igniter.Project.IgniterConfig (module)

Tools for reading and modifying the `.igniter.exs` file.

The command `mix igniter.setup` will generate this file, as well
as keep it up to date with any new configurations. You can run this
command at any time to update the file without overriding your own config.

If the file does not exist, all values are considered to have their default value.

### Options - Igniter.Project.IgniterConfig (module)

- `module_location` - 
  - `:outside_matching_folder`, modules will be placed in a folder exactly matching their path.
  - `:inside_matching_folder`, modules who's name matches an existing folder will be placed inside that folder,
    or moved there if the folder is created.

- `extensions` - 
A list of extensions to use in the project.
- `deps_location` - 
The strategy for finding the `deps` list to add new dependencies to, in your `deps/0` function in `mix.exs`

  - `:last_list_literal` expects your deps function to return a literal list which will be prepended to
  - `{:variable, :name}` expects to find an assignment from the given variable to a list literal, i.e `deps = [...]`, and prepends to that
  - `:mfa` will call the given mfa with the igniter and the zipper within the `deps/0` function. It should return `{:ok, zipper}`
     at the position where the dep should be prepended, or :error if the location could not be found.

- `source_folders` - 
A list of folders to manage elixir files in.
- `dont_move_files` - 
A list of strings or regexes. Any files that equal (in the case of strings) or match (in the case of regexes) will not be moved.

### Igniter.Project.IgniterConfig.add_extension/2 (function)



### Igniter.Project.IgniterConfig.configure/3 (function)



### Igniter.Project.IgniterConfig.dont_move_file_pattern/2 (function)



### Igniter.Project.IgniterConfig.get/2 (function)



### Igniter.Project.IgniterConfig.setup/1 (function)



### Igniter.Project.MixProject (module)

Codemods and utilities for updating project configuration in mix.exs.

### Igniter.Project.MixProject.update/4 (function)

Updates the project configuration AST at the given path.

This function accepts a `function_name` atom corresponding to a function
like `project/0`, `application/0`, or `cli/0` and navigates to the given
path, jumping to private functions if necessary and creating nested
keyword lists if they don't already exist. It then calls the given
`update_fun`, using the return value to update the AST.

`update_fun` must be a function that accepts one argument, a zipper
targeting the current AST at the given configuration path or `nil` if
there was no value at that path. It then must return one of the
following:

  * `{:ok, zipper}` - the updated zipper
  * `{:ok, {:code, quoted}}` - a quoted expression that should be
    inserted as the new value at `path`
  * `{:ok, nil}` - indicates that the last key in `path` should be
    removed
  * `{:error, message}` or `{:warning, message}` - an error or warning
    that should be added to `igniter`
  * `:error` - indicates `igniter` should be returned without change

### Examples - Igniter.Project.MixProject.update/4 (function)

Assuming a newly-generated Mix project that looks like:

    defmodule Example.MixProject do
      use Mix.Project

      def project do
        [
          app: :example,
          version: "0.1.0",
          elixir: "~> 1.17",
          start_permanent: Mix.env() == :prod,
          deps: deps()
        ]
      end

      def application do
        [
          extra_applications: [:logger]
        ]
      end

      defp deps do
        []
      end
    end

### Increment the project version by one patch level - Igniter.Project.MixProject.update/4 (function)

Igniter.Project.MixProject.update(igniter, :project, [:version], fn zipper ->
      new_version =
        zipper.node
        |> Version.parse!()
        |> Map.update!(:patch, &(&1 + 1))
        |> to_string()

      {:ok, {:code, new_version}}
    end)

    # would result in
    def project do
      [
        ...,
        version: "0.1.1",
        ...
      ]
    end

### Set the preferred env for a task to `:test` - Igniter.Project.MixProject.update/4 (function)

Igniter.Project.MixProject.update(
      igniter,
      :cli,
      [:preferred_envs, :"some.task"],
      fn _ -> {:ok, {:code, :test}} end
    )

    # would create `cli/0` and set the env:
    def cli do
      [
        preferred_envs: [
          "some.task": :test
        ]
      ]
    end

### Add `:some_application` to `:extra_applications` - Igniter.Project.MixProject.update/4 (function)

Igniter.Project.MixProject.update(igniter, :application, [:extra_applications], fn
      nil -> {:ok, {:code, [:some_application]}}
      zipper -> Igniter.Code.List.append_to_list(zipper, :some_application)
    end)

    # would result in
    def application do
      [
        extra_applications: [:logger, :some_application]
      ]
    end

### Remove `:extra_applications` altogether - Igniter.Project.MixProject.update/4 (function)

Igniter.Project.MixProject.update(
      igniter,
      :application,
      [:extra_applications],
      fn _ -> {:ok, nil} end
    )

    # would result in
    def application do
      []
    end

### Igniter.Project.Module (module)

Codemods and utilities for interacting with modules

### Igniter.Project.Module.create_module/4 (function)

Creates a new file & module in its appropriate location.

### Options - Igniter.Project.Module.create_module/4 (function)

- `:location` - A location type. See `t:location_type` for more.

### Igniter.Project.Module.find_all_matching_modules/2 (function)



### Igniter.Project.Module.find_and_update_module/3 (function)

Finds a module and updates its contents. Returns `{:error, igniter}` if the module could not be found. Do not discard this igniter.

### Igniter.Project.Module.find_and_update_module!/3 (function)

Finds a module and updates its contents. Raises an error if it doesn't exist

### Igniter.Project.Module.find_and_update_or_create_module/5 (function)

Finds a module and updates its contents wherever it is.

If the module does not yet exist, it is created with the provided contents. In that case,
the path is determined with `Igniter.Code.Module.proper_location/2`, but may optionally be overwritten with options below.

# Options

- `:path` - Path where to create the module, relative to the project root. Default: `nil` (uses `:kind` to determine the path).

### Igniter.Project.Module.find_module/2 (function)

Finds a module, returning a new igniter, and the source and zipper location. This new igniter should not be discarded.

In general, you should not use the returned source and zipper to update the module, instead, use this to interrogate
the contents or source in some way, and then call `find_and_update_module/3` with a function to perform an update.

### Igniter.Project.Module.find_module!/2 (function)

Finds a module, raising an error if its not found.

See `find_module/2` for more information.

### Igniter.Project.Module.location_type/0 (type)

Placement instruction for a module.

- `:source_folder` - The first source folder of the project
- `{:source_folder, path}` - The selected source folder, i.e `"lib"`
- `:test` - Creating a test file
- `:test_support` - Creating a test support file

### Igniter.Project.Module.module_exists/2 (function)

Checks if a module is defined somewhere in the project. The returned igniter should not be discarded.

### Igniter.Project.Module.module_exists?/2 (function)

Checks if a module is defined somewhere in the project. The returned igniter should not be discarded.

### Igniter.Project.Module.module_name/2 (function)

Given a suffix, returns a module name with the prefix of the current project.

### Igniter.Project.Module.module_name_prefix/1 (function)

The module name prefix based on the mix project's module name

### Igniter.Project.Module.parse/1 (function)

Parses a string into a module name

### Igniter.Project.Module.proper_location/3 (function)

Determines where a module should be placed in a project.

### Igniter.Project.TaskAliases (module)

Codemods and utilities for interacting with task aliases in the mix.exs file

### Igniter.Project.TaskAliases.add_alias/4 (function)

Adds an alias to the mix.exs file

# Options

- `:if_exists` - How to alter the alias if it already exists. Options are:
- `:ignore` - Do nothing if the alias already exists. This is the default.
- `:prepend` - Add the new alias to the beginning of the list (if it is not already present).
- `{:prepend, value}` - Add a different value than the originally supplied alias to the beginning of the list (if it is not already present).
- `{:replace_or_append, old, new}` - If the old value is in the list, it is replaced with the new value. Otherwise the new value is appended (if it is not already present).
- `:append` - Add the new alias to the end of the list (if it is not already present).
- `{:append, value}` - Add a different value than the originally supplied alias to the end of the list (if it is not already present).
- `:warn` - Print a warning if the alias already exists.

### Igniter.Project.TaskAliases.modify_existing_alias/3 (function)

Modifies an existing alias, doing nothing if it doesn't exist

### Igniter.Project.Test (module)

Codemods and utilities for interacting with test and test support files

### Igniter.Project.Test.ensure_test_support/1 (function)



### Igniter.Refactors.Elixir (module)

Refactors for changes in Elixir

### Igniter.Refactors.Elixir.unless_to_if_not/1 (function)



### Igniter.Refactors.Rename (module)

Refactors for renaming things in a project

### Igniter.Refactors.Rename.rename_function/4 (function)

Renames a function globally across a project.

### Options - Igniter.Refactors.Rename.rename_function/4 (function)

- `:arity` - `:any` | integer | [integer]. The arity or arities of the function to rename. Defaults to `:any`.
- `:deprecate` - `:soft | :hard`. Leave the original function in place, but with a deprecation.
  Soft deprecations appear in documentation but do not cause warnings. Hard deprecations warn when they are called.

### Igniter.Refactors.Rename.subsume_module_attrs/2 (function)



### Igniter.Code.Common (module)

General purpose utilities for working with `Sourceror.Zipper`.

### Igniter.Code.Common.add_code/3 (function)

Adds the provided code to the zipper.

### Options - Igniter.Code.Common.add_code/3 (function)

- `:placement` - `:after` | `:before`. Determines if the code goes `:after` or `:before` the current node. Defaults to `:after`.
- `:expand_env?` - boolean. Whether or not to read the current file to use it's aliases for added code. Defaults to `false`.

### Example: - Igniter.Code.Common.add_code/3 (function)

iex> existing_zipper = Igniter.Code.Common.parse_to_zipper!("""
    ...> IO.puts("abc")
    ...> """)
    ...>
    ...> existing_zipper
    ...> |> Igniter.Code.Common.add_code("""
    ...> IO.puts("Goodbye, world!")
    ...> """, after: true)
    ...> |> Sourceror.Zipper.root()
    ...> |> Sourceror.to_string()
    "IO.puts(\"abc\")
    IO.puts(\"Goodbye, world!\")"

### Igniter.Code.Common.add_comment/3 (function)



### Igniter.Code.Common.current_env/1 (function)

Expands the environment at the current zipper position and returns the
expanded environment. Currently used for properly working with aliases.

### Igniter.Code.Common.expand_alias/1 (function)



### Igniter.Code.Common.expand_aliases/1 (function)



### Igniter.Code.Common.expand_literal/1 (function)

Expands a literal value using the env at the cursor, if possible

### Igniter.Code.Common.extendable_block?/1 (function)



### Igniter.Code.Common.find_all/2 (function)

Returns a list of `zippers` to each `node` that satisfies the `predicate` function, or
an empty list if none are found.

The optional second parameters specifies the `direction`, defaults to
`:next`.

### Igniter.Code.Common.maybe_move_to_block/1 (function)

Enters a block, and moves to the first child, or returns the zipper unmodified.

### Igniter.Code.Common.maybe_move_to_single_child_block/1 (function)

Enters a block with a single child, and moves to that child,
or returns the zipper unmodified

### Igniter.Code.Common.move_left/2 (function)

Moves a zipper to the left.

If the second argument is a predicate function, it will be called on the zipper and then
move leftwards until the predicate returns `true`. This function will automatically enter
and exit blocks.

If the second argument is a non-negative integer, it will move left that many times if
possible, returning `:error` otherwise.

### Igniter.Code.Common.move_next/2 (function)

Moves nextwards (depth-first), until the provided predicate returns `true`.

Returns `:error` if the end is reached without finding a match.

### Igniter.Code.Common.move_right/2 (function)

Moves a zipper to the right.

If the second argument is a predicate function, it will be called on the zipper and then
move rightwards until the predicate returns `true`. This function will automatically enter
and exit blocks.

If the second argument is a non-negative integer, it will move right that many times if
possible, returning `:error` otherwise.

### Igniter.Code.Common.move_to/2 (function)

Moves to the first node that matches the predicate.

### Igniter.Code.Common.move_to_cursor/2 (function)

Matches and moves to the location of a `__cursor__` in provided source code.

Use `__cursor__()` to match a cursor in the provided source code. Use `__` to skip any code at a point.

For example:

```elixir
zipper =
  """
  if true do
    10
  end
  """
  |> Sourceror.parse_string!()
  |> Sourceror.Zipper.zip()

pattern =
  """
  if __ do
    __cursor__()
  end
  """

{:ok, zipper} = Igniter.Code.Common.move_to_cursor(zipper, pattern)
Sourceror.Zipper.node(zipper)
# => {:__block__,
#     [
#       trailing_comments: [],
#       leading_comments: [],
#       end_of_expression: [newlines: 1, line: 2, column: 5],
#       token: "10",
#       line: 2,
#       column: 3
#     ], ~c"
"}
```

### Igniter.Code.Common.move_to_cursor_match_in_scope/2 (function)

Moves to the cursor that matches the provided pattern or one of the provided patterns, in the current scope.

See `move_to_cursor/2` for an example of a pattern

### Igniter.Code.Common.move_to_do_block/1 (function)

Moves to a do block for the current call.

For example, at a node like:

```elixir
foo do
  10
end
```

You would get a zipper back at `10`.

### Igniter.Code.Common.move_to_last/2 (function)

Moves to the last node that matches the predicate.

Similar to `move_to/2` but it doesn't stop at the first match,
for example a zipper for the following code:

```elixir
port = 4000
port = 4001
```

With a match for `port = _` as `{:=, _, [{:port, _, _}, _]}`,
will return the second `port` variable.

### Igniter.Code.Common.move_to_pattern/2 (macro)

Moves to the next node that matches the given pattern.

### Igniter.Code.Common.move_to_zipper/2 (function)

Moves to the next zipper that matches the predicate.

### Igniter.Code.Common.move_upwards/2 (function)

Moves a zipper upwards.

If the second argument is a predicate function, it will be called on the zipper and then
move upwards until the predicate returns `true`.

If the second argument is a non-negative integer, it will move upwards that many times if
possible, returning `:error` otherwise.

### Igniter.Code.Common.move_upwards_until/2 (function)

Moves to the last node before the node that matches the predicate, going upwards.

### Igniter.Code.Common.node_matches_pattern?/2 (macro)

Returns `true` if the current node matches the given pattern.

### Examples: - Igniter.Code.Common.node_matches_pattern?/2 (macro)

```elixir
list_zipper =
  "[1, 2, 3]"
  |> Sourceror.parse_string!()
  |> Sourceror.Zipper.zip()

Common.node_matches_pattern?(list_zipper, value when is_list(value)) # true
```

### Igniter.Code.Common.nodes_equal?/2 (function)



### Igniter.Code.Common.nth_right/2 (function)



### Igniter.Code.Common.parse_to_zipper!/1 (function)



### Igniter.Code.Common.remove/2 (function)

Removes any nodes matching the provided pattern, until there are no matches left.

### Igniter.Code.Common.remove_all_matches/2 (function)

Removes all nodes matching the given predicate with the given function.

Recurses until the predicate no longer returns false

### Igniter.Code.Common.replace_code/2 (function)

Replaces code with new code.

### Igniter.Code.Common.rightmost/1 (function)

Moves the zipper all the way to the right, potentially entering a single value block.

### Igniter.Code.Common.single_child_block?/1 (function)



### Igniter.Code.Common.update_all_matches/3 (function)

Updates all nodes matching the given predicate with the given function.

Recurses until the predicate no longer returns false

### Igniter.Code.Common.use_aliases/2 (function)

Replaces full module names in `new_code` with any aliases for that
module found in the `current_code` environment.

### Igniter.Code.Common.variable?/2 (function)

Returns true if the node represents a variable with the given name

### Igniter.Code.Common.variable_assignment?/2 (function)

Returns true if the node represents a variable assignment

### Igniter.Code.Common.within/2 (function)

Runs the function `fun` on the subtree of the currently focused `node` and
returns the updated `zipper`.

`fun` must return {:ok, zipper} or `:error`, which may be positioned at the top of the subtree.

### Igniter.Code.Function (module)

Utilities for working with functions.

### Igniter.Code.Function.append_argument/2 (function)

Appends an argument to a function call, leaving the zipper at the function call's node.

### Igniter.Code.Function.argument_equals?/3 (function)

Checks if the provided function call (in a Zipper) has an argument that equals
`term` at `index`.

### Igniter.Code.Function.argument_matches_pattern?/3 (macro)

Returns `true` if the argument at the provided index exists and matches the provided pattern

Note: to check for argument equality, use `argument_equals?/3` instead.

### Igniter.Code.Function.argument_matches_predicate?/3 (function)

Returns true if the argument at the given index matches the provided predicate

### Igniter.Code.Function.function/3 (function)



### Igniter.Code.Function.function?/3 (function)

Returns true if the value is a function literal.

Examples:
  - `fn x -> x end`
  - `&(&1 + &2)`
  - `&SomeMod.fun/2`

To refine the check, you can use `name` and `arity`.

### Names - Igniter.Code.Function.function?/3 (function)

- `:any` - matches any function literal, named or not
- `:any_named` - matches any named function literal
- `:anonymous` - matches any anonymous function literal
- `{module, name}` - matches a function literal with the given module and name

### Igniter.Code.Function.function_call?/1 (function)

Returns `true` if the node is a function call

### Igniter.Code.Function.function_call?/3 (function)

Returns `true` if the node is a function call of the given name

If an `atom` is provided, it only matches functions in the form of `function(name)`.

If an `{module, atom}` is provided, it matches functions called on the given module,
taking into account any imports or aliases.

### Igniter.Code.Function.get_local_function_call/1 (function)

Gets the name and arity of a local function call.

Returns `:error` if the node is not a function call or cannot be determined.

### Igniter.Code.Function.get_local_function_call_name/1 (function)

Gets the name of a local function call.

Returns `:error` if the node is not a function call or cannot be determined.

### Igniter.Code.Function.move_to_def/1 (function)



### Igniter.Code.Function.move_to_def/3 (function)



### Igniter.Code.Function.move_to_defp/3 (function)



### Igniter.Code.Function.move_to_function_call/4 (function)

Moves to a function call by the given name and arity, matching the given predicate, in the current or lower scope

### Igniter.Code.Function.move_to_function_call_in_current_scope/4 (function)

Moves to a function call by the given name and arity, matching the given predicate, in the current scope

### Igniter.Code.Function.move_to_nth_argument/2 (function)

Moves to the `nth` argument of a function call.

### Igniter.Code.Function.update_nth_argument/3 (function)

Updates the `nth` argument of a function call, leaving the zipper at the function call's node.

### Igniter.Code.Keyword (module)

Utilities for working with keyword.

### Igniter.Code.Keyword.get_key/2 (function)

Moves the zipper to the value of `key` in a keyword list.

### Igniter.Code.Keyword.keyword_has_path?/2 (function)

Returns true if the node is a nested keyword list containing a value at the given path.

### Igniter.Code.Keyword.keywordify/2 (function)

Puts into nested keyword lists represented by `path`

### Igniter.Code.Keyword.put_in_keyword/4 (function)

Puts a value at a path into a keyword, calling `updater` on the zipper at the value if the key is already present

### Igniter.Code.Keyword.remove_keyword_key/2 (function)

Removes a key from a keyword list if present. Returns `:error` only if the node is not a list

### Igniter.Code.Keyword.set_keyword_key/4 (function)



### Igniter.Code.List (module)

Utilities for working with lists.

### Igniter.Code.List.append_new_to_list/3 (function)

Appends `quoted` to the list unless it is already present, determined by `equality_pred`.

### Igniter.Code.List.append_to_list/2 (function)

Appends `quoted` to the list

### Igniter.Code.List.do_move_to_list_item/2 (function)

Moves to the list item matching the given predicate, assuming you are currently inside the list

### Igniter.Code.List.equality_pred/0 (type)



### Igniter.Code.List.find_list_item_index/2 (function)

Finds the index of the first list item that satisfies `pred`

### Igniter.Code.List.list?/1 (function)

Returns true if the `zipper` is at a list literal

### Igniter.Code.List.map/2 (function)

Moves to the list item matching the given predicate

### Igniter.Code.List.move_to_list_item/2 (function)

Moves to the list item matching the given predicate

### Igniter.Code.List.prepend_new_to_list/3 (function)

Prepends `quoted` to the list unless it is already present, determined by `equality_pred`.

### Igniter.Code.List.prepend_to_list/2 (function)

Prepends `quoted` to the list

### Igniter.Code.List.remove_from_list/2 (function)



### Igniter.Code.List.remove_index/2 (function)

Removes the item at the given index, returning `:error` if nothing is at that index

### Igniter.Code.List.replace_in_list/3 (function)



### Igniter.Code.Map (module)

Utilities for working with maps.

### Igniter.Code.Map.mappify/2 (function)

Puts a value into nested maps at the given path

### Igniter.Code.Map.put_in_map/4 (function)

Puts a value at a path into a map, calling `updater` on the zipper at the value if the key is already present

### Igniter.Code.Map.set_map_key/4 (function)

Puts a key into a map, calling `updater` on the zipper at the value if the key is already present

### Igniter.Code.Module (module)

Utilities for working with Elixir modules

### Igniter.Code.Module.create_module/4 (function)

Creates a new file & module in its appropriate location.

### Igniter.Code.Module.find_all_matching_modules/2 (function)



### Igniter.Code.Module.find_and_update_module/3 (function)

Finds a module and updates its contents. Returns `{:error, igniter}` if the module could not be found. Do not discard this igniter.

### Igniter.Code.Module.find_and_update_module!/3 (function)



### Igniter.Code.Module.find_and_update_or_create_module/5 (function)

Finds a module and updates its contents wherever it is.

If the module does not yet exist, it is created with the provided contents. In that case,
the path is determined with `Igniter.Code.Module.proper_location/2`, but may optionally be overwritten with options below.

# Options

- `:path` - Path where to create the module, relative to the project root. Default: `nil` (uses `:kind` to determine the path).

### Igniter.Code.Module.find_module/2 (function)

Finds a module, returning a new igniter, and the source and zipper location. This new igniter should not be discarded.

In general, you should not use the returned source and zipper to update the module, instead, use this to interrogate
the contents or source in some way, and then call `find_and_update_module/3` with a function to perform an update.

### Igniter.Code.Module.find_module!/2 (function)

Finds a module, raising an error if its not found.

See `find_module/2` for more information.

### Igniter.Code.Module.module?/1 (function)



### Igniter.Code.Module.module_exists?/2 (function)

Checks if a module is defined somewhere in the project. The returned igniter should not be discarded.

### Igniter.Code.Module.module_matching?/2 (function)

Checks if the value is a module that matches a given predicate

### Igniter.Code.Module.module_name/1 (function)

Given a suffix, returns a module name with the prefix of the current project.

### Igniter.Code.Module.module_name/2 (function)

Given a suffix, returns a module name with the prefix of the current project.

### Igniter.Code.Module.module_name_prefix/0 (function)

The module name prefix based on the mix project's module name

### Igniter.Code.Module.module_name_prefix/1 (function)

The module name prefix based on the mix project's module name

### Igniter.Code.Module.move_to_attribute_definition/2 (function)

Move to an attribute definition inside a module.

### Example - Igniter.Code.Module.move_to_attribute_definition/2 (function)

Given this module:

    defmodule MyAppWeb.Endpoint do
      @doc "My App Endpoint"

      @session_options [
        store: :cookie,
        ...
      ]
    end

You can move into `@doc` attribute with:

    Igniter.Code.Module.move_to_attribute_definition(zipper, :doc)

Or you can move into `@session_options` constant with:

    Igniter.Code.Module.move_to_attribute_definition(zipper, :session_options)

### Igniter.Code.Module.move_to_def/3 (function)



### Igniter.Code.Module.move_to_defmodule/1 (function)

Moves the zipper to a defmodule call

### Igniter.Code.Module.move_to_defmodule/2 (function)

Moves the zipper to a specific defmodule call

### Igniter.Code.Module.move_to_defp/3 (function)



### Igniter.Code.Module.move_to_module_using/2 (function)

Moves the zipper to the body of a module that `use`s the provided module (or one of the provided modules).

### Igniter.Code.Module.move_to_use/2 (function)

Moves the zipper to the `use` statement for a provided module.

### Igniter.Code.Module.move_to_using/2 (function)



### Igniter.Code.Module.parse/1 (function)

Parses a string into a module name

### Igniter.Code.Module.proper_location/2 (function)

Returns the idiomatic file location for a given module, starting with "lib/".

### Igniter.Code.Module.proper_test_location/1 (function)

Returns the test file location for a given module, according to
`mix test` expectations, starting with "test/" and ending with "_test.exs".

### Igniter.Code.Module.proper_test_support_location/1 (function)

Returns the test support location for a given module, starting with
"test/support/" and dropping the module name prefix in the path.

### Igniter.Code.String (module)

Utilities for working with strings.

### Igniter.Code.String.string?/1 (function)

Returns true if the node represents a literal string, false otherwise.

### Igniter.Code.String.update_string/2 (function)

Updates a node representing a string with the result of the given function

### Igniter.Code.Tuple (module)

Utilities for working with tuples.

### Igniter.Code.Tuple.append_elem/2 (function)

Appends `quoted` to the elem

### Igniter.Code.Tuple.elem_equals?/3 (function)



### Igniter.Code.Tuple.tuple?/1 (function)

Returns `true` if the zipper is at a literal tuple, `false` if not.

### Igniter.Code.Tuple.tuple_elem/2 (function)

Returns a zipper at the tuple element at the given index, or `:error` if the index is out of bounds.

### Igniter.Extension (behaviour)

Alter igniter's behavior by adding new functionality.

This is used to allow frameworks to modify things like
the conventional location of files.

### Igniter.Extension.proper_location/3 (callback)

Choose a proper location for any given module.

Possible return values:

- `{:ok, path}`: The path where the module should be located.
- `:error`: It should go in the default place, or according to other extensions.
- `:keep`: Keep the module in the same location, unless another extension has a place for it, or its just been created.

### Igniter.Extensions.Phoenix (module)

A phoenix extension for Igniter.

Install with `mix igniter.add_extension phoenix`

### Igniter.Extensions.Phoenix.proper_location/3 (function)



### Igniter.Libs.Ecto (module)

Codemods & utilities for working with Ecto

### Igniter.Libs.Ecto.gen_migration/4 (function)

Generates a new migration file for the given repo.

### Options - Igniter.Libs.Ecto.gen_migration/4 (function)

- `:body` - the body of the migration
- `:timestamp` - the timestamp to use for the migration.
   Primarily useful for testing so you know what the filename will be.
- `:on_exists` - what to do if the migration *module* already exists. Options are:
  - `:increment` - Calls this function again, but with an increasing number at the end, until it finds a free name. (default)
  - `:skip` - do nothing
  - `:overwrite` - overwrites the file
  - `{:error, error}` - adds an issue to the igniter that prevents writing and displays to the user
  - `{:warning, warning}` - adds a warning to the igniter that allows writing but displays to the user

### Igniter.Libs.Ecto.list_repos/1 (function)

Lists all the ecto repos in the project

### Igniter.Libs.Ecto.select_repo/2 (function)

Selects a repo module from the list of available repos.

### Options - Igniter.Libs.Ecto.select_repo/2 (function)

* `:label` - The label to display to the user when selecting the repo

### Igniter.Libs.Phoenix (module)

Codemods & utilities for working with Phoenix

### Igniter.Libs.Phoenix.add_pipeline/4 (function)

Adds a pipeline to a Phoenix router.

### Options - Igniter.Libs.Phoenix.add_pipeline/4 (function)

* `:router` - The router module to append to. Will be looked up if not provided.
* `:arg2` - The second argument to the scope macro. Must be a value (typically a module).

### Igniter.Libs.Phoenix.add_scope/4 (function)

Adds a scope to a Phoenix router.

### Options - Igniter.Libs.Phoenix.add_scope/4 (function)

- `:router` - The router module to append to. Will be looked up if not provided.
- `:arg2` - The second argument to the scope macro. Must be a value (typically a module).
- `:placement` - `:before` | `:after`. Determines where the `contents` will be placed:
  - `:before` - place before the first scope in the module if one is found, otherwise tries to place
     after the last pipeline or after the `use MyAppWeb, :router` call.
  - `:after` - place at the end (bottom) of the module, after all scopes and pipelines.

### Igniter.Libs.Phoenix.append_to_pipeline/4 (function)

Appends code to a Phoenix router pipeline.

### Options - Igniter.Libs.Phoenix.append_to_pipeline/4 (function)

* `:router` - The router module to append to. Will be looked up if not provided.

### Igniter.Libs.Phoenix.append_to_scope/4 (function)

Appends to a phoenix router scope.

Relatively limited currently only exact matches of a top level route, second argument, and pipelines.

### Options - Igniter.Libs.Phoenix.append_to_scope/4 (function)

* `:router` - The router module to append to. Will be looked up if not provided.
* `:arg2` - The second argument to the scope macro. Must be a value (typically a module).
* `:with_pipelines` - A list of pipelines that the pipeline must be using to be considered a match.
- `:placement` - `:before` | `:after`. Determines where the `contents` will be placed. Note that it first tries
  to find a matching scope and place the contents into that scope, otherwise `:placement` is used to determine
  where to place the contents:
  * `:before` - place before the first scope in the module if one is found, otherwise tries to place
     after the last pipeline or after the `use MyAppWeb, :router` call.
  * `:after` - place at the end (bottom) of the module, after all scopes and pipelines.

### Igniter.Libs.Phoenix.controller?/2 (function)

Returns `true` if the module is a Phoenix controller

### Igniter.Libs.Phoenix.endpoints_for_router/2 (function)

Gets the list of endpoints that use a given router

### Igniter.Libs.Phoenix.has_pipeline/3 (function)

Returns `{igniter, true}` if a pipeline exists in a Phoenix router, and `{igniter, false}` otherwise.

### Options - Igniter.Libs.Phoenix.has_pipeline/3 (function)

* `:router` - The router module to append to. Will be looked up if not provided.
* `:arg2` - The second argument to the scope macro. Must be a value (typically a module).

### Igniter.Libs.Phoenix.html?/2 (function)

Returns `true` if the module is a Phoenix HTML module

### Igniter.Libs.Phoenix.list_routers/1 (function)

Lists all routers found in the project.

### Igniter.Libs.Phoenix.move_to_router_use/2 (function)

Moves to the use statement in a module that matches `use TheirAppWeb, :router`

### Igniter.Libs.Phoenix.prepend_to_pipeline/4 (function)

Prepends code to a Phoenix router pipeline.

### Options - Igniter.Libs.Phoenix.prepend_to_pipeline/4 (function)

* `:router` - The router module to append to. Will be looked up if not provided.

### Igniter.Libs.Phoenix.select_endpoint/3 (function)

Selects an endpoint to be used in a later step. If only one endpoint is found, it will be selected automatically.

If no endpoints exist, `{igniter, nil}` is returned.

If multiple endpoints are found, the user is prompted to select one of them.

### Igniter.Libs.Phoenix.select_router/2 (function)

Selects a router to be used in a later step. If only one router is found, it will be selected automatically.

If no routers exist, `{igniter, nil}` is returned.

If multiple routes are found, the user is prompted to select one of them.

### Igniter.Libs.Phoenix.web_module/1 (function)

Returns the web module name for the current app

### Igniter.Libs.Phoenix.web_module_name/0 (function)

Returns the web module name for the current app

### Igniter.Libs.Phoenix.web_module_name/1 (function)

Generates a module name that lives in the Web directory of the current app.

### Igniter.Libs.Phoenix.web_module_name/2 (function)

Generates a module name that lives in the Web directory of the current app.

### Igniter.Libs.Swoosh (module)

Codemods & utilities for working with Swoosh

### Igniter.Libs.Swoosh.list_mailers/1 (function)

Lists all project modules that call `use Swoosh.Mailer`.

### Igniter.Libs.Swoosh.move_to_mailer_use/1 (function)

Moves to the use statement in a module that matches `use Swoosh.Mailer`

### Igniter.Util.BackwardsCompat (module)

Contains functions that we need to use that were introduced in newer Elixir versions.

### Igniter.Util.BackwardsCompat.relative_to_cwd/2 (function)



### Igniter.Util.Debug (module)

Tools for debugging zippers.

### Igniter.Util.Debug.code_at_node/1 (function)

Returns the formatted code at the node of the zipper to the console

### Igniter.Util.Debug.puts_ast_at_node/1 (function)

Puts the ast at the node of the zipper to the console

### Igniter.Util.Debug.puts_code_at_node/1 (function)

Puts the formatted code at the node of the zipper to the console

### Igniter.Util.IO (module)

Helpers for working with input/output

### Igniter.Util.IO.select/3 (function)

Prompts the user to select from a list, repeating until an item is selected

### Options - Igniter.Util.IO.select/3 (function)

- `display`: A function that takes an item and returns a string to display

### Igniter.Util.IO.yes?/1 (function)

Prompts the user for yes or no, repeating the prompt until a satisfactory answer is given

### Igniter.Util.Install (module)

Tools for installing packages and running their associated
installers, if present.

[!NOTE]
The functions in this module are not composable, and are primarily meant to
be used internally and to support building custom tooling on top of Igniter,
such as [Fireside](https://github.com/ibarakaiev/fireside).

### Igniter.Util.Install.get_deps!/2 (function)



### Igniter.Util.Install.install/4 (function)

Installs the provided list of dependencies. `deps` can be either:
- a string like `"ash,ash_postgres"`
- a list of strings like `["ash", "ash_postgres", ...]`
- a list of tuples like `[{:ash, "~> 3.0"}, {:ash_postgres, "~> 2.0"}]`

### Igniter.Util.Loading (module)

Utilities for doing operations with loading spinners.

### Igniter.Util.Loading.spawn_loader/1 (function)



### Igniter.Util.Loading.with_log/2 (function)



### Igniter.Util.Loading.with_spinner/3 (function)

Runs the function with a loading spinner, suppressing all output.

### Igniter.Util.Version (module)

Utilities for working versions and version requirements

### Igniter.Util.Version.version_string_to_general_requirement/1 (function)



### Igniter.Util.Version.version_string_to_general_requirement!/1 (function)

Provides a general requirement for a given version string.

For example

`3.1.2` would be `~> 3.0`
and
`0.2.4` would be `~> 0.2`

### Igniter.Util.Warning (module)

Utilities for emitting well formatted warnings

### Igniter.Util.Warning.formatted_warning/2 (function)



### Igniter.Util.Warning.warn_with_code_sample/3 (function)



## Links

- [Online documentation](https://hexdocs.pm/igniter)# spark

> Generic tooling for building DSLs

## Docs

### Spark.Dsl (behaviour)

The primary entry point for defining a DSL.

To define a DSL, add `use Spark.Dsl, ...options`. The options supported with `use Spark.Dsl` are:

* `:single_extension_kinds` (list of `t:atom/0`) - The extension kinds that are allowed to have a single value. For example: `[:data_layer]` The default value is `[]`.

* `:many_extension_kinds` (list of `t:atom/0`) - The extension kinds that can have multiple values. e.g `[notifiers: [Notifier1, Notifier2]]` The default value is `[]`.

* `:untyped_extensions?` (`t:boolean/0`) - Whether or not to support an `extensions` key which contains untyped extensions The default value is `true`.

* `:extension_kind_types` (`t:keyword/0`) - A keyword list of extension kinds and their types, e.g `[authorizers: {:list, {:behaviour, Ash.Authorizer}}]` The default value is `[]`.

* `:extension_kind_docs` (`t:keyword/0`) - A keyword list of extension kinds and a short documentation snippet to be used when autocompleting that option The default value is `[]`.

* `:default_extensions` (`t:keyword/0`) - The extensions that are included by default. e.g `[data_layer: Default, notifiers: [Notifier1]]`
  Default values for single extension kinds are overwritten if specified by the implementor, while many extension
  kinds are appended to if specified by the implementor. The default value is `[]`.

* `:opt_schema` (`t:keyword/0`) - A schema for additional options to accept when calling `use YourSpark` The default value is `[]`.

* `:opts_to_document` - A list of `t:atom/0` or `:all`. Spark automatically detects options and documents them in `@moduledoc`.
  You can instruct Spark to use only a subset of options, e.g. `opts_to_document: [:fragments]`. The default value is `:all`.



See the callbacks defined in this module to augment the behavior/compilation of the module getting a Dsl.

### Schemas/Data Types - Spark.Dsl (behaviour)

For more information, see `Spark.Options`.

### Spark.Dsl.entity/0 (type)



### Spark.Dsl.explain/2 (callback)

Validate/add options. Those options will be passed to `handle_opts` and `handle_before_compile`

### Spark.Dsl.handle_before_compile/1 (callback)

Handle options in the context of the module, after all extensions have been processed. Must return a `quote` block.

### Spark.Dsl.handle_fragments/2 (function)



### Spark.Dsl.handle_opts/1 (callback)

Handle options in the context of the module. Must return a `quote` block.

If you want to persist anything in the DSL persistence layer,
use `@persist {:key, value}`. It can be called multiple times to
persist multiple times.

### Spark.Dsl.init/1 (callback)

Validate/add options. Those options will be passed to `handle_opts` and `handle_before_compile`

### Spark.Dsl.is?/2 (function)



### Spark.Dsl.opts/0 (type)



### Spark.Dsl.section/0 (type)



### Spark.Dsl.t/0 (type)



### Spark.Dsl.verify/2 (callback)

A callback that is called in the `after_verify` hook. Only runs on versions of Elixir >= 1.14.0

### Spark.Dsl.Builder (module)

Utilities for building DSL objects programatically, generally used in transformers.

### Spark.Dsl.Builder.defbuilder/2 (macro)



### Spark.Dsl.Builder.defbuilderp/2 (macro)



### Spark.Dsl.Builder.handle_nested_builders/2 (function)

Handles nested values that may be `{:ok, result}` or `{:error, term}`, returning any errors and unwrapping any ok values

This allows users of builders to do things like:

```elixir
dsl_state
|> Ash.Resource.Builder.add_new_action(:update, :publish,
  changes: [
    Ash.Resource.Builder.build_action_change(
      Ash.Resource.Change.Builtins.set_attribute(:state, :published)
    )
  ]
)
```

If your builder function calls `handle_nested_builders/2` with their input before building the thing its building.

### Spark.Dsl.Builder.input/0 (type)



### Spark.Dsl.Builder.result/0 (type)



### Spark.Dsl.Entity (module)

Declares a DSL entity.

A dsl entity represents a dsl constructor who's resulting value is a struct.
This lets the user create complex objects with arbitrary(mostly) validation rules.

The lifecycle of creating entities is complex, happening as Elixir is compiling
the modules in question. Some of the patterns around validating/transforming entities
have not yet solidified. If you aren't careful and don't follow the guidelines listed
here, you can have subtle and strange bugs during compilation. Anything not isolated to
simple value validations should be done in `transformers`. See `Spark.Dsl.Transformer`.

An entity has a `target` indicating which struct will ultimately be built. An entity
also has a `schema`. This schema is used for documentation, and the options are validated
against it before continuing on with the DSL.

To create positional arguments to the builder, use `args`. The values provided to
`args` need to be in the provided schema as well. They will be positional arguments
in the same order that they are provided in the `args` key.

`auto_set_fields` will set the provided values into the produced struct (they do not need
to be included in the schema).

`transform` is a function that takes a created struct and can alter it. This happens immediately
after handling the DSL options, and can be useful for setting field values on a struct based on
other values in that struct. If you need things that aren't contained in that struct, use an
`Spark.Dsl.Transformer`. This function returns `{:ok, new_entity}` or `{:error, error}`, so this can
also be used to validate the entity.

`entities` allows you to specify a keyword list of nested entities. Nested entities are stored
on the struct in the corresponding key, and are used in the same way entities are otherwise.

`singleton_entity_keys` specifies a set of entity keys (specified above) that should only have a
single value. This will be validated and unwrapped into `nil` | `single_value` on success.

`identifier` expresses that a given entity is unique by that field, validated by the DSL.

### Example - Spark.Dsl.Entity (module)

```elixir
@my_entity %Spark.Dsl.Entity{
  name: :my_entity,
  target: MyStruct,
  schema: [my_field: [type: :atom, required: false]]
}
```

Once compiled by Spark, entities can be invoked with a keyword list:

```elixir
my_entity my_field: :value
```

Or with a do block:

```elixir
my_entity do
  my_field :value
end
```

For a full example, see `Spark.Dsl.Extension`.

### Spark.Dsl.Entity.args/0 (type)

Specifies positional arguments for an Entity.

An entity declared like this:

```elixir
@entity %Spark.Dsl.Entity{
  name: :entity,
  target: Entity,
  schema: [
    positional: [type: :atom, required: true],
    other: [type: :atom, required: false],
  ],
  args: [:positional]
}
```

Can be instantiated like this:

```elixir
entity :positional_argument do
  other :other_argument
end
```

### Spark.Dsl.Entity.auto_set_fields/0 (type)

Set the provided key value pairs in the produced struct. These fields do not need to be included in the Entity's schema.

### Spark.Dsl.Entity.deprecations/0 (type)



### Spark.Dsl.Entity.describe/0 (type)

User provided documentation.

Documentation provided in a `Entity`'s `describe` field will be included by `Spark` in any generated documentation that includes the `Entity`.

### Spark.Dsl.Entity.docs/0 (type)

Internal field. Not set by user.

### Spark.Dsl.Entity.entities/0 (type)

A keyword list of nested entities.

### Spark.Dsl.Entity.examples/0 (type)



### Spark.Dsl.Entity.hide/0 (type)



### Spark.Dsl.Entity.id/0 (type)



### Spark.Dsl.Entity.imports/0 (type)



### Spark.Dsl.Entity.links/0 (type)



### Spark.Dsl.Entity.modules/0 (type)



### Spark.Dsl.Entity.name/0 (type)



### Spark.Dsl.Entity.no_depend_modules/0 (type)



### Spark.Dsl.Entity.recursive_as/0 (type)



### Spark.Dsl.Entity.singleton_entity_keys/0 (type)



### Spark.Dsl.Entity.snippet/0 (type)



### Spark.Dsl.Entity.t/0 (type)



### Spark.Dsl.Entity.target/0 (type)

Defines the struct that will be built from this entity definition.

The struct will need to have fields for all [`entities`](#t:entities/0), `t:schema/0` fields, and `t:auto_set_fields/0`.

### Spark.Dsl.Entity.transform/0 (type)

Specifies a function that will run on the target struct after building.

```elixir
@my_entity %Spark.Dsl.Entity{
  name: :my_entity,
  target: MyEntity,
  schema: [
    my_field: [type: :list, required: true]
  ],
  transform: {MyModule, :max_three_items, []}
}

def max_three_items(my_entity) do
  if length(my_entity.my_field) > 3 do
    {:error, "Can't have more than three items"}
  else
    {:ok, my_entity}
  end
end
```

### Spark.Dsl.Extension (behaviour)

An extension to the Spark DSL.

This allows configuring custom DSL components, whose configurations
can then be read back. This guide is still a work in progress, but should
serve as a decent example of what is possible. Open issues on Github if you
have any issues/something is unclear.

The example at the bottom shows how you might build a (not very contextually
relevant) DSL extension that would be used like so:

    defmodule MyApp.Vehicle do
      use Spark.Dsl
    end

    defmodule MyApp.MyResource do
      use MyApp.Vehicle,
        extensions: [MyApp.CarExtension]

      cars do
        car :ford, :focus, trim: :sedan
        car :toyota, :corolla
      end
    end

The extension:

    defmodule MyApp.CarExtension do
      @car_schema [
        make: [
          type: :atom,
          required: true,
          doc: "The make of the car"
        ],
        model: [
          type: :atom,
          required: true,
          doc: "The model of the car"
        ],
        type: [
          type: :atom,
          required: true,
          doc: "The type of the car",
          default: :sedan
        ]
      ]

      @car %Spark.Dsl.Entity{
        name: :car,
        describe: "Adds a car",
        examples: [
          "car :ford, :focus"
        ],
        target: MyApp.Car,
        args: [:make, :model],
        schema: @car_schema
      }

      @cars %Spark.Dsl.Section{
        name: :cars, # The DSL constructor will be `cars`
        describe: """
        Configure what cars are available.

        More, deeper explanation. Always have a short one liner explanation,
        an empty line, and then a longer explanation.
        """,
        entities: [
          @car # See `Spark.Dsl.Entity` docs
        ],
        schema: [
          default_manufacturer: [
            type: :atom,
            doc: "The default manufacturer"
          ]
        ]
      }

      use Spark.Dsl.Extension, sections: [@cars]
    end


Often, we will need to do complex validation/validate based on the configuration
of other resources. Due to the nature of building compile time DSLs, there are
many restrictions around that process. To support these complex use cases, extensions
can include `transformers` which can validate/transform the DSL state after all basic
sections/entities have been created. See `Spark.Dsl.Transformer` for more information.
Transformers are provided as an option to `use`, like so:

    use Spark.Dsl.Extension, sections: [@cars], transformers: [
      MyApp.Transformers.ValidateNoOverlappingMakesAndModels
    ]

By default, the generated modules will have names like `__MODULE__.SectionName.EntityName`, and that could
potentially conflict with modules you are defining, so you can specify the `module_prefix` option, which would allow
you to prefix the modules with something like `__MODULE__.Dsl`, so that the module path generated might be something like
`__MODULE__.Dsl.SectionName.EntityName`, and you could then have the entity struct be `__MODULE__.SectionName.EntityName`
without conflicts.

To expose the configuration of your DSL, define functions that use the
helpers like `get_entities/2` and `get_opt/3`. For example:

    defmodule MyApp.Cars do
      def cars(resource) do
        Spark.Dsl.Extension.get_entities(resource, [:cars])
      end
    end

    MyApp.Cars.cars(MyResource)
    # [%MyApp.Car{...}, %MyApp.Car{...}]

See the documentation for `Spark.Dsl.Section` and `Spark.Dsl.Entity` for more information

### Spark.Dsl.Extension.add_extensions/0 (callback)



### Spark.Dsl.Extension.doc/2 (function)

See  Spark.CheatSheet.doc/2 .

### Spark.Dsl.Extension.doc_index/2 (function)

See  Spark.CheatSheet.doc_index/2 .

### Spark.Dsl.Extension.expand_alias/2 (function)



### Spark.Dsl.Extension.expand_alias_no_require/2 (function)



### Spark.Dsl.Extension.expand_literals/3 (function)



### Spark.Dsl.Extension.explain/1 (callback)



### Spark.Dsl.Extension.fetch_opt/4 (function)



### Spark.Dsl.Extension.fetch_persisted/2 (function)

Fetch a value that was persisted while transforming or compiling the resource, e.g `:primary_key`

### Spark.Dsl.Extension.get_entities/2 (function)

Get the entities configured for a given section

### Spark.Dsl.Extension.get_entity_dsl_patches/2 (function)



### Spark.Dsl.Extension.get_opt/5 (function)

Get an option value for a section at a given path.

Checks to see if it has been overridden via configuration.

### Spark.Dsl.Extension.get_opt_config/3 (function)



### Spark.Dsl.Extension.get_persisted/3 (function)

Get a value that was persisted while transforming or compiling the resource, e.g `:primary_key`

### Spark.Dsl.Extension.get_recursive_entities_for_path/2 (function)



### Spark.Dsl.Extension.module_concat/1 (function)



### Spark.Dsl.Extension.module_imports/0 (callback)



### Spark.Dsl.Extension.monotonic_number/1 (function)



### Spark.Dsl.Extension.persisters/0 (callback)



### Spark.Dsl.Extension.run_transformers/4 (function)



### Spark.Dsl.Extension.sections/0 (callback)



### Spark.Dsl.Extension.shuffle_opts_to_end/5 (function)



### Spark.Dsl.Extension.spark_function_info/1 (function)



### Spark.Dsl.Extension.t/0 (type)



### Spark.Dsl.Extension.transformers/0 (callback)



### Spark.Dsl.Extension.verifiers/0 (callback)



### Spark.Dsl.Fragment (module)

Allows splitting up a DSL into multiple modules, potentially organizing large DSLs

Use the `of` option to expression what your fragment is a fragment of. You can add
extensions as you would normally to that resource, and they will be added to the
parent resource.

    defmodule MyApp.Resource.Graphql do
      use Spark.Dsl.Fragment, of: Ash.Resource, extensions: AshGraphql.Resource

      graphql do
        ...
      end
    end

Then add the fragment to the parent resource.

    defmodule MyApp.Resource do
      use Ash.Resource, fragments: [MyApp.Resource.Graphql], ...
    end

### Spark.Dsl.Patch.AddEntity (module)

Supply this when defining an extension to add entity builders to another extension's section.

For example

```elixir
@entity %Spark.Dsl.Entity{
  ...
}

@dsl_patch %Spark.Dsl.Patch.AddEntity{section_path: [:foo, :bar], entity: @entity}

use Spark.Dsl.Extension, dsl_patches: [@dsl_patch]
```

### Spark.Dsl.Patch.AddEntity.t/0 (type)



### Spark.Dsl.Section (module)

Declares a DSL section.

A dsl section allows you to organize related configurations. All extensions
configure sections, they cannot add DSL builders to the top level. This
keeps things organized, and concerns separated.

A section may have nested sections, which will be configured the same as other sections.
Getting the options/entities of a section is done by providing a path, so you would
use the nested path to retrieve that configuration. See `Spark.Dsl.Extension.get_entities/2`
and `Spark.Dsl.Extension.get_opt/4`.

A section may have entities, which are constructors that produce instances of structs.
For more on entities, see `Spark.Dsl.Entity`.

A section may also have a `schema`, which you can learn more about in `Spark.Options`. Spark will produce
builders for those options, so that they may be configured. They are retrieved with
`Spark.Dsl.Extension.get_opt/4`.

To create a section that is available at the top level (i.e not  nested inside of its own name), use
`top_level?: true`. Remember, however, that this has no effect on sections nested inside of other sections.

For a full example, see `Spark.Dsl.Extension`.

### Spark.Dsl.Section.auto_set_fields/0 (type)



### Spark.Dsl.Section.describe/0 (type)

User provided documentation.

Documentation provided in a `Section`'s `describe` field will be included by `Spark` in any generated documentation that includes the `Section`.

### Spark.Dsl.Section.docs/0 (type)

Internal field. Not set by user.

### Spark.Dsl.Section.entities/0 (type)



### Spark.Dsl.Section.examples/0 (type)



### Spark.Dsl.Section.imports/0 (type)



### Spark.Dsl.Section.links/0 (type)



### Spark.Dsl.Section.modules/0 (type)



### Spark.Dsl.Section.name/0 (type)



### Spark.Dsl.Section.no_depend_modules/0 (type)



### Spark.Dsl.Section.patchable?/0 (type)



### Spark.Dsl.Section.sections/0 (type)



### Spark.Dsl.Section.snippet/0 (type)



### Spark.Dsl.Section.t/0 (type)



### Spark.Dsl.Section.top_level?/0 (type)

Determines whether a section can be declared directly in a module.

When `top_level?: true`, that Section's DSL can be declared outside of a `do` block in a module.

### Example - Spark.Dsl.Section.top_level?/0 (type)

A `Section` declared with `top_level?: true`:

```elixir
@my_section %Spark.Dsl.Section{
  top_level?: true,
  name: :my_section,
  schema: [my_field: [type: :atom, required: true]]
}
```

Can be declared like this:

```elixir
defmodule MyDslModule do
  my_field :value
end
```

With `top_level?: false`, the DSL section would need to be declared explicitly/:

```elixir
defmodule MyDslModule do
  my_section do
    my_field :value
  end
end
```

### Spark.Dsl.Transformer (behaviour)

A transformer manipulates and/or validates the entire DSL state of a resource.

It's `transform/1` takes a `map`, which is just the values/configurations at each point
of the DSL. Don't manipulate it directly, if possible, instead use functions like
`get_entities/3` and `replace_entity/4` to manipulate it.

Use the `after?/1` and `before?/1` callbacks to ensure that your transformer
runs either before or after some other transformer.

Return `true` in `after_compile/0` to have the transformer run in an `after_compile` hook,
but keep in mind that no modifications to the dsl structure will be retained, so there is no
real point in modifying the dsl that you return.

### Spark.Dsl.Transformer.add_entity/4 (function)



### Spark.Dsl.Transformer.after?/1 (callback)



### Spark.Dsl.Transformer.after_compile?/0 (callback)



### Spark.Dsl.Transformer.async_compile/2 (function)

Runs the function in an async compiler.

Use this for compiling new modules and having them compiled
efficiently asynchronously.

### Spark.Dsl.Transformer.before?/1 (callback)



### Spark.Dsl.Transformer.build_entity/4 (function)



### Spark.Dsl.Transformer.build_entity!/4 (function)



### Spark.Dsl.Transformer.eval/3 (function)

Add a quoted expression to be evaluated in the DSL module's context.

Use this *extremely sparingly*. It should almost never be necessary, unless building certain
extensions that *require* the module in question to define a given function.

What you likely want is either one of the DSL introspection functions, like `Spark.Dsl.Extension.get_entities/2`
or `Spark.Dsl.Extension.get_opt/5)`. If you simply want to store a custom value that can be retrieved easily, or
cache some precomputed information onto the resource, use `persist/3`.

Provide the dsl state, bindings that should be unquote-able, and the quoted block
to evaluate in the module. For example, if we wanted to support a `resource.primary_key()` function
that would return the primary key (this is unnecessary, just an example), we might do this:

```elixir
fields = the_primary_key_fields

dsl_state =
  Spark.Dsl.Transformer.eval(
    dsl_state,
    [fields: fields],
    quote do
      def primary_key() do
        unquote(fields)
      end
    end
  )
```

### Spark.Dsl.Transformer.fetch_option/3 (function)



### Spark.Dsl.Transformer.fetch_persisted/2 (function)



### Spark.Dsl.Transformer.get_entities/2 (function)



### Spark.Dsl.Transformer.get_option/4 (function)



### Spark.Dsl.Transformer.get_persisted/3 (function)



### Spark.Dsl.Transformer.persist/3 (function)

Saves a value into the dsl config with the given key.

This can be used to precompute some information and cache it onto the resource,
or simply store a computed value. It can later be retrieved with `Spark.Dsl.Extension.get_persisted/3`.

### Spark.Dsl.Transformer.remove_entity/3 (function)



### Spark.Dsl.Transformer.replace_entity/4 (function)



### Spark.Dsl.Transformer.set_option/4 (function)



### Spark.Dsl.Transformer.sort/1 (function)



### Spark.Dsl.Transformer.transform/1 (callback)



### Spark.Dsl.Verifier (behaviour)

A verifier gets the dsl state and can return `:ok` or `:error`.

In a verifier, you can reference and depend on other modules without causing compile time dependencies.

### Spark.Dsl.Verifier.fetch_option/3 (function)

See  Spark.Dsl.Transformer.fetch_option/3 .

### Spark.Dsl.Verifier.get_entities/2 (function)

See  Spark.Dsl.Transformer.get_entities/2 .

### Spark.Dsl.Verifier.get_option/3 (function)

See  Spark.Dsl.Transformer.get_option/3 .

### Spark.Dsl.Verifier.get_option/4 (function)

See  Spark.Dsl.Transformer.get_option/4 .

### Spark.Dsl.Verifier.get_persisted/2 (function)

See  Spark.Dsl.Transformer.get_persisted/2 .

### Spark.Dsl.Verifier.get_persisted/3 (function)

See  Spark.Dsl.Transformer.get_persisted/3 .

### Spark.Dsl.Verifier.verify/1 (callback)



### Spark.Dsl.Verifiers.VerifyEntityUniqueness (module)

Verifies that each entity that has an identifier is unique at each path.

### Spark.Dsl.Verifiers.VerifyEntityUniqueness.verify/1 (function)

Callback implementation for  Spark.Dsl.Verifier.verify/1 .

### Spark.Options (module)

Provides a standard API to handle keyword-list-based options.

This module began its life as a vendored form of `NimbleOptions`,
meaning that we copied it from `NimbleOptions` into `Spark`.
We had various features to add to it, and the spirit of nimble
options is to be as lightweight as possible. With that in mind,
we were advised to vendor it. We would like to thank the authors
of `NimbleOptions` for their excellent work, and their blessing
to transplant their work into Spark.

`Spark.Options` allows developers to create schemas using a
pre-defined set of options and types. The main benefits are:

  * A single unified way to define simple static options
  * Config validation against schemas
  * Automatic doc generation
  * More types over what is provided by `NimbleOptions`
  * Compile time validators that are highly optimized and produce structs. See `Spark.Options.Validator`.
  * Shared logic between Spark DSLs and options lists.

### Schema Options - Spark.Options (module)

These are the options supported in a *schema*. They are what
defines the validation for the items in the given schema.

* `:type` - The type of the option item. The default value is `:any`.

* `:required` (`t:boolean/0`) - Defines if the option item is required. The default value is `false`.

* `:default` (`t:term/0`) - The default value for the option item if that option is not specified. This value
  is *validated* according to the given `:type`. This means that you cannot
  have, for example, `type: :integer` and use `default: "a string"`.

* `:keys` (`t:keyword/0`) - Available for types `:keyword_list`, `:non_empty_keyword_list`, and `:map`,
  it defines which set of keys are accepted for the option item. The value of the
  `:keys` option is a schema itself. For example: `keys: [foo: [type: :atom]]`.
  Use `:*` as the key to allow multiple arbitrary keys and specify their schema:
  `keys: [*: [type: :integer]]`.

* `:deprecated` (`t:String.t/0`) - Defines a message to indicate that the option item is deprecated. The message will be displayed as a warning when passing the item.

* `:private?` (`t:boolean/0`) - Defines an option as private, used with `Spark.Options.Validator` The default value is `false`.

* `:hide` (one or a list of `t:atom/0`) - A list of keys that should be hidden when generating documentation

* `:as` (`t:atom/0`) - A name to remap the option to when used in DSLs. Not supported in regular option parsing

* `:snippet` (`t:String.t/0`) - A snippet to use when autocompleting DSLs. Not supported in regular option parsing

* `:links` (`t:term/0`) - A keyword list of links to include in DSL documentation for the option item.

* `:doc` (`t:String.t/0` or `false`) - The documentation for the option item.

* `:subsection` (`t:String.t/0`) - The title of separate subsection of the options' documentation

* `:type_doc` (`t:String.t/0` or `false`) - The type doc to use *in the documentation* for the option item. If `false`,
  no type documentation is added to the item. If it's a string, it can be
  anything. For example, you can use `"a list of PIDs"`, or you can use
  a typespec reference that ExDoc can link to the type definition, such as
  `` "`t:binary/0`" ``. You can use Markdown in this documentation. If the
  `:type_doc` option is not present, Spark.Options tries to produce a type
  documentation automatically if it can do it unambiguously. For example,
  if `type: :integer`, Spark.Options will use `t:integer/0` as the
  auto-generated type doc.

* `:type_spec` (`t:Macro.t/0`) - The quoted spec to use *in the typespec* for the option item. You should use this
  when the auto-generated spec is not specific enough. For example, if you are performing
  custom validation on an option (with the `{:custom, ...}` type), then the
  generated type spec for that option will always be `t:term/0`, but you can use
  this option to customize that. The value for this option **must** be a quoted Elixir
  term. For example, if you have an `:exception` option that is validated with a
  `{:custom, ...}` type (based on `is_exception/1`), you can override the type
  spec for that option to be `quote(do: Exception.t())`. *Available since v1.1.0*.

### Types - Spark.Options (module)

* `:any` - Any type.

  * `:keyword_list` - A keyword list.

  * `:non_empty_keyword_list` - A non-empty keyword list.

  * `{:keyword_list, schema}` - A keyword list matching the given options schema.

  * `:non_empty_keyword_list` - A non-empty keyword list.

  * `{:non_empty_keyword_list, schema}` - A non-empty keyword list matching the given options schema.

  * `:map` - A map consisting of `:atom` keys. Shorthand for `{:map, :atom, :any}`.
    Keys can be specified using the `keys` option.

  * `{:map, key_type, value_type}` - A map consisting of `key_type` keys and
    `value_type` values.

  * `:atom` - An atom.

  * `:string` - A string.

  * `:boolean` - A boolean.

  * `:integer` - An integer.

  * `:non_neg_integer` - A non-negative integer.

  * `:pos_integer` - A positive integer.

  * `:float` - A float.

  * `:timeout` - A non-negative integer or the atom `:infinity`.

  * `:pid` - A PID (process identifier).

  * `:reference` - A reference (see `t:reference/0`).

  * `nil` - The value `nil` itself. Available since v1.0.0.

  * `:mfa` - A named function in the format `{module, function, arity}` where
    `arity` is a list of arguments. For example, `{MyModule, :my_fun, [arg1, arg2]}`.

  * `:mod_arg` - A module along with arguments, such as `{MyModule, arguments}`.
    Usually used for process initialization using `start_link` and similar. The
    second element of the tuple can be any term.

  * `:fun` - Any function.

  * `{:fun, arity}` - Any function with the specified arity.

  * `{:fun, args_types}` - A function with the specified arguments.

  * `{:fun, args_types, return_type}` - A function with the specified arguments and return type.

  * `{:in, choices}` or `{:one_of, choices}` - A value that is a member of one of the `choices`. `choices`
    should be a list of terms or a `Range`. The value is an element in said
    list of terms, that is, `value in choices` is `true`.

  * `{:struct, struct_name}` - An instance of the struct type given.

  * `:struct` - An instance of any struct

  * `{:tagged_tuple, tag, inner_type}` - maps to `{tag, type}`

  * `{:spark_behaviour, behaviour}` - expects a module that implements the given behaviour, and can be specified with options, i.e `mod` or `{mod, [opt: :val]}`

  * `{:spark_behaviour, behaviour, builtin_module}` - Same as the above, but also accepts a `builtin_module`. The builtin_module is used to provide additional options for the elixir_sense plugin.

  * `{:spark_function_behaviour, behaviour, {function_mod, arity}}` - expects a module that implements the given behaviour, and can be specified with options, i.e `mod` or `{mod, [opt: :val]}`, that also has a special module that supports being provided an anonymous function or MFA as the `:fun` option.

  * `{:spark_function_behaviour, behaviour, builtin_module, {function_mod, arity}}` - Same as the above, but also accepts a `builtin_module`. The builtin_module is used to provide additional options for the elixir_sense plugin.

  * `{:behaviour, behaviour}` - expects a module that implements a given behaviour.

  * `{:protocol, protocol}` - expects a value for which the protocol is implemented.

  * `{:impl, protocol}` - expects a module for which the protocol is implemented.

  * `{:spark, dsl_module}` - expects a module that is a `Spark.Dsl`

  * `{:mfa_or_fun, arity}` - expects a function or MFA of a corresponding arity.

  * `{:spark_type, module, builtin_function}` - a behaviour that defines `builtin_function/0` that returns a list of atoms that map to built in variations of that thing.

  * `{:spark_type, module, builtin_function, templates}` - same as the above, but includes additional templates for elixir_sense autocomplete

  * `:literal` -> any literal value. Maps to `:any`, but is used for documentation.

  * `{:literal, value}` -> exactly the value specified.

  * `:quoted` -> retains the quoted value of the code provided to the option

  * `{:wrap_list, type}` -> Allows a single value or a list of values.

  * `{:custom, mod, fun, args}` - A custom type. The related value must be validated
    by `mod.fun(values, ...args)`. The function should return `{:ok, value}` or
    `{:error, message}`.

  * `{:or, subtypes}` - A value that matches one of the given `subtypes`. The value is
    matched against the subtypes in the order specified in the list of `subtypes`. If
    one of the subtypes matches and **updates** (casts) the given value, the updated
    value is used. For example: `{:or, [:string, :boolean, {:fun, 2}]}`. If one of the
    subtypes is a keyword list or map, you won't be able to pass `:keys` directly. For this reason,
    `:keyword_list`, `:non_empty_keyword_list`, and `:map` are special cased and can
    be used as subtypes with `{:keyword_list, keys}`, `{:non_empty_keyword_list, keys}` or `{:map, keys}`.
    For example, a type such as `{:or, [:boolean, keyword_list: [enabled: [type: :boolean]]]}`
    would match either a boolean or a keyword list with the `:enabled` boolean option in it.

  * `{:list, subtype}` - A list where all elements match `subtype`. `subtype` can be any
    of the accepted types listed here. Empty lists are allowed. The resulting validated list
    contains the validated (and possibly updated) elements, each as returned after validation
    through `subtype`. For example, if `subtype` is a custom validator function that returns
    an updated value, then that updated value is used in the resulting list. Validation
    fails at the *first* element that is invalid according to `subtype`. If `subtype` is
    a keyword list or map, you won't be able to pass `:keys` directly. For this reason,
    `:keyword_list`, `:non_empty_keyword_list`, and `:map` are special cased and can
    be used as the subtype by using `{:keyword_list, keys}`, `{:non_empty_keyword_list, keys}`
    or `{:keyword_list, keys}`. For example, a type such as
    `{:list, {:keyword_list, enabled: [type: :boolean]}}` would a *list of keyword lists*,
    where each keyword list in the list could have the `:enabled` boolean option in it.

  * `{:tuple, list_of_subtypes}` - A tuple as described by `tuple_of_subtypes`.
    `list_of_subtypes` must be a list with the same length as the expected tuple.
    Each of the list's elements must be a subtype that should match the given element in that
    same position. For example, to describe 3-element tuples with an atom, a string, and
    a list of integers you would use the type `{:tuple, [:atom, :string, {:list, :integer}]}`.
    *Available since v0.4.1*.

### Example - Spark.Options (module)

iex> schema = [
    ...>   producer: [
    ...>     type: :non_empty_keyword_list,
    ...>     required: true,
    ...>     keys: [
    ...>       module: [required: true, type: :mod_arg],
    ...>       concurrency: [
    ...>         type: :pos_integer,
    ...>       ]
    ...>     ]
    ...>   ]
    ...> ]
    ...>
    ...> config = [
    ...>   producer: [
    ...>     concurrency: 1,
    ...>   ]
    ...> ]
    ...>
    ...> {:error, %Spark.Options.ValidationError{} = error} = Spark.Options.validate(config, schema)
    ...> Exception.message(error)
    "required :module option not found, received options: [:concurrency] (in options [:producer])"

### Nested Option Items - Spark.Options (module)

`Spark.Options` allows option items to be nested so you can recursively validate
any item down the options tree.

### Example - Spark.Options (module)

iex> schema = [
    ...>   producer: [
    ...>     required: true,
    ...>     type: :non_empty_keyword_list,
    ...>     keys: [
    ...>       rate_limiting: [
    ...>         type: :non_empty_keyword_list,
    ...>         keys: [
    ...>           interval: [required: true, type: :pos_integer]
    ...>         ]
    ...>       ]
    ...>     ]
    ...>   ]
    ...> ]
    ...>
    ...> config = [
    ...>   producer: [
    ...>     rate_limiting: [
    ...>       interval: :oops!
    ...>     ]
    ...>   ]
    ...> ]
    ...>
    ...> {:error, %Spark.Options.ValidationError{} = error} = Spark.Options.validate(config, schema)
    ...> Exception.message(error)
    "invalid value for :interval option: expected positive integer, got: :oops! (in options [:producer, :rate_limiting])"

### Validating Schemas - Spark.Options (module)

Each time `validate/2` is called, the given schema itself will be validated before validating
the options.

In most applications the schema will never change but validating options will be done
repeatedly.

To avoid the extra cost of validating the schema, it is possible to validate the schema once,
and then use that valid schema directly. This is done by using the `new!/1` function first, and
then passing the returned schema to `validate/2`.

> #### Create the Schema at Compile Time {: .tip}
>
> If your option schema doesn't include any runtime-only terms in it (such as anonymous
> functions), you can call `new!/1` to validate the schema and returned a *compiled* schema
> **at compile time**. This is an efficient way to avoid doing any unnecessary work at
> runtime. See the example below for more information.

### Example - Spark.Options (module)

iex> raw_schema = [
    ...>   hostname: [
    ...>     required: true,
    ...>     type: :string
    ...>   ]
    ...> ]
    ...>
    ...> schema = Spark.Options.new!(raw_schema)
    ...> Spark.Options.validate([hostname: "elixir-lang.org"], schema)
    {:ok, hostname: "elixir-lang.org"}

Calling `new!/1` from a function that receives options will still validate the schema each time
that function is called. Declaring the schema as a module attribute is supported:

    @options_schema Spark.Options.new!([...])

This schema will be validated at compile time. Calling `docs/1` on that schema is also
supported.

### Spark.Options.docs/2 (function)

Returns documentation for the given schema.

You can use this to inject documentation in your docstrings. For example,
say you have your schema in a module attribute:

    @options_schema [...]

With this, you can use `docs/1` to inject documentation:

    @doc "Supported options:\n#{Spark.Options.docs(@options_schema)}"

### Options - Spark.Options.docs/2 (function)

* `:nest_level` - an integer deciding the "nest level" of the generated
    docs. This is useful when, for example, you use `docs/2` inside the `:doc`
    option of another schema. For example, if you have the following nested schema:

        nested_schema = [
          allowed_messages: [type: :pos_integer, doc: "Allowed messages."],
          interval: [type: :pos_integer, doc: "Interval."]
        ]

    then you can document it inside another schema with its nesting level increased:

        schema = [
          producer: [
            type: {:or, [:string, keyword_list: nested_schema]},
            doc:
              "Either a string or a keyword list with the following keys:\n\n" <>
                Spark.Options.docs(nested_schema, nest_level: 1)
          ],
          other_key: [type: :string]
        ]

### Spark.Options.merge/3 (function)

Merges two schemas, and sets the `subsection` option on all options on the right side.

### Spark.Options.new!/1 (function)

Validates the given `schema` and returns a wrapped schema to be used with `validate/2`.

If the given schema is not valid, raises a `Spark.Options.ValidationError`.

### Spark.Options.option_schema/0 (type)



### Spark.Options.option_typespec/1 (function)

Returns the quoted typespec for any option described by the given schema.

The returned quoted code represents the **type union** for all possible
keys in the schema, alongside their type. Nested keyword lists are
spec'ed as `t:keyword/0`.

### Usage - Spark.Options.option_typespec/1 (function)

Because of how typespecs are treated by the Elixir compiler, you have
to use `unquote/1` on the return value of this function to use it
in a typespec:

    @type option() :: unquote(Spark.Options.option_typespec(my_schema))

This function returns the type union for a single option: to give you
flexibility to combine it and use it in your own typespecs. For example,
if you only validate part of the options through Spark.Options, you could
write a spec like this:

    @type my_option() ::
            {:my_opt1, integer()}
            | {:my_opt2, boolean()}
            | unquote(Spark.Options.option_typespec(my_schema))

If you want to spec a whole schema, you could write something like this:

    @type options() :: [unquote(Spark.Options.option_typespec(my_schema))]

### Example - Spark.Options.option_typespec/1 (function)

schema = [
      int: [type: :integer],
      number: [type: {:or, [:integer, :float]}]
    ]

    @type option() :: unquote(Spark.Options.option_typespec(schema))

The code above would essentially compile to:

    @type option() :: {:int, integer()} | {:number, integer() | float()}

### Spark.Options.schema/0 (type)

A schema.

See the module documentation for more information.

### Spark.Options.t/0 (type)

The `Spark.Options` struct embedding a validated schema.

See the [*Validating Schemas* section](#module-validating-schemas) in
the module documentation.

### Spark.Options.type/0 (type)



### Spark.Options.validate/2 (function)

Validates the given `options` with the given `schema`.

See the module documentation for what a `schema` is.

If the validation is successful, this function returns `{:ok, validated_options}`
where `validated_options` is a keyword list. If the validation fails, this
function returns `{:error, validation_error}` where `validation_error` is a
`Spark.Options.ValidationError` struct explaining what's wrong with the options.
You can use `raise/1` with that struct or `Exception.message/1` to turn it into a string.

### Spark.Options.validate!/2 (function)

Validates the given `options` with the given `schema` and raises if they're not valid.

This function behaves exactly like `validate/2`, but returns the options directly
if they're valid or raises a `Spark.Options.ValidationError` exception otherwise.

### Spark.Options.Helpers (module)

Helpers for use with spark options

### Spark.Options.Helpers.append_doc!/3 (function)



### Spark.Options.Helpers.make_optional!/2 (function)



### Spark.Options.Helpers.make_required!/2 (function)



### Spark.Options.Helpers.set_default!/3 (function)



### Spark.Options.Helpers.set_type!/3 (function)



### Spark.Options.ValidationError.__struct__/0 (function)

The error struct.

Only the following documented fields are considered public. All other fields are
considered private and should not be referenced:

  * `:key` (`t:atom/0`) - The key that did not successfully validate.

  * `:keys_path` (list of `t:atom/0`) - If the key is nested, this is the path to the key.

  * `:value` (`t:term/0`) - The value that failed to validate. This field is `nil` if there
    was no value provided.

### Spark.Options.ValidationError.t/0 (type)



### Spark.Options.Validator (module)

Defines a validator module for an option schema.

Validators create structs with keys for each option in their schema,
and an optimized `validate`, and `validate!` function on that struct.

### Upgrading from options lists - Spark.Options.Validator (module)

You can pass the option `define_deprecated_access?: true` to `use Spark.Options.Validator`,
which will make it such that `options[:foo]` will still work, but will emit a deprecation warning.
This cane help with smoother upgrades.

### Example - Spark.Options.Validator (module)

Given a module like the following:

```elixir
defmodule MyOptions do
  use Spark.Options.Validator, schema: [
    foo: [
      type: :string,
      required: true
    ],
    bar: [
      type: :string
    ],
    baz: [
      type: :integer,
      default: 10
    ]
  ]
end
```

You can use it like so:

```elixir
@doc """
Does a thing

### Options - Spark.Options.Validator (module)

#{MyOptions.docs()}
"""
@doc spark_opts: [{1, MyOptions.schema()}]
def your_function(arg, opts \\ []) do
  options = MyOptions.validate!(opts)

  options.foo
  options.bar
end
```

### Spark.OptionsHelpers (module)

Helpers for working with options lists.

### Spark.OptionsHelpers.append_doc!/3 (function)



### Spark.OptionsHelpers.docs/1 (function)

Creates markdown documentation for a given schema.

### Spark.OptionsHelpers.make_optional!/2 (function)



### Spark.OptionsHelpers.make_required!/2 (function)



### Spark.OptionsHelpers.merge_schemas/3 (function)



### Spark.OptionsHelpers.set_default!/3 (function)



### Spark.OptionsHelpers.set_type!/3 (function)



### Spark.OptionsHelpers.validate/2 (function)



### Spark.OptionsHelpers.validate!/2 (function)



### Spark.Error.DslError.t/0 (type)



### Mix.Tasks.Spark.CheatSheetsInSearch.run/1 (function)

Callback implementation for  Mix.Task.run/1 .

### Mix.Tasks.Spark.Formatter.all_entity_builders_everywhere/4 (function)



### Mix.Tasks.Spark.Formatter.run/1 (function)

Callback implementation for  Mix.Task.run/1 .

### Mix.Tasks.Spark.ReplaceDocLinks.run/1 (function)

Callback implementation for  Mix.Task.run/1 .

### Spark (module)

Documentation for `Spark`.

### Spark.extensions/1 (function)

Returns the extensions a given DSL uses

### Spark.implements_behaviour?/2 (function)

Returns true if the module implements the specified behavior

### Spark.otp_app/1 (function)

Returns the configured otp_app of a given DSL instance

### Spark.sparks/2 (function)

Returns all modules that implement the specified behaviour for a given otp_app.

Should only be called at runtime, not at compile time, as it will have
inconsistent results at compile time.

### Spark.CheatSheet (module)

Tools to generate cheat sheets for spark DSLs

### Spark.CheatSheet.cheat_sheet/1 (function)

Generate a cheat sheet for a given DSL

### Spark.CheatSheet.doc/2 (function)

Generate a markdown bullet list documentation for a list of sections

### Spark.CheatSheet.doc_index/3 (function)

Generate a table of contents for a list of sections

### Spark.CheatSheet.section_cheat_sheet/2 (function)



### Spark.CodeHelpers (module)

Helpers for meta programming around code and code snippets

### Spark.CodeHelpers.code_identifier/1 (function)

Given a section of Elixir AST, generate a hash of the code to help with
generating unique names.

### Spark.CodeHelpers.lift_functions/3 (function)

Lift anonymous and captured functions.

Acts as an AST transformer to allow these kinds of functions to be added in
the AST:

In the case of captured functions, it ensures they are all captured remote
functions (ie calls with both the module and function name present) - this
often requires the definition of a new public function on the target module.

In the case of anonymous functions, it converts them into a new public
function on the module and returns a (remote) function capture much like that
of above.

### Spark.CodeHelpers.prewalk/2 (function)

Copy of `Macro.prewalk/2` w/ a branch accumulator

### Spark.CodeHelpers.prewalk/4 (function)

Copy of `Macro.prewalk/3` w/ a branch accumulator

### Spark.CodeHelpers.traverse/5 (function)

A copy of the corresponding `Macro.traverse` function that has a separate accumulator that only goes *down* each branch, only for `pre`

### Spark.Docs (module)

Tools for generating docs & search data for extras.

### Spark.Docs.search_data_for/1 (function)

Generates searchable documentation suitable for ex_doc

### Spark.Formatter (module)

Formats Spark modules.

Currently, it is very simple, and will only reorder the outermost sections according to some rules.

# Plugin

Include the plugin into your `.formatter.exs` like so `plugins: [Spark.Formatter]`.

If no configuration is provided, it will sort all top level DSL sections *alphabetically*.

# Section Order

To provide a custom section order, add configuration to your app, for example:

```elixir
config :spark, :formatter,
  remove_parens?: true,
  "Ash.Resource": [
    section_order: [
      :resource,
      :postgres,
      :attributes,
      :relationships,
      :aggregates,
      :calculations
    ]
  ],
  "MyApp.Resource": [
    # Use this if you use a module that is not the spark DSL itself.
    # For example, you might have a "base" that you use instead that sets some simple defaults.

    # This tells us what the actual thing is so we know what extensions are included automatically.
    type: Ash.Resource,

    # Tell us what extensions might be added under the hood
    extensions: [MyApp.ResourceExtension],
    section_order: [...]
  ]
```

Any sections found that aren't in that list will be left in the order that they were in, the sections
in the list will be sorted "around" those sections. E.g the following list: `[:code_interface, :attributes]` can be interpreted as
"ensure that code_interface comes before attributes, and don't change the rest".

### Spark.Formatter.entity_builders/1 (function)



### Spark.Formatter.features/1 (function)

Callback implementation for  Mix.Tasks.Format.features/1 .

### Spark.Formatter.format/2 (function)

Callback implementation for  Mix.Tasks.Format.format/2 .

### Spark.Igniter (module)

Helpers for patching Spark DSLs.

### Spark.Igniter.add_extension/6 (function)

Adds an extension to a DSL module.

### Spark.Igniter.find/3 (function)

Searches for a match to a zipper function inside a DSL and all of its fragments.

### Spark.Igniter.get_option/3 (function)

Gets an option at a given path within a DSL.
We will attempt to expand literals using the environment at the path
but this is only guaranteed to return the *AST* at that option, *not* necessarily a value.

Additionally, this only finds options set explicitly in the body of the resource, not by an extension.

### Spark.Igniter.has_extension/5 (function)

Returns `{igniter, true}` if the module has the extension, or `{igniter, false}` otherwise.

### Spark.Igniter.prepend_to_section_order/3 (function)

Prepends a new section or list of sections to the section order in a formatter configuration.

### Spark.Igniter.remove_extension/6 (function)

Removes an extension from a DSL module.

### Spark.Igniter.set_option/5 (function)

Sets an option at a given path within in a DSL.

### Spark.Igniter.update_dsl/5 (function)



### Spark.InfoGenerator (module)

Used to dynamically generate configuration functions for Spark extensions
based on their DSL.

### Usage - Spark.InfoGenerator (module)

```elixir
defmodule MyConfig do
  use Spark.InfoGenerator, extension: MyDslExtension, sections: [:my_section]
end
```

### Spark.InfoGenerator.generate_config_functions/2 (macro)

Given an extension and a list of DSL sections generate individual config
functions for each option.

### Spark.InfoGenerator.generate_entity_functions/2 (macro)

Given an extension and a list of DSL sections, generate an entities function
which returns a list of entities.

### Spark.InfoGenerator.generate_options_functions/2 (macro)

Given an extension and a list of DSL sections, generate an options function
which returns a map of all configured options for a resource (including
defaults).

### Spark.InfoGenerator.options/0 (type)



### Spark.InfoGenerator.spec_for_type/2 (function)



## Links

- [Online documentation](https://hexdocs.pm/spark)# ash_ops

> An Ash extension which generates mix tasks for Ash actions

## Docs

### AshOps (module)

An extension for `Ash.Domain` that adds the ability expose resource actions as
mix tasks.

### AshOps.entity/0 (type)



### AshOps.mix_tasks/1 (macro)



### AshOps.Entity.Action (module)

The `mix_tasks.action` DSL entity.

### AshOps.Entity.Action.t/0 (type)



### AshOps.Entity.Create (module)

The `mix_tasks.create` DSL entity.

### AshOps.Entity.Create.t/0 (type)



### AshOps.Entity.Destroy (module)

The `mix_tasks.destroy` DSL entity.

### AshOps.Entity.Destroy.t/0 (type)



### AshOps.Entity.Get (module)

The `mix_tasks.get` DSL entity.

### AshOps.Entity.Get.t/0 (type)



### AshOps.Entity.List (module)

The `mix_tasks.list` DSL entity.

### AshOps.Entity.List.t/0 (type)



### AshOps.Entity.Update (module)

The `mix_tasks.update` DSL entity.

### AshOps.Entity.Update.t/0 (type)



### AshOps.Info (module)

Auto-generated introspection for the `AshOps` extension.

### AshOps.Info.domain_or_dsl/0 (type)



### AshOps.Info.mix_task/2 (function)

Get a mix task by name.

### AshOps.Info.mix_task!/2 (function)

Raising version of `mix_task/2`

### AshOps.Info.mix_tasks/1 (function)

mix_tasks DSL entities

### AshOps.QueryLang (module)

The query language for simple queries entered on the command-line.

This query language is not capable of expressing the full breadth of the Ash
expression language.  It is designed to provide a simple subset of filters
available to users of AshOps. If you need something more advanced then it's
probably a good idea to make a special read query filtered in the way you
require and expose that as a mix task instead.

### Syntax - AshOps.QueryLang (module)

The Ash Ops query language is very similar to the
[Ash expression syntax](https://hexdocs.pm/ash/expressions.html)
while not actually being Elixir.

### Literals - AshOps.QueryLang (module)

- `true` and `false` boolean literals.
- Integer literals, eg `123`, `-123` and `0`.
- Float literals, of the form `1.23` and `-1.23` (ie not scientific notation).
- String literals of delimited with both single ticks (`'`) and double ticks
  (`"`) are interpreted as Elixir binaries.
- Attribute path literals are entered directly, separated by `.` as necessary.

### Infix operators - AshOps.QueryLang (module)

The following infix operators (and their aliases) are available:

- `&&` and `and`,
- `||` and `or`,
- `*` and `times`,
- `/` and `div`,
- `+` and `plus`,
- `-` and `minus`,
- `<>` and `concat`,
- `in`,
- `>` and `gt`,
- `>=` and `gte`,
- `<` and `lt`,
- `<=` and `lte`,
- `==` and `eq`,
- `!=` and `not_eq`.

### Function calls - AshOps.QueryLang (module)

Function calls of the form `function(arg, arg)` format are allowed.  The
functions available are highly dependant on the extensions and data layer
being used by the resource being queried.

### AshOps.QueryLang.parse/2 (function)

Parse a query and return a compiled `Ash.Query` struct.

### AshOps.Task.Action (module)

Provides the implementation of the `action` mix task.

This should only ever be called from the mix task itself.

### AshOps.Task.ArgSchema (module)

A struct which contains information about the arguments a task expects to
receive.

### AshOps.Task.ArgSchema.add_switch/5 (function)

Add a switch to the arguments

### Arguments - AshOps.Task.ArgSchema.add_switch/5 (function)

- `name` the name of the switch - this will be dasherised by `OptionParser`.
- `op_type` the type to cast the argument to (as per `OptionParser.parse/2`).
- `so_schema` the `Spark.Options` schema fragment for to validate the resulting input.
- `help_text` the text to display when asked to render usage information.
- `aliases` a list of "short name" aliases for the switch.

### AshOps.Task.ArgSchema.append_positional/3 (function)

Append a positional argument to the end of the argument list

ie after any action arguments taken by the task.

### AshOps.Task.ArgSchema.default/1 (function)

Return the default arguments that all tasks expect to take.

### AshOps.Task.ArgSchema.parse/2 (function)

Parse and validate the command-line arguments.

### AshOps.Task.ArgSchema.prepend_positional/3 (function)

Prepend a positional argument to the beginning argument list

ie before any action arguments taken by the task.

### AshOps.Task.ArgSchema.remove_positional/2 (function)

Remove a positional argument by name.

### AshOps.Task.ArgSchema.remove_switch/2 (function)

Remove a switch from the argument schemas

### AshOps.Task.ArgSchema.t/0 (type)



### AshOps.Task.ArgSchema.usage/2 (function)

Display usage information about the arguments

### AshOps.Task.Common (module)

Common behaviour for all tasks.

### AshOps.Task.Common.handle_error/1 (function)

Format an error for display and exit with a non-zero status.

### AshOps.Task.Common.identity_or_pk_field/2 (function)

Return the filter field for the configured identity, or the primary key

### AshOps.Task.Common.load_actor/2 (function)

Given a tuple containing a resource and a filter statement, use it to load the
actor.

### AshOps.Task.Common.serialise_record/3 (function)

Serialise the record for display

### AshOps.Task.Common.serialise_records/3 (function)

Serialise a list of records for display

### AshOps.Task.Create (module)

Provides the implementation of the `create` mix task.

This should only ever be called from the mix task itself.

### AshOps.Task.Destroy (module)

Provides the implementation of the `destroy` mix task.

This should only ever be called from the mix task itself.

### AshOps.Task.Get (module)

Provides the implementation of the `get` mix task.

This should only ever be called from the mix task itself.

### AshOps.Task.List (module)

Provides the implementation of the `list` mix task.

This should only ever be called from the mix task itself.

### AshOps.Task.Types (module)

Custom `Spark.Options` types for casting and validating CLI arguments.

### AshOps.Task.Types.actor/2 (function)

Custom option type for loading an actor

### AshOps.Task.Types.atom/2 (function)

Custom option type for atom

### AshOps.Task.Types.filter/1 (function)

Custom option type for query filters

### AshOps.Task.Types.filter_stdin/1 (function)

Custom option type for filter-stdin

### AshOps.Task.Types.identity/2 (function)

Custom option type for an identity

### AshOps.Task.Types.load/2 (function)

Custom option type for load

### AshOps.Task.Types.positional_arguments/4 (function)

Custom option type for positional arguments

### AshOps.Task.Types.sort_input/1 (function)

Parse a sort input

### AshOps.Task.Types.task/0 (type)



### AshOps.Task.Update (module)

Provides the implementation of the `update` mix task.

This should only ever be called from the mix task itself.

### AshOps.Transformer.PrepareTask (module)

A Spark DSL transformer for all `mix_tasks` entities.

### AshOps.Transformer.PrepareTask.after?/1 (function)



### AshOps.Transformer.PrepareTask.after_compile?/0 (function)



### AshOps.Transformer.PrepareTask.before?/1 (function)



### AshOps.Verifier.VerifyTask (module)

A Spark DSL verifier for mix task entities.

## Links

- [Online documentation](https://hexdocs.pm/ash_ops)# splode

> Splode helps you deal with errors and exceptions in your application that are aggregatable and consistent.

## Docs

### Splode (behaviour)

Use this module to create your error aggregator and handler.

For example:

```elixir
defmodule MyApp.Errors do
  use Splode, error_classes: [
    invalid: MyApp.Errors.Invalid,
    unknown: MyApp.Errors.Unknown
  ],
  unknown_error: MyApp.Errors.Unknown.Unknown
end
```

### Splode.from_json/2 (callback)

Converts a combination of a module and json input into an Splode exception.

This allows for errors to be serialized and deserialized

### Splode.set_path/2 (callback)

Sets the path on the error or errors

### Splode.splode_error?/1 (callback)

Returns true if the given value is a splode error.

### Splode.to_class/1 (callback)

Combine errors into an error class

### Splode.to_error/1 (callback)

Turns any value into a splode error

### Splode.Error (behaviour)

Use this module to create an aggregatable error.

For example:

```elixir
defmodule MyApp.Errors.InvalidArgument do
  use Splode.Error, fields: [:name, :message], class: :invalid

  def message(%{name: name, message: message}) do
    "Invalid argument #{name}: #{message}"
  end
end
```

### Splode.Error.error_class?/0 (callback)



### Splode.Error.from_json/1 (callback)



### Splode.Error.splode_error?/0 (callback)



### Splode.Error.t/0 (type)



### Splode.ErrorClass (module)

Tools for working with error classes

### Splode.ErrorClass.error_messages/2 (function)

Creates a long form composite error message for a list of errors

### Splode.Stacktrace (module)

A placeholder for a stacktrace so that we can avoid printing it everywhere

### Splode.Stacktrace.t/0 (type)



### Splode.Error.Unknown.exception/1 (function)

Create an `Elixir.Splode.Error.Unknown` without raising it.

### Keys - Splode.Error.Unknown.exception/1 (function)

- :errors

### Splode.Error.Unknown.message/1 (function)



## Links

- [Online documentation](https://hexdocs.pm/splode)# ash_graphql

> The extension for building GraphQL APIs with Ash

## Docs

### AshGraphql.Igniter (module)

Codemods and utilities for working with AshGraphql & Igniter

### AshGraphql.Igniter.ash_graphql_schemas/1 (function)

Returns all modules that `use AshGraphql`

### AshGraphql.Igniter.find_schema/2 (function)

Returns the AshGraphql schema containing the domain in question, or a list of all AshGraphql schemas

### AshGraphql.Igniter.setup_absinthe_schema/2 (function)

Sets up an absinthe schema for AshGraphql

### AshGraphql.Igniter.setup_phoenix/4 (function)

Sets up the phoenix module for AshGraphql

### AshGraphql.Resource.Subscription (module)

Represents a configured query on a resource

### AshGraphql.Resource.Subscription.schema/0 (function)



### AshGraphql.Resource.Transformers.Subscription (module)

Adds the notifier for Subscriptions to the Resource

### AshGraphql.Resource.Transformers.Subscription.after?/1 (function)



### AshGraphql.Resource.Transformers.Subscription.after_compile?/0 (function)



### AshGraphql.Resource.Transformers.Subscription.before?/1 (function)



### AshGraphql.Resource.Transformers.Subscription.transform/1 (function)



### AshGraphql.Subscription.Actor (behaviour)

Allows the user to substitue an actor for another more generic actor, 
this can be used to deduplicate subscription execution

### AshGraphql.Subscription.Actor.actor/2 (callback)



### AshGraphql.Subscription.Batcher (module)

If started as a GenServer, this module will batch notifications and send them in bulk.
Otherwise, it will send them immediately.

### AshGraphql.Subscription.Batcher.child_spec/1 (function)

Returns a specification to start this module under a supervisor.

See `Supervisor`.

### AshGraphql.Subscription.Batcher.drain/0 (function)



### AshGraphql.Subscription.Batcher.handle_continue/2 (function)



### AshGraphql.Subscription.Batcher.init/1 (function)

Config options

`async_limit` (default 100):
 if there are more than `async_limit` notifications, we will start to backpressure

`send_immediately_threshold` (default 50): 
 if there are less then `send_immediately_threshold` notifications, we will send them immediately

`subscription_batch_interval` (default 1000):
 the interval in milliseconds the batcher waits for new notifications before sending them

### AshGraphql.Subscription.Batcher.publish/5 (function)



### AshGraphql.Subscription.Batcher.start_link/1 (function)



### AshGraphql.Subscription.Config (module)

Creates a config function used for the absinthe subscription definition

See https://github.com/absinthe-graphql/absinthe/blob/3d0823bd71c2ebb94357a5588c723e053de8c66a/lib/absinthe/schema/notation.ex#L58

### AshGraphql.Subscription.Config.create_config/3 (function)



### AshGraphql.Subscription.Endpoint (module)



### AshGraphql.Subscription.Notifier (module)

AshNotifier that triggers absinthe if subscriptions are listening

### AshGraphql.Subscription.Notifier.requires_original_data?/2 (function)



### AshGraphql.Subscription.Runner (module)

Custom implementation if the run_docset function for the PubSub module used for Subscriptions

Mostly a copy of https://github.com/absinthe-graphql/absinthe/blob/3d0823bd71c2ebb94357a5588c723e053de8c66a/lib/absinthe/subscription/local.ex#L40
but this lets us decide if we want to send the data to the client or not in certain error cases

### AshGraphql.Subscription.Runner.run_docset/3 (function)



### AshGraphql (module)

AshGraphql is a GraphQL extension for the Ash framework.

For more information, see the [getting started guide](/documentation/tutorials/getting-started-with-graphql.md)

### AshGraphql.handle_errors/4 (function)

Applies AshGraphql's error handling logic if the value is an `{:error, error}` tuple, otherwise returns the value

Useful for automatically handling errors in custom queries

### Options - AshGraphql.handle_errors/4 (function)

- `domain`: The domain to use when loading the fields. Determined from the resource by default.

### AshGraphql.load_fields/4 (function)

Use this to load any requested fields for a result when it is returned
from a custom resolver or mutation.

### Determining required fields - AshGraphql.load_fields/4 (function)

If you have a custom query/mutation that returns the record at a "path" in
the response, then specify the path. In the example below, `path` would be
`["record"]`. This is how we know what fields to load.

```elixir
query something() {
  result {
    record { # <- this is the instance
      id
      name
    }
  }
}
```

### Options - AshGraphql.load_fields/4 (function)

- `path`: The path to the record(s) in the response
- `domain`: The domain to use when loading the fields. Determined from the resource by default.
- `authorize?`: Whether to authorize access to fields. Defaults to the domain's setting (which defaults to `true`).
- `actor`: The actor to use when authorizing access to fields. Defaults to the actor in the resolution context.
- `tenant`: The tenant to use when authorizing access to fields. Defaults to the tenant in the resolution context.

### AshGraphql.load_fields_on_query/3 (function)

The same as `load_fields/4`, but modifies the provided query to load the required fields.

This allows doing the loading in a single query rather than two separate queries.

### AshGraphql.subscription/1 (macro)



### AshGraphql.Domain (module)

The entrypoint for adding GraphQL behavior to an Ash domain

### AshGraphql.Domain.authorize?/1 (function)



### AshGraphql.Domain.global_type_definitions/2 (function)



### AshGraphql.Domain.graphql/1 (macro)



### AshGraphql.Domain.install/5 (function)



### AshGraphql.Domain.root_level_errors?/1 (function)



### AshGraphql.Domain.show_raised_errors?/1 (function)



### AshGraphql.Domain.subscriptions/6 (function)



### AshGraphql.Domain.Info (module)

Introspection helpers for AshGraphql.Domain

### AshGraphql.Domain.Info.authorize?/1 (function)

Whether or not to run authorization on this domain

### AshGraphql.Domain.Info.error_handler/1 (function)

An error handler for errors produced by the domain

### AshGraphql.Domain.Info.mutations/1 (function)

The mutations exposed by the domain

### AshGraphql.Domain.Info.queries/1 (function)

The queries exposed by the domain

### AshGraphql.Domain.Info.root_level_errors?/1 (function)

Whether or not to surface errors to the root of the response

### AshGraphql.Domain.Info.show_raised_errors?/1 (function)

Whether or not to render raised errors in the GraphQL response

### AshGraphql.Domain.Info.subscriptions/1 (function)



### AshGraphql.Domain.Info.tracer/1 (function)

The tracer to use for the given schema

### AshGraphql.Resource (module)

This Ash resource extension adds configuration for exposing a resource in a graphql.

### AshGraphql.Resource.codegen/1 (function)



### AshGraphql.Resource.decode_id/3 (function)



### AshGraphql.Resource.decode_primary_key/2 (function)



### AshGraphql.Resource.decode_relay_id/1 (function)



### AshGraphql.Resource.define_type?/2 (function)



### AshGraphql.Resource.embedded?/1 (function)



### AshGraphql.Resource.encode_id/2 (function)



### AshGraphql.Resource.encode_primary_key/1 (function)



### AshGraphql.Resource.encode_relay_id/1 (function)



### AshGraphql.Resource.enum_definitions/3 (function)



### AshGraphql.Resource.generate_object?/1 (function)



### AshGraphql.Resource.graphql/1 (macro)



### AshGraphql.Resource.install/5 (function)



### AshGraphql.Resource.managed_relationship_definitions/2 (function)



### AshGraphql.Resource.managed_relationships/1 (function)



### AshGraphql.Resource.map_definitions/4 (function)



### AshGraphql.Resource.mutations/0 (function)



### AshGraphql.Resource.mutations/2 (function)



### AshGraphql.Resource.no_graphql_types/2 (function)



### AshGraphql.Resource.node_type?/1 (function)



### AshGraphql.Resource.primary_key_delimiter/1 (function)



### AshGraphql.Resource.primary_key_get_query/2 (function)



### AshGraphql.Resource.queries/0 (function)



### AshGraphql.Resource.queries/2 (function)



### AshGraphql.Resource.query_type_definitions/5 (function)



### AshGraphql.Resource.ref/1 (function)



### AshGraphql.Resource.subscriptions/0 (function)



### AshGraphql.Resource.subscriptions/2 (function)



### AshGraphql.Resource.type/1 (function)



### AshGraphql.Resource.type_definition/5 (function)



### AshGraphql.Resource.Action (module)

Represents a configured generic action

### AshGraphql.Resource.Info (module)

Introspection helpers for AshGraphql.Resource

### AshGraphql.Resource.Info.argument_input_types/1 (function)

Graphql argument type overrides for the resource

### AshGraphql.Resource.Info.argument_names/1 (function)

Graphql argument name overrides for the resource

### AshGraphql.Resource.Info.attribute_input_types/1 (function)

Graphql attribute input type overrides for the resource

### AshGraphql.Resource.Info.attribute_types/1 (function)

Graphql type overrides for the resource

### AshGraphql.Resource.Info.complexity/1 (function)

The complexity callback `{mod, fun}` for this type

### AshGraphql.Resource.Info.derive_filter?/1 (function)

Wether or not to derive a filter input for the resource automatically

### AshGraphql.Resource.Info.derive_sort?/1 (function)

Wether or not to derive a sort input for the resource automatically

### AshGraphql.Resource.Info.encode_primary_key?/1 (function)

Wether or not to encode the primary key as a single `id` field when reading and getting

### AshGraphql.Resource.Info.error_handler/1 (function)

An error handler for errors produced by the resource

### AshGraphql.Resource.Info.field_names/1 (function)

Graphql field name (attribute/relationship/calculation/arguments) overrides for the resource

### AshGraphql.Resource.Info.filterable_field?/2 (function)

May the specified field be filtered on?

### AshGraphql.Resource.Info.filterable_fields/1 (function)

Fields that may be filtered on

### AshGraphql.Resource.Info.generate_object?/1 (function)

Wether or not an object should be generated, or if one with the type name for this resource should be used.

### AshGraphql.Resource.Info.hide_fields/1 (function)

Fields to hide from the graphql domain

### AshGraphql.Resource.Info.keyset_field/1 (function)

The field name to place the keyset of a result in

### AshGraphql.Resource.Info.managed_relationship/3 (function)

The managed_relationshi configuration for a given action/argument

### AshGraphql.Resource.Info.managed_relationships/1 (function)

The managed_relationship configurations

### AshGraphql.Resource.Info.managed_relationships_auto?/1 (function)



### AshGraphql.Resource.Info.mutations/2 (function)

The mutations exposed for the resource

### AshGraphql.Resource.Info.nullable_fields/1 (function)

Graphql nullability overrides for the resource

### AshGraphql.Resource.Info.paginate_relationship_with/1 (function)

Pagination configuration for list relationships

### AshGraphql.Resource.Info.primary_key_delimiter/1 (function)

The delimiter for a resource with a composite primary key

### AshGraphql.Resource.Info.queries/2 (function)

The queries exposed for the resource

### AshGraphql.Resource.Info.relationships/1 (function)

Which relationships should be included in the generated type

### AshGraphql.Resource.Info.show_field?/2 (function)

Wether or not a given field will be shown

### AshGraphql.Resource.Info.show_fields/1 (function)

Fields to show in the graphql domain

### AshGraphql.Resource.Info.subscription_pubsub/1 (function)

The pubsub module used for subscriptions

### AshGraphql.Resource.Info.subscriptions/2 (function)

The subscriptions exposed for the resource

### AshGraphql.Resource.Info.type/1 (function)

The graphql type of the resource

### AshGraphql.Resource.ManagedRelationship (module)

Represents a managed relationship configuration on a mutation

### AshGraphql.Resource.ManagedRelationship.schema/0 (function)



### AshGraphql.Resource.Mutation (module)

Represents a configured mutation on a resource

### AshGraphql.Resource.Mutation.create_schema/0 (function)



### AshGraphql.Resource.Mutation.destroy_schema/0 (function)



### AshGraphql.Resource.Mutation.update_schema/0 (function)



### AshGraphql.Resource.Query (module)

Represents a configured query on a resource

### AshGraphql.Resource.Query.get_schema/0 (function)



### AshGraphql.Resource.Query.list_schema/0 (function)



### AshGraphql.Resource.Query.read_one_schema/0 (function)



### AshGraphql.Error (protocol)



### AshGraphql.Error.t/0 (type)

All the types that implement this protocol.

### AshGraphql.Error.to_error/1 (function)



### AshGraphql.Errors (module)

Utilities for working with errors in custom resolvers.

### AshGraphql.Errors.to_errors/5 (function)

Transform an error or list of errors into the response for graphql.

### AshGraphql.Resource.Helpers (module)

Imported helpers for the graphql DSL section

### AshGraphql.Resource.Helpers.list_of/1 (function)

A list of a given type, idiomatic for those used to `absinthe` notation.

### AshGraphql.Resource.Helpers.non_null/1 (function)

A non nullable type, idiomatic for those used to `absinthe` notation.

### AshGraphql.ContextHelpers (module)

Helper to extract context from its various locations

### AshGraphql.ContextHelpers.get_context/1 (function)



### AshGraphql.DefaultErrorHandler (module)

Replaces any text in message or short_message with variables

### AshGraphql.DefaultErrorHandler.handle_error/2 (function)



### AshGraphql.DefaultErrorHandler.stringified_value/1 (function)



### AshGraphql.Plug (module)

Automatically set up the GraphQL `actor` and `tenant`.

Adding this plug to your pipeline will automatically set the `actor` and
`tenant` if they were previously put there by `Ash.PlugHelpers.set_actor/2` or
`Ash.PlugHelpers.set_tenant/2`.

### AshGraphql.Plug.call/2 (function)



### AshGraphql.Plug.init/1 (function)



### AshGraphql.Subscription (module)

Helpers for working with absinthe subscriptions

### AshGraphql.Subscription.query_for_subscription/5 (function)

Produce a query that will load the correct data for a subscription.

### AshGraphql.Type (behaviour)

Callbacks used to enrich types with GraphQL-specific metadata.

### AshGraphql.Type.graphql_define_type?/1 (callback)

Used for maps/enums/unions that *would* define a type automatically, to disable them.

### AshGraphql.Type.graphql_describe_enum_value/1 (callback)

Used for `Ash.Type.Enum` to provide a description for individual values. For example:

```elixir
defmodule MyEnum do
use Ash.Type.Enum, values: [:foo, :bar, :baz]

  def graphql_describe_enum_value(:baz), do: "A baz"
  def graphql_describe_enum_value(_), do: nil
end
```

### AshGraphql.Type.graphql_description/1 (callback)

Used to add a custom description to GraphQL generated types (for maps, enums and unions that auto-derive).

```elixir
defmodule MyMap do
  use Ash.Type.NewType, ...


  def graphql_description(_constraints), do: "My special map"
end
```

### AshGraphql.Type.graphql_input_type/1 (callback)

Sets the name of the graphql input type for a given Ash type. For example: `:weekday`.

This will do different things depending on the type you're adding it to.

### Regular Types - AshGraphql.Type.graphql_input_type/1 (callback)

This expresses that you will define a custom type for representing this input in your graphql

### NewTypes - AshGraphql.Type.graphql_input_type/1 (callback)

If it is a subtype of a union, or map/keyword with `fields` the type will be *created* with that name.
So you can use this to decide what it will be named. Otherwise, it behaves as stated above for
regular types.

### AshGraphql.Type.graphql_rename_value/1 (callback)

Used for `Ash.Type.Enum` to rename individual values. For example:

```elixir
defmodule MyEnum do
  use Ash.Type.Enum, values: [:foo, :bar, :baz]

  def graphql_rename_value(:baz), do: :buz
  def graphql_rename_value(other), do: other
end
```

### AshGraphql.Type.graphql_type/1 (callback)

Sets the name of the graphql type for a given Ash type. For example: `:weekday`.

This will do different things depending on the type you're adding it to.

### Regular Types - AshGraphql.Type.graphql_type/1 (callback)

This expresses that you will define a custom type for representing this in your graphql

### NewTypes - AshGraphql.Type.graphql_type/1 (callback)

If it is a subtype of a union, or map/keyword with `fields` the type will be *created* with that name.
So you can use this to decide what it will be named. Otherwise, it behaves as stated above for
regular types.

### AshGraphql.Type.graphql_unnested_unions/1 (callback)

Used for map/embedded types embedded in unions, to avoid nesting them in a key by their name.

See [the unions guide](/documentation/topics/use-unions-with-graphql.md) for more.

### AshGraphql.Types.JSON (module)

The Json scalar type allows arbitrary JSON values to be passed in and out.

### AshGraphql.Types.JSON.decode/1 (function)



### AshGraphql.Types.JSON.encode/1 (function)



### AshGraphql.Types.JSONString (module)

The Json scalar type allows arbitrary JSON values to be passed in and out.

### AshGraphql.Types.JSONString.decode/1 (function)



### AshGraphql.Types.JSONString.encode/1 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_graphql)# ash_json_api

> The JSON:API extension for the Ash Framework.

## Docs

### AshJsonApi (module)

Introspection functions for `AshJsonApi` domains.

For domain DSL documentation, see `AshJsonApi.Domain`.

For Resource DSL documentation, see `AshJsonApi.Resource`

To get started, see the [getting started guide](/documentation/tutorials/getting-started-with-ash-json-api.md)

### AshJsonApi.authorize?/1 (function)



### AshJsonApi.log_errors?/1 (function)



### AshJsonApi.prefix/1 (function)



### AshJsonApi.router/1 (function)



### AshJsonApi.serve_schema?/1 (function)



### AshJsonApi.Domain (module)

The entrypoint for adding JSON:API behavior to an Ash domain

### AshJsonApi.Domain.install/5 (function)



### AshJsonApi.Domain.json_api/1 (macro)



### AshJsonApi.Resource (module)

The entrypoint for adding JSON:API behavior to a resource"

### AshJsonApi.Resource.base_route/1 (function)



### AshJsonApi.Resource.encode_primary_key/1 (function)



### AshJsonApi.Resource.includes/1 (function)



### AshJsonApi.Resource.install/5 (function)



### AshJsonApi.Resource.json_api/1 (macro)



### AshJsonApi.Resource.only_primary_key?/2 (function)



### AshJsonApi.Resource.primary_key_delimiter/1 (function)



### AshJsonApi.Resource.primary_key_fields/1 (function)



### AshJsonApi.Resource.route/3 (function)



### AshJsonApi.Resource.routes/2 (function)



### AshJsonApi.Resource.type/1 (function)



### AshJsonApi.Router (module)

Use this module to create a router for your AshJsonApi.

To use this, create a module and do the following:

```elixir
defmodule YourRouter do
  use AshJsonApi.Router,
    domains: [YourDomain, YourOtherDomain],
    # these next two are optional, only add them if you want those endpoints
    open_api: "/open_api",
    json_schema: "/json_schema",
    # tell us where it is mounted in your router
    prefix: "/api/json"
end
```

Then in your Phoenix router or plug pipeline, forward to this plug.
In phoenix, that looks like this:

```elixir
    forward "/api", YourRouter
```

### Customizing request handling - AshJsonApi.Router (module)

You can provide the `before_dispatch` option to customize request handling.
This can also be used to do things like set monitoring/observability information,
like which domain/resource/route is handling the request.

For example:

```elixir
use AshJsonApi.Router,
  ...,
  before_dispatch: {__MODULE__, :before_dispatch, []}


def before_dispatch(conn, route_info) do
 ...
end
```

`route_info` will be one of the following:

- `:open_api` - The open api is being requested
- `:json_schema` - The json schema is being requested
- `:not_found` - No matching route was found
- A map containing the keys: `domain`, `resource`, `route`, `params`

### AshJsonApi.OpenApi (module)

Provides functions for generating schemas and operations for OpenApi definitions.

Add `open_api_spex` to your `mix.exs` deps for the required struct definitions.

### Example - AshJsonApi.OpenApi (module)

defmodule MyApp.OpenApi do
      alias OpenApiSpex.{OpenApi, Info, Server, Components}

      def spec do
        %OpenApi{
          info: %Info{
            title: "MyApp JSON API",
            version: "1.1"
          },
          servers: [
            Server.from_endpoint(MyAppWeb.Endpoint)
          ],
          paths: AshJsonApi.OpenApi.paths(MyApp.Api),
          tags: AshJsonApi.OpenApi.tags(MyApp.Api),
          components: %Components{
            responses: AshJsonApi.OpenApi.responses(),
            schemas: AshJsonApi.OpenApi.schemas(MyApp.Api)
          }
        }
      end
    end

### AshJsonApi.OpenApi.define_filter?/2 (function)



### AshJsonApi.OpenApi.paths/3 (function)

Paths (routes) from the domain.

### AshJsonApi.OpenApi.raw_filter_type/2 (function)



### AshJsonApi.OpenApi.resource_filter_fields_fields_only/1 (function)



### AshJsonApi.OpenApi.responses/0 (function)

Common responses to include in the API Spec.

### AshJsonApi.OpenApi.schemas/1 (function)

Resource schemas to include in the API spec.

### AshJsonApi.OpenApi.spec/2 (function)



### AshJsonApi.OpenApi.tags/1 (function)

Tags based on resource names to include in the API spec

### AshJsonApi.OpenApi.tags/2 (function)



### AshJsonApi.OpenApi.write_attributes/5 (function)



### AshJsonApi.Test (module)

Utilities for testing AshJsonApi.

### Making Requests - AshJsonApi.Test (module)

The request testing functions get/patch/post/delete all support the following options

- `:status`: Asserts that the response has the provided status after making the request
- `:router`: The corresponding JsonApiRouter to go through. Can be set statically in config, see below for more.
- `:actor`: Sets the provided actor as the actor for the request
- `:tenant`: Sets the provided tenant as the tenant for the request

A standard test would look like this:

```elixir
test "can list posts", %{current_user: current_user} do
  Domain
  # GET /posts
  # assert resp.status == 200
  |> get("/posts", status: 200, actor: current_user, router: MyAppWeb.JsonApiRouter)
  # pattern match on the data key of the response
  |> assert_data_matches([
    %{
      "attributes" => %{
        "name" => "foo"
      }
    }
  ])
end
```

### AshJsonApi.Test.assert_data_equals/2 (macro)

Assert that the response body's `"data"` equals an exact value

### AshJsonApi.Test.assert_data_matches/2 (macro)

Assert that the response body's `"data"` matches a pattern

### AshJsonApi.Test.assert_has_error/2 (macro)

Asserts that an error is in the response where each key present in the provided map
has the same value in the error.

### Example - AshJsonApi.Test.assert_has_error/2 (macro)

```elixir
Domain
|> delete("/posts/1", status: 404)
|> assert_has_error(%{
  "code" => "not_found",
  "detail" => "No post record found with `id: 1`",
  "title" => "Entity Not Found"
})
```

### AshJsonApi.Test.assert_has_matching_include/2 (macro)

Assert that the given function returns true for at least one included record

### Example - AshJsonApi.Test.assert_has_matching_include/2 (macro)

```elixir
Domain
|> get("/posts/#{post.id}/?include=author", status: 200)
|> assert_has_matching_include(fn
  %{"type" => "author", "id" => ^author_id} ->
    true

  _ ->
    false
end)
```

### AshJsonApi.Test.delete/3 (function)

Sends a DELETE request to the given path. See the module docs for more.

### AshJsonApi.Test.get/3 (function)

Sends a GET request to the given path. See the module docs for more.

### AshJsonApi.Test.multipart_post/4 (function)

Sends a multipart POST request to the given path. See the module docs for more.

### AshJsonApi.Test.patch/4 (function)

Sends a PATCH request to the given path. See the module docs for more.

### AshJsonApi.Test.post/4 (function)

Sends a POST request to the given path. See the module docs for more.

### AshJsonApi.Test.refute_has_matching_include/2 (macro)

Refute that the given function returns true for at least one included record

### Example - AshJsonApi.Test.refute_has_matching_include/2 (macro)

```elixir
Domain
|> get("/posts/#{post.id}/?include=author", status: 200)
|> refute_has_matching_include(fn
  %{"type" => "author", "id" => ^author_id} ->
    true

  _ ->
    false
end)
```

### AshJsonApi.Domain.Info (module)

Introspection helpers for AshJsonApi.Domain

### AshJsonApi.Domain.Info.authorize?/1 (function)



### AshJsonApi.Domain.Info.group_by/1 (function)



### AshJsonApi.Domain.Info.include_nil_values?/1 (function)



### AshJsonApi.Domain.Info.log_errors?/1 (function)



### AshJsonApi.Domain.Info.prefix/1 (function)



### AshJsonApi.Domain.Info.router/1 (function)



### AshJsonApi.Domain.Info.routes/1 (function)



### AshJsonApi.Domain.Info.serve_schema?/1 (function)



### AshJsonApi.Domain.Info.show_raised_errors?/1 (function)



### AshJsonApi.Domain.Info.tag/1 (function)



### AshJsonApi.Resource.Info (module)

Introspection helpers for AshJsonApi.Resource

### AshJsonApi.Resource.Info.base_route/1 (function)



### AshJsonApi.Resource.Info.default_fields/1 (function)



### AshJsonApi.Resource.Info.derive_filter?/1 (function)



### AshJsonApi.Resource.Info.derive_sort?/1 (function)



### AshJsonApi.Resource.Info.include_nil_values?/1 (function)



### AshJsonApi.Resource.Info.includes/1 (function)



### AshJsonApi.Resource.Info.primary_key_delimiter/1 (function)



### AshJsonApi.Resource.Info.primary_key_fields/1 (function)



### AshJsonApi.Resource.Info.routes/2 (function)



### AshJsonApi.Resource.Info.type/1 (function)



### AshJsonApi.Resource.Route (module)

Represents a route for a resource

### AshJsonApi.Resource.Route.t/0 (type)



### AshJsonApi.Error (module)

Represents an AshJsonApi Error

### AshJsonApi.Error.class_to_status/1 (function)

Turns an error class into an HTTP status code

### AshJsonApi.Error.format_log/1 (function)



### AshJsonApi.Error.new/1 (function)



### AshJsonApi.Error.t/0 (type)



### AshJsonApi.Error.to_json_api_errors/4 (function)



### AshJsonApi.Error.with_source_pointer/4 (function)



### AshJsonApi.Error.InvalidBody.exception/1 (function)

Create an `Elixir.AshJsonApi.Error.InvalidBody` without raising it.

### Keys - AshJsonApi.Error.InvalidBody.exception/1 (function)

- :json_xema_error

### AshJsonApi.Error.InvalidField.exception/1 (function)

Create an `Elixir.AshJsonApi.Error.InvalidField` without raising it.

### Keys - AshJsonApi.Error.InvalidField.exception/1 (function)

- :type
- :field
- :parameter?
- :detail
- :source_parameter

### AshJsonApi.Error.InvalidHeader.exception/1 (function)

Create an `Elixir.AshJsonApi.Error.InvalidHeader` without raising it.

### Keys - AshJsonApi.Error.InvalidHeader.exception/1 (function)

- :json_xema_error

### AshJsonApi.Error.InvalidIncludes.exception/1 (function)

Create an `Elixir.AshJsonApi.Error.InvalidIncludes` without raising it.

### Keys - AshJsonApi.Error.InvalidIncludes.exception/1 (function)

- :includes

### AshJsonApi.Error.InvalidIncludes.t/0 (type)



### AshJsonApi.Error.InvalidPagination.exception/1 (function)

Create an `Elixir.AshJsonApi.Error.InvalidPagination` without raising it.

### Keys - AshJsonApi.Error.InvalidPagination.exception/1 (function)

- :detail

### AshJsonApi.Error.InvalidQuery.exception/1 (function)

Create an `Elixir.AshJsonApi.Error.InvalidQuery` without raising it.

### Keys - AshJsonApi.Error.InvalidQuery.exception/1 (function)

- :json_xema_error

### AshJsonApi.Error.InvalidType.exception/1 (function)

Create an `Elixir.AshJsonApi.Error.InvalidType` without raising it.

### Keys - AshJsonApi.Error.InvalidType.exception/1 (function)

- :type

### AshJsonApi.Error.NotFound.exception/1 (function)

Create an `Elixir.AshJsonApi.Error.NotFound` without raising it.

### Keys - AshJsonApi.Error.NotFound.exception/1 (function)

- :filter
- :resource

### AshJsonApi.Error.UnacceptableMediaType.exception/1 (function)

Create an `Elixir.AshJsonApi.Error.UnacceptableMediaType` without raising it.

### Keys - AshJsonApi.Error.UnacceptableMediaType.exception/1 (function)



### AshJsonApi.Error.UnsupportedMediaType.exception/1 (function)

Create an `Elixir.AshJsonApi.Error.UnsupportedMediaType` without raising it.

### Keys - AshJsonApi.Error.UnsupportedMediaType.exception/1 (function)



### AshJsonApi.ToJsonApiError (protocol)

A protocol for turning an Ash exception into an AshJsonApi.Error

To use, implement the protocol for a builtin Ash exception type or for your own custom
Ash exception.

### Example - AshJsonApi.ToJsonApiError (protocol)

```elixir
defmodule NotAvailable do
  use Ash.Error.Exception

  use Splode.Error,
    fields: [],
    class: :invalid

  defimpl AshJsonApi.ToJsonApiError do
    def to_json_api_error(error) do
      %AshJsonApi.Error{
        id: Ash.UUID.generate(),
        status_code: 409,
        code: "not_available",
        title: "not_available",
        detail: "Not available"
      }
    end
  end
end
```

### AshJsonApi.ToJsonApiError.t/0 (type)

All the types that implement this protocol.

### AshJsonApi.ToJsonApiError.to_json_api_error/1 (function)



### AshJsonApi.Domain.BaseRoute (module)

Introspection target for base routes in `AshJsonApi.Domain`

### AshJsonApi.Domain.Verifiers.VerifyActions (module)

Verifies that all actions are valid for each route.

### AshJsonApi.Domain.Verifiers.VerifyHasType (module)

Verifies that a resource has a type if it has any routes that need it.

### AshJsonApi.Domain.Verifiers.VerifyQueryParams (module)

Verify query params are not reserved or shadowed by the route

### AshJsonApi.Domain.Verifiers.VerifyRelationships (module)

Verifies that any routes that reference a relationship reference a public one

### AshJsonApi.Domain.Verifiers.VerifyRelationships.verify/1 (function)



### AshJsonApi.Igniter (module)

Codemods and utilities for working with AshJsonApi & Igniter

### AshJsonApi.Igniter.ash_json_api_routers/1 (function)

Returns all modules that `use AshJsonApi.Router`

### AshJsonApi.Igniter.find_ash_json_api_router/2 (function)

Returns the AshJsonApi router containing the domain in question, or a list of all AshJsonApi schemas

### AshJsonApi.Igniter.setup_ash_json_api_router/2 (function)

Sets up an `AshJsonApi.Router` for AshJsonApi

### AshJsonApi.Igniter.setup_phoenix/2 (function)

Sets up the phoenix module for AshJsonApi

### AshJsonApi.Igniter.setup_routes_alias/1 (function)



### AshJsonApi.Plug.Parser (module)

Extracts ash multipart request body.

For use with `Plug.Parsers`, as in the example below.

### Examples - AshJsonApi.Plug.Parser (module)

Should be used with `Plug.Parsers`:

    plug Plug.Parsers,
      parsers: [:urlencoded, :multipart, :json, AshJsonApi.Plug.Parser],
      pass: ["*/*"],
      json_decoder: Jason

### Protocol - AshJsonApi.Plug.Parser (module)

To use files in your request, send a
[multipart](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types#multipart)
with the content type `multipart/x.ash+form-data`. The request MUST
contain a JSON object with the key `data` and the value of the object you want
to send.

The request MAY contain other keys with the value of the file you want to
send. The parser will walk through all of the `data` JSON and replace each
string equal to a part name with the content of the part. This means that if
you have a part named `users_csv` and a key in the `data` JSON object with the
value `users_csv`, the parser will replace the string with the content of the
part.

> #### Conflicting Part names {:.warning}
>
> Ensure that each part name is unique and does not naturally occur inside as
> a string in the `data` JSON object. If a part name is found in the `data`
> JSON object, the parser will replace it with the content of the part.
>
> It is recommended to use a unique value like a UUID as the part name.

### Example HTTP Message - AshJsonApi.Plug.Parser (module)

```
POST /action
Host: example.com
Content-Length: 2740
Content-Type: multipart/x.ash+form-data; boundary=abcde12345
--abcde12345
Content-Disposition: form-data; name="data"
Content-Type: application/vnd.api+json

{"users": "users_csv", "meatdata": "metadata_json"}
--abcde12345
Content-Disposition: form-data; name="users_csv"; filename="users.csv"
Content-Type: text/csv

[file content goes here]
--abcde12345
Content-Disposition: form-data; name="metadata_json"; filename="metadata.json"
Content-Type: application/json

[file content goes there]
--abcde12345--
```

### AshJsonApi.Resource.Verifiers.VerifyActions (module)

Verifies that all actions are valid for each route.

### AshJsonApi.Resource.Verifiers.VerifyHasType (module)

Verifies that a resource has a type if it has any routes that need it.

### AshJsonApi.Resource.Verifiers.VerifyIncludes (module)

Verifies that all includes are valid public relationships

### AshJsonApi.Resource.Verifiers.VerifyQueryParams (module)

Verify query params are not reserved or shadowed by the route

### AshJsonApi.Resource.Verifiers.VerifyRelationships (module)

Verifies that any routes that reference a relationship reference a public one

### AshJsonApi.Resource.Verifiers.VerifyRelationships.verify/1 (function)



### AshJsonApi.Type (behaviour)

The behaviour for customizing how a datatype is rendered and written in AshJsonApi.

### AshJsonApi.Type.json_schema/1 (callback)



### AshJsonApi.Type.json_write_schema/1 (callback)



### Mix.Tasks.AshJsonApi.Install.igniter/1 (function)



### Mix.Tasks.AshJsonApi.Routes.get_url_info/2 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_json_api)# ash_authentication

> Authentication extension for the Ash Framework.

## Docs

### AshAuthentication (module)

AshAuthentication provides a turn-key authentication solution for folks using
[Ash](https://www.ash-hq.org/).

### Usage - AshAuthentication (module)

This package assumes that you have [Ash](https://ash-hq.org/) installed and
configured.  See the Ash documentation for details.

Once installed you can easily add support for authentication by configuring
the `AshAuthentication` extension on your resource:

```elixir
defmodule MyApp.Accounts.User do
  use Ash.Resource,
    extensions: [AshAuthentication],
    domain: MyApp.Accounts

  attributes do
    uuid_primary_key :id
    attribute :email, :ci_string, allow_nil?: false
    attribute :hashed_password, :string, allow_nil?: false, sensitive?: true
  end

  authentication do
    strategies do
      password :password do
        identity_field :email
        hashed_password_field :hashed_password
      end
    end
  end

  identities do
    identity :unique_email, [:email]
  end
end
```

If you plan on providing authentication via the web, then you will need to
define a plug using `AshAuthentication.Plug` which builds a `Plug.Router` that
routes incoming authentication requests to the correct provider and provides
callbacks for you to manipulate the conn after success or failure.

If you're using AshAuthentication with Phoenix, then check out
[`ash_authentication_phoenix`](https://github.com/team-alembic/ash_authentication_phoenix)
which provides route helpers, a controller abstraction and LiveView components
for easy set up.

### Authentication Strategies - AshAuthentication (module)

Currently supported strategies:

1. `AshAuthentication.Strategy.Password`
   - authenticate users against your local database using a unique identity
   (such as username or email address) and a password.
2. `AshAuthentication.Strategy.OAuth2`
   - authenticate using local or remote [OAuth 2.0](https://oauth.net/2/) compatible services.
   - also includes:
     - `AshAuthentication.Strategy.Apple`
     - `AshAuthentication.Strategy.Auth0`
     - `AshAuthentication.Strategy.Github`
     - `AshAuthentication.Strategy.Google`
     - `AshAuthentication.Strategy.Oidc`
     - `AshAuthentication.Strategy.Slack`
3. `AshAuthentication.Strategy.MagicLink`
   - authenticate by sending a single-use link to the user.

### HTTP client settings - AshAuthentication (module)

Most of the authentication strategies based on `OAuth2` wrap the [`assent`](https://hex.pm/packages/assent) package.

If you needs to customize the behavior of the http client used by `assent`, define a custom `http_adapter` in the
application settings:

`config :ash_authentication, :http_adapter, {Assent.HTTPAdapter.Finch, supervisor: MyApp.CustomFinch}`

See [`assent's documentation`](https://hexdocs.pm/assent/README.html#http-client) for more details on the supported
http clients and their configuration.

### Add-ons - AshAuthentication (module)

Add-ons are like strategies, except that they don't actually provide
authentication - they just provide features adjacent to authentication.
Current add-ons:

1. `AshAuthentication.AddOn.Confirmation`
   - allows you to force the user to confirm changes using a confirmation
     token (eg. sending a confirmation email when a new user registers).

### Supervisor - AshAuthentication (module)

Some add-ons or strategies may require processes to be started which manage
their state over the lifetime of the application (eg periodically deleting
expired token revocations).  Because of this you should add
`{AshAuthentication.Supervisor, otp_app: :my_app}` to your application's
supervision tree.  See [the Elixir
docs](https://hexdocs.pm/elixir/Application.html#module-the-application-callback-module)
for more information.

### AshAuthentication.authenticated_resources/1 (function)

Find all resources which support authentication for a given OTP application.

Returns a list of resource modules.

### AshAuthentication.authentication/1 (macro)



### AshAuthentication.do_subject_to_user/3 (function)



### AshAuthentication.resource_config/0 (type)



### AshAuthentication.subject/0 (type)



### AshAuthentication.subject_to_user/3 (function)

Given a subject string, attempt to retrieve a user record.

    iex> %{id: user_id} = build_user()
    ...> {:ok, %{id: ^user_id}} = subject_to_user("user?id=#{user_id}", Example.User)

Any options passed will be passed to the underlying `Domain.read/2` callback.

### AshAuthentication.user_to_subject/1 (function)

Return a subject string for user.

This is done by concatenating the resource's subject name with the resource's
primary key field(s) to generate a uri-like string.

Example:

    iex> build_user(id: "ce7969f9-afa5-474c-bc52-ac23a103cef6") |> user_to_subject()
    "user?id=ce7969f9-afa5-474c-bc52-ac23a103cef6"

### AshAuthentication.TokenResource (module)

This is an Ash resource extension which generates the default token resource.

The token resource is used to store information about tokens that should not
be shared with the end user.  It does not actually contain any tokens.

For example:

  * When an authentication token has been revoked
  * When a confirmation token has changes to apply

### Storage - AshAuthentication.TokenResource (module)

The information stored in this resource is essentially ephemeral - all tokens
have an expiry date, so it doesn't make sense to keep them after that time has
passed.  However, if you have any tokens with very long expiry times then we
suggest you store this resource in a resilient data-layer such as Postgres.

### Usage - AshAuthentication.TokenResource (module)

There is no need to define any attributes or actions (although you can if you
want).  The extension will wire up everything that's needed for the token
system to function.

```
defmodule MyApp.Accounts.Token do
  use Ash.Resource,
    data_layer: AshPostgres.DataLayer,
    extensions: [AshAuthentication.TokenResource],
    domain: MyApp.Accounts

  postgres do
    table "tokens"
    repo MyApp.Repo
  end
end
```

Whilst it is possible to have multiple token resources, there is no need to do
so.

### Removing expired records - AshAuthentication.TokenResource (module)

Once a token has expired there's no point in keeping the information it refers
to, so expired tokens can be automatically removed by adding the
`AshAuthentication.Supervisor` to your application supervision tree.  This
will start the `AshAuthentication.TokenResource.Expunger` `GenServer` which
periodically scans and removes any expired records.

### AshAuthentication.TokenResource.expunge_expired/2 (function)

Remove all expired records.

### AshAuthentication.TokenResource.jti_revoked?/3 (function)

Has the token been revoked?

Similar to `token-revoked?/2..3` except that rather than extracting the JTI
from the token, assumes that it's being passed in directly.

### AshAuthentication.TokenResource.revoke/3 (function)

Revoke a token.

Extracts the JTI from the provided token and uses it to generate a revocation
record.

### AshAuthentication.TokenResource.token/1 (macro)



### AshAuthentication.TokenResource.token_revoked?/3 (function)

Has the token been revoked?

Similar to `jti_revoked?/2..3` except that it extracts the JTI from the token,
rather than relying on it to be passed in.

### AshAuthentication.UserIdentity (module)

An Ash extension which generates the default user identities resource.

If you plan to support multiple different strategies at once (eg giving your
users the choice of more than one authentication provider, or signing them into
multiple services simultaneously) then you will want to create a resource with
this extension enabled. It is used to keep track of the links between your
local user records and their many remote identities.

The user identities resource is used to store information returned by remote
authentication strategies (such as those provided by OAuth2) and maps them to
your user resource(s).  This provides the following benefits:

  1. A user can be signed in to multiple authentication strategies at once.
  2. For those providers that support it, AshAuthentication can handle
     automatic refreshing of tokens.

### Storage - AshAuthentication.UserIdentity (module)

User identities are expected to be relatively long-lived (although they're
deleted on log out), so should probably be stored using a permanent data layer
such as `ash_postgres`.

### Usage - AshAuthentication.UserIdentity (module)

There is no need to define any attributes, etc.  The extension will generate
them all for you.  As there is no other use-case for this resource it's
unlikely that you will need to customise it.

```elixir
defmodule MyApp.Accounts.UserIdentity do
  use Ash.Resource,
    data_layer: AshPostgres.DataLayer,
    extensions: [AshAuthentication.UserIdentity],
    domain: MyApp.Accounts

  user_identity do
    user_resource MyApp.Accounts.User
  end

  postgres do
    table "user_identities"
    repo MyApp.Repo
  end
end
```

If you intend to operate with multiple user resources, you will need to define
multiple user identity resources.

### AshAuthentication.UserIdentity.user_identity/1 (macro)



### AshAuthentication.AddOn.Confirmation (module)

Confirmation support.

Sometimes when creating a new user, or changing a sensitive attribute (such as
their email address) you may want to wait for the user to confirm by way of
sending them a confirmation token to prove that it was really them that took
the action.

In order to add confirmation to your resource, it must been the following
minimum requirements:

1. Have a primary key
2. Have at least one attribute you wish to confirm
3. Tokens must be enabled

### Example - AshAuthentication.AddOn.Confirmation (module)

```elixir
defmodule MyApp.Accounts.User do
  use Ash.Resource,
    extensions: [AshAuthentication],
    domain: MyApp.Accounts

  attributes do
    uuid_primary_key :id
    attribute :email, :ci_string, allow_nil?: false
  end

  authentication do
    add_ons do
      confirmation :confirm do
        monitor_fields [:email]
        sender MyApp.ConfirmationSender
      end
    end

    strategies do
      # ...
    end
  end

  identities do
    identity :email, [:email]
  end
end
```

### Attributes - AshAuthentication.AddOn.Confirmation (module)

A `confirmed_at` attribute will be added to your resource if it's not already
present (see `confirmed_at_field` in the DSL documentation).

### Actions - AshAuthentication.AddOn.Confirmation (module)

By default confirmation will add an action which updates the `confirmed_at`
attribute as well as retrieving previously stored changes and applying them to
the resource.

If you wish to perform the confirm action directly from your code you can do
so via the `AshAuthentication.Strategy` protocol.

### Example - AshAuthentication.AddOn.Confirmation (module)

iex> strategy = Info.strategy!(Example.User, :confirm)
    ...> {:ok, user} = Strategy.action(strategy, :confirm, %{"confirm" => confirmation_token()})
    ...> user.confirmed_at >= one_second_ago()
    true

### Usage with AshAuthenticationPhoenix - AshAuthentication.AddOn.Confirmation (module)

If you are using `AshAuthenticationPhoenix`, and have `require_interaction?` set to `true`,
which you very much should, then you will need to add a `confirm_route` to your router. This
is placed in the same location as `auth_routes`, and should be provided the user and the
strategy name. For example:

```elixir
# Remove this if you do not want to use the confirmation strategy
confirm_route(
  MyApp.Accounts.User,
  :confirm_new_user,
  auth_routes_prefix: "/auth",
  overrides: [MyApp.AuthOverrides, AshAuthentication.Phoenix.Overrides.Default]
)
```

### Plugs - AshAuthentication.AddOn.Confirmation (module)

Confirmation provides a single endpoint for the `:confirm` phase.  If you wish
to interact with the plugs directly, you can do so via the
`AshAuthentication.Strategy` protocol.

### Example - AshAuthentication.AddOn.Confirmation (module)

iex> strategy = Info.strategy!(Example.User, :confirm)
    ...> conn = conn(:get, "/user/confirm", %{"confirm" => confirmation_token()})
    ...> conn = Strategy.plug(strategy, :confirm, conn)
    ...> {_conn, {:ok, user}} = Plug.Helpers.get_authentication_result(conn)
    ...> user.confirmed_at >= one_second_ago()
    true

### AshAuthentication.AddOn.Confirmation.confirmation_token/4 (function)

Generate a confirmation token for a changeset.

This will generate a token with the `"act"` claim set to the confirmation
action for the strategy, and the `"chg"` claim will contain any changes.

### AshAuthentication.AddOn.Confirmation.t/0 (type)



### AshAuthentication.AddOn.Confirmation.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.AddOn.Confirmation.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.AddOn.LogOutEverywhere (module)

Log out everywhere support.

Sometimes it's necessary to be able to invalidate all of a user's sessions
with a single action. This add-on provides this functionality.

In order to use this feature the following features must be enabled:

1. Tokens must be enabled.
2. The `authentication.tokens.store_all_tokens?` option is enabled.
3. The `authentication.tokens.require_token_presence_for_authentication?`
   option is enabled.
4. For the `apply_on_password_change?` option, at least one password strategy
   must be enabled.

### Example - AshAuthentication.AddOn.LogOutEverywhere (module)

```elixir
defmodule MyApp.Accounts.User do
  use Ash.Resource,
    extensions: [AshAuthentication],
    domain: MyApp.Accounts

  authentication do
    tokens do
      enabled? true
      store_all_tokens? true
      require_token_presence_for_authentication? true
    end

    add_ons do
      log_out_everywhere do
        apply_on_password_change? true
      end
    end
```

### Actions - AshAuthentication.AddOn.LogOutEverywhere (module)

By default the add-on will add a `log_out_everywhere` action which reverts all
the existing non-expired tokens for the user in question.

### Example - AshAuthentication.AddOn.LogOutEverywhere (module)

iex> strategy = Info.strategy!(Example.User, :log_out_everywhere)
    ...> {:ok, user} = Strategy.action(strategy, :log_out_everywhere, %{"user_id" => user_id()})
    ...> user.id == user_id()
    true

### AshAuthentication.AddOn.LogOutEverywhere.t/0 (type)



### AshAuthentication.AddOn.LogOutEverywhere.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.AddOn.LogOutEverywhere.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.Strategy (protocol)

The protocol used for interacting with authentication strategies.

Any new Authentication strategy must implement this protocol.

### AshAuthentication.Strategy.action/0 (type)

The name of an individual action supported by the strategy.

This maybe not be the action name on the underlying resource, which may be
generated, but the name that the strategy itself calls the action.

### AshAuthentication.Strategy.action/4 (function)

Perform an named action.

Different strategies are likely to implement a number of different actions
depending on their configuration.  Calling them via this function will ensure
that the context is correctly set, etc.

See `actions/1` for a list of actions provided by the strategy.

Any options passed to the action will be passed to the underlying `Ash.Domain` function.

### AshAuthentication.Strategy.actions/1 (function)

Return a list of actions supported by the strategy.

### Example - AshAuthentication.Strategy.actions/1 (function)

iex> strategy = Info.strategy!(Example.User, :password)
    ...> actions(strategy)
    [:sign_in_with_token, :register, :sign_in, :reset_request, :reset]

### AshAuthentication.Strategy.http_method/0 (type)



### AshAuthentication.Strategy.method_for_phase/2 (function)

Return the HTTP method for a phase.

### Example - AshAuthentication.Strategy.method_for_phase/2 (function)

iex> strategy = Info.strategy!(Example.User, :oauth2)
    ...> method_for_phase(strategy, :request)
    :get

### AshAuthentication.Strategy.name/1 (function)

The "short name" of the strategy, used for genererating routes, etc.

This is most likely the same value that you use for the entity's `name`
argument.

### AshAuthentication.Strategy.path/0 (type)

A path to match in web requests

### AshAuthentication.Strategy.phase/0 (type)

The "phase" of the request.

Usually `:request` or `:callback` but can be any atom.

### AshAuthentication.Strategy.phases/1 (function)

Return a list of phases supported by the strategy.

### Example - AshAuthentication.Strategy.phases/1 (function)

iex> strategy = Info.strategy!(Example.User, :password)
    ...> phases(strategy)
    [:sign_in_with_token, :register, :sign_in, :reset_request, :reset]

### AshAuthentication.Strategy.plug/3 (function)

Handle requests routed to the strategy.

Each phase will be an atom (ie the second element in the route tuple).

See `phases/1` for a list of phases supported by the strategy.

### AshAuthentication.Strategy.route/0 (type)

An individual route.

Eg: `{"/user/password/sign_in", :sign_in}`

### AshAuthentication.Strategy.routes/1 (function)

Used to build the routing table to route web requests to request phases for
each strategy.

### Example - AshAuthentication.Strategy.routes/1 (function)

iex> strategy = Info.strategy!(Example.User, :password)
    ...> routes(strategy)
    [
      {"/user/password/sign_in_with_token", :sign_in_with_token},
      {"/user/password/register", :register},
      {"/user/password/sign_in", :sign_in},
      {"/user/password/reset_request", :reset_request},
      {"/user/password/reset", :reset}
    ]

### AshAuthentication.Strategy.t/0 (type)

All the types that implement this protocol.

### AshAuthentication.Strategy.tokens_required?/1 (function)

Indicates that the strategy creates or consumes tokens.

### AshAuthentication.Strategy.Apple (module)

Strategy for authenticating using [Apple Sign In](https://developer.apple.com/sign-in-with-apple/)

This strategy builds on-top of `AshAuthentication.Strategy.Oidc` and
[`assent`](https://hex.pm/packages/assent).

In order to use Apple Sign In you need to provide the following minimum configuration:

  - `client_id`
  - `team_id`
  - `private_key_id`
  - `private_key_path`
  - `redirect_uri`

### More documentation: - AshAuthentication.Strategy.Apple (module)

- The [Apple Sign In Documentation](https://developer.apple.com/documentation/sign_in_with_apple).
- The [OIDC documentation](`AshAuthentication.Strategy.Oidc`)

### AshAuthentication.Strategy.Apple.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.Strategy.Apple.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.Strategy.Auth0 (module)

Strategy for authenticating using [Auth0](https://auth0.com).

This strategy builds on-top of `AshAuthentication.Strategy.OAuth2` and
[`assent`](https://hex.pm/packages/assent).

In order to use Auth0 you need to provide the following minimum configuration:

  - `client_id`
  - `redirect_uri`
  - `client_secret`
  - `site`

### More documentation: - AshAuthentication.Strategy.Auth0 (module)

- The [Auth0 Tutorial](/documentation/tutorial/auth0.md).
- The [OAuth2 documentation](`AshAuthentication.Strategy.OAuth2`)

### AshAuthentication.Strategy.Auth0.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.Strategy.Auth0.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.Strategy.Custom (behaviour)

Define your own custom authentication strategy.

See [the Custom Strategies guide](/documentation/topics/custom-strategy.md)
for more information.

### AshAuthentication.Strategy.Custom.entity/0 (type)

A Strategy DSL Entity.

See `Spark.Dsl.Entity` for more information.

### AshAuthentication.Strategy.Custom.set_defaults/2 (function)

Sets default values for a DSL schema based on a set of defaults.

If a given default is in the schema, it can be overriden, so we just set the default
and mark it not required.

If not, then we add it to `auto_set_fields`, and the user cannot override it.

### AshAuthentication.Strategy.Custom.strategy/0 (type)

This is the DSL target for your entity and the struct for which you will
implement the `AshAuthentication.Strategy` protocol.

The only required field is `strategy_module` which is used to keep track of
which custom strategy created which strategy.

### AshAuthentication.Strategy.Custom.transform/2 (callback)

If your strategy needs to modify either the entity or the parent resource then
you can implement this callback.

This callback can return one of three results:

  - `{:ok, Entity.t}` - an updated DSL entity - useful if you're just changing
    the entity itself and not changing the wider DSL state of the resource.
    If this is the response then the transformer will take care of updating
    the entity in the DSL state.
  - `{:ok, Dsl.t}` - an updated DSL state for the entire resource.
  - `{:error, Exception.t}` - a compilation-stopping problem was found. Any
    exception can be returned, but we strongly advise you to return a
    `Spark.Error.DslError`.

### AshAuthentication.Strategy.Custom.verify/2 (callback)

If your strategy needs to verify either the entity or the parent resource then
you can implement this callback.

This is called post-compilation in the `@after_verify` hook - see `Module` for
more information.

This callback can return one of the following results:

  - `:ok` - everything is A-Okay.
  - `{:error, Exception.t}` - a compilation-stopping problem was found. Any
    exception can be returned, but we strongly advise you to return a
    `Spark.Error.DslError`.

### AshAuthentication.Strategy.Github (module)

Strategy for authenticating using [GitHub](https://github.com)

This strategy builds on-top of `AshAuthentication.Strategy.OAuth2` and
[`assent`](https://hex.pm/packages/assent).

In order to use GitHub you need to provide the following minimum configuration:

  - `client_id`
  - `redirect_uri`
  - `client_secret`

### More documentation: - AshAuthentication.Strategy.Github (module)

- The [GitHub Tutorial](/documentation/tutorial/github.md).
- The [OAuth2 documentation](`AshAuthentication.Strategy.OAuth2`)

### AshAuthentication.Strategy.Github.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.Strategy.Github.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.Strategy.Google (module)

Strategy for authenticating using [Google](https://google.com)

This strategy builds on-top of `AshAuthentication.Strategy.OAuth2` and
[`assent`](https://hex.pm/packages/assent).

In order to use Google you need to provide the following minimum configuration:

  - `client_id`
  - `redirect_uri`
  - `client_secret`
  - `site`

### More documentation: - AshAuthentication.Strategy.Google (module)

- The [Google OAuth 2.0 Overview](https://developers.google.com/identity/protocols/oauth2).
- The [Google Tutorial](/documentation/tutorial/google.md)
- The [OAuth2 documentation](`AshAuthentication.Strategy.OAuth2`)

### AshAuthentication.Strategy.Google.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.Strategy.Google.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.Strategy.MagicLink (module)

Strategy for authentication using a magic link.

In order to use magic link authentication your resource needs to meet the
following minimum requirements:

1. Have a primary key.
2. A uniquely constrained identity field (eg `username` or `email`)
3. Have tokens enabled.

There are other options documented in the DSL.

### Example - AshAuthentication.Strategy.MagicLink (module)

```elixir
defmodule MyApp.Accounts.User do
  use Ash.Resource,
    extensions: [AshAuthentication],
    domain: MyApp.Accounts

  attributes do
    uuid_primary_key :id
    attribute :email, :ci_string, allow_nil?: false
  end

  authentication do
    strategies do
      magic_link do
        identity_field :email
        sender fn user_or_email, token, _opts ->
          # will be a user if the token relates to an existing user
          # will be an email if there is no matching user (such as during sign up)
          # opts will contain the `tenant` key, use this if you need to alter the link based
          # on the tenant that requested the token
          MyApp.Emails.deliver_magic_link(user_or_email, token)
        end
      end
    end
  end

  identities do
    identity :unique_email, [:email]
  end
end
```

### Tenancy - AshAuthentication.Strategy.MagicLink (module)

Note that the tenant is provided to the sender in the `opts` key. Use this if you need
to modify the url (i.e `tenant.app.com`) based on the tenant that requested the token.

### Actions - AshAuthentication.Strategy.MagicLink (module)

By default the magic link strategy will automatically generate the request and
sign-in actions for you, however you're free to define them yourself.  If you
do, then the action will be validated to ensure that all the needed
configuration is present.

If you wish to work with the actions directly from your code you can do so via
the `AshAuthentication.Strategy` protocol.

### Examples - AshAuthentication.Strategy.MagicLink (module)

Requesting that a magic link token is sent for a user:

    iex> strategy = Info.strategy!(Example.User, :magic_link)
    ...> user = build_user()
    ...> Strategy.action(strategy, :request, %{"username" => user.username})
    :ok

Signing in using a magic link token:

    ...> {:ok, token} = MagicLink.request_token_for(strategy, user)
    ...> {:ok, signed_in_user} = Strategy.action(strategy, :sign_in, %{"token" => token})
    ...> signed_in_user.id == user
    true

### Usage with AshAuthenticationPhoenix - AshAuthentication.Strategy.MagicLink (module)

If you are using `AshAuthenticationPhoenix`, and have `require_authentication?` set to `true`, which you very much should, then you will need to add a `magic_sign_in_route` to your router. This is placed in the same location as `auth_routes`, and should be provided the user and the strategy name. For example:

```elixir
# Remove this if you do not want to use the magic link strategy
magic_sign_in_route(
  MyApp.Accounts.User,
  :sign_in,
  auth_routes_prefix: "/auth",
  overrides: [MyApp.AuthOverrides, AshAuthentication.Phoenix.Overrides.Default]
)
```

### Plugs - AshAuthentication.Strategy.MagicLink (module)

The magic link strategy provides plug endpoints for both request and sign-in
actions.

If you wish to work with the plugs directly, you can do so via the
`AshAuthentication.Strategy` protocol.

### Examples: - AshAuthentication.Strategy.MagicLink (module)

Dispatching to plugs directly:

    iex> strategy = Info.strategy!(Example.User, :magic_link)
    ...> user = build_user()
    ...> conn = conn(:post, "/user/magic_link/request", %{"user" => %{"username" => user.username}})
    ...> conn = Strategy.plug(strategy, :request, conn)
    ...> {_conn, {:ok, nil}} = Plug.Helpers.get_authentication_result(conn)

    ...> {:ok, token} = MagicLink.request_token_for(strategy, user)
    ...> conn = conn(:get, "/user/magic_link", %{"token" => token})
    ...> conn = Strategy.plug(strategy, :sign_in, conn)
    ...> {_conn, {:ok, signed_in_user}} = Plug.Helpers.get_authentication_result(conn)
    ...> signed_in_user.id == user.id
    true

See the [Magic Link Tutorial](/documentation/tutorial/magic-links.md) for more information.

### AshAuthentication.Strategy.MagicLink.request_token_for/4 (function)

Generate a magic link token for a user.

Used by `AshAuthentication.Strategy.MagicLink.RequestPreparation`.

### AshAuthentication.Strategy.MagicLink.request_token_for_identity/4 (function)

Generate a magic link token for an identity field.

Used by `AshAuthentication.Strategy.MagicLink.RequestPreparation`.

### AshAuthentication.Strategy.MagicLink.t/0 (type)



### AshAuthentication.Strategy.MagicLink.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.Strategy.MagicLink.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.Strategy.OAuth2 (module)

Strategy for authenticating using any OAuth 2.0 server as the source of truth.

This authentication strategy provides registration and sign-in for users using a
remote [OAuth 2.0](https://oauth.net/2/) server as the source of truth. You
will be required to provide either a "register" or a "sign-in" action depending
on your configuration, which the strategy will attempt to validate for common
misconfigurations.

This strategy wraps the excellent [`assent`](https://hex.pm/packages/assent)
package, which provides OAuth 2.0 capabilities.

In order to use OAuth 2.0 authentication on your resource, it needs to meet
the following minimum criteria:

1. Have a primary key.
2. Provide a strategy-specific action, either register or sign-in.
3. Provide configuration for OAuth2 destinations, secrets, etc.

### Example: - AshAuthentication.Strategy.OAuth2 (module)

```elixir
defmodule MyApp.Accounts.User do
  use Ash.Resource,
    extensions: [AshAuthentication],
    domain: MyApp.Accounts

  attributes do
    uuid_primary_key :id
    attribute :email, :ci_string, allow_nil?: false
  end

  authentication do
    strategies do
      oauth2 :example do
        client_id "OAuth Client ID"
        redirect_uri "https://my.app/"
        client_secret "My Super Secret Secret"
        site "https://auth.example.com/"
      end
    end
  end
end
```

### Secrets and runtime configuration - AshAuthentication.Strategy.OAuth2 (module)

In order to use OAuth 2.0 you need to provide a varying number of secrets and
other configuration which may change based on runtime environment.  The
`AshAuthentication.Secret` behaviour is provided to accommodate this.  This
allows you to provide configuration either directly on the resource (ie as a
string), as an anonymous function, or as a module.

>

### Warning - AshAuthentication.Strategy.OAuth2 (module)

>
> We **strongly** urge you not to share actual secrets in your code or
> repository.

### Examples: - AshAuthentication.Strategy.OAuth2 (module)

Providing configuration as an anonymous function:

```elixir
oauth2 do
  client_secret fn _path, resource ->
    Application.fetch_env(:my_app, resource, :oauth2_client_secret)
  end
end
```

Providing configuration as a module:

```elixir
defmodule MyApp.Secrets do
  use AshAuthentication.Secret

  def secret_for([:authentication, :strategies, :example, :client_secret], MyApp.User, _opts), do: Application.fetch_env(:my_app, :oauth2_client_secret)
end

# and in your strategies:

oauth2 :example do
  client_secret MyApp.Secrets
end
```

### User identities - AshAuthentication.Strategy.OAuth2 (module)

Because your users can be signed in via multiple providers at once, you can
specify an `identity_resource` in the DSL configuration which points to a
seperate Ash resource which has the `AshAuthentication.UserIdentity` extension
present. This resource will be used to store details of the providers in use
by each user and a relationship will be added to the user resource.

Setting the `identity_resource` will cause extra validations to be applied to
your resource so that changes are tracked correctly on sign-in or
registration.

### Actions - AshAuthentication.Strategy.OAuth2 (module)

When using an OAuth 2.0 provider you need to declare either a "register" or
"sign-in" action.  The reason for this is that it's not possible for us to
know ahead of time how you want to manage the link between your user resources
and the "user info" provided by the OAuth server.

Both actions receive the following two arguments:

1. `user_info` - a map with string keys containing the [OpenID Successful
   UserInfo
   response](https://openid.net/specs/openid-connect-core-1_0.html#UserInfoResponse).
   Usually this will be used to populate your email, nickname or other
   identifying field.
2. `oauth_tokens` a map with string keys containing the [OpenID Successful
   Token
   response](https://openid.net/specs/openid-connect-core-1_0.html#TokenResponse)
   (or similar).

The actions themselves can be interacted with directly via the
`AshAuthentication.Strategy` protocol, but you are more likely to interact
with them via the web/plugs.

### Sign-in - AshAuthentication.Strategy.OAuth2 (module)

The sign-in action is called when a successful OAuth2 callback is received.
You should use it to constrain the query to the correct user based on the
arguments provided.

This action is only needed when the `registration_enabled?` DSL settings is
set to `false`.

### Registration - AshAuthentication.Strategy.OAuth2 (module)

The register action is a little more complicated than the sign-in action,
because we cannot tell the difference between a new user and a returning user
(they all use the same OAuth flow).  In order to handle this your register
action must be defined as an upsert with a configured `upsert_identity` (see
example below).

### Examples: - AshAuthentication.Strategy.OAuth2 (module)

Providing sign-in to users who already exist in the database (and by extension
rejecting new users):

```elixir
defmodule MyApp.Accounts.User do
  attributes do
    uuid_primary_key :id
    attribute :email, :ci_string, allow_nil?: false
  end

  actions do
    read :sign_in_with_example do
      argument :user_info, :map, allow_nil?: false
      argument :oauth_tokens, :map, allow_nil?: false
      prepare AshAuthentication.Strategy.OAuth2.SignInPreparation

      filter expr(email == get_path(^arg(:user_info), [:email]))
    end
  end

  authentication do
    strategies do
      oauth2 :example do
        registration_enabled? false
      end
    end
  end
end
```

Providing registration or sign-in to all comers:

```elixir
defmodule MyApp.Accounts.User do
  attributes do
    uuid_primary_key :id
    attribute :email, :ci_string, allow_nil?: false
  end

  actions do
    create :register_with_oauth2 do
      argument :user_info, :map, allow_nil?: false
      argument :oauth_tokens, :map, allow_nil?: false
      upsert? true
      upsert_identity :email

      change AshAuthentication.GenerateTokenChange
      change fn changeset, _ctx ->
        user_info = Ash.Changeset.get_argument(changeset, :user_info)

        changeset
        |> Ash.Changeset.change_attribute(:email, user_info["email"])
      end
    end
  end

  authentication do
    strategies do
      oauth2 :example do
      end
    end
  end
end
```

### Plugs - AshAuthentication.Strategy.OAuth2 (module)

OAuth 2.0 is (usually) a browser-based flow. This means that you're most
likely to interact with this strategy via it's plugs.  There are two phases to
authentication with OAuth 2.0:

1. The request phase, where the user's browser is redirected to the remote
   authentication provider for authentication.
2. The callback phase, where the provider redirects the user back to your app
   to create a local database record, session, etc.

### AshAuthentication.Strategy.OAuth2.secret/0 (type)



### AshAuthentication.Strategy.OAuth2.secret_keyword/0 (type)



### AshAuthentication.Strategy.OAuth2.secret_list/0 (type)



### AshAuthentication.Strategy.OAuth2.t/0 (type)



### AshAuthentication.Strategy.OAuth2.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.Strategy.OAuth2.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.Strategy.Oidc (module)

Strategy for authentication using an [OpenID
Connect](https://openid.net/connect/) compatible server as the source of
truth.

This strategy builds on-top of `AshAuthentication.Strategy.OAuth2` and
[`assent`](https://hex.pm/packages/assent).

In order to use OIDC you need to provide the following minimum configuration:

- `client_id` - The client id, required
- `site` - The OIDC issuer, required
- `openid_configuration_uri` - The URI for OpenID Provider, optional, defaults
  to `/.well-known/openid-configuration`
- `client_authentication_method` - The Client Authentication method to use,
  optional, defaults to `client_secret_basic`
- `client_secret` - The client secret, required if
  `:client_authentication_method` is `:client_secret_basic`,
  `:client_secret_post`, or `:client_secret_jwt`
- `openid_configuration` - The OpenID configuration, optional, the
  configuration will be fetched from `:openid_configuration_uri` if this is
  not defined
- `id_token_signed_response_alg` - The `id_token_signed_response_alg`
  parameter sent by the Client during Registration, defaults to `RS256`
- `id_token_ttl_seconds` - The number of seconds from `iat` that an ID Token
  will be considered valid, optional, defaults to nil
- `nonce` - The nonce to use for authorization request, optional, MUST be
  session based and unguessable.

### Nonce - AshAuthentication.Strategy.Oidc (module)

`nonce` can be set in the provider config. The `nonce` will be returned in the
`session_params` along with `state`. You can use this to store the value in
the current session e.g. a httpOnly session cookie.

A random value generator can look like this:

```elixir
16
|> :crypto.strong_rand_bytes()
|> Base.encode64(padding: false)
```

AshAuthentication will dynamically generate one for the session if `nonce` is
set to `true`.

### More documentation: - AshAuthentication.Strategy.Oidc (module)

- The [OAuth2 documentation](`AshAuthentication.Strategy.OAuth2`)

### AshAuthentication.Strategy.Oidc.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.Strategy.Oidc.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.Strategy.Password (module)

Strategy for authenticating using local resources as the source of truth.

In order to use password authentication your resource needs to meet the
following minimum requirements:

1. Have a primary key.
2. A uniquely constrained identity field (eg `username` or `email`).
3. A sensitive string field within which to store the hashed password.

There are other options documented in the DSL.

### Example: - AshAuthentication.Strategy.Password (module)

```elixir
defmodule MyApp.Accounts.User do
  use Ash.Resource,
    extensions: [AshAuthentication],
    domain: MyApp.Accounts

  attributes do
    uuid_primary_key :id
    attribute :email, :ci_string, allow_nil?: false
    attribute :hashed_password, :string, allow_nil?: false, sensitive?: true
  end

  authentication do
    strategies do
      password :password do
        identity_field :email
        hashed_password_field :hashed_password
      end
    end
  end

  identities do
    identity :unique_email, [:email]
  end
end
```

### Actions - AshAuthentication.Strategy.Password (module)

By default the password strategy will automatically generate the register,
sign-in, reset-request and reset actions for you, however you're free to
define them yourself.  If you do, then the action will be validated to ensure
that all the needed configuration is present.

If you wish to work with the actions directly from your code you can do so via
the `AshAuthentication.Strategy` protocol.

### Examples: - AshAuthentication.Strategy.Password (module)

Interacting with the actions directly:

    iex> strategy = Info.strategy!(Example.User, :password)
    ...> {:ok, marty} = Strategy.action(strategy, :register, %{"username" => "marty", "password" => "outatime1985", "password_confirmation" => "outatime1985"})
    ...> marty.username |> to_string()
    "marty"

    ...> {:ok, user} = Strategy.action(strategy, :sign_in, %{"username" => "marty", "password" => "outatime1985"})
    ...> user.username |> to_string()
    "marty"

### Plugs - AshAuthentication.Strategy.Password (module)

The password strategy provides plug endpoints for all four actions, although
only sign-in and register will be reported by `Strategy.routes/1` if the
strategy is not configured as resettable.

If you wish to work with the plugs directly, you can do so via the
`AshAuthentication.Strategy` protocol.

### Examples: - AshAuthentication.Strategy.Password (module)

Dispatching to plugs directly:

    iex> strategy = Info.strategy!(Example.User, :password)
    ...> conn = conn(:post, "/user/password/register", %{"user" => %{"username" => "marty", "password" => "outatime1985", "password_confirmation" => "outatime1985"}})
    ...> conn = Strategy.plug(strategy, :register, conn)
    ...> {_conn, {:ok, marty}} = Plug.Helpers.get_authentication_result(conn)
    ...> marty.username |> to_string()
    "marty"

    ...> conn = conn(:post, "/user/password/reset_request", %{"user" => %{"username" => "marty"}})
    ...> conn = Strategy.plug(strategy, :reset_request, conn)
    ...> {_conn, :ok} = Plug.Helpers.get_authentication_result(conn)

### Testing - AshAuthentication.Strategy.Password (module)

See the [Testing guide](/documentation/topics/testing.md) for tips on testing resources using this strategy.

### AshAuthentication.Strategy.Password.reset_token_for/2 (function)

Generate a reset token for a user.

Used by `AshAuthentication.Strategy.Password.RequestPasswordResetPreparation`.

### AshAuthentication.Strategy.Password.t/0 (type)



### AshAuthentication.Strategy.Password.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.Strategy.Password.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.Strategy.Slack (module)

Strategy for authenticating using [Slack](https://slack.com)

This strategy builds on-top of `AshAuthentication.Strategy.Oidc` and
[`assent`](https://hex.pm/packages/assent).

In order to use GitHub you need to provide the following minimum configuration:

  - `client_id`
  - `redirect_uri`
  - `client_secret`

### More documentation: - AshAuthentication.Strategy.Slack (module)

- The [Slack Tutorial](/documentation/tutorial/slack.md).
- The [OIDC documentation](`AshAuthentication.Strategy.Oidc`)

### AshAuthentication.Strategy.Slack.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.Strategy.Slack.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.BcryptProvider (module)

Provides the default implementation of `AshAuthentication.HashProvider` using `Bcrypt`.

### AshAuthentication.BcryptProvider.hash/1 (function)

Given some user input as a string, convert it into it's hashed form using `Bcrypt`.

### Example - AshAuthentication.BcryptProvider.hash/1 (function)

iex> {:ok, hashed} = hash("Marty McFly")
    ...> String.starts_with?(hashed, "$2b$04$")
    true

### AshAuthentication.BcryptProvider.simulate/0 (function)

Simulate a password check to help avoid timing attacks.

### Example - AshAuthentication.BcryptProvider.simulate/0 (function)

iex> simulate()
    false

### AshAuthentication.BcryptProvider.valid?/2 (function)

Check if the user input matches the hash.

### Example - AshAuthentication.BcryptProvider.valid?/2 (function)

iex> valid?("Marty McFly", "$2b$04$qgacrnrAJz8aPwaVQiGJn.PvryldV.NfOSYYvF/CZAGgMvvzhIE7S")
    true

### AshAuthentication.HashProvider (behaviour)

A behaviour providing password hashing.

### AshAuthentication.HashProvider.hash/1 (callback)

Given some user input as a string, convert it into it's hashed form.

### AshAuthentication.HashProvider.simulate/0 (callback)

Attempt to defeat timing attacks by simulating a password hash check.

See [Bcrypt.no_user_verify/1](https://hexdocs.pm/bcrypt_elixir/Bcrypt.html#no_user_verify/1) for more information.

### AshAuthentication.HashProvider.valid?/2 (callback)

Check if the user input matches the hash.

### AshAuthentication.Jwt (module)

Uses the excellent `joken` hex package to generate and sign Json Web Tokens.

### Configuration - AshAuthentication.Jwt (module)

There are a few things we need to know in order to generate and sign a JWT:

  * `signing_algorithm` - the crypographic algorithm used to to sign tokens.
  * `token_lifetime` - how long the token is valid for (in hours).
  * `signing_secret` - the secret key used to sign the tokens.

These can be configured in your resource's token DSL:

```elixir
defmodule MyApp.Accounts.User do
  # ...

  authentication do
    tokens do
      token_lifetime 32
      signing_secret fn _, _ ->
        System.fetch_env("TOKEN_SIGNING_SECRET")
      end
    end
  end

  # ...
end
```

The signing secret is retrieved using the `AshAuthentication.Secret`
behaviour, which means that it can be retrieved one of three ways:

1. As a string directly in your resource DSL (please don't do this unless you
   know why this is a bad idea!), or
2. a two-arity anonymous function which returns `{:ok, secret}`, or
3. the name of a module which implements the `AshAuthentication.Secret`
   behaviour.

Available signing algorithms are EdDSA, Ed448ph, Ed448, Ed25519ph, Ed25519, PS512, PS384, PS256, ES512, ES384, ES256, RS512, RS384, RS256, HS512, HS384 or HS256.  Defaults to HS256.

We strongly advise against storing the signing secret in your mix config or
directly in your resource configuration.  We instead suggest you make use of
[`runtime.exs`](https://elixir-lang.org/getting-started/mix-otp/config-and-releases.html#configuration)
and read it from the system environment or other secret store.

The default token lifetime is 168 and should be
specified in integer positive hours.

### AshAuthentication.Jwt.claims/0 (type)

"claims" are the decoded contents of a JWT.  A map of (short) string keys to
string values.

### AshAuthentication.Jwt.default_algorithm/0 (function)

The default signing algorithm

### AshAuthentication.Jwt.default_lifetime_hrs/0 (function)

The default token lifetime

### AshAuthentication.Jwt.peek/1 (function)

Given a token, read it's claims without validating.

### AshAuthentication.Jwt.supported_algorithms/0 (function)

Supported signing algorithms

### AshAuthentication.Jwt.token/0 (type)

A string likely to contain a valid JWT.

### AshAuthentication.Jwt.token_for_resource/4 (function)

Given a resource, generate a signed JWT with a set of claims.

### AshAuthentication.Jwt.token_for_user/4 (function)

Given a user, generate a signed JWT for use while authenticating.

### AshAuthentication.Jwt.token_to_resource/2 (function)

Given a token, find a matching resource configuration.

### Warning - AshAuthentication.Jwt.token_to_resource/2 (function)

This function *does not* validate the token, so don't rely on it for
authentication or authorisation.

### AshAuthentication.Jwt.verify/4 (function)

Given a token, verify it's signature and validate it's claims.

### AshAuthentication.Info (module)

Generated configuration functions based on a resource's DSL configuration.

### AshAuthentication.Info.authentication_add_ons/1 (function)

authentication.add_ons DSL entities

### AshAuthentication.Info.authentication_domain/1 (function)

The name of the Ash domain to use to access this resource when doing anything authentication related.

### AshAuthentication.Info.authentication_domain!/1 (function)

The name of the Ash domain to use to access this resource when doing anything authentication related.

### AshAuthentication.Info.authentication_get_by_subject_action_name/1 (function)

The name of the read action used to retrieve records. If the action doesn't exist, one will be generated for you.

### AshAuthentication.Info.authentication_get_by_subject_action_name!/1 (function)

The name of the read action used to retrieve records. If the action doesn't exist, one will be generated for you.

### AshAuthentication.Info.authentication_options/1 (function)

authentication DSL options

Returns a map containing the and any configured or default values.

### AshAuthentication.Info.authentication_providers/1 (function)

authentication.providers DSL entities

### AshAuthentication.Info.authentication_select_for_senders/1 (function)

A list of fields that we will ensure are selected whenever a sender will be invoked.  Defaults to `[:email]` if there is an `:email` attribute on the resource, and `[]` otherwise.

### AshAuthentication.Info.authentication_select_for_senders!/1 (function)

A list of fields that we will ensure are selected whenever a sender will be invoked.  Defaults to `[:email]` if there is an `:email` attribute on the resource, and `[]` otherwise.

### AshAuthentication.Info.authentication_strategies/1 (function)

authentication.strategies DSL entities

### AshAuthentication.Info.authentication_subject_name/1 (function)

The subject name is used anywhere that a short version of your resource name is needed.  Must be unique system-wide and will be inferred from the resource name by default (ie `MyApp.Accounts.User` -> `user`).

### AshAuthentication.Info.authentication_subject_name!/1 (function)

The subject name is used anywhere that a short version of your resource name is needed.  Must be unique system-wide and will be inferred from the resource name by default (ie `MyApp.Accounts.User` -> `user`).

### AshAuthentication.Info.authentication_tokens_enabled?/1 (function)

Should JWTs be generated by this resource?

### AshAuthentication.Info.authentication_tokens_options/1 (function)

authentication.tokens DSL options

Returns a map containing the and any configured or default values.

### AshAuthentication.Info.authentication_tokens_require_token_presence_for_authentication?/1 (function)

Require a locally-stored token for authentication. See the [tokens guide](/documentation/topics/tokens.md) for more.

### AshAuthentication.Info.authentication_tokens_signing_algorithm/1 (function)

The algorithm to use for token signing. Available signing algorithms are; EdDSA, Ed448ph, Ed448, Ed25519ph, Ed25519, PS512, PS384, PS256, ES512, ES384, ES256, RS512, RS384, RS256, HS512, HS384 and HS256.

### AshAuthentication.Info.authentication_tokens_signing_algorithm!/1 (function)

The algorithm to use for token signing. Available signing algorithms are; EdDSA, Ed448ph, Ed448, Ed25519ph, Ed25519, PS512, PS384, PS256, ES512, ES384, ES256, RS512, RS384, RS256, HS512, HS384 and HS256.

### AshAuthentication.Info.authentication_tokens_signing_secret/1 (function)

The secret used to sign tokens.  Takes either a module which implements the `AshAuthentication.Secret` behaviour, a 2 arity anonymous function or a string.

### AshAuthentication.Info.authentication_tokens_signing_secret!/1 (function)

The secret used to sign tokens.  Takes either a module which implements the `AshAuthentication.Secret` behaviour, a 2 arity anonymous function or a string.

### AshAuthentication.Info.authentication_tokens_store_all_tokens?/1 (function)

Store all tokens in the `token_resource`. See the [tokens guide](/documentation/topics/tokens.md) for more.

### AshAuthentication.Info.authentication_tokens_token_lifetime/1 (function)

How long a token should be valid. See [the tokens guide](/documentation/topics/tokens.md) for more.

### AshAuthentication.Info.authentication_tokens_token_lifetime!/1 (function)

How long a token should be valid. See [the tokens guide](/documentation/topics/tokens.md) for more.

### AshAuthentication.Info.authentication_tokens_token_resource/1 (function)

The resource used to store token information, such as in-flight confirmations, revocations, and if `store_all_tokens?` is enabled, authentication tokens themselves.

### AshAuthentication.Info.authentication_tokens_token_resource!/1 (function)

The resource used to store token information, such as in-flight confirmations, revocations, and if `store_all_tokens?` is enabled, authentication tokens themselves.

### AshAuthentication.Info.domain/1 (function)

Retrieve the domain to use for authentication.

If the `authentication.domain` DSL option is set, it will be used, otherwise
it will default to that configured on the resource.

### AshAuthentication.Info.domain!/1 (function)

Raising version of `domain/1`

### AshAuthentication.Info.dsl_or_resource/0 (type)



### AshAuthentication.Info.find_strategy/3 (function)

Find the underlying strategy that required a change/preparation to be used.

This is because the `strategy_name` can be passed on the change options, eg:

```elixir
change {AshAuthentication.Strategy.Password.HashPasswordChange, strategy_name: :banana_custard}
```

Or via the action context, eg:

```elixir
prepare set_context(%{strategy_name: :banana_custard})
prepare AshAuthentication.Strategy.Password.SignInPreparation
```

Or via the passed-in context on calling the action.

### AshAuthentication.Info.strategy/2 (function)

Retrieve a named strategy from a resource.

### AshAuthentication.Info.strategy!/2 (function)

Retrieve a named strategy from a resource (raising version).

### AshAuthentication.Info.strategy_for_action/2 (function)

Given an action name, retrieve the strategy it is for from the DSL
configuration.

### AshAuthentication.Info.strategy_for_action!/2 (function)

Given an action name, retrieve the strategy it is for from the DSL
configuration.

### AshAuthentication.TokenResource.Info (module)

Introspection functions for the `AshAuthentication.TokenResource` Ash
extension.

### AshAuthentication.TokenResource.Info.token_confirmation_get_changes_action_name/1 (function)

The name of the action used to get confirmation changes.

### AshAuthentication.TokenResource.Info.token_confirmation_get_changes_action_name!/1 (function)

The name of the action used to get confirmation changes.

### AshAuthentication.TokenResource.Info.token_confirmation_options/1 (function)

token.confirmation DSL options

Returns a map containing the and any configured or default values.

### AshAuthentication.TokenResource.Info.token_confirmation_store_changes_action_name/1 (function)

The name of the action used to store confirmation changes.

### AshAuthentication.TokenResource.Info.token_confirmation_store_changes_action_name!/1 (function)

The name of the action used to store confirmation changes.

### AshAuthentication.TokenResource.Info.token_created_at_attribute_name/1 (function)

The name of the `created_at` attribute on this resource.

### AshAuthentication.TokenResource.Info.token_created_at_attribute_name!/1 (function)

The name of the `created_at` attribute on this resource.

### AshAuthentication.TokenResource.Info.token_domain/1 (function)

The Ash domain to use to access this resource.

### AshAuthentication.TokenResource.Info.token_domain!/1 (function)

The Ash domain to use to access this resource.

### AshAuthentication.TokenResource.Info.token_expunge_expired_action_name/1 (function)

The name of the action used to remove expired tokens.

### AshAuthentication.TokenResource.Info.token_expunge_expired_action_name!/1 (function)

The name of the action used to remove expired tokens.

### AshAuthentication.TokenResource.Info.token_expunge_interval/1 (function)

How often to scan this resource for records which have expired, and thus can be removed.

### AshAuthentication.TokenResource.Info.token_expunge_interval!/1 (function)

How often to scan this resource for records which have expired, and thus can be removed.

### AshAuthentication.TokenResource.Info.token_get_token_action_name/1 (function)

The name of the action used to retrieve tokens from the store, if `require_tokens_for_authentication?` is enabled in your authentication resource.

### AshAuthentication.TokenResource.Info.token_get_token_action_name!/1 (function)

The name of the action used to retrieve tokens from the store, if `require_tokens_for_authentication?` is enabled in your authentication resource.

### AshAuthentication.TokenResource.Info.token_options/1 (function)

token DSL options

Returns a map containing the and any configured or default values.

### AshAuthentication.TokenResource.Info.token_read_expired_action_name/1 (function)

The name of the action use to find all expired tokens.

### AshAuthentication.TokenResource.Info.token_read_expired_action_name!/1 (function)

The name of the action use to find all expired tokens.

### AshAuthentication.TokenResource.Info.token_revocation_is_revoked_action_name/1 (function)

The name of the action used to check if a token is revoked.

### AshAuthentication.TokenResource.Info.token_revocation_is_revoked_action_name!/1 (function)

The name of the action used to check if a token is revoked.

### AshAuthentication.TokenResource.Info.token_revocation_options/1 (function)

token.revocation DSL options

Returns a map containing the and any configured or default values.

### AshAuthentication.TokenResource.Info.token_revocation_revoke_all_stored_for_subject_action_name/1 (function)

The name of the action used to revoke all stored tokens for a given subject.

### AshAuthentication.TokenResource.Info.token_revocation_revoke_all_stored_for_subject_action_name!/1 (function)

The name of the action used to revoke all stored tokens for a given subject.

### AshAuthentication.TokenResource.Info.token_revocation_revoke_token_action_name/1 (function)

The name of the action used to revoke tokens.

### AshAuthentication.TokenResource.Info.token_revocation_revoke_token_action_name!/1 (function)

The name of the action used to revoke tokens.

### AshAuthentication.TokenResource.Info.token_store_token_action_name/1 (function)

The name of the action to use to store a token, if `require_tokens_for_authentication?` is enabled in your authentication resource.

### AshAuthentication.TokenResource.Info.token_store_token_action_name!/1 (function)

The name of the action to use to store a token, if `require_tokens_for_authentication?` is enabled in your authentication resource.

### AshAuthentication.UserIdentity.Info (module)

Introspection functions for the `AshAuthentication.UserIdentity` Ash
extension.

### AshAuthentication.UserIdentity.Info.user_identity_access_token_attribute_name/1 (function)

The name of the `access_token` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_access_token_attribute_name!/1 (function)

The name of the `access_token` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_access_token_expires_at_attribute_name/1 (function)

The name of the `access_token_expires_at` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_access_token_expires_at_attribute_name!/1 (function)

The name of the `access_token_expires_at` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_destroy_action_name/1 (function)

The name of the action used to destroy records.

### AshAuthentication.UserIdentity.Info.user_identity_destroy_action_name!/1 (function)

The name of the action used to destroy records.

### AshAuthentication.UserIdentity.Info.user_identity_domain/1 (function)

The Ash domain to use to access this resource.

### AshAuthentication.UserIdentity.Info.user_identity_domain!/1 (function)

The Ash domain to use to access this resource.

### AshAuthentication.UserIdentity.Info.user_identity_options/1 (function)

user_identity DSL options

Returns a map containing the and any configured or default values.

### AshAuthentication.UserIdentity.Info.user_identity_read_action_name/1 (function)

The name of the action used to query identities.

### AshAuthentication.UserIdentity.Info.user_identity_read_action_name!/1 (function)

The name of the action used to query identities.

### AshAuthentication.UserIdentity.Info.user_identity_refresh_token_attribute_name/1 (function)

The name of the `refresh_token` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_refresh_token_attribute_name!/1 (function)

The name of the `refresh_token` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_strategy_attribute_name/1 (function)

The name of the `strategy` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_strategy_attribute_name!/1 (function)

The name of the `strategy` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_uid_attribute_name/1 (function)

The name of the `uid` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_uid_attribute_name!/1 (function)

The name of the `uid` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_upsert_action_name/1 (function)

The name of the action used to create and update records.

### AshAuthentication.UserIdentity.Info.user_identity_upsert_action_name!/1 (function)

The name of the action used to create and update records.

### AshAuthentication.UserIdentity.Info.user_identity_user_id_attribute_name/1 (function)

The name of the `user_id` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_user_id_attribute_name!/1 (function)

The name of the `user_id` attribute on this resource.

### AshAuthentication.UserIdentity.Info.user_identity_user_relationship_name/1 (function)

The name of the belongs-to relationship between identities and users.

### AshAuthentication.UserIdentity.Info.user_identity_user_relationship_name!/1 (function)

The name of the belongs-to relationship between identities and users.

### AshAuthentication.UserIdentity.Info.user_identity_user_resource/1 (function)

The user resource to which these identities belong.

### AshAuthentication.UserIdentity.Info.user_identity_user_resource!/1 (function)

The user resource to which these identities belong.

### AshAuthentication.Debug (module)

Allows you to debug authentication failures in development.

Simply add `config :ash_authentication, debug_authentication_failures?: true`
to your `dev.exs` and get fancy log messages when authentication fails.

### AshAuthentication.Debug.enabled?/0 (function)

Has authentication debug logging been enabled?

### AshAuthentication.Secret (behaviour)

A module to implement retrieving of secrets.

Allows you to implement secrets access via your method or choice at runtime.

The context paramter is either a map with the `conn` key containing the Plug.Conn
if the secret is being retrieved in a plug, or the context of the ash action it is
called in

### Example - AshAuthentication.Secret (behaviour)

```elixir
defmodule MyApp.GetSecret do
  use AshAuthentication.Secret

  def secret_for([:authentication, :strategies, :oauth2, :client_id], MyApp.User, _opts, _context), do: Application.fetch_env(:my_app, :oauth_client_id)
end

defmodule MyApp.Accounts.User do
  use Ash.Resource,
    extensions: [AshAuthentication],
    domain: MyApp.Accounts

  authentication do
    strategies do
      oauth2 do
        client_id MyApp.GetSecret
        client_secret MyApp.GetSecret
      end
    end
  end
end
```

You can also implement it directly as a function:

```elixir
defmodule MyApp.User do
   use Ash.Resource,
    extensions: [AshAuthentication],
    domain: MyApp.Accounts

  authentication do
    strategies do
      oauth2 do
        client_id fn _secret, _resource ->
          Application.fetch_env(:my_app, :oauth_client_id)
        end
      end
    end
  end
end
```

### Secret name - AshAuthentication.Secret (behaviour)

Because you may wish to reuse this module for a number of different providers
and resources, the first argument passed to the callback is the "secret name",
it contains the "path" to the option being set.  The path is made up of a list
containing the DSL path to the secret.

### AshAuthentication.Secret.secret_for/3 (callback)



### AshAuthentication.Secret.secret_for/4 (callback)

Secret retrieval callback.

This function will be called with the "secret name", see the module
documentation for more info.

The context paramter is either a map with the `conn` key containing the Plug.Conn
if the secret is being retrieved in a plug, or the context of the ash action it is
called in

### AshAuthentication.Sender (behaviour)

A module to implement sending of a token to a user.

Allows you to glue sending of instructions to
[swoosh](https://hex.pm/packages/swoosh),
[ex_twilio](https://hex.pm/packages/ex_twilio) or whatever notification system
is appropriate for your application.

Note that the return value and any failures are ignored.  If you need retry
logic, etc, then you should implement it in your sending system.

### Example - AshAuthentication.Sender (behaviour)

Implementing as a module:

```elixir
defmodule MyApp.PasswordResetSender do
  use AshAuthentication.Sender
  import Swoosh.Email

  def send(user, reset_token, _opts) do
    new()
    |> to({user.name, user.email})
    |> from({"Doc Brown", "emmet@brown.inc"})
    |> subject("Password reset instructions")
    |> html_body("""
       Password reset instructions 
       
        Hi #{user.name}, 

        Someone (maybe you) has requested a password reset for your account.
        If you did not initiate this request then please ignore this email.
       
       
        Click here to reset
       
    """)
    |> MyApp.Mailer.deliver()
  end
end

defmodule MyApp.Accounts.User do
  use Ash.Resource,
    extensions: [AshAuthentication],
    domain: MyApp.Accounts

  authentication do
    strategies do
      password :password do
        resettable do
          sender MyApp.PasswordResetSender
        end
      end
    end
  end
end
```

You can also implement it directly as a function:

```elixir
defmodule MyApp.Accounts.User do
  use Ash.Resource,
    extensions: [AshAuthentication],
    domain: MyApp.Accounts

  authentication do
    strategies do
      password :password do
        resettable do
          sender fn user, token ->
            MyApp.Mailer.send_password_reset_email(user, token)
          end
        end
      end
    end
  end
end
```

### AshAuthentication.Sender.send/3 (callback)

Sending callback.

This function will be called with a value representing a user, the token and any options passed
to the module in the DSL.

### AshAuthentication.Supervisor (module)

Starts and manages any processes required by AshAuthentication.

Add to your application supervisor:

### Example - AshAuthentication.Supervisor (module)

```elixir
defmodule MyApp.Application do
  use Application

  def start(_type, _args) do
    children = [
      {AshAuthentication.Supervisor, otp_app: :my_app}
    ]

    Supervisor.start_link(children, strategy: :one_for_one, name: MyApp.Supervisor)
  end
end
```

### AshAuthentication.Supervisor.child_spec/1 (function)

Returns a specification to start this module under a supervisor.

See `Supervisor`.

### AshAuthentication.Plug (behaviour)

Generate an authentication plug.

Use in your app by creating a new module called `AuthPlug` or similar:

```elixir
defmodule MyAppWeb.AuthPlug do
  use AshAuthentication.Plug, otp_app: :my_app

  def handle_success(conn, _activity, user, _token) do
    conn
    |> store_in_session(user)
    |> send_resp(200, "Welcome back #{user.name}")
  end

  def handle_failure(conn, _activity, reason) do
    conn
    |> send_resp(401, "Better luck next time")
  end
end
```

### Using in Phoenix - AshAuthentication.Plug (behaviour)

In your Phoenix router you can add it:

```elixir
scope "/auth" do
  pipe_through :browser
  forward "/", MyAppWeb.AuthPlug
end
```

In order to load any authenticated users for either web or API users you can add the following to your router:

```elixir
import MyAppWeb.AuthPlug

pipeline :session_users do
  plug :load_from_session
end

pipeline :bearer_users do
  plug :load_from_bearer
end

scope "/", MyAppWeb do
  pipe_through [:browser, :session_users]

  live "/", PageLive, :home
end

scope "/api", MyAppWeb do
  pipe_through [:api, :bearer_users]

  get "/" ApiController, :index
end
```

### Using in a Plug application - AshAuthentication.Plug (behaviour)

```elixir
use Plug.Router

forward "/auth", to: MyAppWeb.AuthPlug
```

Note that you will need to include a bunch of other plugs in the pipeline to
do useful things like session and query param fetching.

### AshAuthentication.Plug.activity/0 (type)



### AshAuthentication.Plug.handle_failure/3 (callback)

When there is any failure during authentication this callback is called.

Note that this includes not just authentication failures but potentially
route-not-found errors also.

The default implementation simply returns a 401 status with the message
"Access denied".  You almost definitely want to override this.

### AshAuthentication.Plug.handle_success/4 (callback)

When authentication has been succesful, this callback will be called with the
conn, the successful activity, the authenticated resource and a token.

This allows you to choose what action to take as appropriate for your
application.

The default implementation calls `store_in_session/2` and returns a simple
"Access granted" message to the user.  You almost definitely want to override
this behaviour.

### AshAuthentication.Plug.token/0 (type)



### AshAuthentication.Plug.Helpers (module)

Authentication helpers for use in your router, etc.

### AshAuthentication.Plug.Helpers.assign_new_resources/4 (function)

Assigns all subjects from their equivalent sessions, if they are not already assigned.

This is meant to used via `AshAuthenticationPhoenix` for nested liveviews.
See `AshAuthenticationPhoenix.LiveSession.assign_new_resources/3` for more.

### AshAuthentication.Plug.Helpers.get_authentication_result/1 (function)



### AshAuthentication.Plug.Helpers.load_subjects/3 (function)

Given a list of subjects, turn as many as possible into users.

Opts are forwarded to `AshAuthentication.subject_to_user/2`

### AshAuthentication.Plug.Helpers.retrieve_from_bearer/3 (function)

Validate authorization header(s).

Assumes that your clients are sending a bearer-style authorization header with
your request.  If a valid bearer token is present then the subject is loaded
into the assigns under their subject name (with the prefix `current_`).

If the authentication token is required to be present in the database, it is
loaded into the assigns using `current_#{subject_name}_token_record`

If there is no user present for a resource then the assign is set to `nil`.

### AshAuthentication.Plug.Helpers.retrieve_from_session/3 (function)

Attempt to retrieve all users from the connections' session.

Iterates through all configured authentication resources for `otp_app` and
retrieves any users stored in the session, loads them and stores them in the
assigns under their subject name (with the prefix `current_`).

If there is no user present for a resource then the assign is set to `nil`.

### AshAuthentication.Plug.Helpers.revoke_bearer_tokens/2 (function)

Revoke all authorization header(s).

Any bearer-style authorization headers will have their tokens revoked.

### AshAuthentication.Plug.Helpers.set_actor/2 (function)

Set a subject as the request actor.

Presumes that you have already loaded your user resource(s) into the
connection's assigns.

Uses `Ash.PlugHelpers` to streamline integration with `AshGraphql` and
`AshJsonApi`.

### Examples - AshAuthentication.Plug.Helpers.set_actor/2 (function)

Setting the actor for a AshGraphql API using `Plug.Router`.

```elixir
defmodule MyApp.ApiRouter do
  use Plug.Router
  import MyApp.AuthPlug

  plug :match

  plug :retrieve_from_bearer
  plug :set_actor, :user

  plug :dispatch

  forward "/gql",
    to: Absinthe.Plug,
    init_opts: [schema: MyApp.Schema]
end
```

### AshAuthentication.Plug.Helpers.store_authentication_result/2 (function)

Store result in private.

This is used by authentication plug handlers to store their result for passing
back to the dispatcher.

### AshAuthentication.Plug.Helpers.store_in_session/2 (function)

Store the user in the connections' session.

### AshAuthentication.Checks.AshAuthenticationInteraction (module)

This check is true if the context `private.ash_authentication?` is set to true.

This context will only ever be set in code that is called internally by
`ash_authentication`, allowing you to create a bypass in your policies on your
user/user_token resources.

```elixir
policies do
  bypass AshAuthenticationInteraction do
    authorize_if always()
  end
end
```

### AshAuthentication.Checks.AshAuthenticationInteraction.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### AshAuthentication.Checks.AshAuthenticationInteraction.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### AshAuthentication.Checks.AshAuthenticationInteraction.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### AshAuthentication.Checks.AshAuthenticationInteraction.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### AshAuthentication.Checks.AshAuthenticationInteraction.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### AshAuthentication.GenerateTokenChange (module)

Given a successful registration or sign-in, generate a token.

### AshAuthentication.Strategy.Password.HashPasswordChange (module)

Set the hash based on the password input.

Uses the configured `AshAuthentication.HashProvider` to generate a hash of the
user's password input and store it in the changeset.

You can use this change in your actions where you want to change the user's
password.  If you're not using one of the actions generated by the password
strategy then you'll need to manually pass the strategy name in the changeset
context.  Eg:

```elixir
Changeset.new(user, %{})
|> Changeset.set_context(%{strategy_name: :password})
|> Changeset.for_update(:update, params)
|> Accounts.update()
```

or by adding it statically to your action definition:

```elixir
update :change_password do
  change set_context(%{strategy_name: :password})
  change AshAuthentication.Strategy.Password.HashPasswordChange
end
```

or by adding it as an option to the change definition:

```elixir
update :change_password do
  change {AshAuthentication.Strategy.Password.HashPasswordChange, strategy_name: :password}
end
```

### AshAuthentication.Strategy.Password.PasswordConfirmationValidation (module)

Validate that the password and password confirmation match.

This check is only performed when the `confirmation_required?` DSL option is
set to `true`.

You can use this validation in your own actions where you want to validate
that the password and the password confirmation arguments match.  If you're
not using one of the actions generated by the password strategy then you'll
need to manually pass the strategy name in the changeset context.  Eg:

```elixir
Changeset.new(user, %{})
|> Changeset.set_context(%{strategy_name: :password})
|> Changeset.for_update(:change_password, params)
|> Accounts.update()
```

or by adding it statically in your action definition:

```elixir
update :change_password do
  change set_context(%{strategy_name: :password})
  change AshAuthentication.Strategy.Password.HashPasswordChange
end
```

### AshAuthentication.Strategy.Password.PasswordConfirmationValidation.validate/3 (function)

Validates that the password and password confirmation fields contain
equivalent values - if confirmation is required.

### AshAuthentication.Strategy.Password.PasswordValidation (module)

A convenience validation that checks that the password argument against the
hashed password stored in the record.

You can use this validation in your changes where you want the user to enter
their current password before being allowed to make a change (eg in a password
change flow).

### Options: - AshAuthentication.Strategy.Password.PasswordValidation (module)

You can provide these options either in the DSL options, or in the changeset
context.

  - `strategy_name` - the name of the authentication strategy to use.  Required.
  - `password_argument` - the name of the argument to check for the current
    password.  If missing this will default to the `password_field` value
    configured on the strategy.

### Examples - AshAuthentication.Strategy.Password.PasswordValidation (module)

```elixir
defmodule MyApp.Accounts.User do
  # ...

  actions do
    update :change_password do
      accept []
      argument :current_password, :string, sensitive?: true, allow_nil?: false
      argument :password, :string, sensitive?: true, allow_nil?: false
      argument :password_confirmation, :string, sensitive?: true, allow_nil?: false

      validate confirm(:password, :password_confirmation)
      validate {AshAuthentication.Strategy.Password.PasswordValidation, strategy_name: :password, password_argument: :current_password}

      change {AshAuthentication.Strategy.Password.HashPasswordChange, strategy_name: :password}
    end
  end

  # ...
end
```

### AshAuthentication.Validations (module)

Common validations shared by several transformers.

### AshAuthentication.Validations.find_attribute/2 (function)

Find and return a named attribute in the DSL state.

### AshAuthentication.Validations.maybe_build_attribute/3 (function)

Build an attribute if not present.

### AshAuthentication.Validations.persisted_option/2 (function)

Find and return a persisted option in the DSL state.

### AshAuthentication.Validations.validate_behaviour/2 (function)

Ensure that the named module implements a specific behaviour.

### AshAuthentication.Validations.validate_extension/2 (function)

Validates that `extension` is present on the resource.

### AshAuthentication.Validations.validate_field_in_values/3 (function)

Given a map validate that the provided field is one of the values provided.

### AshAuthentication.Validations.validate_field_with/4 (function)

Given a map, validate that the provided field predicate returns true for the value.

### AshAuthentication.Validations.validate_secret/3 (function)

Validate that a "secret" field is configured correctly.

### AshAuthentication.Validations.validate_token_generation_enabled/2 (function)

Ensure that token generation is enabled for the resource.

### AshAuthentication.Validations.Action (module)

Validation helpers for Resource actions.

### AshAuthentication.Validations.Action.validate_action_argument_option/4 (function)

Validate an action's argument has an option set to one of the provided values.

### AshAuthentication.Validations.Action.validate_action_exists/2 (function)

Validate that a named action actually exists.

### AshAuthentication.Validations.Action.validate_action_has_argument/2 (function)

Validate the presence of an argument on an action.

### AshAuthentication.Validations.Action.validate_action_has_change/2 (function)

Validate the presence of the named change module on an action.

### AshAuthentication.Validations.Action.validate_action_has_manual/2 (function)

Validate the presence of the named manual module on an action.

### AshAuthentication.Validations.Action.validate_action_has_preparation/2 (function)

Validate the presence of the named preparation module on an action.

### AshAuthentication.Validations.Action.validate_action_has_validation/2 (function)

Validate the presence of the named validation module on an action.

### AshAuthentication.Validations.Action.validate_action_option/3 (function)

Validate the action has the provided option.

### AshAuthentication.Validations.Attribute (module)

Validation helpers for Resource attributes.

### AshAuthentication.Validations.Attribute.validate_attribute_option/4 (function)

Validate that an option is set correctly on an attribute

### AshAuthentication.Validations.Attribute.validate_attribute_unique_constraint/3 (function)

Validate than an attribute has a unique identity applied.

### AshAuthentication.Errors.AuthenticationFailed.exception/1 (function)

Create an `Elixir.AshAuthentication.Errors.AuthenticationFailed` without raising it.

### Keys - AshAuthentication.Errors.AuthenticationFailed.exception/1 (function)

- :caused_by
- :changeset
- :field
- :query
- :strategy

### AshAuthentication.Errors.AuthenticationFailed.t/0 (type)



### AshAuthentication.Errors.CannotConfirmUnconfirmedUser.exception/1 (function)

Create an `Elixir.AshAuthentication.Errors.CannotConfirmUnconfirmedUser` without raising it.

### Keys - AshAuthentication.Errors.CannotConfirmUnconfirmedUser.exception/1 (function)

- :resource
- :confirmation_strategy

### AshAuthentication.Errors.InvalidToken.exception/1 (function)

Create an `Elixir.AshAuthentication.Errors.InvalidToken` without raising it.

### Keys - AshAuthentication.Errors.InvalidToken.exception/1 (function)

- :type
- :field

### AshAuthentication.Errors.MissingSecret.exception/1 (function)

Create an `Elixir.AshAuthentication.Errors.MissingSecret` without raising it.

### Keys - AshAuthentication.Errors.MissingSecret.exception/1 (function)

- :resource

### AshAuthentication.Errors.UnconfirmedUser.exception/1 (function)

Create an `Elixir.AshAuthentication.Errors.UnconfirmedUser` without raising it.

### Keys - AshAuthentication.Errors.UnconfirmedUser.exception/1 (function)

- :resource
- :field
- :confirmation_field

### AshAuthentication.AddOn.Confirmation.Actions (module)

Actions for the confirmation add-on.

Provides the code interface for working with resources via confirmation.

### AshAuthentication.AddOn.Confirmation.Actions.confirm/3 (function)

Attempt to confirm a user.

### AshAuthentication.AddOn.Confirmation.Actions.get_changes/3 (function)

Get changes from the tokens resource for application.

### AshAuthentication.AddOn.Confirmation.Actions.store_changes/4 (function)

Store changes in the tokens resource for later re-use.

### AshAuthentication.AddOn.Confirmation.ConfirmChange (module)

Performs a change based on the contents of a confirmation token.

### AshAuthentication.AddOn.Confirmation.ConfirmationHookChange (module)

Triggers a confirmation flow when one of the monitored fields is changed.

Optionally inhibits changes to monitored fields on update.

You can use this change in your actions where you want to send the user a
confirmation (or inhibit changes after confirmation).  If you're not using one
of the actions generated by the confirmation add-on then you'll need to
manually pass the strategy name in the changeset context. Eg:

```elixir
Changeset.new(user, %{})
|> Changeset.set_context(%{strategy_name: :confirm})
|> Changeset.for_update(:update, params)
|> Accounts.update()
```

or by adding it statically to your action definition:

```elixir
update :change_email do
  change set_context(%{strategy_name: :confirm})
  change AshAuthentication.AddOn.Confirmation.ConfirmationHookChange
end
```

or by adding it as an option to the change definition:

```elixir
update :change_email do
  change {AshAuthentication.AddOn.Confirmation.ConfirmationHookChange, strategy_name: :confirm}
end
```

### AshAuthentication.AddOn.Confirmation.Dsl (module)

Defines the Spark DSL entity for this add on.

### AshAuthentication.AddOn.Confirmation.Plug (module)

Handlers for incoming OAuth2 HTTP requests.

### AshAuthentication.AddOn.Confirmation.Plug.accept/2 (function)

Present a confirm button to the user.

### AshAuthentication.AddOn.Confirmation.Plug.confirm/2 (function)

Attempt to perform a confirmation.

### AshAuthentication.AddOn.Confirmation.Transformer (module)

DSL transformer for confirmation add-on.

Ensures that there is only ever one present and that it is correctly
configured.

### AshAuthentication.AddOn.Confirmation.Verifier (module)

DSL verifier for confirmation add-on.

### AshAuthentication.AddOn.LogOutEverywhere.Action (module)

Revokes all tokens for the specified user.

### AshAuthentication.AddOn.LogOutEverywhere.Dsl (module)

Defines the Spark DSL entity for this add on.

### AshAuthentication.AddOn.LogOutEverywhere.OnPasswordChange (module)

Logs a user out from everywhere by revoking all stored tokens.

### AshAuthentication.AddOn.LogOutEverywhere.Transformer (module)

DSL transformer the the log-out-everywhere add-on.

Ensures that there is only ever one present and that it is correctly
configured.

### AshAuthentication.AddOn.LogOutEverywhere.Verifier (module)

DSL verifier for the log-out-everywhere add-on.

### AshAuthentication.Checks.UsingApiKey (module)

This check is true if `user.__metadata__[:using_api_key?]` is set to true.

### AshAuthentication.Checks.UsingApiKey.eager_evaluate?/0 (function)

Callback implementation for  Ash.Policy.Check.eager_evaluate?/0 .

### AshAuthentication.Checks.UsingApiKey.prefer_expanded_description?/0 (function)

Callback implementation for  Ash.Policy.Check.prefer_expanded_description?/0 .

### AshAuthentication.Checks.UsingApiKey.requires_original_data?/2 (function)

Callback implementation for  Ash.Policy.Check.requires_original_data?/2 .

### AshAuthentication.Checks.UsingApiKey.strict_check/3 (function)

Callback implementation for  Ash.Policy.Check.strict_check/3 .

### AshAuthentication.Checks.UsingApiKey.type/0 (function)

Callback implementation for  Ash.Policy.Check.type/0 .

### AshAuthentication.Igniter (module)

Codemods for working with AshAuthentication

### AshAuthentication.Igniter.add_add_on/3 (function)

Adds an add on to the authentication.add_ons section of a resource

### AshAuthentication.Igniter.add_new_add_on/5 (function)

Adds a new add_on to the authentication.strategies section of a resource

### AshAuthentication.Igniter.add_new_strategy/5 (function)

Adds a new strategy to the authentication.strategies section of a resource

### AshAuthentication.Igniter.add_secret_from_env/5 (function)

Adds a secret to a secret module that reads from application env

### AshAuthentication.Igniter.add_strategy/3 (function)

Adds a strategy to the authentication.strategies section of a resource

### AshAuthentication.Igniter.defines_add_on/4 (function)

Returns true if the given resource defines an authentication add on with the provided name

### AshAuthentication.Igniter.defines_strategy/4 (function)

Returns true if the given resource defines an authentication strategy with the provided name

### AshAuthentication.Igniter.defines_strategy_of_type/3 (function)

Returns true if the given resource defines an authentication strategy of the provided type

### AshAuthentication.Jwt.Config (module)

Implementation details JWT generation and validation.

Provides functions to generate token configuration at runtime, based on the
resource being signed for and for verifying claims and checking for token
revocation.

### AshAuthentication.Jwt.Config.default_claims/2 (function)

Generate the default claims for a specified resource.

### AshAuthentication.Jwt.Config.generate_audience/1 (function)

The generator function used to generate the "aud" claim.

It generates an Elixir-style `~>` version requirement against the current
major and minor version numbers of AshAuthentication.

### AshAuthentication.Jwt.Config.generate_issuer/1 (function)

The generator function used to generate the "iss" claim.

### AshAuthentication.Jwt.Config.token_signer/3 (function)

The signer used to sign the token on a per-resource basis.

### AshAuthentication.Jwt.Config.validate_audience/4 (function)

The validation function used to validate the "aud" claim.

Uses `Version.match?/2` to validate the provided claim against the current
version.  The use of `~>` means that tokens generated by versions of
AshAuthentication with the the same major version and at least the same minor
version should be compatible.

### AshAuthentication.Jwt.Config.validate_issuer/3 (function)

The validation function used to validate the "iss" claim.

It simply verifies that the claim starts with `"AshAuthentication"`

### AshAuthentication.Jwt.Config.validate_jti/4 (function)

The validation function used to the validate the "jti" claim.

This is done by checking that the token is valid with the token revocation
resource.  Requires that the subject's resource configuration be passed as the
validation context.  This is automatically done by calling `Jwt.verify/2`.

### AshAuthentication.Jwt.Config.validate_tenant/2 (function)

Validate that the "tenant" claim matches the provided tenant option.

### AshAuthentication.Plug.Defaults (module)

Provides the default implementations of `handle_success/3` and
`handle_failure/2` used in generated authentication plugs.

### AshAuthentication.Plug.Defaults.handle_failure/3 (function)

The default implementation of `handle_failure/1`.

Sends a very basic 401 response.

### AshAuthentication.Plug.Defaults.handle_success/4 (function)

The default implementation of `handle_success/3`.

Calls `AshAuthentication.Plug.Helpers.store_in_session/2` then sends a
basic 200 response.

### AshAuthentication.Plug.Dispatcher (module)

Route requests and callbacks to the correct provider plugs.

### AshAuthentication.Plug.Dispatcher.call/2 (function)

Send the request to the correct strategy and then return the result.

### AshAuthentication.Plug.Dispatcher.config/0 (type)



### AshAuthentication.Plug.Macros (module)

Generators used within `use AshAuthentication.Plug`.

### AshAuthentication.Plug.Macros.define_load_from_bearer/1 (macro)

Generates the `load_from_bearer/2` plug with the `otp_app` prefilled.

### AshAuthentication.Plug.Macros.define_load_from_session/1 (macro)

Generates the `load_from_session/2` plug with the `otp_app` prefilled.

### AshAuthentication.Plug.Macros.define_revoke_bearer_tokens/1 (macro)

Generates the `revoke_bearer_tokens/2` plug with the `otp_app` prefilled.

### AshAuthentication.Plug.Macros.validate_subject_name_uniqueness/1 (macro)

Generates the subject name validation code for the auth plug.

### AshAuthentication.Plug.Router (module)

Dynamically generates the authentication router for the authentication
requests and callbacks.

Used internally by `AshAuthentication.Plug`.

### AshAuthentication.Preparations.FilterBySubject (module)

Filters a user by the identifier in the subject of a JWT.

### AshAuthentication.Preparations.FilterBySubject.init/1 (function)

Callback implementation for  Ash.Resource.Preparation.init/1 .

### AshAuthentication.SecretFunction (module)

Implements `AshAuthentication.Secret` for functions that are provided to the
DSL instead of modules.

### AshAuthentication.SenderFunction (module)

Implements `AshAuthentication.Sender` for functions that are provided to the
DSL instead of modules.

### AshAuthentication.Strategy.ApiKey (module)

Strategy for authenticating using an API key.

### Security Considerations - AshAuthentication.Strategy.ApiKey (module)

Responsibility for generating, securing, expiring and revoking lies on the implementor.
If you are using API keys, you *must* ensure that your policies and application are set
up to prevent misuse of these keys. For example:

```elixir
policy AshAuthentication.Checks.UsingApiKey do
  authorize_if action([:a, :list, :of, :allowed, :action, :names])
end
```

To detect that a user is signed in with an API key, you can see if
`user.__metadata__[:using_api_key?]` is set. If they are signed
in, then `user.__metadata__[:api_key]` will be set to the API key that they
used, allowing you to write policies that depend on the permissions granted
by the API key.

### AshAuthentication.Strategy.ApiKey.t/0 (type)



### AshAuthentication.Strategy.ApiKey.transform/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.transform/2 .

### AshAuthentication.Strategy.ApiKey.verify/2 (function)

Callback implementation for  AshAuthentication.Strategy.Custom.verify/2 .

### AshAuthentication.Strategy.ApiKey.Actions (module)

Actions for the API key strategy.

Provides the code interface for working with user resources for providing
API keys resurce.

### AshAuthentication.Strategy.ApiKey.Actions.sign_in/3 (function)

Attempt to sign a user in via API key.

### AshAuthentication.Strategy.ApiKey.GenerateApiKey (module)

Generates a random API key for a user.

The API key is generated using a random byte string and a prefix. The prefix
is used to generate a key that is compliant with secret scanning. You can use
this to set up an endpoint that will automatically revoke leaked tokens, which
is an extremely powerful and useful security feature.

See [the guide on Github](https://docs.github.com/en/code-security/secret-scanning/secret-scanning-partnership-program/secret-scanning-partner-program) for more information.

### Options - AshAuthentication.Strategy.ApiKey.GenerateApiKey (module)

* `:prefix` - The prefix to use for the API key.

### AshAuthentication.Strategy.ApiKey.Plug (module)

Plug for authenticating using API keys.

This plug validates API keys from either a query parameter or HTTP header.

### AshAuthentication.Strategy.ApiKey.Plug.auth_error/0 (type)



### AshAuthentication.Strategy.ApiKey.Plug.call/2 (function)

Process the connection and attempt to authenticate using the API key.

### AshAuthentication.Strategy.ApiKey.Plug.init/1 (function)

Initialize the plug with options.

### Options - AshAuthentication.Strategy.ApiKey.Plug.init/1 (function)

* `:resource` - The resource to authenticate against.
* `:source` - Where to get the API key from. Can be `:header`, `:query_param` or `:header_or_query_param`. Default: `:header`.
  Keep in mind that query params are often stored in logs etc, so we *highly* recommend using `:header`.
* `:param_name` - The name of the query parameter when `source: :query_param`. Default: `"api_key"`
* `:header_prefix` - The prefix to strip from the Authorization header value when `source: :header`. Default: `"Bearer "`
* `:strategy` - The name of the API key strategy being used, defaults to the only api key strategy on the resource, or an error if there are multiple.
* `:required?` - If `true`, the absence of an API key is treated as an error, and the `on_error` function is called with `:missing_api_key`. Default: `true`.
* `:on_error` - The function to call when an error occurs. Takes a `conn` and an `error` which will be `:invalid_api_key` or an AshAuthentication error. The default is: `AshAuthentication.Strategy.ApiKey.Plug.on_error/2`
* `:assign` - The name of the assign to set the authenticated subject. Default: `:current_ `, i.e `:current_user`

### AshAuthentication.Strategy.ApiKey.Plug.on_error/2 (function)

Handles errors that occur during the api key authentication process.

This function determines the response format based on the `Accept` header
of the incoming request. If the client accepts JSON responses, it returns
a JSON-formatted error message. Otherwise, it returns a plain text error
message.

  - If the `Accept` header contains "json", the response will be:
    - Status: 401 Unauthorized
    - Content-Type: application/json
    - Body: `{"error":"Unauthorized"}`
  - Otherwise, the response will be:
    - Status: 401 Unauthorized
    - Content-Type: text/plain (default)
    - Body: `Unauthorized`

### AshAuthentication.Strategy.ApiKey.Plug.source_type/0 (type)



### AshAuthentication.Strategy.ApiKey.SignInPreparation (module)

Prepare a query for sign in.

### AshAuthentication.Strategy.ApiKey.SignInPreparation.init/1 (function)

Callback implementation for  Ash.Resource.Preparation.init/1 .

### AshAuthentication.Strategy.ApiKey.Transformer (module)

DSL transformer for API keys.

### AshAuthentication.Strategy.ApiKey.Verifier (module)

DSL verifier for API key authentication.

### AshAuthentication.Strategy.Apple.Verifier (module)

DSL verifier for Apple strategy.

### AshAuthentication.Strategy.Custom.Helpers (module)

Helpers for use within custom strategies.

### AshAuthentication.Strategy.Custom.Helpers.put_add_on/2 (function)

Update the add-on in the DSL state by name.

This helper should only be used within transformers.

### AshAuthentication.Strategy.Custom.Helpers.put_strategy/2 (function)

Update the strategy in the DSL state by name.

This helper should only be used within transformers.

### AshAuthentication.Strategy.Custom.Helpers.register_strategy_actions/3 (function)

If there's any chance that an implementor may try and use actions genrated by
your strategy programatically then you should register your actions with Ash
Authentication so that it can find the appropriate strategy when needed.

The strategy can be retrieved again by calling
`AshAuthentication.Info.strategy_for_action/2`.

This helper should only be used within transformers.

### AshAuthentication.Strategy.Custom.Transformer (module)

Transformer used by custom strategies.

It delegates transformation passes to the individual strategies.

### AshAuthentication.Strategy.Custom.Transformer.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### AshAuthentication.Strategy.Custom.Verifier (module)

Verifier used by custom strategies.

It delegates verification passes to the individual strategies.

### AshAuthentication.Strategy.MagicLink.Actions (module)

Actions for the magic link strategy.

Provides the code interface for working with user resources for providing
magic links.

### AshAuthentication.Strategy.MagicLink.Actions.request/3 (function)

Request a magic link for a user.

### AshAuthentication.Strategy.MagicLink.Actions.sign_in/3 (function)

Attempt to sign a user in via magic link.

### AshAuthentication.Strategy.MagicLink.Plug (module)

Plugs for the magic link strategy.

Handles requests and sign-ins.

### AshAuthentication.Strategy.MagicLink.Plug.accept/2 (function)

Present a sign in button to the user.

### AshAuthentication.Strategy.MagicLink.Plug.request/2 (function)

Handle a request for a magic link.

Retrieves form parameters from nested within the subject name, eg:

```
%{
  "user" => %{
    "email" => "marty@mcfly.me"
  }
}
```

### AshAuthentication.Strategy.MagicLink.Plug.sign_in/2 (function)

Sign in via magic link.

### AshAuthentication.Strategy.MagicLink.Request (module)

Requests a magic link for the given identity field.

### AshAuthentication.Strategy.MagicLink.RequestPreparation (module)

Prepare a query for a magic link request.

This preparation performs three jobs, one before the query executes and two
after:
1. it constraints the query to match the identity field passed to the action.
2. if there is a user returned by the query, then
  a. generate a magic link token and
  b. publish a notification.

Always returns an empty result.

### AshAuthentication.Strategy.MagicLink.RequestPreparation.init/1 (function)

Callback implementation for  Ash.Resource.Preparation.init/1 .

### AshAuthentication.Strategy.MagicLink.SignInChange (module)

Set up a create action for magic link sign in.

### AshAuthentication.Strategy.MagicLink.SignInPreparation (module)

Prepare a query for sign in.

### AshAuthentication.Strategy.MagicLink.SignInPreparation.init/1 (function)

Callback implementation for  Ash.Resource.Preparation.init/1 .

### AshAuthentication.Strategy.MagicLink.Transformer (module)

DSL transformer for magic links.

### AshAuthentication.Strategy.MagicLink.Verifier (module)

DSL verifier for magic links.

### AshAuthentication.Strategy.OAuth2.Actions (module)

Actions for the oauth2 strategy.

Provides the code interface for working with resources via an OAuth2 strategy.

### AshAuthentication.Strategy.OAuth2.Actions.register/3 (function)

Attempt to register a new user.

### AshAuthentication.Strategy.OAuth2.Actions.sign_in/3 (function)

Attempt to sign in a user.

### AshAuthentication.Strategy.OAuth2.Dsl (module)

Defines the Spark DSL entity for this strategy.

### AshAuthentication.Strategy.OAuth2.IdentityChange (module)

Updates the identity resource when a user is registered.

### AshAuthentication.Strategy.OAuth2.Plug (module)

Handlers for incoming OAuth2 HTTP requests.

### AshAuthentication.Strategy.OAuth2.Plug.callback/2 (function)

Perform the callback phase of OAuth2.

Responds to a user being redirected back from the remote authentication
provider, and validates the passed options, ultimately registering or
signing-in a user if the authentication was successful.

### AshAuthentication.Strategy.OAuth2.Plug.request/2 (function)

Perform the request phase of OAuth2.

Builds a redirection URL based on the provider configuration and redirects the
user to that endpoint.

### AshAuthentication.Strategy.OAuth2.SignInPreparation (module)

Prepare a query for sign in

Performs three main tasks:

  1. Ensures that there is only one matching user record returned, otherwise
     returns an authentication failed error.
  2. Generates an access token if token generation is enabled.
  3. Updates the user identity resource, if one is enabled.

### AshAuthentication.Strategy.OAuth2.SignInPreparation.init/1 (function)

Callback implementation for  Ash.Resource.Preparation.init/1 .

### AshAuthentication.Strategy.OAuth2.Transformer (module)

DSL transformer for oauth2 strategies.

Iterates through any oauth2 strategies and ensures that all the correct
actions and settings are in place.

### AshAuthentication.Strategy.OAuth2.Verifier (module)

DSL verifier for oauth2 strategies.

### AshAuthentication.Strategy.Oidc.NonceGenerator (module)

An implmentation of `AshAuthentication.Secret` that generates nonces for
OpenID Connect strategies.

Defaults to `16` bytes of random data.  You can change this by setting the
`byte_size` option in your DSL:

```elixir
oidc do
  nonce {AshAuthentication.NonceGenerator, byte_size: 32}
  # ...
end
```

### AshAuthentication.Strategy.Oidc.Transformer (module)

DSL transformer for oidc strategies.

Adds a nonce generator to the strategy if `nonce` is set to `true`.
Delegates to the default OAuth2 transformer.

### AshAuthentication.Strategy.Oidc.Verifier (module)

DSL verifier for OpenID Connect strategy.

### AshAuthentication.Strategy.Password.Actions (module)

Actions for the password strategy

Provides the code interface for working with resources via a password
strategy.

### AshAuthentication.Strategy.Password.Actions.register/3 (function)

Attempt to register a new user.

### AshAuthentication.Strategy.Password.Actions.reset/3 (function)

Attempt to change a user's password using a reset token.

### AshAuthentication.Strategy.Password.Actions.reset_request/3 (function)

Request a password reset.

### AshAuthentication.Strategy.Password.Actions.sign_in/3 (function)

Attempt to sign in a user.

### AshAuthentication.Strategy.Password.Actions.sign_in_with_token/3 (function)

Attempt to sign in a previously-authenticated user with a short-lived sign in token.

### AshAuthentication.Strategy.Password.Dsl (module)

Defines the Spark DSL entity for this strategy.

### AshAuthentication.Strategy.Password.Plug (module)

Plugs for the password strategy.

Handles registration, sign-in and password resets.

### AshAuthentication.Strategy.Password.Plug.register/2 (function)

Handle a registration request

### AshAuthentication.Strategy.Password.Plug.reset/2 (function)

Handle a reset request

### AshAuthentication.Strategy.Password.Plug.reset_request/2 (function)

Handle a reset request request

### AshAuthentication.Strategy.Password.Plug.sign_in/2 (function)

Handle a sign-in request

### AshAuthentication.Strategy.Password.Plug.sign_in_with_token/2 (function)

Handle a request to validate a sign in token

### AshAuthentication.Strategy.Password.RequestPasswordReset (module)

Requests a password reset.

This implementation performs three jobs:
1. looks up the user with the given action and field
2. if a matching user is found:
  a. a reset token is generated
  b. and the password reset sender is invoked

### AshAuthentication.Strategy.Password.RequestPasswordResetPreparation (module)

Prepare a query for a password reset request.

This preparation performs three jobs, one before the query executes and two
after:
1. it constraints the query to match the identity field passed to the action.
2. if there is a user returned by the query, then
  a. generate a reset token and
  b. publish a notification.

Always returns an empty result.

### AshAuthentication.Strategy.Password.RequestPasswordResetPreparation.init/1 (function)

Callback implementation for  Ash.Resource.Preparation.init/1 .

### AshAuthentication.Strategy.Password.ResetTokenValidation (module)

Validate that the token is a valid password reset request token.

### AshAuthentication.Strategy.Password.Resettable (module)

The entity used to store password reset information.

### AshAuthentication.Strategy.Password.Resettable.t/0 (type)



### AshAuthentication.Strategy.Password.SignInPreparation (module)

Prepare a query for sign in

This preparation performs two jobs, one before the query executes and one
after.

Firstly, it constrains the query to match the identity field passed to the
action.

Secondly, it validates the supplied password using the configured hash
provider, and if correct allows the record to be returned, otherwise returns
an authentication failed error.

### AshAuthentication.Strategy.Password.SignInPreparation.init/1 (function)

Callback implementation for  Ash.Resource.Preparation.init/1 .

### AshAuthentication.Strategy.Password.SignInPreparation.user_confirmed_if_needed/2 (function)



### AshAuthentication.Strategy.Password.SignInWithTokenPreparation (module)

Prepare a query for sign in via token.

This preparation first validates the token argument and extracts the subject
from it and constrains the query to a matching user.

### AshAuthentication.Strategy.Password.SignInWithTokenPreparation.init/1 (function)

Callback implementation for  Ash.Resource.Preparation.init/1 .

### AshAuthentication.Strategy.Password.Transformer (module)

DSL transformer for the password strategy.

Iterates through any password authentication strategies and ensures that all
the correct actions and settings are in place.

### AshAuthentication.Strategy.Password.Verifier (module)

DSL verifier for the password strategy.

### AshAuthentication.Strategy.Slack.Verifier (module)

DSL verifier for Slack strategy.

### AshAuthentication.TokenResource.Actions (module)

The code interface for interacting with the token resource.

### AshAuthentication.TokenResource.Actions.expunge_expired/2 (function)

Remove all expired records.

### AshAuthentication.TokenResource.Actions.get_token/3 (function)

Retrieve a token by token or JTI optionally filtering by purpose.

### AshAuthentication.TokenResource.Actions.jti_revoked?/3 (function)

Has the token been revoked?

Similar to `token-revoked?/2..3` except that rather than extracting the JTI
from the token, assumes that it's being passed in directly.

### AshAuthentication.TokenResource.Actions.revoke/3 (function)

Revoke a token.

Extracts the JTI from the provided token and uses it to generate a revocation
record.

### AshAuthentication.TokenResource.Actions.store_token/3 (function)

Store a token.

Stores a token for any purpose.

### AshAuthentication.TokenResource.Actions.token_revoked?/3 (function)

Has the token been revoked?

Similar to `jti_revoked?/2..3` except that it extracts the JTI from the token,
rather than relying on it to be passed in.

### AshAuthentication.TokenResource.Expunger (module)

A `GenServer` which periodically removes expired token revocations.

Scans all token revocation resources based on their configured expunge
interval and removes any expired records.

```elixir
defmodule MyApp.Accounts.Token do
  use Ash.Resource,
    extensions: [AshAuthentication.TokenResource],
    domain: MyApp.Accounts

  token do
    expunge_interval 12
  end
end
```

This GenServer is started by the `AshAuthentication.Supervisor` which should
be added to your app's supervision tree.

### AshAuthentication.TokenResource.Expunger.child_spec/1 (function)

Returns a specification to start this module under a supervisor.

See `Supervisor`.

### AshAuthentication.TokenResource.GetConfirmationChangesPreparation (module)

Constrains a query to only records which are confirmations that match the jti
argument.

### AshAuthentication.TokenResource.GetConfirmationChangesPreparation.init/1 (function)

Callback implementation for  Ash.Resource.Preparation.init/1 .

### AshAuthentication.TokenResource.GetTokenPreparation (module)

Constrains a query to only records which match the `jti` or `token` argument
and optionally by the `purpose` argument.

### AshAuthentication.TokenResource.GetTokenPreparation.init/1 (function)

Callback implementation for  Ash.Resource.Preparation.init/1 .

### AshAuthentication.TokenResource.IsRevoked (module)

Checks for the existence of a revocation token for the provided token revocation token for the provided token.

### AshAuthentication.TokenResource.IsRevokedPreparation (module)

Constrains a query to only records which are revocations that match the token
or jti argument.

### AshAuthentication.TokenResource.IsRevokedPreparation.init/1 (function)

Callback implementation for  Ash.Resource.Preparation.init/1 .

### AshAuthentication.TokenResource.RevokeAllStoredForSubjectChange (module)

Updates all tokens for a given subject to have the purpose revocation

### AshAuthentication.TokenResource.RevokeTokenChange (module)

Generates a revocation record for a given token.

### AshAuthentication.TokenResource.StoreConfirmationChangesChange (module)

Populates the JTI based on the token argument.

### AshAuthentication.TokenResource.StoreTokenChange (module)

Stores an arbitrary token.

### AshAuthentication.TokenResource.Transformer (module)

The token resource transformer.

Sets up the default schema and actions for the token resource.

### AshAuthentication.TokenResource.Transformer.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### AshAuthentication.TokenResource.Verifier (module)

The token resource verifier.

### AshAuthentication.Transformer (module)

The Authentication transformer

Sets up non-provider-specific configuration for authenticated resources.

### AshAuthentication.Transformer.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### AshAuthentication.Transformer.SetSelectForSenders (module)

Sets the `select_for_senders` options to its default value.

### AshAuthentication.Transformer.SetSelectForSenders.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### AshAuthentication.Transformer.SetSelectForSenders.before?/1 (function)

Callback implementation for  Spark.Dsl.Transformer.before?/1 .

### AshAuthentication.UserIdentity.Actions (module)

Code interface for provider identity actions.

Allows you to interact with UserIdentity resources without having to mess
around with changesets, domains, etc.  These functions are delegated to from
within `AshAuthentication.UserIdentity`.

### AshAuthentication.UserIdentity.Actions.upsert/2 (function)

Upsert an identity for a user.

### AshAuthentication.UserIdentity.Transformer (module)

The user identity transformer.

Sets up the default schema and actions for a user identity resource.

### AshAuthentication.UserIdentity.Transformer.after_compile?/0 (function)

Callback implementation for  Spark.Dsl.Transformer.after_compile?/0 .

### AshAuthentication.UserIdentity.UpsertIdentityChange (module)

A change which upserts a user's identity into the user identity resource.

Expects the following arguments:

  - `user_info` a map with string keys as returned from the OAuth2/OpenID
    upstream provider.
  - `oauth_tokens` a map with string keys containing the OAuth2 token
    response.
  - `user_id` the ID of the user this identity relates to.
  - `strategy` the name of the strategy.

This is usually dynamically inserted into a generated action, however you can
add it to your own action if needed.

### AshAuthentication.UserIdentity.Verifier (module)

The user identity verifier.

### AshAuthentication.Verifier (module)

The Authentication verifier.

Checks configuration constraints after compile.

### Mix.Tasks.AshAuthentication.AddStrategy.igniter/1 (function)

Callback implementation for  Igniter.Mix.Task.igniter/1 .

### Mix.Tasks.AshAuthentication.Install.data_layer_args/2 (function)



### Mix.Tasks.AshAuthentication.Install.setup_data_layer/2 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_authentication)# ash_authentication_phoenix

> Phoenix integration for Ash Authentication

## Docs

### AshAuthentication.Phoenix.Test.Gettext (module)

Gettext stub,
referenced in AshAuthentication.Phoenix.Test.Router

### AshAuthentication.Phoenix.Test.Gettext.handle_missing_bindings/2 (function)



### AshAuthentication.Phoenix.Test.Gettext.handle_missing_plural_translation/7 (function)



### AshAuthentication.Phoenix.Test.Gettext.translate_test/2 (function)



### Mix.Tasks.AshAuthentication.Phoenix.Routes.get_url_info/2 (function)



### Mix.Tasks.AshAuthenticationPhoenix.Install.igniter/1 (function)



### Mix.Tasks.AshAuthenticationPhoenix.Install.setup_routes_alias/1 (function)



### AshAuthentication.Phoenix (module)

Welcome to `AshAuthentication.Pheonix`.

The `ash_authentication_phoenix` package extends
[`ash_authentication`](https://github.com/team-alembic/ash_authentication) by
adding router helpers, plugs and behaviours that makes adding authentication
to an existing Ash-based Phoenix application dead easy.

### Where to start. - AshAuthentication.Phoenix (module)

Presuming that you already have [Phoenix](https://phoenixframework.org/),
[Ash](https://ash-hq.org/) and
[AshAuthentication](https://github.com/team-alembic/ash_authentication)
installed and configured, start by adding plugs and routes to your router
using `AshAuthentication.Phoenix.Router` and customising your sign-in page as
needed.

### Customisation - AshAuthentication.Phoenix (module)

There are several methods of customisation available depending on the level of
control you would like:

  1. Use the generic sign-in liveview -
     `AshAuthentication.Phoenix.SignInLive`.
  2. Apply overrides using `AshAuthentication.Phoenix.Overrides` to set your
     own CSS classes for all components.
  3. Build your own sign-in pages using the pre-defined components.
  4. Build your own sign-in pages using the generated `auth` routes.

### AshAuthentication.Phoenix.Controller (behaviour)

The authentication controller generator.

Since authentication often requires explicit HTTP requests to do things like
set cookies or return Authorization headers, use this module to create an
`AuthController` in your Phoenix application.

### Example - AshAuthentication.Phoenix.Controller (behaviour)

Handling the registration or authentication of a normal web-based user.

```elixir
defmodule MyAppWeb.AuthController do
  use MyAppWeb, :controller
  use AshAuthentication.Phoenix.Controller

  def success(conn, _activity, user, _token) do
    conn
    |> store_in_session(user)
    |> assign(:current_user, user)
    |> redirect(to: Routes.page_path(conn, :index))
  end

  def failure(conn, _activity, _reason) do
    conn
    |> put_status(401)
    |> render("failure.html")
  end

  def sign_out(conn, _params) do
    conn
    |> clear_session()
    |> render("sign_out.html")
  end
end
```

Handling registration or authentication of an API user.

```elixir
defmodule MyAppWeb.ApiAuthController do
  use MyAppWeb, :controller
  use AshAuthentication.Phoenix.Controller
  alias AshAuthentication.TokenRevocation

  def success(conn, _activity, _user, token) do
    conn
    |> put_status(200)
    |> json(%{
      authentication: %{
        status: :success,
        bearer: token}
    })
  end

  def failure(conn, _activity, _reason) do
    conn
    |> put_status(401)
    |> json(%{
      authentication: %{
        status: :failed
      }
    })
  end

  def sign_out(conn, _params) do
    conn
    |> revoke_bearer_tokens()
    |> json(%{
      status: :ok
    })
  end
end
```

### AshAuthentication.Phoenix.Controller.activity/0 (type)



### AshAuthentication.Phoenix.Controller.failure/3 (callback)

Called when authentication fails.

### AshAuthentication.Phoenix.Controller.sign_out/2 (callback)

Called when a request to sign out is received.

### AshAuthentication.Phoenix.Controller.success/4 (callback)

Called when authentication (or registration, depending on the provider) has been successful.

### AshAuthentication.Phoenix.Controller.t/0 (type)



### AshAuthentication.Phoenix.Controller.token/0 (type)



### AshAuthentication.Phoenix.Controller.user/0 (type)



### AshAuthentication.Phoenix.LiveSession (module)

Ensures that any loaded users which are present in a conn's assigns are also
present in a live view socket's assigns.

Typical usage is via the `ash_authentication_live_session/2` macro, but can also
manually called like so:

```elixir
scope "/", ExampleWeb do
  pipe_through(:browser)

  live_session :authenticated, on_mount: LiveSession, session: {LiveSession, :generate_session, []} do
    live "/", ExampleLive
  end
end
```

### AshAuthentication.Phoenix.LiveSession.ash_authentication_live_session/3 (macro)

Generate a live session wherein all subject assigns are copied from the conn
into the socket.

Options:
  * `:otp_app` - Set the otp app in which to search for authenticated resources.

All other options are passed through to `live_session`, but with session and on_mount hooks
added to set assigns for authenticated resources. Unlike `live_session`, this supports
multiple MFAs provided for the `session` option. The produced sessions will be merged.

### AshAuthentication.Phoenix.LiveSession.assign_new_resources/3 (function)

Assigns all subjects from their equivalent sessions, if they are not already assigned.

This exists to power nested liveviews, which have the session available but
do not automatically inherit any assigns.

This does verify the token and confirm that it is not expired, but it
bypasses the check for the token's presence in the token resource, even if
you have configured AshAuthentication to
`require_token_presence_for_authentication?`. This is because nested live views
do not need to check *again* for this, as the `:load_from_session` plug already
does this.

### AshAuthentication.Phoenix.LiveSession.generate_session/3 (function)

Supplements the session with any `current_X` assigns which are authenticated
resource records from the conn.

### AshAuthentication.Phoenix.LiveSession.on_mount/4 (function)

Inspects the incoming session for any subject_name -> subject values and loads
them into the socket's assigns.

For example a session containing `{"user",
"user?id=aa6c179c-ee75-4d49-8796-528c2981b396"}` becomes an assign called
`current_user` with the loaded user as the value.

### AshAuthentication.Phoenix.LiveSession.opts/1 (function)

Get options that should be passed to `live_session`.

This is useful for integrating with other tools that require a custom `live_session`,
like `beacon_live_admin`. For example:

```elixir
beacon_live_admin AshAuthentication.Phoenix.LiveSession.opts(...beacon_opts) do
  ...
end
```

### AshAuthentication.Phoenix.Plug (module)

Helper plugs mixed in to your router.

When you `use AshAuthentication.Phoenix.Router` this module is included, so
that you can use these plugs in your pipelines.

### AshAuthentication.Phoenix.Plug.load_from_bearer/2 (function)

Attempt to retrieve actors from the `Authorization` header(s).

A wrapper around `AshAuthentication.Plug.Helpers.retrieve_from_bearer/2` with
the `otp_app` as extracted from the endpoint.

### AshAuthentication.Phoenix.Plug.load_from_session/2 (function)

Attempt to retrieve all actors from the connections' session.

A wrapper around `AshAuthentication.Plug.Helpers.retrieve_from_session/2`
with the `otp_app` as extracted from the endpoint.

### AshAuthentication.Phoenix.Plug.revoke_bearer_tokens/2 (function)

Revoke all token(s) in the `Authorization` header(s).

A wrapper around `AshAuthentication.Plug.Helpers.revoke_bearer_tokens/2` with
the `otp_app` as extracted from the endpoint.

### AshAuthentication.Phoenix.Plug.store_in_session/2 (function)

Store the actor in the connections' session.

### AshAuthentication.Phoenix.Router (module)

Phoenix route generation for AshAuthentication.

Using this module imports the macros in this module and the plug functions
from `AshAuthentication.Phoenix.Plug`.

### Usage - AshAuthentication.Phoenix.Router (module)

Adding authentication to your live-view router is very simple:

```elixir
defmodule MyAppWeb.Router do
  use MyAppWeb, :router
  use AshAuthentication.Phoenix.Router

  pipeline :browser do
    # ...
    plug(:load_from_session)
  end

  pipeline :api do
    # ...
    plug(:load_from_bearer)
  end

  scope "/", MyAppWeb do
    pipe_through :browser
    sign_in_route auth_routes_prefix: "/auth"
    sign_out_route AuthController
    auth_routes_for MyApp.Accounts.User, to: AuthController
    reset_route auth_routes_prefix: "/auth"
  end
```

### AshAuthentication.Phoenix.Router.auth_route_options/0 (type)

Options that can be passed to `auth_routes_for`.

### AshAuthentication.Phoenix.Router.auth_routes/3 (macro)

Generates the routes needed for the various strategies for a given
AshAuthentication resource.

This matches *all* routes at the provided `path`, which defaults to `/auth`. This means that
if you have any other routes that begin with `/auth`, you will need to make sure this
appears after them.

### Upgrading from `auth_routes_for/2` - AshAuthentication.Phoenix.Router.auth_routes/3 (macro)

If you are using route helpers anywhere in your application, typically looks like `Routes.auth_path/3`
or `Helpers.auth_path/3` you will need to update them to use verified routes. To see what routes are
available to you, use `mix ash_authentication.phoenix.routes`.

If you are using any of the components provided by `AshAuthenticationPhoenix`, you will need to supply
them with the `auth_routes_prefix` assign, set to the `path` you provide here (set to `/auth` by default).

You also will need to set `auth_routes_prefix` on the `reset_route`, i.e `reset_route(auth_routes_prefix: "/auth")`

### Options - AshAuthentication.Phoenix.Router.auth_routes/3 (macro)

* `path` - the path to mount auth routes at. Defaults to `/auth`. If changed, you will also want
  to change the `auth_routes_prefix` option in `sign_in_route` to match.
  routes.
* `not_found_plug` - a plug to call if no route is found. By default, it renders a simple JSON
  response with a 404 status code.
* `as` - the alias to use for the generated scope. Defaults to `:auth`.

### AshAuthentication.Phoenix.Router.auth_routes_for/2 (macro)

Generates the routes needed for the various strategies for a given
AshAuthentication resource.

This is required if you wish to use authentication.

### Options - AshAuthentication.Phoenix.Router.auth_routes_for/2 (macro)

* `to` - a module which implements the
    `AshAuthentication.Phoenix.Controller` behaviour.  This is required.
  * `path` - a string (starting with "/") wherein to mount the generated
    routes.
  * `scope_opts` - any options to pass to the generated scope.

### Example - AshAuthentication.Phoenix.Router.auth_routes_for/2 (macro)

```elixir
scope "/", DevWeb do
  auth_routes_for(MyApp.Accounts.User,
    to: AuthController,
    path: "/authentication",
    scope_opts: [host: "auth.example.com"]
  )
end
```

### AshAuthentication.Phoenix.Router.confirm_route/3 (macro)

Generates a generic, white-label confirmation page using LiveView and the components in
`AshAuthentication.Phoenix.Components`.

This is used when `require_interaction?` is set to `true` on a confirmation strategy.

Available options are:

  * `path` the path under which to mount the live-view. Defaults to
    "/ ".
  * `token_as_route_param?` whether to use the token as a route parameter. i.e ` /:token`. Defaults to `true`.
  * `live_view` the name of the live view to render. Defaults to
    `AshAuthentication.Phoenix.ConfirmLive`.
  * `as` which is passed to the generated `live` route. Defaults to `:auth`.
  * `overrides` specify any override modules for customisation. See
    `AshAuthentication.Phoenix.Overrides` for more information.
  * `gettext_fn` as a `{module :: module, function :: atom}` tuple pointing to a
    `(msgid :: String.t(), bindings :: keyword) :: String.t()` typed function that will be called to translate
    each output text of the live view.
  * `gettext_backend` as a `{module :: module, domain :: String.t()}` tuple pointing to a Gettext backend module
    and specifying the Gettext domain. This is basically a convenience wrapper around `gettext_fn`.

All other options are passed to the generated `scope`.

### AshAuthentication.Phoenix.Router.magic_sign_in_route/3 (macro)

Generates a genric, white-label magic link sign in page using LiveView and the components in `AshAuthentication.Phoenix.Components`.

This is used when `require_interaction?` is set to `true` on a magic link strategy.

Available options are:

  * `path` the path under which to mount the live-view. Defaults to
    "/ ".
  * `token_as_route_param?` whether to use the token as a route parameter. i.e ` /:token`. Defaults to `true`.
  * `live_view` the name of the live view to render. Defaults to
    `AshAuthentication.Phoenix.MagicSignInLive`.
  * `as` which is passed to the generated `live` route. Defaults to `:auth`.
  * `overrides` specify any override modules for customisation. See
    `AshAuthentication.Phoenix.Overrides` for more information.
  * `gettext_fn` as a `{module :: module, function :: atom}` tuple pointing to a
    `(msgid :: String.t(), bindings :: keyword) :: String.t()` typed function that will be called to translate
    each output text of the live view.
  * `gettext_backend` as a `{module :: module, domain :: String.t()}` tuple pointing to a Gettext backend module
    and specifying the Gettext domain. This is basically a convenience wrapper around `gettext_fn`.

All other options are passed to the generated `scope`.

### AshAuthentication.Phoenix.Router.path_option/0 (type)

A sub-path if required.  Defaults to `/auth`.

### AshAuthentication.Phoenix.Router.reset_route/1 (macro)

Generates a generic, white-label password reset page using LiveView and the components in
`AshAuthentication.Phoenix.Components`. This is the page that allows a user to actually change his password,
after requesting a reset token via the sign-in (`/reset`) route.

Available options are:

  * `path` the path under which to mount the live-view. Defaults to
    `/password-reset`.
  * `live_view` the name of the live view to render. Defaults to
    `AshAuthentication.Phoenix.ResetLive`.
  * `as` which is passed to the generated `live` route. Defaults to `:auth`.
  * `overrides` specify any override modules for customisation. See
    `AshAuthentication.Phoenix.Overrides` for more information.
  * `gettext_fn` as a `{module :: module, function :: atom}` tuple pointing to a
    `(msgid :: String.t(), bindings :: keyword) :: String.t()` typed function that will be called to translate
    each output text of the live view.
  * `gettext_backend` as a `{module :: module, domain :: String.t()}` tuple pointing to a Gettext backend module
    and specifying the Gettext domain. This is basically a convenience wrapper around `gettext_fn`.

All other options are passed to the generated `scope`.

### AshAuthentication.Phoenix.Router.scope_opts_option/0 (type)

Any options which should be passed to the generated scope.

### AshAuthentication.Phoenix.Router.sign_in_route/1 (macro)

Generates a generic, white-label sign-in page using LiveView and the
components in `AshAuthentication.Phoenix.Components`.

This is completely optional.

Available options are:

* `path` the path under which to mount the sign-in live-view. Defaults to `/sign-in` within the current router scope.
* `auth_routes_prefix` if set, this will be used instead of route helpers when determining routes.
  Allows disabling `helpers: true`.
  If a tuple {:unscoped, path} is provided, the path prefix will not inherit the current route scope.
* `register_path` - the path under which to mount the password strategy's registration live-view.
   If not set, and registration is supported, registration will use a dynamic toggle and will not be routeable to.
   If a tuple {:unscoped, path} is provided, the registration path will not inherit the current route scope.
* `reset_path` - the path under which to mount the password strategy's password reset live-view, for a user to
  request a reset token by email. If not set, and password reset is supported, password reset will use a
  dynamic toggle and will not be routeable to. If a tuple {:unscoped, path} is provided, the reset path
  will not inherit the current route scope.
* `resources` - Which resources should have their sign in UIs rendered. Defaults to all resources
  that use `AshAuthentication`.
* `live_view` the name of the live view to render. Defaults to
  `AshAuthentication.Phoenix.SignInLive`.
* `auth_routes_prefix` the prefix to use for the auth routes. Defaults to `/auth`.
* `as` which is used to prefix the generated `live_session` and `live` route name. Defaults to `:auth`.
* `otp_app` the otp app or apps to find authentication resources in. Pulls from the socket by default.
* `overrides` specify any override modules for customisation.  See
  `AshAuthentication.Phoenix.Overrides` for more information.
* `gettext_fn` as a `{module :: module, function :: atom}` tuple pointing to a
  `(msgid :: String.t(), bindings :: keyword) :: String.t()` typed function that will be called to translate
  each output text of the live view.
* `gettext_backend` as a `{module :: module, domain :: String.t()}` tuple pointing to a Gettext backend module
  and specifying the Gettext domain. This is basically a convenience wrapper around `gettext_fn`.

All other options are passed to the generated `scope`.

### AshAuthentication.Phoenix.Router.sign_out_route/3 (macro)

Generates a sign-out route which points to the `sign_out` action in your auth
controller.

This is optional, but you probably want it.

### AshAuthentication.Phoenix.Router.to_option/0 (type)

The controller which will handle success and failure.

### AshAuthentication.Phoenix.Components.Apple (module)

Generates a sign-in button for Apple.

### Component hierarchy - AshAuthentication.Phoenix.Components.Apple (module)

This is the top-most strategy-specific component, nested below
`AshAuthentication.Phoenix.Components.SignIn`.

### Props - AshAuthentication.Phoenix.Components.Apple (module)

* `strategy` - The strategy configuration as per
    `AshAuthentication.Info.strategy/2`.  Required.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### Overrides - AshAuthentication.Phoenix.Components.Apple (module)

This component provides the following overrides:

  * `:root_class` - CSS classes for the root `div` element.
  * `:link_class` - CSS classes for the `a` element.
  * `:icon_class` - CSS classes for the icon SVG.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Apple.icon/1 (function)



### AshAuthentication.Phoenix.Components.Apple.props/0 (type)



### AshAuthentication.Phoenix.Components.Banner (module)

Renders a very simple banner at the top of the sign-in component.

Can show either an image or some text, depending on the provided overrides.

### Props - AshAuthentication.Phoenix.Components.Banner (module)

* `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### Overrides - AshAuthentication.Phoenix.Components.Banner (module)

This component provides the following overrides:

  * `:text` - Banner text. Set to `nil` to disable.
  * `:root_class` - CSS class for the root `div` element.
  * `:href_class` - CSS class for the `a` tag.
  * `:href_url` - A URL for the banner image to link to. Set to `nil` to disable.
  * `:image_class` - CSS class for the `img` tag.
  * `:dark_image_class` - Css class for the `img` tag in dark mode.
  * `:image_url` - A URL for the `img` `src` attribute. Set to `nil` to disable.
  * `:dark_image_url` - A URL for the `img` `src` attribute in dark mode. Set to `nil` to disable.
  * `:text_class` - CSS class for the text `div`.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Banner.props/0 (type)



### AshAuthentication.Phoenix.Components.Confirm (module)

Renders a confirmation button.

### Component hierarchy - AshAuthentication.Phoenix.Components.Confirm (module)

Children:
  * `AshAuthentication.Phoenix.Components.ConfirmForm`

### Props - AshAuthentication.Phoenix.Components.Confirm (module)

* `token` - The confirmation token.
  * `resource` - The resource to confirm.
  * `strategy` - The strategy to confirm.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.
  * `otp_app` - The otp app to look for authenticated resources in

### Overrides - AshAuthentication.Phoenix.Components.Confirm (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:strategy_class` - CSS class for a `div` surrounding each strategy component.
  * `:show_banner` - Whether or not to show the banner.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Confirm.props/0 (type)



### AshAuthentication.Phoenix.Components.Confirm.Form (module)

Generates a default confirmation form.

### Component hierarchy - AshAuthentication.Phoenix.Components.Confirm.Form (module)

This is a child of `AshAuthentication.Phoenix.Components.Confirm`.

Children:

  * `AshAuthentication.Phoenix.Components.Confirm.Input.submit/1`

### Props - AshAuthentication.Phoenix.Components.Confirm.Form (module)

* `token` - The confirmation token.
  * `socket` - Phoenix LiveView socket.  This is needed to be able to retrieve
    the correct CSS configuration. Required.
  * `strategy` - The configuration map as per
    `AshAuthentication.Info.strategy/2`. Required.
  * `label` - The text to show in the submit label. Generated from the
    strategy name (via `Phoenix.Naming.humanize/1`) if not
    supplied. Set to `false` to disable.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### Overrides - AshAuthentication.Phoenix.Components.Confirm.Form (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:label_class` - CSS class for the `h2` element.
  * `:form_class` - CSS class for the `form` element.
  * `:disable_button_text` - Text for the submit button when the request is happening.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Confirm.Form.props/0 (type)



### AshAuthentication.Phoenix.Components.Confirm.Input (module)

Function components for dealing with form input during password
authentication.

### Component hierarchy - AshAuthentication.Phoenix.Components.Confirm.Input (module)

These function components are consumed by
`AshAuthentication.Phoenix.Components.Password.SignInForm`,
`AshAuthentication.Phoenix.Components.Password.RegisterForm` and
`AshAuthentication.Phoenix.Components.ResetForm`.

### Overrides - AshAuthentication.Phoenix.Components.Confirm.Input (module)

This component provides the following overrides:

  * `:submit_label` - A function that takes the strategy and returns text for the confirm button, or a string.
  * `:submit_class` - CSS class for the form submit `input` element.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Confirm.Input.submit/1 (function)

Generate an form submit button.

### Props - AshAuthentication.Phoenix.Components.Confirm.Input.submit/1 (function)

* `socket` - Phoenix LiveView socket.  This is needed to be able to retrieve
    the correct CSS configuration.  Required.
  * `strategy` - The configuration map as per
    `AshAuthentication.authenticated_resources/1`.  Required.
  * `form` - An `AshPhoenix.Form`.  Required.
  * `submit_label` - The text to show in the submit label.  Generated from the
    configured action name (via `Phoenix.Naming.humanize/1`) if not supplied.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### AshAuthentication.Phoenix.Components.Helpers (module)

Helpers which are commonly needed inside the various components.

### AshAuthentication.Phoenix.Components.Helpers.auth_path/6 (function)



### AshAuthentication.Phoenix.Components.Helpers.otp_app_from_socket/1 (function)

The LiveView `Socket` contains a reference to the Phoenix endpoint, and from
there we can extract the `otp_app` of the current request.

This is pulled from `assigns[:otp_app]`, or inferred
from the socket if that is not set.

### AshAuthentication.Phoenix.Components.Helpers.route_helpers/1 (function)

The LiveView `Socket` contains a refererence to the Phoenix router, and from
there we can generate the name of the route helpers module.

### AshAuthentication.Phoenix.Components.HorizontalRule (module)

A horizontal rule with text.

This component is pretty tailwind-specific, but I (@jimsynz) really wanted a
certain look.  If you think I'm wrong then please let me know.

### Overrides - AshAuthentication.Phoenix.Components.HorizontalRule (module)

This component provides the following overrides:

  * `:text` - Text to display in front of the horizontal rule.
  * `:root_class` - CSS class for the root `div` element.
  * `:hr_outer_class` - CSS class for the outer `div` element of the horizontal rule.
  * `:hr_inner_class` - CSS class for the inner `div` element of the horizontal rule.
  * `:text_outer_class` - CSS class for the outer `div` element of the text area.
  * `:text_inner_class` - CSS class for the inner `div` element of the text area.


See `AshAuthentication.Phoenix.Overrides` for more information.

### Props - AshAuthentication.Phoenix.Components.HorizontalRule (module)

* `overrides` - A list of override modules.

### AshAuthentication.Phoenix.Components.HorizontalRule.props/0 (type)



### AshAuthentication.Phoenix.Components.MagicLink (module)

Generates a sign-in for for a resource using the "Magic link" strategy.

### Component hierarchy - AshAuthentication.Phoenix.Components.MagicLink (module)

This is the top-most strategy-specific component, nested below
`AshAuthentication.Phoenix.Components.SignIn`.

Children:

  * `AshAuthentication.Phoenix.Components.Password.Input.identity_field/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.submit/1`

### Props - AshAuthentication.Phoenix.Components.MagicLink (module)

* `strategy` - the strategy configuration as per
    `AshAuthentication.Info.strategy/2`.  Required.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### Overrides - AshAuthentication.Phoenix.Components.MagicLink (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:label_class` - CSS class for the `h2` element.
  * `:form_class` - CSS class for the `form` element.
  * `:disable_button_text` - Text for the submit button when the request is happening.
  * `:request_flash_text` - Text for the flash message when a request is received.  Set to `nil` to disable.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.MagicLink.props/0 (type)



### AshAuthentication.Phoenix.Components.MagicLink.Form (module)

Generates a default magic sign in form.

### Component heirarchy - AshAuthentication.Phoenix.Components.MagicLink.Form (module)

This is a child of `AshAuthentication.Phoenix.Components.MagicLink.SignIn`.

Children:

  * `AshAuthentication.Phoenix.Components.MagicLink.Input.submit/1`.

### Props - AshAuthentication.Phoenix.Components.MagicLink.Form (module)

* `token` - The magic sign in token.
  * `socket` - Phoenix LiveView socket.  This is needed to be able to retrieve
    the correct CSS configuration. Required.
  * `strategy` - The configuration map as per
    `AshAuthentication.Info.strategy/2`. Required.
  * `label` - The text to show in the submit label. Generated from the
    strategy name (via `Phoenix.Naming.humanize/1`) if not
    supplied. Set to `false` to disable.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### Overrides - AshAuthentication.Phoenix.Components.MagicLink.Form (module)

This component provides the following overrides:

  * `:root_class` - CSS class for root `div` element.
  * `:label_class` - CSS class for the `h2` element.
  * `:form_class` - CSS class for the `form` element.
  * `:disable_button_text` - Text for the submit button when the request is happening.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.MagicLink.Input (module)

Function components for dealing with form input during magic link sign in.

### Component hierarchy - AshAuthentication.Phoenix.Components.MagicLink.Input (module)

These function components are consumed by
`AshAuthentication.Phoenix.Components.MagicLink.Form`

### Overrides - AshAuthentication.Phoenix.Components.MagicLink.Input (module)

This component provides the following overrides:

  * `:submit_label` - A function that takes the strategy and returns text for the sign in button, or a string.
  * `:submit_class` - CSS class for the form submit `input` element.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.MagicLink.Input.submit/1 (function)

Generate an form submit button.

### Props - AshAuthentication.Phoenix.Components.MagicLink.Input.submit/1 (function)

* `socket` - Phoenix LiveView socket.  This is needed to be able to retrieve
    the correct CSS configuration.  Required.
  * `strategy` - The configuration map as per
    `AshAuthentication.authenticated_resources/1`.  Required.
  * `form` - An `AshPhoenix.Form`.  Required.
  * `submit_label` - The text to show in the submit label.  Generated from the
    configured action name (via `Phoenix.Naming.humanize/1`) if not supplied.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### AshAuthentication.Phoenix.Components.MagicLink.SignIn (module)

Renders a magic sign in button.

### Component heirarchy - AshAuthentication.Phoenix.Components.MagicLink.SignIn (module)

Children:
  * `AshAuthentication.Phoenix.Components.MagicLink.Form`.

### Props - AshAuthentication.Phoenix.Components.MagicLink.SignIn (module)

* `token` - The magic link token.
  * `resource` - The resource to sign into.
  * `strategy` - The magic link strategy.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.
  * `otp_app` - The otp app to look for authenticated resources in

### Overrides - AshAuthentication.Phoenix.Components.MagicLink.SignIn (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:strategy_class` - CSS class for the `div` surrounding each strategy component.
  * `:show_banner` - Whether or not to show the banner


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.OAuth2 (module)

Generates a sign-in button for OAuth2.

### Component hierarchy - AshAuthentication.Phoenix.Components.OAuth2 (module)

This is the top-most strategy-specific component, nested below
`AshAuthentication.Phoenix.Components.SignIn`.

### Props - AshAuthentication.Phoenix.Components.OAuth2 (module)

* `strategy` - The strategy configuration as per
    `AshAuthentication.Info.strategy/2`.  Required.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### Overrides - AshAuthentication.Phoenix.Components.OAuth2 (module)

This component provides the following overrides:

  * `:root_class` - CSS classes for the root `div` element.
  * `:link_class` - CSS classes for the `a` element.
  * `:icon_class` - CSS classes for the icon SVG.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.OAuth2.icon/1 (function)



### AshAuthentication.Phoenix.Components.OAuth2.props/0 (type)



### AshAuthentication.Phoenix.Components.Password (module)

Generates sign in, registration and reset forms for a resource.

### Component hierarchy - AshAuthentication.Phoenix.Components.Password (module)

This is the top-most strategy-specific component, nested below
`AshAuthentication.Phoenix.Components.SignIn`.

Children:

  * `AshAuthentication.Phoenix.Components.Password.SignInForm`
  * `AshAuthentication.Phoenix.Components.Password.RegisterForm`
  * `AshAuthentication.Phoenix.Components.Password.ResetForm`

### Props - AshAuthentication.Phoenix.Components.Password (module)

* `strategy` - The strategy configuration as per
    `AshAuthentication.Info.strategy/2`.  Required.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### Slots - AshAuthentication.Phoenix.Components.Password (module)

* `sign_in_extra` - rendered inside the sign-in form with the form passed as
    a slot argument.
  * `register_extra` - rendered inside the registration form with the form
    passed as a slot argument.
  * `reset_extra` - rendered inside the reset form with the form passed as a
    slot argument.
  * `path` - used as the base for links to other pages.
  * `reset_path` - the path to use for reset links.
  * `register_path` - the path to use for register links.

```heex
<.live_component
  module={AshAuthentication.Phoenix.Components.Password}
  strategy={AshAuthentication.Info.strategy!(Example.User, :password)}
  id="user-with-password"
  socket={@socket}
  overrides={[AshAuthentication.Phoenix.Overrides.Default]}>

  <:sign_in_extra :let={form}>
    <.input field={form[:capcha]} />
  </:sign_in_extra>

  <:register_extra :let={form}>
    <.input field={form[:name]} />
  </:register_extra>

  <:reset_extra :let={form}>
    <.input field={form[:capcha]} />
  </:reset_extra>
</.live_component>
```

### Overrides - AshAuthentication.Phoenix.Components.Password (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:hide_class` - CSS class to apply to hide an element.
  * `:show_first` - The form to show on first load.  Either `:sign_in` or `:register`. Only relevant if paths aren't set for them in the router.
  * `:interstitial_class` - CSS class for the `div` element between the form and the button.
  * `:sign_in_toggle_text` - Toggle text to display when the sign in form is not showing (or `nil` to disable).
  * `:register_toggle_text` - Toggle text to display when the register form is not showing (or `nil` to disable).
  * `:reset_toggle_text` - Toggle text to display when the reset form is not showing (or `nil` to disable).
  * `:toggler_class` - CSS class for the toggler `a` element.
  * `:register_form_module` - The Phoenix component to be used for the registration form. Defaults to `AshAuthentication.Phoenix.Components.Password.RegisterForm`.
  * `:slot_class` - CSS class for the `div` surrounding the slot.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Password.props/0 (type)



### AshAuthentication.Phoenix.Components.Password.Input (module)

Function components for dealing with form input during password
authentication.

### Component hierarchy - AshAuthentication.Phoenix.Components.Password.Input (module)

These function components are consumed by
`AshAuthentication.Phoenix.Components.Password.SignInForm`,
`AshAuthentication.Phoenix.Components.Password.RegisterForm` and
`AshAuthentication.Phoenix.Components.ResetForm`.

### Overrides - AshAuthentication.Phoenix.Components.Password.Input (module)

This component provides the following overrides:

  * `:label_class` - CSS class for `label` elements.
  * `:submit_class` - CSS class for the form submit `input` element.
  * `:field_class` - CSS class for `div` elements surrounding the fields.
  * `:input_class` - CSS class for text/password `input` elements.
  * `:identity_input_label` - Label for identity field.
  * `:identity_input_placeholder` - Placeholder for identity field.
  * `:password_input_label` - Label for password field.
  * `:password_confirmation_input_label` - Label for password confirmation field.
  * `:input_class_with_error` - CSS class for text/password `input` elements when there is a validation error.
  * `:error_ul` - CSS class for the `ul` element on error lists.
  * `:error_li` - CSS class for the `li` elements on error lists.
  * `:input_debounce` - Number of milliseconds to debounce input by (or `nil` to disable).


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Password.Input.error/1 (function)

Generate a list of errors for a field (if there are any).

### Props - AshAuthentication.Phoenix.Components.Password.Input.error/1 (function)

* `socket` - Phoenix LiveView socket.  This is needed to be able to retrieve
    the correct CSS configuration.  Required.
  * `form` - An `AshPhoenix.Form`.  Required.
  * `field` - The field for which to retrieve the errors.  Required.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### AshAuthentication.Phoenix.Components.Password.Input.identity_field/1 (function)

Generate a form field for the configured identity field.

### Props - AshAuthentication.Phoenix.Components.Password.Input.identity_field/1 (function)

* `socket` - Phoenix LiveView socket.
    This is needed to be able to retrieve the correct CSS configuration.
    Required.
  * `strategy` - The configuration map as per
    `AshAuthentication.authenticated_resources/1`.
    Required.
  * `form` - An `AshPhoenix.Form`.
    Required.
  * `input_type` - Either `:text` or `:email`.
    If not set it will try and guess based on the name of the identity field.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### AshAuthentication.Phoenix.Components.Password.Input.password_confirmation_field/1 (function)

Generate a form field for the configured password confirmation entry field.

### Props - AshAuthentication.Phoenix.Components.Password.Input.password_confirmation_field/1 (function)

* `socket` - Phoenix LiveView socket.  This is needed to be able to retrieve
    the correct CSS configuration.  Required.
  * `strategy` - The configuration map as per
    `AshAuthentication.authenticated_resources/1`.  Required.
  * `form` - An `AshPhoenix.Form`.  Required.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### AshAuthentication.Phoenix.Components.Password.Input.password_field/1 (function)

Generate a form field for the configured password entry field.

### Props - AshAuthentication.Phoenix.Components.Password.Input.password_field/1 (function)

* `socket` - Phoenix LiveView socket.  This is needed to be able to retrieve
    the correct CSS configuration.  Required.
  * `strategy` - The configuration map as per
    `AshAuthentication.authenticated_resources/1`.  Required.
  * `form` - An `AshPhoenix.Form`.  Required.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### AshAuthentication.Phoenix.Components.Password.Input.submit/1 (function)

Generate an form submit button.

### Props - AshAuthentication.Phoenix.Components.Password.Input.submit/1 (function)

* `socket` - Phoenix LiveView socket.  This is needed to be able to retrieve
    the correct CSS configuration.  Required.
  * `strategy` - The configuration map as per
    `AshAuthentication.authenticated_resources/1`.  Required.
  * `form` - An `AshPhoenix.Form`.  Required.
  * `action` - Either `:sign_in`, `:register`, `:request_reset` or `:reset`.  Required.
  * `label` - The text to show in the submit label.  Generated from the
    configured action name (via `Phoenix.Naming.humanize/1`) if not supplied.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### AshAuthentication.Phoenix.Components.Password.RegisterForm (module)

Generates a default registration form.

### Component hierarchy - AshAuthentication.Phoenix.Components.Password.RegisterForm (module)

This is a child of `AshAuthentication.Phoenix.Components.Password`.

Children:

  * `AshAuthentication.Phoenix.Components.Password.Input.identity_field/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.password_field/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.password_confirmation_field/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.submit/1`

### Props - AshAuthentication.Phoenix.Components.Password.RegisterForm (module)

* `strategy` - The strategy configuration as per
    `AshAuthentication.Info.strategy/2`.  Required.
  * `socket` - Needed to infer the otp-app from the Phoenix endpoint.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### Overrides - AshAuthentication.Phoenix.Components.Password.RegisterForm (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:label_class` - CSS class for the `h2` element.
  * `:form_class` - CSS class for the `form` element.
  * `:disable_button_text` - Text for the submit button when the request is happening.
  * `:slot_class` - CSS class for the `div` surrounding the slot.
  * `:button_text` - Text for the submit button.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Password.RegisterForm.props/0 (type)



### AshAuthentication.Phoenix.Components.Password.ResetForm (module)

Generates a default password reset form.

### Component hierarchy - AshAuthentication.Phoenix.Components.Password.ResetForm (module)

This is a child of `AshAuthentication.Phoenix.Components.Password`.

Children:

  * `AshAuthentication.Phoenix.Components.Password.Input.identity_field/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.submit/1`

### Props - AshAuthentication.Phoenix.Components.Password.ResetForm (module)

* `strategy` - The configuration map as per
    `AshAuthentication.Info.strategy/2`. Required.
  * `label` - The text to show in the submit label.  Generated from the
    configured action name (via `Phoenix.Naming.humanize/1`) if not supplied.
    Set to `false` to disable.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### Overrides - AshAuthentication.Phoenix.Components.Password.ResetForm (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:label_class` - CSS class for the `h2` element.
  * `:form_class` - CSS class for the `form` element.
  * `:disable_button_text` - Text for the submit button when the request is happening.
  * `:slot_class` - CSS class for the `div` surrounding the slot.
  * `:button_text` - Tex for the submit button.
  * `:reset_flash_text` - Text for the flash message when a request is received.  Set to `nil` to disable.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Password.ResetForm.props/0 (type)



### AshAuthentication.Phoenix.Components.Password.SignInForm (module)

Generates a default sign in form.

### Component hierarchy - AshAuthentication.Phoenix.Components.Password.SignInForm (module)

This is a child of `AshAuthentication.Phoenix.Components.Password`.

Children:

  * `AshAuthentication.Phoenix.Components.Password.Input.identity_field/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.password_field/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.submit/1`

### Props - AshAuthentication.Phoenix.Components.Password.SignInForm (module)

* `strategy` - The configuration map as per
    `AshAuthentication.Info.strategy/2`. Required.
  * `label` - The text to show in the submit label. Generated from the
    configured action name (via `Phoenix.Naming.humanize/1`) if not supplied.
    Set to `false` to disable.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### Overrides - AshAuthentication.Phoenix.Components.Password.SignInForm (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:label_class` - CSS class for the `h2` element.
  * `:form_class` - CSS class for the `form` element.
  * `:disable_button_text` - Text for the submit button when the request is happening.
  * `:slot_class` - CSS class for the `div` surrounding the slot.
  * `:button_text` - Text for the submit button.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Password.SignInForm.props/0 (type)



### AshAuthentication.Phoenix.Components.Reset (module)

Renders a password-reset form.

### Component hierarchy - AshAuthentication.Phoenix.Components.Reset (module)

Children:

  * `AshAuthentication.Phoenix.Components.Password.Input.password_field/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.password_confirmation_field/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.submit/1`

### Props - AshAuthentication.Phoenix.Components.Reset (module)

* `token` - The reset token.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.
  * `otp_app` - The otp app to look for authenticated resources in

### Overrides - AshAuthentication.Phoenix.Components.Reset (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:strategy_class` - CSS class for a `div` surrounding each strategy component.
  * `:show_banner` - Whether or not to show the banner.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Reset.props/0 (type)



### AshAuthentication.Phoenix.Components.Reset.Form (module)

Generates a default password reset form.

### Component hierarchy - AshAuthentication.Phoenix.Components.Reset.Form (module)

This is a child of `AshAuthentication.Phoenix.Components.Reset`.

Children:

  * `AshAuthentication.Phoenix.Components.Password.Input.identity_field/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.password_field/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.submit/1`
  * `AshAuthentication.Phoenix.Components.Password.Input.error/1`

### Props - AshAuthentication.Phoenix.Components.Reset.Form (module)

* `token` - The reset token.
  * `socket` - Phoenix LiveView socket.  This is needed to be able to retrieve
    the correct CSS configuration. Required.
  * `strategy` - The configuration map as per
    `AshAuthentication.Info.strategy/2`. Required.
  * `label` - The text to show in the submit label. Generated from the
    configured action name (via `Phoenix.Naming.humanize/1`) if not
    supplied. Set to `false` to disable.
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### Overrides - AshAuthentication.Phoenix.Components.Reset.Form (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:label_class` - CSS class for the `h2` element.
  * `:form_class` - CSS class for the `form` element.
  * `:disable_button_text` - Text for the submit button when the request is happening.
  * `:spacer_class` - CSS classes for space between the password input and submit elements.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Components.Reset.Form.props/0 (type)



### AshAuthentication.Phoenix.Components.SignIn (module)

Renders sign in mark-up for an authenticated resource.

This means that it will render sign-in UI for all of the authentication
strategies for a resource.

For each strategy configured on the resource a component name is inferred
(e.g. `AshAuthentication.Strategy.Password` becomes
`AshAuthentication.Phoenix.Components.Password`) and is rendered into the
output.

### Component hierarchy - AshAuthentication.Phoenix.Components.SignIn (module)

This is the top-most authentication component.

Children:

  * `AshAuthentication.Phoenix.Components.Password`.
  * `AshAuthentication.Phoenix.Components.OAuth2`.

### Overrides - AshAuthentication.Phoenix.Components.SignIn (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:strategy_class` - CSS class for a `div` surrounding each strategy component.
  * `:show_banner` - Whether or not to show the banner.
  * `:authentication_error_container_class` - CSS class for the container for the text of the authentication error.
  * `:authentication_error_text_class` - CSS class for the authentication error text.
  * `:strategy_display_order` - Whether to display the form or link strategies first. Accepted values are `:forms_first` or `:links_first`.


See `AshAuthentication.Phoenix.Overrides` for more information.

### Props - AshAuthentication.Phoenix.Components.SignIn (module)

* `otp_app` - The otp app to look for authenticated resources in
  * `live_action` - The live_action being routed to
  * `path` - The path to use as the base for links
  * `reset_path` - The path to use for reset links
  * `register_path` - The path to use for register links
  * `overrides` - A list of override modules.
  * `gettext_fn` - Optional text translation function.

### AshAuthentication.Phoenix.Components.SignIn.props/0 (type)



### AshAuthentication.Phoenix.ConfirmLive (module)

A generic, white-label confirmation page.

This is used when `require_interaction?` is set to `true` on a confirmation strategy.

### Overrides - AshAuthentication.Phoenix.ConfirmLive (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:confirm_id` - Element ID for the `Reset` LiveComponent.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.MagicSignInLive (module)

A generic, white-label confirmation page.

This is used when `require_interaction?` is set to `true` on a confirmation strategy.

### Overrides - AshAuthentication.Phoenix.MagicSignInLive (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:magic_sign_in_id` - Element ID for the `MagicSignIn` LiveComponent.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Overrides (module)

Behaviour for overriding component styles and attributes in your application.

The default implementation is `AshAuthentication.Phoenix.Overrides.Default`
which uses [TailwindCSS](https://tailwindcss.com/) to generate a fairly
generic looking user interface.

You can override this by adding your own override modules to the
`AshAuthentication.Phoenix.Router.sign_in_route/1` macro in your router:

```elixir
sign_in_route overrides: [MyAppWeb.AuthOverrides, AshAuthentication.Phoenix.Overrides.Default]
```

and defining `lib/my_app_web/auth_overrides.ex` within which you can set any
overrides.

The `use` macro defines overridable versions of all callbacks which return
`nil`, so you only need to define the functions that you care about.

Each of the override modules specified in the config will be called in the
order that they're specified, so you can still use the defaults if you just
override some properties.

```elixir
defmodule MyAppWeb.AuthOverrides do
  use AshAuthentication.Phoenix.Overrides
  alias AshAuthentication.Phoenix.Components

  override Components.Banner do
    set :image_url, "/images/sign_in_logo.png"
  end
end
```

### AshAuthentication.Phoenix.Overrides.override/2 (macro)

Define overrides for a specific component.

### AshAuthentication.Phoenix.Overrides.set/2 (macro)

Override a setting within a component.

### AshAuthentication.Phoenix.Overrides.Default (module)

This is the default overrides for our component UI.

The CSS styles are based on [TailwindCSS](https://tailwindcss.com/).

### AshAuthentication.Phoenix.Overrides.Default.overrides/0 (function)



### AshAuthentication.Phoenix.Overrides.Info (module)

Override introspection.

### AshAuthentication.Phoenix.Overrides.Info.all_overridable_modules/0 (function)

Returns a map of all known overridable modules and their overrides.

### AshAuthentication.Phoenix.Overrides.Overridable (behaviour)

Auto generates documentation and helpers for components.

### AshAuthentication.Phoenix.Overrides.Overridable.override_for/3 (macro)

Retrieve configuration for a potentially overriden value.

### AshAuthentication.Phoenix.ResetLive (module)

A generic, white-label password reset page.

This live-view can be rendered into your app using the
`AshAuthentication.Phoenix.Router.reset_route/1` macro in your router (or by
using `Phoenix.LiveView.Controller.live_render/3` directly in your markup).

This live-view looks for the `token` URL parameter, and if found passes it to
`AshAuthentication.Phoenix.Components.Reset`.

### Overrides - AshAuthentication.Phoenix.ResetLive (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:reset_id` - Element ID for the `Reset` LiveComponent.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.SignInLive (module)

A generic, white-label sign-in page.

This live-view can be rendered into your app using the
`AshAuthentication.Phoenix.Router.sign_in_route/1` macro in your router (or by
using `Phoenix.LiveView.Controller.live_render/3` directly in your markup).

This live-view finds all Ash resources with an authentication configuration
(via `AshAuthentication.authenticated_resources/1`) and renders the
appropriate UI for their providers using
`AshAuthentication.Phoenix.Components.SignIn`.

### Overrides - AshAuthentication.Phoenix.SignInLive (module)

This component provides the following overrides:

  * `:root_class` - CSS class for the root `div` element.
  * `:sign_in_id` - Element ID for the `SignIn` LiveComponent.


See `AshAuthentication.Phoenix.Overrides` for more information.

### AshAuthentication.Phoenix.Utils.Flash (module)

Utility functions for sending and receiving flash messages.

### AshAuthentication.Phoenix.Utils.Flash.on_mount/4 (function)

Attach a hook to receive flash messages sent from components, for rendering in
the top-level liveview.

### AshAuthentication.Phoenix.Utils.Flash.put_flash!/3 (function)

Send flash messages from components, to be rendered in their parent liveview.

## Links

- [Online documentation](https://hexdocs.pm/ash_authentication_phoenix)# ash_postgres

> The PostgreSQL data layer for Ash Framework

## Docs

### AshPostgres.Igniter (module)

Codemods and utilities for working with AshPostgres & Igniter

### AshPostgres.Igniter.add_postgres_extension/3 (function)



### AshPostgres.Igniter.list_repos/1 (function)



### AshPostgres.Igniter.repo/2 (function)



### AshPostgres.Igniter.select_repo/2 (function)



### AshPostgres.Igniter.table/2 (function)



### AshPostgres.MigrationCompileCache (module)

A cache for the compiled migrations.

This is used to avoid recompiling the migration files
every time a migration is run, as well as ensuring that
migrations are compiled sequentially.

This is important because otherwise there is a race condition
where two invocations could be compiling the same migration at
once, which would error out.

### AshPostgres.MigrationCompileCache.compile_file/1 (function)

Compile a file, caching the result for future calls.

### AshPostgres.MigrationCompileCache.start_link/1 (function)



### Mix.Tasks.AshPostgres.GenerateMigrations.run/1 (function)



### Mix.Tasks.AshPostgres.SquashSnapshots.run/1 (function)



### AshPostgres.Functions.Binding (module)

Refers to the current table binding.

### AshPostgres.Functions.Binding.args/0 (function)



### AshPostgres.Functions.VectorL2Distance (module)

Maps to the vector l2 distance operator. Requires `vector` extension to be installed.

### AshPostgres.Functions.VectorL2Distance.args/0 (function)



### AshPostgres (module)

The AshPostgres extension gives you tools to map a resource to a postgres database table.

For more, check out the [getting started guide](/documentation/tutorials/get-started-with-ash-postgres.md)

### AshPostgres.base_filter_sql/1 (function)



### AshPostgres.check_constraints/1 (function)



### AshPostgres.custom_indexes/1 (function)



### AshPostgres.custom_statements/1 (function)



### AshPostgres.exclusion_constraint_names/1 (function)



### AshPostgres.foreign_key_names/1 (function)



### AshPostgres.identity_index_names/1 (function)



### AshPostgres.manage_tenant_create?/1 (function)



### AshPostgres.manage_tenant_template/1 (function)



### AshPostgres.manage_tenant_update?/1 (function)



### AshPostgres.migrate?/1 (function)



### AshPostgres.migration_types/1 (function)



### AshPostgres.polymorphic?/1 (function)



### AshPostgres.polymorphic_name/1 (function)



### AshPostgres.polymorphic_on_delete/1 (function)



### AshPostgres.polymorphic_on_update/1 (function)



### AshPostgres.references/1 (function)



### AshPostgres.repo/1 (function)



### AshPostgres.schema/1 (function)



### AshPostgres.skip_unique_indexes/1 (function)



### AshPostgres.table/1 (function)



### AshPostgres.unique_index_names/1 (function)



### AshPostgres.DataLayer (module)

A postgres data layer that leverages Ecto's postgres capabilities.

### AshPostgres.DataLayer.add_known_binding/3 (function)



### AshPostgres.DataLayer.codegen/1 (function)



### AshPostgres.DataLayer.from_ecto/1 (function)



### AshPostgres.DataLayer.install/4 (function)



### AshPostgres.DataLayer.install/5 (function)



### AshPostgres.DataLayer.migrate/1 (function)



### AshPostgres.DataLayer.postgres/1 (macro)



### AshPostgres.DataLayer.rollback/1 (function)



### AshPostgres.DataLayer.setup/1 (function)



### AshPostgres.DataLayer.tear_down/1 (function)



### AshPostgres.DataLayer.to_ecto/1 (function)



### AshPostgres.Repo (behaviour)

Resources that use `AshPostgres.DataLayer` use a `Repo` to access the database.

This repo is a thin wrapper around an `Ecto.Repo`.

You can use `Ecto.Repo`'s `init/2` to configure your repo like normal, but
instead of returning `{:ok, config}`, use `super(config)` to pass the
configuration to the `AshPostgres.Repo` implementation.

### Installed Extensions - AshPostgres.Repo (behaviour)

To configure your list of installed extensions, define `installed_extensions/0`

Extensions can be a string, representing a standard postgres extension, or a module that implements `AshPostgres.CustomExtension`.
That custom extension will be called to generate migrations that serve a specific purpose.

Extensions that are relevant to ash_postgres:

* "ash-functions" - This isn't really an extension, but it expresses that certain functions
  should be added when generating migrations, to support the `||` and `&&` operators in expressions.
* `"uuid-ossp"` - Sets UUID primary keys defaults in the migration generator
* `"pg_trgm"` - Makes the `AshPostgres.Functions.TrigramSimilarity` function available
* "citext" - Allows case insensitive fields to be used
* `"vector"` - Makes the `AshPostgres.Functions.VectorCosineDistance` function available. See `AshPostgres.Extensions.Vector` for more setup instructions.

```
def installed_extensions() do
  ["pg_trgm", "uuid-ossp", "vector", YourCustomExtension]
end
```

### Transaction Hooks - AshPostgres.Repo (behaviour)

You can define `on_transaction_begin/1`, which will be invoked whenever a transaction is started for Ash.

This will be invoked with a map containing a `type` key and metadata.

```elixir
%{type: :create, %{resource: YourApp.YourResource, action: :action}}
```

### Additional Repo Configuration - AshPostgres.Repo (behaviour)

Because an `AshPostgres.Repo` is also an `Ecto.Repo`, it has all of the same callbacks.

In the `c:Ecto.Repo.init/2` callback, you can configure the following additional items:

- `:tenant_migrations_path` - The path where your tenant migrations are stored (only relevant for a multitenant implementation)
- `:snapshots_path` - The path where the resource snapshots for the migration generator are stored.

### AshPostgres.Repo.all_tenants/0 (callback)

Return a list of all schema names (only relevant for a multitenant implementation)

### AshPostgres.Repo.create?/0 (callback)

Should the repo should be created by `mix ash_postgres.create`?

### AshPostgres.Repo.default_constraint_match_type/2 (callback)

Determine how constraint names are matched when generating errors.

This is useful if you are using something like citus that creates generated constraint
names for each node. In that case, for example, you might return a regex that
matches the name plus digits.

### AshPostgres.Repo.default_prefix/0 (callback)

The default prefix(postgres schema) to use when building queries

### AshPostgres.Repo.disable_atomic_actions?/0 (callback)

Disable atomic actions for this repo

### AshPostgres.Repo.disable_expr_error?/0 (callback)

Disable expression errors for this repo

### AshPostgres.Repo.drop?/0 (callback)

Should the repo should be dropped by `mix ash_postgres.drop`?

### AshPostgres.Repo.installed_extensions/0 (callback)

Use this to inform the data layer about what extensions are installed

### AshPostgres.Repo.migrations_path/0 (callback)

The path where your migrations are stored

### AshPostgres.Repo.min_pg_version/0 (callback)

Configure the version of postgres that is being used.

### AshPostgres.Repo.on_transaction_begin/1 (callback)

Use this to inform the data layer about the oldest potential postgres version it will be run on.

Must be an integer greater than or equal to 13.

### Combining with other tools - AshPostgres.Repo.on_transaction_begin/1 (callback)

For things like `Fly.Repo`, where you might need to have more fine grained control over the repo module,
you can use the `define_ecto_repo?: false` option to `use AshPostgres.Repo`.

### AshPostgres.Repo.override_migration_type/1 (callback)

Allows overriding a given migration type for *all* fields, for example if you wanted to always use :timestamptz for :utc_datetime fields

### AshPostgres.Repo.prefer_transaction?/0 (callback)

Whether or not to explicitly start and close a transaction for each action, even if there are no transaction hooks. Defaults to `true`.

### AshPostgres.Repo.prefer_transaction_for_atomic_updates?/0 (callback)

Whether or not to explicitly start and close a transaction for each atomic update action, even if there are no transaction hooks. Defaults to `false`.

### AshPostgres.Repo.tenant_migrations_path/0 (callback)

The path where your tenant migrations are stored (only relevant for a multitenant implementation)

### AshPostgres.ManualRelationship (behaviour)

A behavior for postgres-specific manual relationship functionality

### AshPostgres.ManualRelationship.ash_postgres_join/6 (callback)



### AshPostgres.ManualRelationship.ash_postgres_subquery/4 (callback)



### AshPostgres.CheckConstraint (module)

Represents a configured check constraint on the table backing a resource

### AshPostgres.CheckConstraint.schema/0 (function)



### AshPostgres.CustomExtension (behaviour)

A custom extension implementation.

### AshPostgres.CustomExtension.install/1 (callback)



### AshPostgres.CustomExtension.uninstall/1 (callback)



### AshPostgres.CustomIndex (module)

Represents a custom index on the table backing a resource

### AshPostgres.CustomIndex.fields/0 (function)



### AshPostgres.CustomIndex.name/2 (function)



### AshPostgres.CustomIndex.schema/0 (function)



### AshPostgres.CustomIndex.transform/1 (function)



### AshPostgres.DataLayer.Info (module)

Introspection functions for

### AshPostgres.DataLayer.Info.base_filter_sql/1 (function)

A stringified version of the base_filter, to be used in a where clause when generating unique indexes

### AshPostgres.DataLayer.Info.calculation_to_sql/2 (function)



### AshPostgres.DataLayer.Info.calculations_to_sql/1 (function)

A keyword list of calculations to their sql representation

### AshPostgres.DataLayer.Info.check_constraints/1 (function)

The configured check_constraints for a resource

### AshPostgres.DataLayer.Info.custom_indexes/1 (function)

The configured custom_indexes for a resource

### AshPostgres.DataLayer.Info.custom_statements/1 (function)

The configured custom_statements for a resource

### AshPostgres.DataLayer.Info.exclusion_constraint_names/1 (function)

The configured exclusion_constraint_names

### AshPostgres.DataLayer.Info.foreign_key_names/1 (function)

The configured foreign_key_names

### AshPostgres.DataLayer.Info.global_upsert_keys/1 (function)

A list of keys to always include in upserts.

### AshPostgres.DataLayer.Info.identity_index_names/1 (function)

The configured identity_index_names

### AshPostgres.DataLayer.Info.identity_where_to_sql/2 (function)

Returns the literal SQL for the `where` clause given a resource and an
identity name.

See `identity_wheres_to_sql/1` for more details.

### AshPostgres.DataLayer.Info.identity_wheres_to_sql/1 (function)

A keyword list of identity names to the literal SQL string representation of
the `where` clause portion of identity's partial unique index.

For example, given the following identity for a resource:

    identities do
      identity :active, [:status] do
        where expr(status == "active")
      end
    end

An appropriate `identity_wheres_to_sql` would need to be made to generate the
correct migration for the partial index used by the identity:

    postgres do
      ...

      identity_wheres_to_sql active: "status = 'active'"
    end

### AshPostgres.DataLayer.Info.manage_tenant_create?/1 (function)

Whether or not to create a tenant for a given resource

### AshPostgres.DataLayer.Info.manage_tenant_template/1 (function)

The template for a managed tenant

### AshPostgres.DataLayer.Info.manage_tenant_update?/1 (function)

Whether or not to update a tenant for a given resource

### AshPostgres.DataLayer.Info.migrate?/1 (function)

Whether or not the resource should be included when generating migrations

### AshPostgres.DataLayer.Info.migration_defaults/1 (function)

A keyword list of customized migration defaults

### AshPostgres.DataLayer.Info.migration_ignore_attributes/1 (function)

A list of attributes to be ignored when generating migrations

### AshPostgres.DataLayer.Info.migration_types/1 (function)

A keyword list of customized migration types

### AshPostgres.DataLayer.Info.min_pg_version/1 (function)

Gets the resource's repo's postgres version

### AshPostgres.DataLayer.Info.pg_version_matches?/2 (function)

Checks a version requirement against the resource's repo's postgres version

### AshPostgres.DataLayer.Info.polymorphic?/1 (function)

The configured polymorphic? for a resource

### AshPostgres.DataLayer.Info.polymorphic_name/1 (function)

The configured polymorphic_reference_name for a resource

### AshPostgres.DataLayer.Info.polymorphic_on_delete/1 (function)

The configured polymorphic_reference_on_delete for a resource

### AshPostgres.DataLayer.Info.polymorphic_on_update/1 (function)

The configured polymorphic_reference_on_update for a resource

### AshPostgres.DataLayer.Info.reference/2 (function)

The configured reference for a given relationship of a  resource

### AshPostgres.DataLayer.Info.references/1 (function)

The configured references for a resource

### AshPostgres.DataLayer.Info.repo/2 (function)

The configured repo for a resource

### AshPostgres.DataLayer.Info.schema/1 (function)

The configured schema for a resource

### AshPostgres.DataLayer.Info.simple_join_first_aggregates/1 (function)



### AshPostgres.DataLayer.Info.skip_identities/1 (function)

Identities not to include in the migrations

### AshPostgres.DataLayer.Info.skip_unique_indexes/1 (function)

Skip generating unique indexes when generating migrations

### AshPostgres.DataLayer.Info.storage_types/1 (function)

A keyword list of customized storage types

### AshPostgres.DataLayer.Info.table/1 (function)

The configured table for a resource

### AshPostgres.DataLayer.Info.unique_index_names/1 (function)

The configured unique_index_names

### AshPostgres.Reference (module)

Represents the configuration of a reference (i.e foreign key).

### AshPostgres.Reference.schema/0 (function)



### AshPostgres.Statement (module)

Represents a custom statement to be run in generated migrations

### AshPostgres.Statement.fields/0 (function)



### AshPostgres.Statement.schema/0 (function)



### AshPostgres.Ltree (module)

Ash Type for [postgres `ltree`](https://www.postgresql.org/docs/current/ltree.html),
a hierarchical tree-like data type.

### Postgres Extension - AshPostgres.Ltree (module)

To be able to use the `ltree` type, you'll have to enable the postgres `ltree`
extension first.

See `m:AshPostgres.Repo#module-installed-extensions`

### Constraints - AshPostgres.Ltree (module)

* `:escape?` (`t:boolean/0`) - Escape the ltree segments to make it possible to include characters that
  are either `.` (the separation character) or any other unsupported
  character like `-` (Postgres <= 15).  
  If the option is enabled, any characters besides `[0-9a-zA-Z]` will be
  replaced with `_[HEX Ascii Code]`.  
  Additionally the type will no longer take strings as user input since
  it's impossible to decide between `.` being a separator or part of a
  segment.  
  If the option is disabled, any string will be relayed directly to
  postgres. If the segments are provided as a list, they can't contain `.`
  since postgres would split the segment.

* `:min_length` (`t:non_neg_integer/0`) - A minimum length for the tree segments.

* `:max_length` (`t:non_neg_integer/0`) - A maximum length for the tree segments.

### AshPostgres.Ltree.handle_change?/0 (function)



### AshPostgres.Ltree.prepare_change?/0 (function)



### AshPostgres.Ltree.segment/0 (type)



### AshPostgres.Ltree.shared_root/2 (function)

Get shared root of given ltrees.

### Examples - AshPostgres.Ltree.shared_root/2 (function)

iex> Ltree.shared_root(["1", "2"], ["1", "1"])
    ["1"]

    iex> Ltree.shared_root(["1", "2"], ["2", "1"])
    []

### AshPostgres.Ltree.t/0 (type)



### AshPostgres.Timestamptz (module)

Implements the PostgresSQL [timestamptz](https://www.postgresql.org/docs/current/datatype-datetime.html) (aka `timestamp with time zone`) type.

Postgres [*strongly recommends*](https://wiki.postgresql.org/wiki/Don%27t_Do_This#Don.27t_use_timestamp_.28without_time_zone.29) using this type instead of the standard timestamps/datetimes without a time zone. Generally speaking, it is best practice to use the [nanosecond-precision](`AshPostgres.TimestamptzUsec`) variant.

The basic reason `timestamptz` exists is to guarantee that the precise moment in time is stored as microseconds since January 1st, 2000 in UTC. This guarantee eliminates many time arithmetic problems, and ensures portability.

It does not actually store a timezone, in spite of the name. As far as Elixir/Ecto is concerned, it is always of type `DateTime` and set to UTC. Using this type ensures Postgres internally uses the same contract as Ecto's `:utc_datetime`, which is to always store `DateTime` in UTC. This is especially helpful if you need to do complex time arithmetic in SQL fragments, or build reports/materialized views that use localized time formatting.

Using this type ubiquitously in your schemas is particularly beneficial for consistency, and this is currently [under consideration](https://github.com/ash-project/ash_postgres/issues/264) as a configuration option for the default datetime storage type.

```elixir
attribute :timestamp, AshPostgres.Timestamptz
timestamps type: AshPostgres.Timestamptz
```

Alternatively, you can set up a shortname:

```elixir
# config.exs
config :ash, :custom_types, timestamptz: AshPostgres.Timestamptz
```

After saving, you will need to run `mix compile ash --force`.

```elixir
attribute :timestamp, :timestamptz
timestamps type: :timestamptz
```

### AshPostgres.Timestamptz.handle_change?/0 (function)



### AshPostgres.Timestamptz.prepare_change?/0 (function)



### AshPostgres.TimestamptzUsec (module)

Implements the PostgresSQL [timestamptz](https://www.postgresql.org/docs/current/datatype-datetime.html) (aka `timestamp with time zone`) type with nanosecond precision.

```elixir
attribute :timestamp, AshPostgres.TimestamptzUsec
timestamps type: AshPostgres.TimestamptzUsec
```

Alternatively, you can set up a shortname:

```elixir
# config.exs
config :ash, :custom_types, timestamptz_usec: AshPostgres.TimestamptzUsec
```

After saving, you will need to run `mix compile ash --force`.

```elixir
attribute :timestamp, :timestamptz_usec
timestamps type: :timestamptz_usec
```

    

Please see `AshPostgres.Timestamptz` for details about the usecase for this type.

### AshPostgres.TimestamptzUsec.handle_change?/0 (function)



### AshPostgres.TimestamptzUsec.prepare_change?/0 (function)



### AshPostgres.Tsquery (module)

A thin wrapper around `:string` for working with tsquery types in calculations.

A calculation of this type cannot be selected, but may be used in calculations.

### AshPostgres.Tsquery.handle_change?/0 (function)



### AshPostgres.Tsquery.prepare_change?/0 (function)



### AshPostgres.Tsvector (module)

A type for representing postgres' tsvectors.

Values will be a list of `Postgrex.Lexeme`

### AshPostgres.Tsvector.handle_change?/0 (function)



### AshPostgres.Tsvector.prepare_change?/0 (function)



### AshPostgres.Type (behaviour)

Postgres specific callbacks for `Ash.Type`.

Use this in addition to `Ash.Type`.

### AshPostgres.Type.postgres_reference_expr/3 (callback)



### AshPostgres.Type.value_to_postgres_default/3 (callback)



### AshPostgres.Extensions.Vector (module)

An extension that adds support for the `vector` type.

Create a file with these contents, not inside of a module:

```elixir
Postgrex.Types.define( .PostgrexTypes, [AshPostgres.Extensions.Vector] ++ Ecto.Adapters.Postgres.extensions(), [])
```

And then ensure that you refer to these types in your repo configuration, i.e

```elixir
config :my_app, YourApp.Repo,
  types:  .PostgrexTypes
```

### AshPostgres.Extensions.Vector.decode/1 (function)



### AshPostgres.Extensions.Vector.encode/1 (function)



### AshPostgres.Extensions.Vector.format/1 (function)



### AshPostgres.Extensions.Vector.init/1 (function)



### AshPostgres.Extensions.Vector.matching/1 (function)



### AshPostgres.CustomAggregate (behaviour)

A custom aggregate implementation for ecto.

### AshPostgres.CustomAggregate.dynamic/2 (callback)

The dynamic expression to create the aggregate.

The binding refers to the resource being aggregated,
use `as(^binding)` to reference it.

For example:

    Ecto.Query.dynamic(
      [],
      fragment("string_agg(?, ?)", field(as(^binding), ^opts[:field]), ^opts[:delimiter])
    )

### AshPostgres.Migration (module)

Utilities for use in migrations

### AshPostgres.Migration.create_enum/2 (function)

A utility for creating postgres enums for an Ash enum type.

In your migration, you can say:

```elixir
def up() do
  AshPostgres.Migration.create_enum(MyEnumType)
end
```

Attribution:

This code and example was copied from ecto_enum. I didn't use the library itself
because it has a lot that would not currently be relevant for Ash.
https://github.com/gjaldon/ecto_enum

Must be done manually, as the migration generator will not do it.
Additionally, altering the type must be done in its own, separate migration, which
must have `@disable_ddl_transaction true`, as you cannot do this operation
in a transaction.

For example:

```elixir
defmodule MyApp.Repo.Migrations.AddToGenderEnum do
  use Ecto.Migration
  @disable_ddl_transaction true

  def up do
    Ecto.Migration.execute "ALTER TYPE gender ADD VALUE IF NOT EXISTS 'other'"
  end

  def down do
    ...
  end
end
```

Keep in mind, that if you want to create a custom enum type, you will want to add
```elixir
def storage_type(_), do: :my_type_name
```

### AshPostgres.Migration.drop_enum/1 (function)



### EctoMigrationDefault (protocol)

Allows configuring how values are translated to default values in migrations.

Still a work in progress, but covers most standard values aside from maps.

### EctoMigrationDefault.t/0 (type)

All the types that implement this protocol.

### EctoMigrationDefault.to_default/1 (function)

Returns the text (elixir code) that will be placed into a migration as the default value

### AshPostgres.Functions.ILike (module)

Maps to the builtin postgres function `ilike`.

### AshPostgres.Functions.ILike.args/0 (function)



### AshPostgres.Functions.Like (module)

Maps to the builtin postgres function `like`.

### AshPostgres.Functions.Like.args/0 (function)



### AshPostgres.Functions.TrigramSimilarity (module)

Maps to the builtin postgres trigram similarity function. Requires `pgtrgm` extension to be installed.

See the postgres docs on [trigram](https://www.postgresql.org/docs/9.6/pgtrgm.html) for more information.

Requires the pg_trgm extension. Configure which extensions you have installed in your `AshPostgres.Repo`

    # Example

    filter(query, trigram_similarity(name, "geoff") > 0.4)

### AshPostgres.Functions.TrigramSimilarity.args/0 (function)



### AshPostgres.Functions.VectorCosineDistance (module)

Maps to the vector cosine distance operator. Requires `vector` extension to be installed.

### AshPostgres.Functions.VectorCosineDistance.args/0 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_postgres)# ash_sql

> Shared utilities for ecto-based sql data layers.

## Docs



## Links

- [Online documentation](https://hexdocs.pm/ash_sql)# ash_sqlite

> The SQLite data layer for Ash Framework.

## Docs

### AshSqlite (module)

The AshSqlite extension gives you tools to map a resource to a sqlite database table.

For more, check out the [getting started guide](/documentation/tutorials/getting-started-with-ash-sqlite.md)

### AshSqlite.DataLayer (module)

A sqlite data layer that leverages Ecto's sqlite capabilities.

### AshSqlite.DataLayer.add_known_binding/3 (function)



### AshSqlite.DataLayer.codegen/1 (function)



### AshSqlite.DataLayer.from_ecto/1 (function)



### AshSqlite.DataLayer.install/4 (function)



### AshSqlite.DataLayer.install/5 (function)



### AshSqlite.DataLayer.migrate/1 (function)



### AshSqlite.DataLayer.rollback/1 (function)



### AshSqlite.DataLayer.setup/1 (function)



### AshSqlite.DataLayer.sqlite/1 (macro)



### AshSqlite.DataLayer.tear_down/1 (function)



### AshSqlite.DataLayer.to_ecto/1 (function)



### AshSqlite.Repo (behaviour)

Resources that use `AshSqlite.DataLayer` use a `Repo` to access the database.

This repo is a thin wrapper around an `Ecto.Repo`.

You can use `Ecto.Repo`'s `init/2` to configure your repo like normal, but
instead of returning `{:ok, config}`, use `super(config)` to pass the
configuration to the `AshSqlite.Repo` implementation.

### Additional Repo Configuration - AshSqlite.Repo (behaviour)

Because an `AshPostgres.Repo` is also an `Ecto.Repo`, it has all of the same callbacks.

In the `c:Ecto.Repo.init/2` callback, you can configure the following additional items:

- `:tenant_migrations_path` - The path where your tenant migrations are stored (only relevant for a multitenant implementation)
- `:snapshots_path` - The path where the resource snapshots for the migration generator are stored.

### AshSqlite.Repo.installed_extensions/0 (callback)

Use this to inform the data layer about what extensions are installed

### AshSqlite.Repo.migrations_path/0 (callback)

The path where your migrations are stored

### AshSqlite.Repo.min_pg_version/0 (callback)

Use this to inform the data layer about the oldest potential sqlite version it will be run on.

Must be an integer greater than or equal to 13.

### AshSqlite.Repo.override_migration_type/1 (callback)

Allows overriding a given migration type for *all* fields, for example if you wanted to always use :timestamptz for :utc_datetime fields

### AshSqlite.ManualRelationship (behaviour)

A behavior for sqlite-specific manual relationship functionality

### AshSqlite.ManualRelationship.ash_sqlite_join/6 (callback)



### AshSqlite.ManualRelationship.ash_sqlite_subquery/4 (callback)



### AshSqlite.CustomExtension (behaviour)

A custom extension implementation.

### AshSqlite.CustomExtension.install/1 (callback)



### AshSqlite.CustomExtension.uninstall/1 (callback)



### AshSqlite.CustomIndex (module)

Represents a custom index on the table backing a resource

### AshSqlite.CustomIndex.fields/0 (function)



### AshSqlite.CustomIndex.name/2 (function)



### AshSqlite.CustomIndex.schema/0 (function)



### AshSqlite.CustomIndex.transform/1 (function)



### AshSqlite.DataLayer.Info (module)

Introspection functions for

### AshSqlite.DataLayer.Info.base_filter_sql/1 (function)

A stringified version of the base_filter, to be used in a where clause when generating unique indexes

### AshSqlite.DataLayer.Info.custom_indexes/1 (function)

The configured custom_indexes for a resource

### AshSqlite.DataLayer.Info.custom_statements/1 (function)

The configured custom_statements for a resource

### AshSqlite.DataLayer.Info.exclusion_constraint_names/1 (function)

The configured exclusion_constraint_names

### AshSqlite.DataLayer.Info.foreign_key_names/1 (function)

The configured foreign_key_names

### AshSqlite.DataLayer.Info.global_upsert_keys/1 (function)

A list of keys to always include in upserts.

### AshSqlite.DataLayer.Info.identity_index_names/1 (function)

The configured identity_index_names

### AshSqlite.DataLayer.Info.migrate?/1 (function)

Whether or not the resource should be included when generating migrations

### AshSqlite.DataLayer.Info.migration_defaults/1 (function)

A keyword list of customized migration defaults

### AshSqlite.DataLayer.Info.migration_ignore_attributes/1 (function)

A list of attributes to be ignored when generating migrations

### AshSqlite.DataLayer.Info.migration_types/1 (function)

A keyword list of customized migration types

### AshSqlite.DataLayer.Info.polymorphic?/1 (function)

The configured polymorphic? for a resource

### AshSqlite.DataLayer.Info.polymorphic_name/1 (function)

The configured polymorphic_reference_name for a resource

### AshSqlite.DataLayer.Info.polymorphic_on_delete/1 (function)

The configured polymorphic_reference_on_delete for a resource

### AshSqlite.DataLayer.Info.polymorphic_on_update/1 (function)

The configured polymorphic_reference_on_update for a resource

### AshSqlite.DataLayer.Info.reference/2 (function)

The configured reference for a given relationship of a  resource

### AshSqlite.DataLayer.Info.references/1 (function)

The configured references for a resource

### AshSqlite.DataLayer.Info.repo/1 (function)

The configured repo for a resource

### AshSqlite.DataLayer.Info.skip_identities/1 (function)

Identities not to include in the migrations

### AshSqlite.DataLayer.Info.skip_unique_indexes/1 (function)

Skip generating unique indexes when generating migrations

### AshSqlite.DataLayer.Info.table/1 (function)

The configured table for a resource

### AshSqlite.DataLayer.Info.unique_index_names/1 (function)

The configured unique_index_names

### AshSqlite.Reference (module)

Represents the configuration of a reference (i.e foreign key).

### AshSqlite.Reference.schema/0 (function)



### AshSqlite.Statement (module)

Represents a custom statement to be run in generated migrations

### AshSqlite.Statement.fields/0 (function)



### AshSqlite.Statement.schema/0 (function)



### AshSqlite.Type (behaviour)

Sqlite specific callbacks for `Ash.Type`.

Use this in addition to `Ash.Type`.

### AshSqlite.Type.value_to_sqlite_default/3 (callback)



### AshSqlite.Functions.Like (module)

Maps to the builtin sqlite function `like`.

### AshSqlite.Functions.Like.args/0 (function)



### AshSqlite.Functions.ILike (module)

Maps to the builtin sqlite function `ilike`.

### AshSqlite.Functions.ILike.args/0 (function)



### Mix.Tasks.AshSqlite.GenerateMigrations.run/1 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_sqlite)# ash_csv

> The CSV data layer for Ash Framework

## Docs

### AshCsv (module)

A CSV datalayer for the Ash framework

For DSL documentation, see `AshCsv.DataLayer`

### AshCsv.DataLayer (module)

The data layer implementation for AshCsv

### AshCsv.DataLayer.columns/1 (function)



### AshCsv.DataLayer.create?/1 (function)



### AshCsv.DataLayer.file/1 (function)



### AshCsv.DataLayer.filter_matches/3 (function)



### AshCsv.DataLayer.header?/1 (function)



### AshCsv.DataLayer.separator/1 (function)



### AshCsv.DataLayer.Info (module)

Introspection helpers for AshCsv.DataLayer

### AshCsv.DataLayer.Info.columns/1 (function)



### AshCsv.DataLayer.Info.create?/1 (function)



### AshCsv.DataLayer.Info.file/1 (function)



### AshCsv.DataLayer.Info.header?/1 (function)



### AshCsv.DataLayer.Info.separator/1 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_csv)# ash_admin

> A super-admin UI for Ash Framework, built with Phoenix LiveView.

## Docs

### AshAdmin.Components.Resource.RelationshipField (module)

This module defines a LiveComponent for rendering a relationship field in an AshAdmin resource form.
It handles the logic for displaying a select dropdown or a typeahead input field, fetching and
displaying suggestions, and updating the selected value.

### AshAdmin.Components.Resource.RelationshipField.form_control_label/1 (function)



### AshAdmin.Components.Resource.RelationshipField.handle_event/3 (function)



### AshAdmin.Components.Resource.RelationshipField.mount/1 (function)



### AshAdmin.Components.Resource.RelationshipField.render/1 (function)



### AshAdmin.Components.Resource.RelationshipField.update/2 (function)



### AshAdmin.CoreComponents (module)

Provides core UI components.

At the first glance, this module may seem daunting, but its goal is
to provide some core building blocks in your application, such as modals,
tables, and forms. The components are mostly markup and well documented
with doc strings and declarative assigns. You may customize and style
them in any way you want, based on your application growth and needs.

The default components use Tailwind CSS, a utility-first CSS framework.
See the [Tailwind CSS documentation](https://tailwindcss.com) to learn
how to customize them or feel free to swap in another framework altogether.

Icons are provided by [heroicons](https://heroicons.com). See `icon/1` for usage.

### AshAdmin.CoreComponents.back/1 (function)

Renders a back navigation link.

### Examples - AshAdmin.CoreComponents.back/1 (function)

<.back navigate={~p"/posts"}>Back to posts</.back>

### Attributes - AshAdmin.CoreComponents.back/1 (function)

* `navigate` (`:any`) (required)

### Slots - AshAdmin.CoreComponents.back/1 (function)

* `inner_block` (required)

### AshAdmin.CoreComponents.button/1 (function)

Renders a button.

### Examples - AshAdmin.CoreComponents.button/1 (function)

<.button>Send!</.button>
    <.button phx-click="go" class="ml-2">Send!</.button>

### Attributes - AshAdmin.CoreComponents.button/1 (function)

* `type` (`:string`) - Defaults to `nil`.
* `class` (`:string`) - Defaults to `nil`.
* Global attributes are accepted. Supports all globals plus: `["disabled", "form", "name", "value"]`.

### Slots - AshAdmin.CoreComponents.button/1 (function)

* `inner_block` (required)

### AshAdmin.CoreComponents.error/1 (function)

Generates a generic error message.

### Slots - AshAdmin.CoreComponents.error/1 (function)

* `inner_block` (required)

### AshAdmin.CoreComponents.flash/1 (function)

Renders flash notices.

### Examples - AshAdmin.CoreComponents.flash/1 (function)

<.flash kind={:info} flash={@flash} />
    <.flash kind={:info} phx-mounted={show("#flash")}>Welcome Back!</.flash>

### Attributes - AshAdmin.CoreComponents.flash/1 (function)

* `id` (`:string`) - the optional id of flash container. Defaults to `"flash"`.
* `flash` (`:map`) - the map of flash messages to display. Defaults to `%{}`.
* `title` (`:string`) - Defaults to `nil`.
* `kind` (`:atom`) - used for styling and flash lookup.Must be one of `:info`, or `:error`.
* Global attributes are accepted. the arbitrary HTML attributes to add to the flash container.

### Slots - AshAdmin.CoreComponents.flash/1 (function)

* `inner_block` - the optional inner block that renders the flash message.

### AshAdmin.CoreComponents.flash_group/1 (function)

Shows the flash group with standard titles and content.

### Examples - AshAdmin.CoreComponents.flash_group/1 (function)

<.flash_group flash={@flash} />

### Attributes - AshAdmin.CoreComponents.flash_group/1 (function)

* `flash` (`:map`) (required) - the map of flash messages.

### AshAdmin.CoreComponents.header/1 (function)

Renders a header with title.

### Attributes - AshAdmin.CoreComponents.header/1 (function)

* `class` (`:string`) - Defaults to `nil`.

### Slots - AshAdmin.CoreComponents.header/1 (function)

* `inner_block` (required)
* `subtitle`
* `actions`

### AshAdmin.CoreComponents.hide/2 (function)



### AshAdmin.CoreComponents.hide_modal/2 (function)



### AshAdmin.CoreComponents.icon/1 (function)

Renders a [Heroicon](https://heroicons.com).

Heroicons come in three styles – outline, solid, and mini.
By default, the outline style is used, but solid and mini may
be applied by using the `-solid` and `-mini` suffix.

You can customize the size and colors of the icons by setting
width, height, and background color classes.

Icons are extracted from your `assets/vendor/heroicons` directory and bundled
within your compiled app.css by the plugin in your `assets/tailwind.config.js`.

### Examples - AshAdmin.CoreComponents.icon/1 (function)

<.icon name="hero-x-mark-solid" />
    <.icon name="hero-arrow-path" class="ml-1 w-3 h-3 animate-spin" />

### Attributes - AshAdmin.CoreComponents.icon/1 (function)

* `name` (`:string`) (required)
* `class` (`:string`) - Defaults to `nil`.

### AshAdmin.CoreComponents.input/1 (function)

Renders an input with label and error messages.

A `Phoenix.HTML.FormField` may be passed as argument,
which is used to retrieve the input name, id, and values.
Otherwise all attributes may be passed explicitly.

### Types - AshAdmin.CoreComponents.input/1 (function)

This function accepts all HTML input types, considering that:

  * You may also set `type="select"` to render a ` ` tag

  * `type="checkbox"` is used exclusively to render boolean values

  * For live file uploads, see `Phoenix.Component.live_file_input/1`

See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input
for more information.

### Examples - AshAdmin.CoreComponents.input/1 (function)

<.input field={@form[:email]} type="email" />
    <.input name="my-input" errors={["oh no!"]} />

### Attributes - AshAdmin.CoreComponents.input/1 (function)

* `id` (`:any`) - Defaults to `nil`.
* `name` (`:any`)
* `label` (`:string`) - Defaults to `nil`.
* `value` (`:any`)
* `type` (`:string`) - Defaults to `"text"`.
* `field` (`Phoenix.HTML.FormField`) - a form field struct retrieved from the form, for example: @form[:email].
* `errors` (`:list`) - Defaults to `[]`.
* `checked` (`:boolean`) - the checked flag for checkbox inputs.
* `prompt` (`:string`) - the prompt for select inputs. Defaults to `nil`.
* `options` (`:list`) - the options to pass to Phoenix.HTML.Form.options_for_select/2.
* `multiple` (`:boolean`) - the multiple flag for select inputs. Defaults to `false`.
* Global attributes are accepted. Supports all globals plus: `["accept", "autocomplete", "capture", "cols", "disabled", "form", "list", "max", "maxlength", "min", "minlength", "multiple", "pattern", "placeholder", "readonly", "required", "rows", "size", "step"]`.

### Slots - AshAdmin.CoreComponents.input/1 (function)

* `inner_block`

### AshAdmin.CoreComponents.label/1 (function)

Renders a label.

### Attributes - AshAdmin.CoreComponents.label/1 (function)

* `for` (`:string`) - Defaults to `nil`.

### Slots - AshAdmin.CoreComponents.label/1 (function)

* `inner_block` (required)

### AshAdmin.CoreComponents.list/1 (function)

Renders a data list.

### Examples - AshAdmin.CoreComponents.list/1 (function)

<.list>
      <:item title="Title"><%= @post.title %></:item>
      <:item title="Views"><%= @post.views %></:item>
    </.list>

### Slots - AshAdmin.CoreComponents.list/1 (function)

* `item` (required) - Accepts attributes:

  * `title` (`:string`) (required)

### AshAdmin.CoreComponents.modal/1 (function)

Renders a modal.

### Examples - AshAdmin.CoreComponents.modal/1 (function)

<.modal id="confirm-modal">
      This is a modal.
    </.modal>

JS commands may be passed to the `:on_cancel` to configure
the closing/cancel event, for example:

    <.modal id="confirm" on_cancel={JS.navigate(~p"/posts")}>
      This is another modal.
    </.modal>

### Attributes - AshAdmin.CoreComponents.modal/1 (function)

* `id` (`:string`) (required)
* `show` (`:boolean`) - Defaults to `false`.
* `on_cancel` (`Phoenix.LiveView.JS`) - Defaults to `%Phoenix.LiveView.JS{ops: []}`.

### Slots - AshAdmin.CoreComponents.modal/1 (function)

* `inner_block` (required)

### AshAdmin.CoreComponents.show/2 (function)



### AshAdmin.CoreComponents.show_modal/2 (function)



### AshAdmin.CoreComponents.simple_form/1 (function)

Renders a simple form.

### Examples - AshAdmin.CoreComponents.simple_form/1 (function)

<.simple_form for={@form} phx-change="validate" phx-submit="save">
      <.input field={@form[:email]} label="Email"/>
      <.input field={@form[:username]} label="Username" />
      <:actions>
        <.button>Save</.button>
      </:actions>
    </.simple_form>

### Attributes - AshAdmin.CoreComponents.simple_form/1 (function)

* `for` (`:any`) (required) - the datastructure for the form.
* `as` (`:any`) - the server side parameter to collect all input under. Defaults to `nil`.
* Global attributes are accepted. the arbitrary HTML attributes to apply to the form tag. Supports all globals plus: `["autocomplete", "name", "rel", "action", "enctype", "method", "novalidate", "target", "multipart"]`.

### Slots - AshAdmin.CoreComponents.simple_form/1 (function)

* `inner_block` (required)
* `actions` - the slot for form actions, such as a submit button.

### AshAdmin.CoreComponents.table/1 (function)

Renders a table with generic styling.

### Examples - AshAdmin.CoreComponents.table/1 (function)

<.table id="users" rows={@users}>
      <:col :let={user} label="id"><%= user.id %></:col>
      <:col :let={user} label="username"><%= user.username %></:col>
    </.table>

### Attributes - AshAdmin.CoreComponents.table/1 (function)

* `id` (`:string`) (required)
* `rows` (`:list`) (required)
* `row_id` (`:any`) - the function for generating the row id. Defaults to `nil`.
* `row_click` (`:any`) - the function for handling phx-click on each row. Defaults to `nil`.
* `row_item` (`:any`) - the function for mapping each row before calling the :col and :action slots. Defaults to `&Function.identity/1`.

### Slots - AshAdmin.CoreComponents.table/1 (function)

* `col` (required) - Accepts attributes:

  * `label` (`:string`)
* `action` - the slot for showing user actions in the last table column.

### AshAdmin.CoreComponents.translate_error/1 (function)

Translates an error message using gettext.

### AshAdmin.CoreComponents.translate_errors/2 (function)

Translates the errors for a field from a keyword list of errors.

### AshAdmin.Domain (module)

A domain extension to alter the behavior of a domain in the admin UI.

### AshAdmin.Domain.admin/1 (macro)



### AshAdmin.Domain.default_resource_page/1 (function)



### AshAdmin.Domain.name/1 (function)



### AshAdmin.Domain.resource_group_labels/1 (function)



### AshAdmin.Domain.show?/1 (function)



### AshAdmin.Domain.show_resources/1 (function)



### AshAdmin.Gettext (module)

A module providing Internationalization with a gettext-based API.

By using [Gettext](https://hexdocs.pm/gettext),
your module gains a set of macros for translations, for example:

    use Gettext, backend: AshAdmin.Gettext

    # Simple translation
    gettext("Here is the string to translate")

    # Plural translation
    ngettext("Here is the string to translate",
             "Here are the strings to translate",
             3)

    # Domain-based translation
    dgettext("errors", "Here is the error message to translate")

See the [Gettext Docs](https://hexdocs.pm/gettext) for detailed usage.

### AshAdmin.Gettext.handle_missing_bindings/2 (function)



### AshAdmin.Gettext.handle_missing_plural_translation/7 (function)



### AshAdmin.Gettext.handle_missing_translation/5 (function)



### AshAdmin.Resource (module)

A resource extension to alter the behaviour of a resource in the admin UI.

### AshAdmin.Resource.actor?/1 (function)



### AshAdmin.Resource.admin/1 (macro)



### AshAdmin.Resource.create_actions/1 (function)



### AshAdmin.Resource.destroy_actions/1 (function)



### AshAdmin.Resource.field/2 (function)



### AshAdmin.Resource.fields/1 (function)



### AshAdmin.Resource.format_fields/1 (function)



### AshAdmin.Resource.generic_actions/1 (function)



### AshAdmin.Resource.label_field/1 (function)



### AshAdmin.Resource.name/1 (function)



### AshAdmin.Resource.polymorphic?/2 (function)



### AshAdmin.Resource.polymorphic_actions/1 (function)



### AshAdmin.Resource.polymorphic_tables/2 (function)



### AshAdmin.Resource.read_actions/1 (function)



### AshAdmin.Resource.relationship_display_fields/1 (function)



### AshAdmin.Resource.relationship_select_max_items/1 (function)



### AshAdmin.Resource.resource_group/1 (function)



### AshAdmin.Resource.show_action/1 (function)



### AshAdmin.Resource.show_calculations/1 (function)



### AshAdmin.Resource.show_sensitive_fields/1 (function)



### AshAdmin.Resource.table_columns/1 (function)



### AshAdmin.Resource.update_actions/1 (function)



### AshAdmin.Resource.Field (module)

The representation of a configured field in the admin UI.

### AshAdmin.Resource.Field.schema/0 (function)



### AshAdmin.Resource.Transformers.AddPositionSortCalculation (module)

Adds a `ash_admin_position_sort` calculation to resources that have defined admin.label_field.
This calculation is used to sort typeahead search suggestions in a related resource field.

### AshAdmin.Resource.Transformers.AddPositionSortCalculation.after?/1 (function)



### AshAdmin.Resource.Transformers.AddPositionSortCalculation.after_compile?/0 (function)



### AshAdmin.Resource.Transformers.AddPositionSortCalculation.before?/1 (function)



### AshAdmin.Resource.Transformers.AddPositionSortCalculation.describe/1 (function)



### AshAdmin.Resource.Transformers.AddPositionSortCalculation.has_calculate?/0 (function)



### AshAdmin.Resource.Transformers.AddPositionSortCalculation.has_expression?/0 (function)



### AshAdmin.Resource.Transformers.AddPositionSortCalculation.init/1 (function)



### AshAdmin.Resource.Transformers.AddPositionSortCalculation.load/3 (function)



### AshAdmin.Resource.Transformers.AddPositionSortCalculation.strict_loads?/0 (function)



### AshAdmin.Resource.Transformers.ValidateTableColumns (module)

Validates that table columns are all either attributes, or `:one` cardinality relationships.

### AshAdmin.Resource.Transformers.ValidateTableColumns.after?/1 (function)



### AshAdmin.Resource.Transformers.ValidateTableColumns.after_compile?/0 (function)



### AshAdmin.Resource.Transformers.ValidateTableColumns.before?/1 (function)



### AshAdmin.Resource.Transformers.ValidateTableColumns.transform/1 (function)



### AshAdmin.Router (module)

Provides LiveView routing for AshAdmin.

### AshAdmin.Router.admin_browser_pipeline/1 (macro)

Can be used to create a `:browser` pipeline easily if you don't have one.

By default it is called `:browser`, but you can rename it by supplying an argument,
for example:

```elixir
defmodule MyAppWeb.Router do
  use Phoenix.Router

  import AshAdmin.Router
  admin_browser_pipeline :something

  scope "/" do

    pipe_through [:something]
    ash_admin "/admin"
  end
end
```

### AshAdmin.Router.ash_admin/2 (macro)

Defines an AshAdmin route.
It expects the `path` the admin dashboard will be mounted at
and a set of options.

### Options - AshAdmin.Router.ash_admin/2 (macro)

* `:live_socket_path` - Optional override for the socket path. it must match
    the `socket "/live", Phoenix.LiveView.Socket` in your endpoint. Defaults to `/live`.

  * `:on_mount` - Optional list of hooks to attach to the mount lifecycle.

  * `:session` - Optional extra session map or MFA tuple to be merged with the session.

  * `:csp_nonce_assign_key` - Optional assign key to find the CSP nonce value used for assets
    Supports either `atom()` or
      `%{optional(:img) => atom(), optional(:script) => atom(), optional(:style) => atom()}`   
      Defaults to `ash_admin-Ed55GFnX` for backwards compatibility.
  
  * `:live_session_name` - Optional atom to name the `live_session`. Defaults to `:ash_admin`.

### Examples - AshAdmin.Router.ash_admin/2 (macro)

defmodule MyAppWeb.Router do
      use Phoenix.Router

      scope "/" do
        import AshAdmin.Router

        # Make sure you are piping through the browser pipeline
        # If you don't have one, see `admin_browser_pipeline/1`
        pipe_through [:browser]

        ash_admin "/admin"
        ash_admin "/csp/admin", live_session_name: :ash_admin_csp, csp_nonce_assign_key: :csp_nonce_value
      end
    end

### AshAdmin.Errors.NotFound.message/1 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_admin)# ash_appsignal

> The AppSignal APM integration for Ash Framework

## Docs

### AshAppsignal (module)

Documentation for `AshAppsignal`.

## Links

- [Online documentation](https://hexdocs.pm/ash_appsignal)# opentelemetry_ash

> The Opentelemetry integration for Ash Framework

## Docs

### OpentelemetryAsh (module)

Documentation for `OpentelemetryAsh`.

## Links

- [Online documentation](https://hexdocs.pm/opentelemetry_ash)# ash_archival

> An Ash extension to implement archival (soft deletion) for resources.

## Docs

### AshArchival.ArchiveRelatedArguments (behaviour)

The behaviour for specifiying arguments for related resources

### AshArchival.ArchiveRelatedArguments.arguments/3 (callback)



### AshArchival (module)

An Archival extension for `Ash.Resource`

### AshArchival.Resource (module)

Configures a resource to be archived instead of destroyed for all destroy actions.

For more information, see [the getting started guide](/documentation/tutorials/get-started-with-ash-archival.md)

### AshArchival.Resource.archive/1 (macro)



### AshArchival.Resource.Info (module)

Introspection helpers for `AshArchival.Resource`

### AshArchival.Resource.Info.archive_archive_related/1 (function)

A list of relationships that should have all related items archived when this is archived. Notifications are not sent for this operation.

### AshArchival.Resource.Info.archive_archive_related!/1 (function)

A list of relationships that should have all related items archived when this is archived. Notifications are not sent for this operation.

### AshArchival.Resource.Info.archive_archive_related_arguments/1 (function)

A function to allow passing along some of the arguments to related resources when archiving them.

### AshArchival.Resource.Info.archive_archive_related_arguments!/1 (function)

A function to allow passing along some of the arguments to related resources when archiving them.

### AshArchival.Resource.Info.archive_attribute/1 (function)

The attribute in which to store the archival flag (the current datetime).

### AshArchival.Resource.Info.archive_attribute!/1 (function)

The attribute in which to store the archival flag (the current datetime).

### AshArchival.Resource.Info.archive_attribute_type/1 (function)

The attribute type.

### AshArchival.Resource.Info.archive_attribute_type!/1 (function)

The attribute type.

### AshArchival.Resource.Info.archive_base_filter?/1 (function)

Whether or not a base filter exists that applies the `is_nil(archived_at)` rule.

### AshArchival.Resource.Info.archive_exclude_destroy_actions/1 (function)

A destroy action or actions that should *not* archive, but instead be left alone. This allows for having a destroy *or* archive pattern.

### AshArchival.Resource.Info.archive_exclude_destroy_actions!/1 (function)

A destroy action or actions that should *not* archive, but instead be left alone. This allows for having a destroy *or* archive pattern.

### AshArchival.Resource.Info.archive_exclude_read_actions/1 (function)

A read action or actions that should show archived items. They will not get the automatic `is_nil(archived_at)` filter.

### AshArchival.Resource.Info.archive_exclude_read_actions!/1 (function)

A read action or actions that should show archived items. They will not get the automatic `is_nil(archived_at)` filter.

### AshArchival.Resource.Info.archive_exclude_upsert_actions/1 (function)

This option is deprecated as it no longer has any effect. Upserts are handled according to the upsert identity. See the upserts guide for more.

### AshArchival.Resource.Info.archive_exclude_upsert_actions!/1 (function)

This option is deprecated as it no longer has any effect. Upserts are handled according to the upsert identity. See the upserts guide for more.

### AshArchival.Resource.Info.archive_options/1 (function)

archive DSL options

Returns a map containing the and any configured or default values.

## Links

- [Online documentation](https://hexdocs.pm/ash_archival)# ash_cloak

> An Ash extension to seamlessly encrypt and decrypt resource attributes.

## Docs

### AshCloak (module)

An extension for encrypting attributes of a resource.

See the getting started guide for more information.

### AshCloak.cloak/1 (macro)



### AshCloak.encrypt_and_set/3 (function)

Encrypts and writes to an encrypted attribute.

If the changeset is pending (i.e not currently running the action), then it is added as a before_action hook.
Otherwise, it is run immediately

Raises AshCloak.Errors.NoSuchEncryptedAttribute if the attribute is not configured for encryption.

### AshCloak.Changes.Encrypt (module)

Takes an argument, and encrypts it into an attribute called `encrypted_{attribute}`

### AshCloak.Changes.Encrypt.atomic/3 (function)



### AshCloak.Changes.Encrypt.change/3 (function)



### AshCloak.Info (module)

Introspection functions for the `AshCloak` extension.

### AshCloak.Info.cloak_attributes/1 (function)

The attribute or attributes to encrypt. The attribute will be renamed to `encrypted_{attribute}`, and a calculation with the same name will be added.

### AshCloak.Info.cloak_attributes!/1 (function)

The attribute or attributes to encrypt. The attribute will be renamed to `encrypted_{attribute}`, and a calculation with the same name will be added.

### AshCloak.Info.cloak_decrypt_by_default/1 (function)

A list of attributes that should be decrypted (their calculation should be loaded) by default.

### AshCloak.Info.cloak_decrypt_by_default!/1 (function)

A list of attributes that should be decrypted (their calculation should be loaded) by default.

### AshCloak.Info.cloak_on_decrypt/1 (function)

A function to call when decrypting any value. Takes the resource, field, records, and calculation context. Must return `:ok` or `{:error, error}`

### AshCloak.Info.cloak_on_decrypt!/1 (function)

A function to call when decrypting any value. Takes the resource, field, records, and calculation context. Must return `:ok` or `{:error, error}`

### AshCloak.Info.cloak_options/1 (function)

cloak DSL options

Returns a map containing the and any configured or default values.

### AshCloak.Info.cloak_vault/1 (function)

The vault to use to encrypt & decrypt the value

### AshCloak.Info.cloak_vault!/1 (function)

The vault to use to encrypt & decrypt the value

### AshCloak.Errors.NoSuchEncryptedAttribute.exception/1 (function)

Create an `Elixir.AshCloak.Errors.NoSuchEncryptedAttribute` without raising it.

### Keys - AshCloak.Errors.NoSuchEncryptedAttribute.exception/1 (function)

- :key
- :resource

## Links

- [Online documentation](https://hexdocs.pm/ash_cloak)# ash_money

> The extension for working with money types in Ash.

## Docs

### AshMoney (module)

`AshMoney` provides a type for working with money in your Ash resources.

It also provides an `AshPostgres.Extension` that can be used to add support for
money types and operators to your Postgres database.

### AshMoney.Types.Money (module)

A money type for Ash that uses the `ex_money` library.

When constructing a composite type, use a tuple in the following structure:

`composite_type(%{currency: "USD", amount: Decimal.new("0")}}, AshMoney.Types.Money)`

If you've added a custom type, like `:money`:

```elixir
composite_type(%{currency: "USD", amount: Decimal.new("0")}}, :money)
```

### AshMoney.Types.Money.handle_change?/0 (function)



### AshMoney.Types.Money.prepare_change?/0 (function)



### AshMoney.AshPostgresExtension (module)

Installs the `money_with_currency` type and operators/functions for Postgres.

### AshMoney.AshPostgresExtension.extension/0 (function)



### AshMoney.AshPostgresExtension.install/1 (function)



### AshMoney.AshPostgresExtension.uninstall/1 (function)



### Comparable.Type.Decimal.To.Money (module)



### Comparable.Type.Float.To.Money (module)



### Comparable.Type.Integer.To.Money (module)



### Comparable.Type.Money.To.Decimal (module)



### Comparable.Type.Money.To.Float (module)



### Comparable.Type.Money.To.Integer (module)



### Comparable.Type.Money.To.Money (module)



### Mix.Tasks.AshMoney.Install.igniter/2 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_money)# ash_oban

> The extension for integrating Ash resources with Oban.

## Docs

### AshOban.ActorPersister (behaviour)

A behaviour for storing and retrieving an actor from oban job arguments

### AshOban.ActorPersister.actor/0 (type)



### AshOban.ActorPersister.actor_json/0 (type)



### AshOban.ActorPersister.lookup/1 (callback)



### AshOban.ActorPersister.store/1 (callback)



### AshOban.Igniter (module)

Codemods and utilities for resources that use `AshOban`.

### AshOban.Igniter.add_new_trigger/4 (function)

Adds the given code block to the resource's `triggers` block if there is no existing trigger with the given name

### AshOban.Igniter.add_trigger/3 (function)

Adds the given code block to the resource's `triggers` block

### AshOban.Igniter.defines_trigger/3 (function)

Returns true if the given resource defines a trigger with the provided name

### AshOban.ListTenants (behaviour)

The behaviour for listing tenants.

### AshOban.ListTenants.list_tenants/1 (callback)



### AshOban.Verifiers.VerifyModuleNames (module)

Verifies that module names have been set for triggers and scheduled actions

### AshOban.Verifiers.VerifyModuleNames.verify/1 (function)



### AshOban (module)

Tools for working with AshOban triggers.

### Module Names - AshOban (module)

Each trigger and scheduled action must have a defined module
name, otherwise changing the name of the trigger will lead to
"dangling" jobs. Because Oban uses the module name to determine
which code should execute when a job runs, changing the module name
associated with a trigger will cause those jobs to fail and be lost
if their worker's module name was configured. By configuring the module
name explicitly, renaming the resource or the trigger will not cause
an issue.

This was an oversight in the initial design of AshOban triggers and
scheduled actions, and in the future the module names will be required
to ensure that this does not happen.

Use `mix ash_oban.set_default_module_names` to set the module names to
their appropriate default values.

### AshOban.authorize?/0 (function)



### AshOban.build_trigger/3 (function)

Builds a specific trigger for the record provided, but does not insert it into the database.

### Options - AshOban.build_trigger/3 (function)

- `:actor` - the actor to set on the job. Requires configuring an actor persister.
- `:tenant` - the tenant to set on the job.
- `:action_arguments` - additional arguments to merge into the action invocation's arguments map.
   affects the uniqueness checks for the job.
- `:args` - additional arguments to merge into the job's arguments map.
   the action will not use these arguments, it can only be used to affect the job uniqueness checks.
   you likely are looking for the `:action_arguments` job.

All other options are passed through to `c:Oban.Worker.new/2`

### AshOban.config/3 (function)

Alters your oban configuration to include the required AshOban configuration.

# Options

* `:require?` (`t:boolean/0`) - Whether to require queues and plugins to be defined in your oban config. This can be helpful to
  allow the ability to split queues between nodes. See https://hexdocs.pm/oban/splitting-queues.html The default value is `true`.

### AshOban.do_schedule_and_run_triggers/2 (function)



### AshOban.lookup_actor/2 (function)



### AshOban.oban/1 (macro)



### AshOban.result/0 (type)



### AshOban.run_trigger/3 (function)

Runs a specific trigger for the record provided.

### Options - AshOban.run_trigger/3 (function)

Options are passed through to `build_trigger/3` check its documentation
for the possible values

### AshOban.run_triggers/3 (function)

Runs a specific trigger for the records provided.

### Options - AshOban.run_triggers/3 (function)

Options are passed through to `build_trigger/3` check its documentation
for the possible values

### AshOban.schedule/3 (function)

Schedules all relevant jobs for the provided trigger or scheduled action

### Options - AshOban.schedule/3 (function)

`:actor` - the actor to set on the job. Requires configuring an actor persister.

### AshOban.schedule_and_run_triggers/2 (function)

Runs the schedulers for the given resource, domain, or otp_app, or list of resources, domains, or otp_apps.

Options:

- `drain_queues?` - Defaults to false, drains the queues after scheduling. This is primarily for testing
- `queue`, `with_limit`, `with_recursion`, `with_safety`, `with_scheduled` - passed through to `Oban.drain_queue/2`, if it is called
- `scheduled_actions?` - Defaults to false, unless a scheduled action name was explicitly provided. Schedules all applicable scheduled actions.
- `triggers?` - Defaults to true, schedules all applicable scheduled actions.
- `actor` - The actor to schedule and run the triggers with
- `oban` - The oban module to use. Defaults to `Oban`

If the input is:
* a list - each item is passed into `schedule_and_run_triggers/1`, and the results are merged together.
* an otp_app - each domain configured in the `ash_domains` of that otp_app is passed into `schedule_and_run_triggers/1`, and the results are merged together.
* a domain - each reosurce configured in that domain is passed into `schedule_and_run_triggers/1`, and the results are merged together.
* a tuple of {resource, :trigger_name} - that trigger is scheduled, and the results are merged together.
* a resource - each trigger configured in that resource is scheduled, and the results are merged together.

### AshOban.stacktrace/1 (function)



### AshOban.store_actor/3 (function)



### AshOban.triggerable/0 (type)



### AshOban.Changes.BuiltinChanges (module)

Builtin changes for `AshOban`

### AshOban.Changes.BuiltinChanges.run_oban_trigger/2 (function)



### AshOban.Changes.RunObanTrigger (module)

Runs an oban trigger by name.

### AshOban.Checks.AshObanInteraction (module)

This check is true if the context `private.ash_oban?` is set to true.

This context will only ever be set in code that is called internally by
`ash_oban`, allowing you to create a bypass in your policies on your
user/user_token resources.

```elixir
policies do
  bypass AshObanInteraction do
    authorize_if always()
  end
end
```

### AshOban.Checks.AshObanInteraction.eager_evaluate?/0 (function)



### AshOban.Checks.AshObanInteraction.prefer_expanded_description?/0 (function)



### AshOban.Checks.AshObanInteraction.requires_original_data?/2 (function)



### AshOban.Checks.AshObanInteraction.strict_check/3 (function)



### AshOban.Checks.AshObanInteraction.type/0 (function)



### AshOban.Info (module)

Introspection for AshOban

### AshOban.Info.oban_domain/1 (function)

The Domain to use when calling actions on this resource. Defaults to the resource's domain.

### AshOban.Info.oban_domain!/1 (function)

The Domain to use when calling actions on this resource. Defaults to the resource's domain.

### AshOban.Info.oban_list_tenants/1 (function)

A list of tenants or a function behaviour that returns a list of tenants a trigger should be run for. Can be overwritten on the trigger level.

### AshOban.Info.oban_list_tenants!/1 (function)

A list of tenants or a function behaviour that returns a list of tenants a trigger should be run for. Can be overwritten on the trigger level.

### AshOban.Info.oban_options/1 (function)

oban DSL options

Returns a map containing the and any configured or default values.

### AshOban.Info.oban_scheduled_action/2 (function)



### AshOban.Info.oban_scheduled_actions/1 (function)

oban.scheduled_actions DSL entities

### AshOban.Info.oban_trigger/2 (function)



### AshOban.Info.oban_triggers/1 (function)

oban.triggers DSL entities

### AshOban.Info.oban_triggers_and_scheduled_actions/1 (function)



### AshOban.Info.pro?/0 (function)



### AshOban.Schedule (module)

A configured scheduled action.

### AshOban.Schedule.t/0 (type)



### AshOban.Trigger (module)

A configured trigger.

### AshOban.Trigger.t/0 (type)



### AshOban.Trigger.transform/1 (function)



### AshOban.Test (module)

Helpers for testing ash_oban triggers

### AshOban.Test.schedule_and_run_triggers/2 (function)

Calls `AshOban.schedule_and_run_triggers/2` with `drain_queues?: true`.

### AshOban.Errors.TriggerNoLongerApplies.exception/1 (function)

Create an `Elixir.AshOban.Errors.TriggerNoLongerApplies` without raising it.

### Keys - AshOban.Errors.TriggerNoLongerApplies.exception/1 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_oban)# ash_state_machine

> The extension for building state machines with Ash resources.

## Docs

### AshStateMachine (module)

Provides tools for defining and working with resource-backed state machines.

### AshStateMachine.possible_next_states/1 (function)

A reusable helper which returns all possible next states for a record
(regardless of action).

### AshStateMachine.possible_next_states/2 (function)

A reusable helper which returns all possible next states for a record given a
specific action.

### AshStateMachine.state_machine/1 (macro)



### AshStateMachine.transition_state/2 (function)

A utility to transition the state of a changeset, honoring the rules of the resource.

### AshStateMachine.Info (module)

Introspection helpers for `AshStateMachine`

### AshStateMachine.Info.state_machine_all_states/1 (function)



### AshStateMachine.Info.state_machine_default_initial_state/1 (function)

The default initial state

### AshStateMachine.Info.state_machine_default_initial_state!/1 (function)

The default initial state

### AshStateMachine.Info.state_machine_deprecated_states/1 (function)

A list of states that have been deprecated but are still valid. These will still be in the possible list of states, but `:*` will not include them.

### AshStateMachine.Info.state_machine_deprecated_states!/1 (function)

A list of states that have been deprecated but are still valid. These will still be in the possible list of states, but `:*` will not include them.

### AshStateMachine.Info.state_machine_extra_states/1 (function)

A list of states that may be used by transitions to/from `:*`. See the docs on wildcards for more.

### AshStateMachine.Info.state_machine_extra_states!/1 (function)

A list of states that may be used by transitions to/from `:*`. See the docs on wildcards for more.

### AshStateMachine.Info.state_machine_initial_states/1 (function)

The allowed starting states of this state machine.

### AshStateMachine.Info.state_machine_initial_states!/1 (function)

The allowed starting states of this state machine.

### AshStateMachine.Info.state_machine_options/1 (function)

state_machine DSL options

Returns a map containing the and any configured or default values.

### AshStateMachine.Info.state_machine_state_attribute/1 (function)

The attribute to store the state in.

### AshStateMachine.Info.state_machine_state_attribute!/1 (function)

The attribute to store the state in.

### AshStateMachine.Info.state_machine_transitions/1 (function)

state_machine.transitions DSL entities

### AshStateMachine.Info.state_machine_transitions/2 (function)



### AshStateMachine.Transition (module)

The configuration for an transition.

### AshStateMachine.Transition.t/0 (type)



### AshStateMachine.BuiltinChanges (module)

Changes for working with AshStateMachine resources.

### AshStateMachine.BuiltinChanges.next_state/0 (function)

Try and transition to the next state. Must be only one possible next state.

### AshStateMachine.BuiltinChanges.transition_state/1 (function)

Changes the state to the target state, validating the transition

### AshStateMachine.Charts (module)

Returns a mermaid flow chart of a given state machine resource.

### AshStateMachine.Charts.mermaid_flowchart/1 (function)



### AshStateMachine.Charts.mermaid_state_diagram/1 (function)



### AshStateMachine.Errors.InvalidInitialState.exception/1 (function)

Create an `Elixir.AshStateMachine.Errors.InvalidInitialState` without raising it.

### Keys - AshStateMachine.Errors.InvalidInitialState.exception/1 (function)

- :action
- :target

### AshStateMachine.Errors.NoMatchingTransition.exception/1 (function)

Create an `Elixir.AshStateMachine.Errors.NoMatchingTransition` without raising it.

### Keys - AshStateMachine.Errors.NoMatchingTransition.exception/1 (function)

- :action
- :target
- :old_state

### AshStateMachine.Checks.ValidNextState (module)

A policy for pre_flight checking if a state transition is allowed.

### AshStateMachine.Checks.ValidNextState.auto_filter/3 (function)



### AshStateMachine.Checks.ValidNextState.auto_filter_not/3 (function)



### AshStateMachine.Checks.ValidNextState.check/4 (function)



### AshStateMachine.Checks.ValidNextState.describe/1 (function)



### AshStateMachine.Checks.ValidNextState.eager_evaluate?/0 (function)



### AshStateMachine.Checks.ValidNextState.expand_description/3 (function)



### AshStateMachine.Checks.ValidNextState.filter/3 (function)



### AshStateMachine.Checks.ValidNextState.prefer_expanded_description?/0 (function)



### AshStateMachine.Checks.ValidNextState.reject/3 (function)



### AshStateMachine.Checks.ValidNextState.requires_original_data?/2 (function)



### AshStateMachine.Checks.ValidNextState.strict_check/3 (function)



### AshStateMachine.Checks.ValidNextState.strict_check_context/1 (function)



### AshStateMachine.Checks.ValidNextState.type/0 (function)



### Mix.Tasks.AshStateMachine.GenerateFlowCharts.run/1 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_state_machine)# ash_paper_trail

> The extension for keeping an audit log of changes to your Ash resources.

## Docs

### AshPaperTrail (module)

Documentation for `AshPaperTrail`.

### AshPaperTrail.allow_resource_versions/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff (module)

Builds a diff of the changeset that is both fairly easy read and includes a complete
  representation of the changes mades.

### AshPaperTrail.ChangeBuilders.FullDiff.build_changes/3 (function)

Return a map of the changes made with a key for each attribute and a value
  that is a map representing each change.  The structure of map representing the
  each change comes in multiple:  simple/native, embedded, union, and array of embedded and array of unions.

  %{
    subject: %{ from: "subject", to: "new subject" },
    body: { unchanged: "body" }
  }

### AshPaperTrail.ChangeBuilders.FullDiff.EmbeddedChange (module)

A simple attribute change will be represented as a map:

  %{ created: %{ subject: %{to: "subject"} } }
  %{ updated: %{ subject: %{from: "subject", to: "new subject"} } }
  %{ unchanged: %{ subject: %{unchanged: "subject"} } }
  %{ destroyed: %{ subject: %{unchanged: "subject"} } }

### AshPaperTrail.ChangeBuilders.FullDiff.EmbeddedChange.build/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.EmbeddedChange.dump_data_value/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.Helpers (module)

Misc helpers for building a full diff of a changeset.

### AshPaperTrail.ChangeBuilders.FullDiff.Helpers.attribute_change_map/1 (function)

Builds a simple change map based on the given values.

attribute_change_map({data_present, data, value_present, value})

### AshPaperTrail.ChangeBuilders.FullDiff.Helpers.attribute_changes/2 (function)

Building a map of attribute changes for the embedded resource

### AshPaperTrail.ChangeBuilders.FullDiff.Helpers.build_index_change/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.Helpers.dump_value/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.Helpers.embedded?/1 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.Helpers.embedded_change_map/1 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.Helpers.embedded_union?/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.Helpers.map_get_keys/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.Helpers.union?/1 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.Helpers.union_change_map/1 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.Helpers.unique_id/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.ListChange (module)

A list of changes represented as a map:

  %{ to: nil }
  %{ unchanged: nil }
  %{ from: nil, to: [ ...all.new.items... ] }
  %{ from: [ ...all.new.items.removed.... ], to: nil }
  %{ to: [ ...one.or.more.items.changing... ] }
  %{ unchanged: [ ...no.items.changing... ] }

With each element of the array represented as a change:

#TODO: instead of `to:` and `from:` used `added:` and `removed:`
#

A nil item added:
  %{ to: nil, index: %{to: index} }

A nil item unchanged:
  %{ unchanged: nil, index: %{unchanged: index} }

A simple item added:
  %{ to: value, index: %{to: index} }

A simple item removed:
  %{ from: value, index: %{from: index} }

A simple item moved:
  %{ unchanged: value, index: %{from: from, to: to} }

A simple item unchanged:
  %{ unchanged: value, index: %{unchanged: index} }

A union item when added:
  %{ to: %{type: type, value: value }, index: %{to: index} }

A union item when unchanged:
  %{ unchanged: %{type: type, value: value }, index: %{unchanged: index} }

A union item when removed:
  %{ from: %{type: type, value: value }, index: %{from: index} }

An embedded item added:
  %{ created: %{ ...attrs...}, index: %{to: index} }

An embedded item when unchanged and unmoved:
  %{ unchanged: %{...attrs...}, index: %{unchanged: index} }

An embedded item when updated and unmoved:
  %{ updated: %{...attrs...}, index: %{unchanged: index} }

An embedded item when unchanged and moved:
  %{ unchanged: %{...attrs...} }, index: %{from: prev, to: index} }

An embedded item when updated and moved:
  %{ updated: %{...attrs...}, index: %{from: prev, to: index} }

An embedded item when removed:
  %{ destroyed: value: %{...attrs...}, index: %{from: index} }

### AshPaperTrail.ChangeBuilders.FullDiff.ListChange.add_index_change/3 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.ListChange.build/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.SimpleChange (module)

A simple attribute change will be represented as a map:

  %{ to: value }
  %{ from: value, to: value }
  %{ unchange: value }

### AshPaperTrail.ChangeBuilders.FullDiff.SimpleChange.build/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.SimpleChange.dump_data_value/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.UnionChange (module)

A non-embedded union attribute change will be represented as a map:

  %{ to: nil }
  %{ to: %{value: value, type: type } }
  %{ from: %{value: value, type: type }, to: %{value: value, type: type } }
  %{ unchanged: %{value: value, type: type } }

  If the from & to are embedded resources with the same primary key
  then, we'll have consider it changed and represent it as:

  %{ changed: %{type: type, updated: %{ ...attributes... } } }

  If the union value is an embedded resource the `value` key will be replaced with
  created, unchanged, updated, destroyed.

  %{ from: nil, created: %{type: type, value: %{ ...attributes... } } }
  %{ unchanged: %{type: type, value: %{ ...attributes... } } }
  %{ updated: %{type: type, value: %{ ...attributes... } } }
  %{ from: %{type: type, value: value}, created: %{type: type, value: %{ ...attributes... } }
  %{ destroyed: %{type: type, value: %{ ...attributes... } }, to: nil }
  %{ destroyed: %{type: type, value: %{ ...attributes... } }, created: %{type: type, value: %{ ...attributes... } } }
  %{ destroyed: %{type: type, destroyed: %{ ...attributes... } }, to: %{type: type, value: value } }

### AshPaperTrail.ChangeBuilders.FullDiff.UnionChange.build/2 (function)



### AshPaperTrail.ChangeBuilders.FullDiff.UnionChange.dump_union_type_value/2 (function)



### AshPaperTrail.Domain (module)

Documentation for `AshPaperTrail.Domain`.

### AshPaperTrail.Domain.paper_trail/1 (macro)



### AshPaperTrail.Domain.Info (module)

Introspection helpers for `AshPaperTrail.Domain`

### AshPaperTrail.Domain.Info.include_versions?/1 (function)



### AshPaperTrail.Domain.Transformers.AllowResourceVersions (module)

Adds any version resources to the domain for any resources.

### AshPaperTrail.Domain.Transformers.AllowResourceVersions.after?/1 (function)



### AshPaperTrail.Domain.Transformers.AllowResourceVersions.after_compile?/0 (function)



### AshPaperTrail.Domain.Transformers.AllowResourceVersions.before?/1 (function)



### AshPaperTrail.Domain.Transformers.AllowResourceVersions.transform/1 (function)



### AshPaperTrail.Resource (module)

Documentation for `AshPaperTrail.Resource`.

### AshPaperTrail.Resource.paper_trail/1 (macro)



### AshPaperTrail.Resource.BelongsToActor (module)

Represents a belongs_to_actor relationship on a version resource

### AshPaperTrail.Resource.BelongsToActor.t/0 (type)



### AshPaperTrail.Resource.Changes.CreateNewVersion (module)

Creates a new version whenever a resource is created, deleted, or updated

### AshPaperTrail.Resource.Info (module)

Introspection helpers for `AshPaperTrail.Resource`

### AshPaperTrail.Resource.Info.attributes_as_attributes/1 (function)



### AshPaperTrail.Resource.Info.belongs_to_actor/1 (function)



### AshPaperTrail.Resource.Info.change_tracking_mode/1 (function)



### AshPaperTrail.Resource.Info.ignore_actions/1 (function)



### AshPaperTrail.Resource.Info.ignore_attributes/1 (function)



### AshPaperTrail.Resource.Info.mixin/1 (function)



### AshPaperTrail.Resource.Info.on_actions/1 (function)



### AshPaperTrail.Resource.Info.only_when_changed?/1 (function)



### AshPaperTrail.Resource.Info.primary_key_type/1 (function)



### AshPaperTrail.Resource.Info.reference_source?/1 (function)



### AshPaperTrail.Resource.Info.relationship_opts/1 (function)



### AshPaperTrail.Resource.Info.resource_identifier/1 (function)



### AshPaperTrail.Resource.Info.sensitive_attributes/1 (function)



### AshPaperTrail.Resource.Info.store_action_inputs?/1 (function)



### AshPaperTrail.Resource.Info.store_action_name?/1 (function)



### AshPaperTrail.Resource.Info.store_resource_identifier?/1 (function)



### AshPaperTrail.Resource.Info.version_extensions/1 (function)



### AshPaperTrail.Resource.Info.version_resource/1 (function)



### AshPaperTrail.Resource.Transformers.CreateVersionResource (module)

Creates a version resource for a given resource

### AshPaperTrail.Resource.Transformers.CreateVersionResource.after?/1 (function)



### AshPaperTrail.Resource.Transformers.CreateVersionResource.after_compile?/0 (function)



### AshPaperTrail.Resource.Transformers.CreateVersionResource.before?/1 (function)



### AshPaperTrail.Resource.Transformers.CreateVersionResource.transform/1 (function)



### AshPaperTrail.Resource.Transformers.RelateVersionResource (module)

Relates the resource to its created version resource

### AshPaperTrail.Resource.Transformers.RelateVersionResource.after?/1 (function)



### AshPaperTrail.Resource.Transformers.RelateVersionResource.after_compile?/0 (function)



### AshPaperTrail.Resource.Transformers.RelateVersionResource.before?/1 (function)



### AshPaperTrail.Resource.Transformers.RelateVersionResource.transform/1 (function)



### AshPaperTrail.Resource.Transformers.ValidateBelongsToActor (module)

Validates that when multiple belongs_to_actor options are defined that they all allow_nil? true

### AshPaperTrail.Resource.Transformers.ValidateBelongsToActor.after?/1 (function)



### AshPaperTrail.Resource.Transformers.ValidateBelongsToActor.after_compile?/0 (function)



### AshPaperTrail.Resource.Transformers.ValidateBelongsToActor.before?/1 (function)



### AshPaperTrail.Resource.Transformers.ValidateBelongsToActor.transform/1 (function)



### AshPaperTrail.Resource.Transformers.VersionOnChange (module)

Adds the `CreateNewVersion` change to the resource.

### AshPaperTrail.Resource.Transformers.VersionOnChange.after?/1 (function)



### AshPaperTrail.Resource.Transformers.VersionOnChange.after_compile?/0 (function)



### AshPaperTrail.Resource.Transformers.VersionOnChange.before?/1 (function)



### AshPaperTrail.Resource.Transformers.VersionOnChange.transform/1 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_paper_trail)# ash_double_entry

> A customizable double entry bookkeeping system backed by Ash resources.

## Docs

### AshDoubleEntry.Account.Info (module)

Introspection helpers for `AshDoubleEntry.Account`

### AshDoubleEntry.Account.Info.account_balance_resource/1 (function)

The resource used for balances

### AshDoubleEntry.Account.Info.account_balance_resource!/1 (function)

The resource used for balances

### AshDoubleEntry.Account.Info.account_open_action_accept/1 (function)

A list of extra attributes to be accepted by the open action. The `identifier` and `currency` attributes are always accepted.

### AshDoubleEntry.Account.Info.account_open_action_accept!/1 (function)

A list of extra attributes to be accepted by the open action. The `identifier` and `currency` attributes are always accepted.

### AshDoubleEntry.Account.Info.account_options/1 (function)

account DSL options

Returns a map containing the and any configured or default values.

### AshDoubleEntry.Account.Info.account_pre_check_identities_with/1 (function)

A domain to use to precheck generated identities. Required by certain data layers.

### AshDoubleEntry.Account.Info.account_pre_check_identities_with!/1 (function)

A domain to use to precheck generated identities. Required by certain data layers.

### AshDoubleEntry.Account.Info.account_transfer_resource/1 (function)

The resource used for transfers

### AshDoubleEntry.Account.Info.account_transfer_resource!/1 (function)

The resource used for transfers

### AshDoubleEntry.Balance.Info (module)

Introspection helpers for `AshDoubleEntry.Balance`

### AshDoubleEntry.Balance.Info.balance_account_resource/1 (function)

The resource used for accounts

### AshDoubleEntry.Balance.Info.balance_account_resource!/1 (function)

The resource used for accounts

### AshDoubleEntry.Balance.Info.balance_data_layer_can_add_money?/1 (function)

Whether or not the data layer supports adding money.

### AshDoubleEntry.Balance.Info.balance_money_composite_type?/1 (function)

Whether the balance is stored as a composite type.

### AshDoubleEntry.Balance.Info.balance_options/1 (function)

balance DSL options

Returns a map containing the and any configured or default values.

### AshDoubleEntry.Balance.Info.balance_pre_check_identities_with/1 (function)

A domain to use to precheck generated identities. Required by certain data layers.

### AshDoubleEntry.Balance.Info.balance_pre_check_identities_with!/1 (function)

A domain to use to precheck generated identities. Required by certain data layers.

### AshDoubleEntry.Balance.Info.balance_transfer_resource/1 (function)

The resource used for transfers

### AshDoubleEntry.Balance.Info.balance_transfer_resource!/1 (function)

The resource used for transfers

### AshDoubleEntry.Transfer.Info (module)

Introspection helpers for `AshDoubleEntry.Transfer`

### AshDoubleEntry.Transfer.Info.transfer_account_resource/1 (function)

The resource to use for account balances

### AshDoubleEntry.Transfer.Info.transfer_account_resource!/1 (function)

The resource to use for account balances

### AshDoubleEntry.Transfer.Info.transfer_balance_resource/1 (function)

The resource being used for balances

### AshDoubleEntry.Transfer.Info.transfer_balance_resource!/1 (function)

The resource being used for balances

### AshDoubleEntry.Transfer.Info.transfer_create_accept/1 (function)

Additional attributes to accept when creating a transfer

### AshDoubleEntry.Transfer.Info.transfer_create_accept!/1 (function)

Additional attributes to accept when creating a transfer

### AshDoubleEntry.Transfer.Info.transfer_destroy_balances?/1 (function)

Whether or not balances must be manually destroyed. See the getting started guide for more.

### AshDoubleEntry.Transfer.Info.transfer_options/1 (function)

transfer DSL options

Returns a map containing the and any configured or default values.

### AshDoubleEntry.Transfer.Info.transfer_pre_check_identities_with/1 (function)

A domain to use to precheck generated identities. Required by certain data layers.

### AshDoubleEntry.Transfer.Info.transfer_pre_check_identities_with!/1 (function)

A domain to use to precheck generated identities. Required by certain data layers.

### AshDoubleEntry.Account (module)

An extension for creating a double entry ledger account. See the getting started guide for more.

### AshDoubleEntry.Account.account/1 (macro)



### AshDoubleEntry.Balance (module)

An extension for creating a double entry ledger balance. See the getting started guide for more.

### AshDoubleEntry.Balance.balance/1 (macro)



### AshDoubleEntry.Transfer (module)

An extension for creating a double entry ledger transfer. See the getting started guide for more.

### AshDoubleEntry.Transfer.transfer/1 (macro)



### AshDoubleEntry.ULID (module)

An Ash type for ULID strings.

### AshDoubleEntry.ULID.bingenerate/1 (function)

Generates a binary ULID.

If a value is provided for `timestamp`, the generated ULID will be for the provided timestamp.
Otherwise, a ULID will be generated for the current time.

Arguments:

* `timestamp`: A Unix timestamp with millisecond precision.

### AshDoubleEntry.ULID.bingenerate_last/1 (function)

Generates a binary ULID.

Do not use this for storage, only for generating comparators, i.e "balance as of a given ulid".

If a value is provided for `timestamp`, the generated ULID will be for the provided timestamp.
Otherwise, a ULID will be generated for the current time.

Arguments:

* `timestamp`: A Unix timestamp with millisecond precision.

### AshDoubleEntry.ULID.cast_input/2 (function)

Casts a string to ULID.

### AshDoubleEntry.ULID.cast_stored/2 (function)

Converts a binary ULID into a Crockford Base32 encoded string.

### AshDoubleEntry.ULID.dump_to_native/2 (function)

Converts a Crockford Base32 encoded ULID into a binary.

### AshDoubleEntry.ULID.generate/1 (function)

Generates a Crockford Base32 encoded ULID.

If a value is provided for `timestamp`, the generated ULID will be for the provided timestamp.
Otherwise, a ULID will be generated for the current time.

Arguments:

* `timestamp`: A Unix timestamp with millisecond precision.

### AshDoubleEntry.ULID.generate_last/1 (function)

Generates a Crockford Base32 encoded ULID, guaranteed to sort equal to or after any other ULID generated for the same timestamp.

Do not use this for storage, only for generating comparators, i.e "balance as of a given ulid".

If a value is provided for `timestamp`, the generated ULID will be for the provided timestamp.
Otherwise, a ULID will be generated for the current time.

Arguments:

* `timestamp`: A Unix timestamp with millisecond precision.

### AshDoubleEntry.ULID.handle_change?/0 (function)



### AshDoubleEntry.ULID.prepare_change?/0 (function)



### AshDoubleEntry.ULID.storage_type/0 (function)

The underlying schema type.

### AshDoubleEntry.ULID.t/0 (type)

A hex-encoded ULID string.

## Links

- [Online documentation](https://hexdocs.pm/ash_double_entry)# ash_phoenix

> Utilities for integrating Ash and Phoenix

## Docs

### AshPhoenix (module)

An extension to add form builders to the code interface.

There is currently no DSL for this extension.

This defines a `form_to_ ` function for each code interface
function. Positional arguments are ignored, given that in forms,
all input typically comes from the `params` map.

The generated function passes all options through to
`AshPhoenix.Form.for_action/3`

Update and destroy actions take the record being updated/destroyed
as the first argument.

For example, given this code interface definition on a domain
called `MyApp.Accounts`:

```elixir
resources do
  resource MyApp.Accounts.User do
    define :register_with_password, args: [:email, :password]
    define :update_user, action: :update, args: [:email, :password]
  end
end
```

Adding the `AshPhoenix` extension would define 
`form_to_register_with_password/2`.

### Usage - AshPhoenix (module)

Without options:

```elixir
MyApp.Accounts.form_to_register_with_password()
#=> %AshPhoenix.Form{}
```

With options:

```elixir
MyApp.Accounts.form_to_register_with_password(params: %{"email" => "placeholder@email"})
#=> %AshPhoenix.Form{}
```

With 

```elixir
MyApp.Accounts.form_to_update_user(params: %{"email" => "placeholder@email"})
#=> %AshPhoenix.Form{}
```

### AshPhoenix.forms/1 (macro)



### AshPhoenix.FormDefinition (module)

A customized form code interface

### AshPhoenix.Inertia.Error (module)

Provides a mapping from an Ash Error type to a plain map that can be used with the `Inertia.Controller.assign_errors/2` function.

Note this module is only available when the `:inertia` dependency is included in your application.

### Typical usage with Inertia - AshPhoenix.Inertia.Error (module)

Inertia users will typically pass Ash errors directly into the `Inertia.Controller.assign_errors/2` function in their controllers.
Internally the Inertia library will use the `Inertia.Errors` protocol to transform the Ash Error to a plain map for JSON serialization.

```elixir
  def create(conn, params) do
    case MyApp.Posts.create(params, actor: conn.assigns.current_user) do
      {:ok, post} ->
        redirect(conn, to: ~p"/posts/#{post.slug}")

      {:error, errors} ->
        conn
        |> assign_errors(errors)
        |> render_inertia("CreatePost")
    end
  end
```

The `Inertia.Errors` protocol is implemented for common error types and the Ash error classes, such as `Ash.Error.Invalid` and `Ash.Error.Forbidden`.
If you have a situation where there is no protocol implementation for your error type, you may need to call `Ash.Error.to_error_class/1` on the error
first, before passing it to ` Inertia.Controller.assign_errors/2`, or providing an implementation of the `Inertia.Errors` protocol for the error type.

### AshPhoenix.Inertia.Error.to_errors/2 (function)

Converts an error, or list of errors to a map of error field to error message.

Nested field errors are flattened with the error path added as a dotted prefex, eg

```elixir
%{
  "user.contact.email_address" => "Is required"
}
```

### Parameters - AshPhoenix.Inertia.Error.to_errors/2 (function)

- `error_or_errors` (required) The error struct or list
 - `message_func` (optional) A function to transform a tuple of message string and variables map to a single string.

### Examples - AshPhoenix.Inertia.Error.to_errors/2 (function)

iex> AshPhoenix.Inertia.Error.to_errors(
    iex>   %Ash.Error.Action.InvalidArgument{
    iex>    path: [:customer, :contact],
    iex>    field: :email,
    iex>    message: "%{email} is already taken",
    iex>    vars: %{email: "acme@example.com"}
    iex>  }
    iex>)
    %{"customer.contact.email" => "acme@example.com is already taken"}

    iex> AshPhoenix.Inertia.Error.to_errors(
    iex>   %Ash.Error.Invalid{
    iex>    errors: [
    iex>      %Ash.Error.Action.InvalidArgument{
    iex>        path: [:customer, :contact],
    iex>        field: :email,
    iex>        message: "%{email} is already taken",
    iex>        vars: %{email: "acme@example.com"}
    iex>      },
    iex>      %Ash.Error.Action.InvalidArgument{
    iex>        path: [:product],
    iex>        field: :sku,
    iex>        message: "%{product_name} is out of stock",
    iex>        vars: %{product_name: "acme powder"}
    iex>      }
    iex>    ]
    iex>  }
    iex>)
    %{
      "customer.contact.email" => "acme@example.com is already taken",
      "product.sku" => "acme powder is out of stock"
    }

### AshPhoenix.Info (module)

Introspection helpers for the `AshPhoenix` DSL extension

### AshPhoenix.Info.form/2 (function)



### AshPhoenix.Info.forms/1 (function)

forms DSL entities

### AshPhoenix.LiveView.SubdomainHook (module)

This is a basic hook that loads the current tenant assign from a given
value set on subdomain.

Options:

* `:assign` (`t:atom/0`) - The key to use when assigning the current tenant The default value is `:current_tenant`.

* `:handle_subdomain` - An mfa to call with the socket and a subdomain value. Can be used to do something like fetch the current user given the tenant.
          Must return either `{:cont, socket}`, `{:cont, socket, opts} or `{:halt, socket}`.



To use the hook, you can do one of the following:

```elixir
live_session :foo, on_mount: [
  AshPhoenix.LiveView.SubdomainHook,
]
```
This will assign the tenant's subdomain value to `:current_tenant` key by default.

If you want to specify the assign key

```elixir
live_session :foo, on_mount: [
  {AshPhoenix.LiveView.SubdomainHook, [assign: :different_assign_key}]
]
```

You can also provide `handle_subdomain` module, function, arguments tuple
that will be run after the tenant is assigned.

```elixir
live_session :foo, on_mount: [
  {AshPhoenix.LiveView.SubdomainHook, [handle_subdomain: {FooApp.SubdomainHandler, :handle_subdomain, [:bar]}]
]
```

This can be any module, function, and list of arguments as it uses Elixir's [apply/3](https://hexdocs.pm/elixir/1.18.3/Kernel.html#apply/3).

The socket and tenant will be the first two arguments.

The function return must match Phoenix LiveView's [on_mount/1](https://hexdocs.pm/phoenix_live_view/Phoenix.LiveView.html#on_mount/1)

```elixir
defmodule FooApp.SubdomainHandler do
  def handle_subdomain(socket, tenant, :bar) do
    # your logic here
    {:cont, socket}
  end
end
```

### AshPhoenix.LiveView.SubdomainHook.on_mount/4 (function)



### AshPhoenix.LiveView (module)

Utilities for keeping Ash query results up to date in a LiveView.

### AshPhoenix.LiveView.assign/0 (type)



### AshPhoenix.LiveView.assign_page_and_stream_result/3 (function)

Shorthand to add results of a page onto a socket along with the page.

### Examples: - AshPhoenix.LiveView.assign_page_and_stream_result/3 (function)

```elixir
AshPhoenix.LiveView.assign_page_and_stream_result(%Phoenix.LiveView.Socket{}, %Ash.Page.Offset{results: [1,2,3]})
# => %Phoenix.LiveView.Socket{assigns: %{streams: %{results: [1,2,3]}, page: %Ash.Page.Offset{results: nil}}}
```

### Options - AshPhoenix.LiveView.assign_page_and_stream_result/3 (function)

* `:results_key` (`t:atom/0`) -  The default value is `:results`.

* `:page_key` (`t:atom/0`) -  The default value is `:page`.

* `:stream_opts` (`t:keyword/0`) -  The default value is `[reset: true]`.

### AshPhoenix.LiveView.assigns/0 (type)



### AshPhoenix.LiveView.callback/0 (type)



### AshPhoenix.LiveView.callback_result/0 (type)



### AshPhoenix.LiveView.can_link_to_page?/2 (function)



### AshPhoenix.LiveView.change_page/3 (function)



### AshPhoenix.LiveView.handle_live/4 (function)

Incorporates an `Ash.Notifier.Notification` into the query results, based on the liveness configuration.

You will want to match on receiving a notification from Ash, and the easiest way to do that is to match
on the payload like so:

```
@impl true
def handle_info(%{topic: topic, payload: %Ash.Notifier.Notification{}}, socket) do
  {:noreply, handle_live(socket, topic, [:query1, :query2, :query3])}
end
```

Feel free to intercept notifications and do your own logic to respond to events. Ultimately, all
that matters is that you also call `handle_live/3` if you want it to update your query results.

The assign or list of assigns passed as the third argument must be the same names passed into
`keep_live`. If you only want some queries to update based on some events, you can define multiple
matches on events, and only call `handle_live/3` with the assigns that should be updated for that
notification.

### AshPhoenix.LiveView.keep_live/4 (function)

Runs the callback, and stores the information required to keep it live in the socket assigns.

The data will be assigned to the provided key, e.g `keep_live(socket, :me, ...)` would assign the results
to `:me` (accessed as `@me` in the template).

Additionally, you'll need to define a `handle_info/2` callback for your liveview to receive any
notifications, and pass that notification into `handle_live/3`. See `handle_live/3` for more.

### Important - AshPhoenix.LiveView.keep_live/4 (function)

The logic for handling events to keep data live is currently very limited. It will simply rerun the query
every time. To this end, you should feel free to intercept individual events and handle them yourself for
more optimized liveness.

### Pagination - AshPhoenix.LiveView.keep_live/4 (function)

To make paginated views convenient, as well as making it possible to keep those views live, Ash does not
simply rerun the query when it gets an update, as that could involve shuffling the records around on the
page. Eventually this will be configurable, but for now, Ash simply adjusts the query to only include the
records that are on the page. If a record would be removed from a page due to a data change, it will simply
be left there. For the best performance, use `keyset` pagination. If you *need* the ability to jump to a
page by number, you'll want to use `offset` pagination, but keep in mind that it performs worse on large
tables.

To support this, accept a second parameter to your callback function, which will be the options to use in `page_opts`

### Options: - AshPhoenix.LiveView.keep_live/4 (function)

* `:subscribe` - A topic or list of topics that should cause this data to update.

* `:refetch?` (`t:boolean/0`) - A boolean flag indicating whether a refetch is allowed to happen. Defaults to `true`

* `:after_fetch` (`t:term/0`) - A two argument function that takes the results, and the socket, and returns the new socket. Can be used to set assigns based on the result of the query.

* `:results` - For list and page queries, by default the records shown are never changed (unless the page changes) Valid values are :keep, :lose The default value is `:keep`.

* `:load_until_connected?` (`t:boolean/0`) - If the socket is not connected, then the value of the provided assign is set to `:loading`. Has no effect if `initial` is provided.

* `:initial` (`t:term/0`) - Results to use instead of running the query immediately.

* `:refetch_interval` (`t:non_neg_integer/0`) - An interval (in ms) to periodically refetch the query

* `:refetch_window` (`t:non_neg_integer/0`) - The minimum time (in ms) between refetches, including refetches caused by notifications.



A great way to get readable millisecond values is to use the functions in erlang's `:timer` module,
like `:timer.hours/1`, `:timer.minutes/1`, and `:timer.seconds/1`

#### refetch_interval

If this option is set, a message is sent as `{:refetch, assign_name, opts}` on that interval.
You can then match on that event, like so:

```
def handle_info({:refetch, assign, opts}, socket) do
  {:noreply, handle_live(socket, :refetch, assign, opts)}
end
```

This is the equivalent of `:timer.send_interval(interval, {:refetch, assign, opts})`, so feel free to
roll your own solution if you have complex refetching requirements.

#### refetch_window

Normally, when a pubsub message is received the query is rerun. This option will cause the query to wait at least
this amount of time before doing a refetch. This is accomplished with `Process.send_after/4`, and recording the
last time each query was refetched. For example if a refetch happens at time `0`, and the `refetch_window` is
10,000 ms, we would refetch, and record the time. Then if another refetch should happen 5,000 ms later, we would
look and see that we need to wait another 5,000ms. So we use `Process.send_after/4` to send a
`{:refetch, assign, opts}` message in 5,000ms. The time that a refetch was requested is tracked, so if the
data has since been refetched, it won't be refetched again.

#### Future Plans

One interesting thing here is that, given that we know the scope of data that a resource cares about,
we should be able to make optimizations to this code, to support partial refetches, or even just updating
the data directly. However, this will need to be carefully considered, as the risks involve showing users
data they could be unauthorized to see, or having state in the socket that is inconsistent.

### AshPhoenix.LiveView.last_page/1 (function)



### AshPhoenix.LiveView.liveness_options/0 (type)



### AshPhoenix.LiveView.next_page?/1 (function)

Returns true if there's a next page.

### Examples - AshPhoenix.LiveView.next_page?/1 (function)

iex> AshPhoenix.LiveView.next_page?(%Ash.Page.Offset{offset: 10, limit: 10, more?: true})
    true

    iex> AshPhoenix.LiveView.next_page?(%{offset: 0, limit: 10, more?: false})
    false

### AshPhoenix.LiveView.on_page?/2 (function)



### AshPhoenix.LiveView.page_from_params/3 (function)

Generates a page request for doing pagination based on the passed in parameters.

### Examples - AshPhoenix.LiveView.page_from_params/3 (function)

iex> AshPhoenix.LiveView.page_from_params(%{"offset" => "10", "limit" => "10"}, 20, true)
    [count: true, limit: 10, offset: 10]

    iex> AshPhoenix.LiveView.page_from_params(%{"offset" => "10", "limit" => "10"}, 20)
    [count: false, limit: 10, offset: 10]

    iex> AshPhoenix.LiveView.page_from_params(%{"offset" => "10", "count" => "true"}, 20)
    [count: true, limit: 20, offset: 10]

### AshPhoenix.LiveView.page_link_params/2 (function)

Converts Ash.Page.Offset to query link params

Options:

* "first" - first page
* "prev"  - prev page
* "next"  - next page
* "last"  - last page (if the page is loaded with `count: true`)

Returns `:invalid` or a list of query link params.

### AshPhoenix.LiveView.page_number/1 (function)



### AshPhoenix.LiveView.page_params/0 (type)



### AshPhoenix.LiveView.page_params/1 (function)

Converts an `Ash.Page.Keyset` or `Ash.Page.Offset` struct into page parameters in keyword format.

### AshPhoenix.LiveView.prev_page?/1 (function)

Returns true if there's a previous page.

### Examples - AshPhoenix.LiveView.prev_page?/1 (function)

iex> AshPhoenix.LiveView.prev_page?(%Ash.Page.Offset{offset: 10, limit: 10})
    true

    iex> AshPhoenix.LiveView.prev_page?(%{offset: 0, limit: 10})
    false

### AshPhoenix.LiveView.socket/0 (type)



### AshPhoenix.LiveView.topic/0 (type)



### AshPhoenix.SubdomainPlug (module)

This is a basic plug that loads the current tenant assign from a given
value set on subdomain.

This was copied from `Triplex.SubdomainPlug`, here:
  https://github.com/ateliware/triplex/blob/master/lib/triplex/plugs/subdomain_plug.ex

Options:

* `:endpoint` (`t:atom/0`) - Required. The endpoint that the plug is in, used for deterining the host

* `:assign` (`t:atom/0`) - The key to use when assigning the current tenant The default value is `:current_tenant`.

* `:handle_subdomain` - An mfa to call with the conn and a subdomain value. Can be used to do something like fetch the current user given the tenant. Must return the new conn.



To plug it on your router, you can use:
    plug AshPhoenix.SubdomainPlug,
      endpoint: MyApp.Endpoint

An additional helper here can be used for determining the host in your liveview, and/or using
the host that was already assigned to the conn.

For example:

    def handle_params(params, uri, socket) do
      socket =
        assign_new(socket, :current_tenant, fn ->
          AshPhoenix.SubdomainPlug.live_tenant(socket, uri)
        end)

      socket =
        assign_new(socket, :current_organization, fn ->
          if socket.assigns[:current_tenant] do
            MyApp.Accounts.Ash.get!(MyApp.Accounts.Organization,
              subdomain: socket.assigns[:current_tenant]
            )
          end
        end)

      {:noreply, socket}
    end

### AshPhoenix.SubdomainPlug.live_tenant/2 (function)



### Mix.Tasks.AshPhoenix.Gen.Html.run/1 (function)



### Mix.Tasks.AshPhoenix.Gen.Live.igniter/2 (function)



### AshPhoenix.Form (module)

A module to allow you to fluidly use resources with Phoenix forms.

### Life cycle - AshPhoenix.Form (module)

The general workflow is, with either LiveView or Phoenix forms:

1. Create a form with `AshPhoenix.Form`
2. Render the form with `Phoenix.Component.form` (or `CoreComponents.simple_form`), or, if using Surface, ` `
3. To validate the form (e.g with `phx-change` for liveview), pass the submitted params to `AshPhoenix.Form.validate/3`
4. On form submission, pass the params to `AshPhoenix.Form.submit/2`
5. On success, use the result to redirect or assign. On failure, reassign the provided form.

The following keys exist on the form to show where in the lifecycle you are:

- `submitted_once?` - If the form has ever been submitted. Useful for not showing any errors on the first attempt to fill out a form.
- `just_submitted?` - If the form has just been submitted and *no validation* has happened since. Useful for things like
  triggering a UI effect that should stop when the form is modified again.
- `.changed?` - If something about the form is different than it originally was. Note that in some cases this can yield a
  false positive, specifically if a nested form is removed and then a new one is added with the exact same values.
- `.touched_forms` - A MapSet containing all keys in the form that have been modified. When submitting a form, only these keys are included in the parameters.

### Forms in the code interface - AshPhoenix.Form (module)

Throughout this documentation you will see forms created with `AshPhoenix.Form.for_create/3` and other functions like it.
This is perfectly fine to do, however there is a way to use `AshPhoenix.Form` in a way that adds clarity to its usage
and makes it easier to find usage of each action. Code interfaces allow us to do this for standard action calls, i.e:

```elixir
resources do
  resource MyApp.Accounts.User do
    define :register_with_password, args: [:email, :password]
    define :update_user, action: :update, args: [:email, :password]
  end
end
```

Adding the `AshPhoenix` extension to our domains and resources, like so:

```elixir
use Ash.Domain,
  extensions: [AshPhoenix]
```

will cause another function to be generated for each definition, beginning with `form_to_`.

By default, the `args` option in `define` is ignored when building forms. If you want to have
positional arguments, configure that in the `forms` section which is added by the `AshPhoenix`
section. For example:

```elixir
forms do
  form :update_user, args: [:email]
end
```

With this extension, the standard setup for forms looks something like this:

```elixir
def render(assigns) do
  ~H"""
  <.form for={@form} phx-change="validate" phx-submit="submit">
    <.input field={@form[:email]} />
    <.input field={@form[:password]} />
    <.button type="submit" />
  </.form>
  """
end

def mount(_params, _session, socket) do
  # Here we call our new generated function to create the form
  {:ok, assign(socket, form: MyApp.Accounts.form_to_register_with_password() |> to_form())}
end

def handle_event("validate", %{"form" => params}, socket) do
  form = AshPhoenix.Form.validate(socket.assigns.form, params)
  {:noreply, assign(socket, :form, form)}
end

def handle_event("submit", %{"form" => params}, socket) do
  case AshPhoenix.Form.submit(socket.assigns.form, params: params) do
    {:ok, _user} ->
      socket =
        socket
        |> put_flash(:success, "User registered successfully")
        |> push_navigate(to: ~p"/")

      {:noreply, socket}

    {:error, form} ->
      socket =
        socket
        |> put_flash(:error, "Something went wrong")
        |> assign(:form, form)

      {:noreply, socket}
  end
end
```

### Working with related or embedded data - AshPhoenix.Form (module)

See the [nested forms guide](/documentation/topics/nested-forms.md)

### Working with compound types - AshPhoenix.Form (module)

Compound types, such as `Ash.Money`, will need some extra work to make it work.

For instance, when working with the `Transfer` type in `AshDoubleEntry.Transfer`, it will have the `Ash.Money` type for `amount`. When rendering the forms, you should do as follows:
```
<.input
    name={@form[:amount].name <> "[amount]"}
    id={@form[:amount].id <> "_amount"}
    label="Amount"
    value={if(@form[:amount].value, do: @form[:amount].value.amount)}
  />
  <.input
    type="select"
    name={@form[:amount].name <> "[currency]"}
    id={@form[:amount].id <> "_currency"}
    options={[:USD, :HKD, :EUR]}
    label="Currency"
    value={if(@form[:amount].value, do: @form[:amount].value.currency)}
  />
```

The above will allow the fields to be used by the `AshPhoenix.Form` when creating or updating a Transfer.
You can follow the same style with other compound types.

### AshPhoenix.Form.add_error/3 (function)

Adds an error to the source underlying the form.

This can be used for adding errors from different sources to a form. Keep in mind, if they don't match
a field on the form (typically extracted via the `field` key in the error), they won't be displayed by default.
Ensure that the `errors` field of the form is set to `true` if you want the errors to be visible.

See `Ash.Error.to_ash_error/3` for more on supported values for `error`.

# Options

- `:path` - The path to add the error to. If the error(s) already have a path, don't specify a path yourself.

### AshPhoenix.Form.add_form/3 (function)

Adds a new form at the provided path.

Doing this requires that the form has a `create_action` and a `resource` configured.

`path` can be one of two things:

1. A list of atoms and integers that lead to a form in the `forms` option provided. `[:posts, 0, :comments]` to add a comment to the first post.
2. The html name of the form, e.g `form[posts][0][comments]` to mimic the above

If you pass parameters to this function, keep in mind that, unless they are string keyed in
the same shape they might come from your form, then the result of `params/1` will reflect that,
i.e `add_form(form, "foo", params: %{bar: 10})`, could produce params like `%{"field" => value, "foo" => [%{bar: 10}]}`.
Notice how they are not string keyed as you would expect. However, once the form is changed (in liveview) and a call
to `validate/2` is made with that input, then the parameters would become what you'd expect. In this way, if you are using
`add_form` with not string keys/values you may not be able to depend on the shape of the `params` map (which you should ideally
not depend on anyway).

* `:prepend` (`t:boolean/0`) - If specified, the form is placed at the beginning of the list instead of the end of the list The default value is `false`.

* `:params` (`t:term/0`) - The initial parameters to add the form with. The default value is `%{}`.

* `:validate?` (`t:boolean/0`) - Validates the new full form. The default value is `true`.

* `:validate_opts` (`t:term/0`) - Options to pass to `validate`. Only used if `validate?` is set to `true` (the default) The default value is `[]`.

* `:type` - If `type` is set to `:read`, the form will be created for a read action. A hidden field will be set in the form called `_form_type` to track this information. Valid values are :read, :create, :update, :destroy The default value is `:create`.

* `:data` (`t:term/0`) - The data to set backing the form. Generally you'd only want to do this if you are adding a form with `type: :read` additionally.

### AshPhoenix.Form.arguments/1 (function)

A utility to get the list of arguments the action underlying the form accepts

### AshPhoenix.Form.attributes/1 (function)

A utility to get the list of attributes the action underlying the form accepts

### AshPhoenix.Form.can_submit?/1 (function)



### AshPhoenix.Form.clear_value/2 (function)

Clears a given input's value on a form.

Accepts a field (atom) or a list of fields (atoms) as a second argument.

### AshPhoenix.Form.do_sort_forms/5 (function)



### AshPhoenix.Form.ensure_can_submit!/1 (function)



### AshPhoenix.Form.errors/2 (function)

Returns the errors on the form.

By default, only errors on the form being passed in (not nested forms) are provided.
Use `for_path` to get errors for nested forms.

* `:format` - Values:
      - `:raw` - `[field:, {message, substitutions}}]` (for translation)
      - `:simple` - `[field: "message w/ variables substituted"]`
      - `:plaintext` - `["field: message w/ variables substituted"]`
   Valid values are :simple, :raw, :plaintext The default value is `:simple`.

* `:for_path` (`t:term/0`) - The path of the form you want errors for, either as a list or as a string, e.g `[:comments, 0]` or `form[comments][0]`
  Passing `:all` will cause this function to return a map of path to its errors, like so:  
  `%{[:comments, 0] => [body: "is invalid"], ...}` The default value is `[]`.

### AshPhoenix.Form.for_action/3 (function)

Creates a form corresponding to any given action on a resource.

If given a create, read, update, or destroy action, the appropriate `for_*`
function will be called instead. So use this function when you don't know
the type of the action, or it is a generic action.

### Options - AshPhoenix.Form.for_action/3 (function)

* `:actor` (`t:term/0`) - The actor performing the action. Passed through to the underlying action.

* `:forms` (`t:keyword/0`) - Nested form configurations. See `for_create/3` "Nested Form Options" docs for more.

* `:warn_on_unhandled_errors?` (`t:boolean/0`) - Warns on any errors that don't match the form pattern of `{:field, "message", [replacement: :vars]}` or implement the `AshPhoenix.FormData.Error` protocol. The default value is `true`.

* `:domain` (`t:atom/0`) - The domain to use when calling the action.

* `:as` (`t:String.t/0`) - The name of the form in the submitted params. You will need to pull the form params out using this key. The default value is `"form"`.

* `:id` (`t:String.t/0`) - The html id of the form. Defaults to the value of `:as` if provided, otherwise "form"

* `:transform_errors` - Allows for manual manipulation and transformation of errors.  
  If possible, try to implement `AshPhoenix.FormData.Error` for the error (if it as a custom one, for example).
  If that isn't possible, you can provide this function which will get the changeset and the error, and should
  return a list of ash phoenix formatted errors, e.g `[{field :: atom, message :: String.t(), substituations :: Keyword.t()}]`  
  Example:  
  AshPhoenix.Form.for_create(..., transform_errors: fn
    %{field: :field1} = error ->
      %{error | field: :field2}  
    error ->
      error
  end

* `:prepare_source` - A 1-argument function the receives the initial changeset (or query) and makes any relevant changes to it.
  This can be used to do things like:  
  * Set default argument values before the validations are run using `Ash.Changeset.set_arguments/2` or `Ash.Changeset.set_argument/3`
  * Set changeset context
  * Do any other pre-processing on the changeset

* `:prepare_params` - A 2-argument function that receives the params map and the :validate atom and should return prepared params.
  Called before the form is validated.

* `:transform_params` - A function for post-processing the form parameters before they are used for changeset validation/submission.
  Use a 3-argument function to pattern match on the `AshPhoenix.Form` struct.

* `:method` (`t:String.t/0`) - The http method to associate with the form. Defaults to `post` for creates, and `put` for everything else.

* `:exclude_fields_if_empty` - These fields will be ignored if they are empty strings.  
  This list of fields supports dead view forms. When a form is submitted from dead view
  empty fields are submitted as empty strings. This is problematic for fields that allow_nil
  or those that have default values.

* `:tenant` (`t:term/0`) - The current tenant. Passed through to the underlying action.

* `:params` (`t:term/0`) - The initial parameters to use for the form. This is useful for setting up a form with default values. The default value is `%{}`.



Any *additional* options will be passed to the underlying call to build the source, i.e
`Ash.ActionInput.for_action/4`, or `Ash.Changeset.for_*`. This means you can set things
like the tenant/actor. These will be retained, and provided again when `Form.submit/3` is called.

### Nested Form Options - AshPhoenix.Form.for_action/3 (function)

* `:type` - The cardinality of the nested form - `:list` or `:single`. Valid values are :list, :single The default value is `:single`.

* `:sparse?` (`t:boolean/0`) - If the nested form is `sparse`, the form won't expect all inputs for all forms to be present.  
  Has no effect if the type is `:single`.  
  Normally, if you leave some forms out of a list of nested forms, they are removed from the parameters
  passed to the action. For example, if you had a `post` with two comments `[%Comment{id: 1}, %Comment{id: 2}]`
  and you passed down params like `comments[0][id]=1&comments[1][text]=new_text`, we would remove the second comment
  from the input parameters, resulting in the following being passed into the action: `%{"comments" => [%{"id" => 1, "text" => "new"}]}`.
  By setting it to sparse, you have to explicitly use `remove_form` for that removal to happen. So in the same scenario above, the parameters
  that would be sent would actually be `%{"comments" => [%{"id" => 1, "text" => "new"}, %{"id" => 2}]}`.  
  One major difference with `sparse?` is that the form actually ignores the *index* provided, e.g `comments[0]...`, and instead uses the primary
  key e.g `comments[0][id]` to match which form is being updated. This prevents you from having to find the index of the specific item you want to
  update. Which could be very gnarly on deeply nested forms. If there is no primary key, or the primary key does not match anything, it is treated
  as a new form.  
  REMEMBER: You need to use `Phoenix.Components.inputs_for` to render the nested forms, or manually add hidden inputs using
  `hidden_inputs_for` (or `HiddenInputs` if using Surface) for the id to be automatically placed into the form.

* `:forms` (`t:keyword/0`) - Forms nested inside the current nesting level in all cases.

* `:for_type` - What action types the form applies for. Leave blank for it to apply to all action types. Valid values are :read, :create, :update

* `:merge?` (`t:boolean/0`) - When building parameters, this input will be merged with its parent input. This allows for combining multiple forms into a single input. The default value is `false`.

* `:for` (`t:atom/0`) - When creating parameters for the action, the key that the forms should be gathered into. Defaults to the key used to configure the nested form. Ignored if `merge?` is `true`.

* `:resource` (`t:atom/0`) - The resource of the nested forms. Unnecessary if you are providing the `data` key, and not adding additional forms to this path.

* `:create_action` (`t:atom/0`) - The create action to use when building new forms. Only necessary if you want to use `add_form/3` with this path.

* `:update_action` (`t:atom/0`) - The update action to use when building forms for data. Only necessary if you supply the `data` key.

* `:data` (`t:term/0`) - The current value or values that should have update forms built by default.  
  You can also provide a single argument function that will return the data based on the
  data of the parent form. This is important for multiple nesting levels of `:list` type
  forms, because the data depends on which parent is being rendered.

### AshPhoenix.Form.for_create/3 (function)

Creates a form corresponding to a create action on a resource.

### Options - AshPhoenix.Form.for_create/3 (function)

Options not listed below are passed to the underlying call to build the changeset/query, i.e `Ash.Changeset.for_create/4`

* `:actor` (`t:term/0`) - The actor performing the action. Passed through to the underlying action.

* `:forms` (`t:keyword/0`) - Nested form configurations. See `for_create/3` "Nested Form Options" docs for more.

* `:warn_on_unhandled_errors?` (`t:boolean/0`) - Warns on any errors that don't match the form pattern of `{:field, "message", [replacement: :vars]}` or implement the `AshPhoenix.FormData.Error` protocol. The default value is `true`.

* `:domain` (`t:atom/0`) - The domain to use when calling the action.

* `:as` (`t:String.t/0`) - The name of the form in the submitted params. You will need to pull the form params out using this key. The default value is `"form"`.

* `:id` (`t:String.t/0`) - The html id of the form. Defaults to the value of `:as` if provided, otherwise "form"

* `:transform_errors` - Allows for manual manipulation and transformation of errors.  
  If possible, try to implement `AshPhoenix.FormData.Error` for the error (if it as a custom one, for example).
  If that isn't possible, you can provide this function which will get the changeset and the error, and should
  return a list of ash phoenix formatted errors, e.g `[{field :: atom, message :: String.t(), substituations :: Keyword.t()}]`  
  Example:  
  AshPhoenix.Form.for_create(..., transform_errors: fn
    %{field: :field1} = error ->
      %{error | field: :field2}  
    error ->
      error
  end

* `:prepare_source` - A 1-argument function the receives the initial changeset (or query) and makes any relevant changes to it.
  This can be used to do things like:  
  * Set default argument values before the validations are run using `Ash.Changeset.set_arguments/2` or `Ash.Changeset.set_argument/3`
  * Set changeset context
  * Do any other pre-processing on the changeset

* `:prepare_params` - A 2-argument function that receives the params map and the :validate atom and should return prepared params.
  Called before the form is validated.

* `:transform_params` - A function for post-processing the form parameters before they are used for changeset validation/submission.
  Use a 3-argument function to pattern match on the `AshPhoenix.Form` struct.

* `:method` (`t:String.t/0`) - The http method to associate with the form. Defaults to `post` for creates, and `put` for everything else.

* `:exclude_fields_if_empty` - These fields will be ignored if they are empty strings.  
  This list of fields supports dead view forms. When a form is submitted from dead view
  empty fields are submitted as empty strings. This is problematic for fields that allow_nil
  or those that have default values.

* `:tenant` (`t:term/0`) - The current tenant. Passed through to the underlying action.

* `:params` (`t:term/0`) - The initial parameters to use for the form. This is useful for setting up a form with default values. The default value is `%{}`.

### Nested Form Options - AshPhoenix.Form.for_create/3 (function)

`AshPhoenix.Form` automatically determines the nested forms available based on an action's usage of
`change manage_relationship(...)`. See the [Related Forms](/documentation/topics/nested-forms.md)
for more.

* `:type` - The cardinality of the nested form - `:list` or `:single`. Valid values are :list, :single The default value is `:single`.

* `:sparse?` (`t:boolean/0`) - If the nested form is `sparse`, the form won't expect all inputs for all forms to be present.  
  Has no effect if the type is `:single`.  
  Normally, if you leave some forms out of a list of nested forms, they are removed from the parameters
  passed to the action. For example, if you had a `post` with two comments `[%Comment{id: 1}, %Comment{id: 2}]`
  and you passed down params like `comments[0][id]=1&comments[1][text]=new_text`, we would remove the second comment
  from the input parameters, resulting in the following being passed into the action: `%{"comments" => [%{"id" => 1, "text" => "new"}]}`.
  By setting it to sparse, you have to explicitly use `remove_form` for that removal to happen. So in the same scenario above, the parameters
  that would be sent would actually be `%{"comments" => [%{"id" => 1, "text" => "new"}, %{"id" => 2}]}`.  
  One major difference with `sparse?` is that the form actually ignores the *index* provided, e.g `comments[0]...`, and instead uses the primary
  key e.g `comments[0][id]` to match which form is being updated. This prevents you from having to find the index of the specific item you want to
  update. Which could be very gnarly on deeply nested forms. If there is no primary key, or the primary key does not match anything, it is treated
  as a new form.  
  REMEMBER: You need to use `Phoenix.Components.inputs_for` to render the nested forms, or manually add hidden inputs using
  `hidden_inputs_for` (or `HiddenInputs` if using Surface) for the id to be automatically placed into the form.

* `:forms` (`t:keyword/0`) - Forms nested inside the current nesting level in all cases.

* `:for_type` - What action types the form applies for. Leave blank for it to apply to all action types. Valid values are :read, :create, :update

* `:merge?` (`t:boolean/0`) - When building parameters, this input will be merged with its parent input. This allows for combining multiple forms into a single input. The default value is `false`.

* `:for` (`t:atom/0`) - When creating parameters for the action, the key that the forms should be gathered into. Defaults to the key used to configure the nested form. Ignored if `merge?` is `true`.

* `:resource` (`t:atom/0`) - The resource of the nested forms. Unnecessary if you are providing the `data` key, and not adding additional forms to this path.

* `:create_action` (`t:atom/0`) - The create action to use when building new forms. Only necessary if you want to use `add_form/3` with this path.

* `:update_action` (`t:atom/0`) - The update action to use when building forms for data. Only necessary if you supply the `data` key.

* `:data` (`t:term/0`) - The current value or values that should have update forms built by default.  
  You can also provide a single argument function that will return the data based on the
  data of the parent form. This is important for multiple nesting levels of `:list` type
  forms, because the data depends on which parent is being rendered.

### AshPhoenix.Form.for_destroy/3 (function)

Creates a form corresponding to a destroy action on a record.

Options:
* `:actor` (`t:term/0`) - The actor performing the action. Passed through to the underlying action.

* `:forms` (`t:keyword/0`) - Nested form configurations. See `for_create/3` "Nested Form Options" docs for more.

* `:warn_on_unhandled_errors?` (`t:boolean/0`) - Warns on any errors that don't match the form pattern of `{:field, "message", [replacement: :vars]}` or implement the `AshPhoenix.FormData.Error` protocol. The default value is `true`.

* `:domain` (`t:atom/0`) - The domain to use when calling the action.

* `:as` (`t:String.t/0`) - The name of the form in the submitted params. You will need to pull the form params out using this key. The default value is `"form"`.

* `:id` (`t:String.t/0`) - The html id of the form. Defaults to the value of `:as` if provided, otherwise "form"

* `:transform_errors` - Allows for manual manipulation and transformation of errors.  
  If possible, try to implement `AshPhoenix.FormData.Error` for the error (if it as a custom one, for example).
  If that isn't possible, you can provide this function which will get the changeset and the error, and should
  return a list of ash phoenix formatted errors, e.g `[{field :: atom, message :: String.t(), substituations :: Keyword.t()}]`  
  Example:  
  AshPhoenix.Form.for_create(..., transform_errors: fn
    %{field: :field1} = error ->
      %{error | field: :field2}  
    error ->
      error
  end

* `:prepare_source` - A 1-argument function the receives the initial changeset (or query) and makes any relevant changes to it.
  This can be used to do things like:  
  * Set default argument values before the validations are run using `Ash.Changeset.set_arguments/2` or `Ash.Changeset.set_argument/3`
  * Set changeset context
  * Do any other pre-processing on the changeset

* `:prepare_params` - A 2-argument function that receives the params map and the :validate atom and should return prepared params.
  Called before the form is validated.

* `:transform_params` - A function for post-processing the form parameters before they are used for changeset validation/submission.
  Use a 3-argument function to pattern match on the `AshPhoenix.Form` struct.

* `:method` (`t:String.t/0`) - The http method to associate with the form. Defaults to `post` for creates, and `put` for everything else.

* `:exclude_fields_if_empty` - These fields will be ignored if they are empty strings.  
  This list of fields supports dead view forms. When a form is submitted from dead view
  empty fields are submitted as empty strings. This is problematic for fields that allow_nil
  or those that have default values.

* `:tenant` (`t:term/0`) - The current tenant. Passed through to the underlying action.

* `:params` (`t:term/0`) - The initial parameters to use for the form. This is useful for setting up a form with default values. The default value is `%{}`.



Any *additional* options will be passed to the underlying call to `Ash.Changeset.for_destroy/4`. This means
you can set things like the tenant/actor. These will be retained, and provided again when `Form.submit/3` is called.

### Nested Form Options - AshPhoenix.Form.for_destroy/3 (function)

`AshPhoenix.Form` automatically determines the nested forms available based on an action's usage of
`change manage_relationship(...)`. See the [Related Forms](/documentation/topics/nested-forms.md)
for more.

* `:type` - The cardinality of the nested form - `:list` or `:single`. Valid values are :list, :single The default value is `:single`.

* `:sparse?` (`t:boolean/0`) - If the nested form is `sparse`, the form won't expect all inputs for all forms to be present.  
  Has no effect if the type is `:single`.  
  Normally, if you leave some forms out of a list of nested forms, they are removed from the parameters
  passed to the action. For example, if you had a `post` with two comments `[%Comment{id: 1}, %Comment{id: 2}]`
  and you passed down params like `comments[0][id]=1&comments[1][text]=new_text`, we would remove the second comment
  from the input parameters, resulting in the following being passed into the action: `%{"comments" => [%{"id" => 1, "text" => "new"}]}`.
  By setting it to sparse, you have to explicitly use `remove_form` for that removal to happen. So in the same scenario above, the parameters
  that would be sent would actually be `%{"comments" => [%{"id" => 1, "text" => "new"}, %{"id" => 2}]}`.  
  One major difference with `sparse?` is that the form actually ignores the *index* provided, e.g `comments[0]...`, and instead uses the primary
  key e.g `comments[0][id]` to match which form is being updated. This prevents you from having to find the index of the specific item you want to
  update. Which could be very gnarly on deeply nested forms. If there is no primary key, or the primary key does not match anything, it is treated
  as a new form.  
  REMEMBER: You need to use `Phoenix.Components.inputs_for` to render the nested forms, or manually add hidden inputs using
  `hidden_inputs_for` (or `HiddenInputs` if using Surface) for the id to be automatically placed into the form.

* `:forms` (`t:keyword/0`) - Forms nested inside the current nesting level in all cases.

* `:for_type` - What action types the form applies for. Leave blank for it to apply to all action types. Valid values are :read, :create, :update

* `:merge?` (`t:boolean/0`) - When building parameters, this input will be merged with its parent input. This allows for combining multiple forms into a single input. The default value is `false`.

* `:for` (`t:atom/0`) - When creating parameters for the action, the key that the forms should be gathered into. Defaults to the key used to configure the nested form. Ignored if `merge?` is `true`.

* `:resource` (`t:atom/0`) - The resource of the nested forms. Unnecessary if you are providing the `data` key, and not adding additional forms to this path.

* `:create_action` (`t:atom/0`) - The create action to use when building new forms. Only necessary if you want to use `add_form/3` with this path.

* `:update_action` (`t:atom/0`) - The update action to use when building forms for data. Only necessary if you supply the `data` key.

* `:data` (`t:term/0`) - The current value or values that should have update forms built by default.  
  You can also provide a single argument function that will return the data based on the
  data of the parent form. This is important for multiple nesting levels of `:list` type
  forms, because the data depends on which parent is being rendered.

### AshPhoenix.Form.for_read/3 (function)

Creates a form corresponding to a read action on a resource.

Options:
* `:actor` (`t:term/0`) - The actor performing the action. Passed through to the underlying action.

* `:forms` (`t:keyword/0`) - Nested form configurations. See `for_create/3` "Nested Form Options" docs for more.

* `:warn_on_unhandled_errors?` (`t:boolean/0`) - Warns on any errors that don't match the form pattern of `{:field, "message", [replacement: :vars]}` or implement the `AshPhoenix.FormData.Error` protocol. The default value is `true`.

* `:domain` (`t:atom/0`) - The domain to use when calling the action.

* `:as` (`t:String.t/0`) - The name of the form in the submitted params. You will need to pull the form params out using this key. The default value is `"form"`.

* `:id` (`t:String.t/0`) - The html id of the form. Defaults to the value of `:as` if provided, otherwise "form"

* `:transform_errors` - Allows for manual manipulation and transformation of errors.  
  If possible, try to implement `AshPhoenix.FormData.Error` for the error (if it as a custom one, for example).
  If that isn't possible, you can provide this function which will get the changeset and the error, and should
  return a list of ash phoenix formatted errors, e.g `[{field :: atom, message :: String.t(), substituations :: Keyword.t()}]`  
  Example:  
  AshPhoenix.Form.for_create(..., transform_errors: fn
    %{field: :field1} = error ->
      %{error | field: :field2}  
    error ->
      error
  end

* `:prepare_source` - A 1-argument function the receives the initial changeset (or query) and makes any relevant changes to it.
  This can be used to do things like:  
  * Set default argument values before the validations are run using `Ash.Changeset.set_arguments/2` or `Ash.Changeset.set_argument/3`
  * Set changeset context
  * Do any other pre-processing on the changeset

* `:prepare_params` - A 2-argument function that receives the params map and the :validate atom and should return prepared params.
  Called before the form is validated.

* `:transform_params` - A function for post-processing the form parameters before they are used for changeset validation/submission.
  Use a 3-argument function to pattern match on the `AshPhoenix.Form` struct.

* `:method` (`t:String.t/0`) - The http method to associate with the form. Defaults to `post` for creates, and `put` for everything else.

* `:exclude_fields_if_empty` - These fields will be ignored if they are empty strings.  
  This list of fields supports dead view forms. When a form is submitted from dead view
  empty fields are submitted as empty strings. This is problematic for fields that allow_nil
  or those that have default values.

* `:tenant` (`t:term/0`) - The current tenant. Passed through to the underlying action.

* `:params` (`t:term/0`) - The initial parameters to use for the form. This is useful for setting up a form with default values. The default value is `%{}`.



Any *additional* options will be passed to the underlying call to `Ash.Query.for_read/4`. This means
you can set things like the tenant/actor. These will be retained, and provided again when `Form.submit/3` is called.

Keep in mind that the `source` of the form in this case is a query, not a changeset. This means that, very likely,
you would not want to use nested forms here. However, it could make sense if you had a query argument that was an
embedded resource, so the capability remains.

### Nested Form Options - AshPhoenix.Form.for_read/3 (function)

* `:type` - The cardinality of the nested form - `:list` or `:single`. Valid values are :list, :single The default value is `:single`.

* `:sparse?` (`t:boolean/0`) - If the nested form is `sparse`, the form won't expect all inputs for all forms to be present.  
  Has no effect if the type is `:single`.  
  Normally, if you leave some forms out of a list of nested forms, they are removed from the parameters
  passed to the action. For example, if you had a `post` with two comments `[%Comment{id: 1}, %Comment{id: 2}]`
  and you passed down params like `comments[0][id]=1&comments[1][text]=new_text`, we would remove the second comment
  from the input parameters, resulting in the following being passed into the action: `%{"comments" => [%{"id" => 1, "text" => "new"}]}`.
  By setting it to sparse, you have to explicitly use `remove_form` for that removal to happen. So in the same scenario above, the parameters
  that would be sent would actually be `%{"comments" => [%{"id" => 1, "text" => "new"}, %{"id" => 2}]}`.  
  One major difference with `sparse?` is that the form actually ignores the *index* provided, e.g `comments[0]...`, and instead uses the primary
  key e.g `comments[0][id]` to match which form is being updated. This prevents you from having to find the index of the specific item you want to
  update. Which could be very gnarly on deeply nested forms. If there is no primary key, or the primary key does not match anything, it is treated
  as a new form.  
  REMEMBER: You need to use `Phoenix.Components.inputs_for` to render the nested forms, or manually add hidden inputs using
  `hidden_inputs_for` (or `HiddenInputs` if using Surface) for the id to be automatically placed into the form.

* `:forms` (`t:keyword/0`) - Forms nested inside the current nesting level in all cases.

* `:for_type` - What action types the form applies for. Leave blank for it to apply to all action types. Valid values are :read, :create, :update

* `:merge?` (`t:boolean/0`) - When building parameters, this input will be merged with its parent input. This allows for combining multiple forms into a single input. The default value is `false`.

* `:for` (`t:atom/0`) - When creating parameters for the action, the key that the forms should be gathered into. Defaults to the key used to configure the nested form. Ignored if `merge?` is `true`.

* `:resource` (`t:atom/0`) - The resource of the nested forms. Unnecessary if you are providing the `data` key, and not adding additional forms to this path.

* `:create_action` (`t:atom/0`) - The create action to use when building new forms. Only necessary if you want to use `add_form/3` with this path.

* `:update_action` (`t:atom/0`) - The update action to use when building forms for data. Only necessary if you supply the `data` key.

* `:data` (`t:term/0`) - The current value or values that should have update forms built by default.  
  You can also provide a single argument function that will return the data based on the
  data of the parent form. This is important for multiple nesting levels of `:list` type
  forms, because the data depends on which parent is being rendered.

### AshPhoenix.Form.for_update/3 (function)

Creates a form corresponding to an update action on a record.

Options:
* `:actor` (`t:term/0`) - The actor performing the action. Passed through to the underlying action.

* `:forms` (`t:keyword/0`) - Nested form configurations. See `for_create/3` "Nested Form Options" docs for more.

* `:warn_on_unhandled_errors?` (`t:boolean/0`) - Warns on any errors that don't match the form pattern of `{:field, "message", [replacement: :vars]}` or implement the `AshPhoenix.FormData.Error` protocol. The default value is `true`.

* `:domain` (`t:atom/0`) - The domain to use when calling the action.

* `:as` (`t:String.t/0`) - The name of the form in the submitted params. You will need to pull the form params out using this key. The default value is `"form"`.

* `:id` (`t:String.t/0`) - The html id of the form. Defaults to the value of `:as` if provided, otherwise "form"

* `:transform_errors` - Allows for manual manipulation and transformation of errors.  
  If possible, try to implement `AshPhoenix.FormData.Error` for the error (if it as a custom one, for example).
  If that isn't possible, you can provide this function which will get the changeset and the error, and should
  return a list of ash phoenix formatted errors, e.g `[{field :: atom, message :: String.t(), substituations :: Keyword.t()}]`  
  Example:  
  AshPhoenix.Form.for_create(..., transform_errors: fn
    %{field: :field1} = error ->
      %{error | field: :field2}  
    error ->
      error
  end

* `:prepare_source` - A 1-argument function the receives the initial changeset (or query) and makes any relevant changes to it.
  This can be used to do things like:  
  * Set default argument values before the validations are run using `Ash.Changeset.set_arguments/2` or `Ash.Changeset.set_argument/3`
  * Set changeset context
  * Do any other pre-processing on the changeset

* `:prepare_params` - A 2-argument function that receives the params map and the :validate atom and should return prepared params.
  Called before the form is validated.

* `:transform_params` - A function for post-processing the form parameters before they are used for changeset validation/submission.
  Use a 3-argument function to pattern match on the `AshPhoenix.Form` struct.

* `:method` (`t:String.t/0`) - The http method to associate with the form. Defaults to `post` for creates, and `put` for everything else.

* `:exclude_fields_if_empty` - These fields will be ignored if they are empty strings.  
  This list of fields supports dead view forms. When a form is submitted from dead view
  empty fields are submitted as empty strings. This is problematic for fields that allow_nil
  or those that have default values.

* `:tenant` (`t:term/0`) - The current tenant. Passed through to the underlying action.

* `:params` (`t:term/0`) - The initial parameters to use for the form. This is useful for setting up a form with default values. The default value is `%{}`.



Any *additional* options will be passed to the underlying call to `Ash.Changeset.for_update/4`. This means
you can set things like the tenant/actor. These will be retained, and provided again when `Form.submit/3` is called.

### Nested Form Options - AshPhoenix.Form.for_update/3 (function)

`AshPhoenix.Form` automatically determines the nested forms available based on an action's usage of
`change manage_relationship(...)`. See the [Related Forms](/documentation/topics/nested-forms.md)
for more.

* `:type` - The cardinality of the nested form - `:list` or `:single`. Valid values are :list, :single The default value is `:single`.

* `:sparse?` (`t:boolean/0`) - If the nested form is `sparse`, the form won't expect all inputs for all forms to be present.  
  Has no effect if the type is `:single`.  
  Normally, if you leave some forms out of a list of nested forms, they are removed from the parameters
  passed to the action. For example, if you had a `post` with two comments `[%Comment{id: 1}, %Comment{id: 2}]`
  and you passed down params like `comments[0][id]=1&comments[1][text]=new_text`, we would remove the second comment
  from the input parameters, resulting in the following being passed into the action: `%{"comments" => [%{"id" => 1, "text" => "new"}]}`.
  By setting it to sparse, you have to explicitly use `remove_form` for that removal to happen. So in the same scenario above, the parameters
  that would be sent would actually be `%{"comments" => [%{"id" => 1, "text" => "new"}, %{"id" => 2}]}`.  
  One major difference with `sparse?` is that the form actually ignores the *index* provided, e.g `comments[0]...`, and instead uses the primary
  key e.g `comments[0][id]` to match which form is being updated. This prevents you from having to find the index of the specific item you want to
  update. Which could be very gnarly on deeply nested forms. If there is no primary key, or the primary key does not match anything, it is treated
  as a new form.  
  REMEMBER: You need to use `Phoenix.Components.inputs_for` to render the nested forms, or manually add hidden inputs using
  `hidden_inputs_for` (or `HiddenInputs` if using Surface) for the id to be automatically placed into the form.

* `:forms` (`t:keyword/0`) - Forms nested inside the current nesting level in all cases.

* `:for_type` - What action types the form applies for. Leave blank for it to apply to all action types. Valid values are :read, :create, :update

* `:merge?` (`t:boolean/0`) - When building parameters, this input will be merged with its parent input. This allows for combining multiple forms into a single input. The default value is `false`.

* `:for` (`t:atom/0`) - When creating parameters for the action, the key that the forms should be gathered into. Defaults to the key used to configure the nested form. Ignored if `merge?` is `true`.

* `:resource` (`t:atom/0`) - The resource of the nested forms. Unnecessary if you are providing the `data` key, and not adding additional forms to this path.

* `:create_action` (`t:atom/0`) - The create action to use when building new forms. Only necessary if you want to use `add_form/3` with this path.

* `:update_action` (`t:atom/0`) - The update action to use when building forms for data. Only necessary if you supply the `data` key.

* `:data` (`t:term/0`) - The current value or values that should have update forms built by default.  
  You can also provide a single argument function that will return the data based on the
  data of the parent form. This is important for multiple nesting levels of `:list` type
  forms, because the data depends on which parent is being rendered.

### AshPhoenix.Form.get_form/2 (function)

Gets the form at the specified path

### AshPhoenix.Form.has_form?/2 (function)

Returns true if a given form path exists in the form

### AshPhoenix.Form.hidden_fields/1 (function)

Returns the hidden fields for a form as a keyword list

### AshPhoenix.Form.ignore/1 (function)

Toggles the form to be ignored or not ignored.

To set this manually in an html form, use the field `:_ignored` and set it
to the string "true". Any other value will not result in the form being ignored.

### AshPhoenix.Form.ignored?/1 (function)

Returns true if the form is ignored

### AshPhoenix.Form.merge_options/2 (function)

Merge the new options with the saved options on a form. See `update_options/2` for more.

### AshPhoenix.Form.params/2 (function)

Returns the parameters from the form that would be submitted to the action.

This can be useful if you want to get the parameters and manipulate them/build a custom changeset
afterwards.

### AshPhoenix.Form.parse_path!/3 (function)

A utility for parsing paths of nested forms in query encoded format.

For example:

```elixir
parse_path!(form, "post[comments][0][sub_comments][0])

[:comments, 0, :sub_comments, 0]
```

### AshPhoenix.Form.path/0 (type)



### AshPhoenix.Form.remove_form/3 (function)

Removes a form at the provided path.

See `add_form/3` for more information on the `path` argument.

If you are not using liveview, and you want to support removing forms that were created based on the `data`
option from the browser, you'll need to include in the form submission a custom list of strings to remove, and
then manually iterate over them in your controller, for example:

```elixir
Enum.reduce(removed_form_paths, form, &AshPhoenix.Form.remove_form(&2, &1))
```

* `:validate?` (`t:boolean/0`) - Validates the new full form. The default value is `true`.

* `:validate_opts` (`t:term/0`) - Options to pass to `validate`. Only used if `validate?` is set to `true` (the default) The default value is `[]`.

### AshPhoenix.Form.set_data/2 (function)

Sets the data of the form, in addition to the data of the underlying source, if applicable.

Queries do not track data (because that wouldn't make sense), so this will not update the data
for read actions

### AshPhoenix.Form.sort_forms/3 (function)

This function sorts nested forms at the specified path.

The path can either be an attribute, e.g. [:comments] (for changing the entire order) or an attribute with an index,
like `[:comments, 2]` (used for incrementing or decrementing).

You can provide the following instructions:
- `[0, 1, 2]`: indices in the new order (they can be either strings or integers).
- `:increment`: increment the index of a specific form, swapping it with the next form.
- `:decrement`: decrement the index of a specific form, swapping it with the previous form.

### AshPhoenix.Form.source/0 (type)



### AshPhoenix.Form.submit/2 (function)

Submits the form.

If the submission returns an error, the resulting form can be rerendered. Any nested
errors will be passed down to the corresponding form for that input.

Options:

* `:force?` (`t:boolean/0`) - Submit the form even if it is invalid in its current state. The default value is `false`.

* `:action_opts` (`t:keyword/0`) - Opts to pass to the call to Ash when calling the action. The default value is `[]`.

* `:errors` (`t:boolean/0`) - Wether or not to show errors after submitting. The default value is `true`.

* `:override_params` (`t:term/0`) - If specified, then the params are not extracted from the form.  
  How this different from `params`: providing `params` is simply results in calling `validate(form, params)` before proceeding.
  The values that are passed into the action are then extracted from the form using `params/2`. With `override_params`, the form
  is not validated again, and the `override_params` are passed directly into the action.

* `:params` (`t:term/0`) - If specified, `validate/3` is called with the new params before submitting the form.  
  This is a shortcut to avoid needing to explicitly validate before every submit.  
  For example:  
  ```elixir
  form
  |> AshPhoenix.Form.validate(params)
  |> AshPhoenix.Form.submit()
  ```  
  Is the same as:  
  ```elixir
  form
  |> AshPhoenix.Form.submit(params: params)
  ```

* `:read_one?` (`t:boolean/0`) - If submitting a read form, a single result will be returned (via read_one) instead of a list of results.  
  Ignored for non-read forms. The default value is `false`.

* `:before_submit` (function of arity 1) - A function to apply to the source (changeset or query) just before submitting the action. Must return the modified changeset.

### AshPhoenix.Form.submit!/2 (function)

Same as `submit/2`, but raises an error if the submission fails.

### AshPhoenix.Form.t/0 (type)



### AshPhoenix.Form.touch/2 (function)

Mark a field or fields as touched

To mark nested fields as touched use with `update_form/4` or `update_forms_at_path/4`

### AshPhoenix.Form.update_form/4 (function)

Updates the form at the provided path using the given function.

Marks all forms along the path as touched by default. To prevent it, provide `mark_as_touched?: false`.

This can be useful if you have a button that should modify a nested form in some way, for example.

### AshPhoenix.Form.update_forms_at_path/4 (function)

Updates the list of forms matching a given path. Does not validate that the path points at a single form like `update_form/4`.

Additionally, if it gets to a list of child forms and the next part of the path is not an integer,
it will update all of the forms at that path.

### AshPhoenix.Form.update_options/2 (function)

Update the saved options on a form.

When a form is created, options like `actor` and `authorize?` are stored in the `opts` key.
If you have a case where these options change over time, for example a select box that determines the actor, use this function to override those opts.

You may want to validate again after this has been changed if it can change the results of your form validation.

### AshPhoenix.Form.update_params/3 (function)

Update the previous params provided to the form, and revalidate.

Accepts the same options as `validate/2`, passing them through directly.

You should prefer to use `validate/2` when you have all of the params from the form.
This is meant for cases when some event has occured that should modify the params,
not as a replacement for `validate/2`.

This can be useful for things like customized inputs or buttons, that have special
handlers in your live view. For example, if you have an appointment that expresses
a list of available times in the UI, but the action just takes a single `time` argument,
you can make each available time a button, like so:

```heex
<.button phx-click="time-selected" phx-value-time="<%= time %>" />
```

and then have an event handler like this:

```elixir
def handle_event("time-selected", %{"time" => time}, socket) do
  form = AshPhoenix.Form.update_params(socket.assigns.form, &Map.put(&1, "time", time))
  {:noreply, assign(socket, :form, form)}
end
```

### AshPhoenix.Form.validate/3 (function)

Validates the parameters against the form.

Options:

* `:errors` (`t:boolean/0`) - Set to false to hide errors after validation. The default value is `true`.

* `:target` (list of `t:String.t/0`) - The `_target` param provided by phoenix. Used to support the `only_touched?` option.

* `:only_touched?` (`t:boolean/0`) - If set to true, only fields that have been marked as touched will be used  
  If you use this for validation you likely want to use it when submitting as well. The default value is `false`.

### AshPhoenix.Form.value/2 (function)

Gets the value for a given field in the form.

### AshPhoenix.Form.Auto (module)

A tool to automatically generate available nested forms based on a resource and action.

To use this, specify `forms: [auto?: true]` when creating the form.

Keep in mind, you can always specify these manually when creating a form by simply specifying the `forms` option.

There are two things that this builds forms for:

1. Attributes/arguments who's type is an embedded resource.
2. Arguments that have a corresponding `change manage_relationship(..)` configured.

For more on relationships see the documentation for `Ash.Changeset.manage_relationship/4`.

When building forms, you can switch on the action type and/or resource of the form, in order to have different
fields depending on the form. For example, if you have a simple relationship called `:comments` with
`on_match: :update` and `on_no_match: :create`, there are two types of forms that can be in `inputs_for(form, :comments)`.

In which case you may have something like this:

```elixir
<%= for comment_form <- inputs_for(f, :comments) do %>
  <%= hidden_inputs_for(comment_form) %>
  <%= if comment_form.source.type == :create do %>
    <%= text_input comment_form, :text %>
    <%= text_input comment_form, :on_create_field %>
  <% else %>
    <%= text_input comment_form, :text %>
    <%= text_input comment_form, :on_update_field %>
  <% end %>

   Remove Comment 
   Add Comment 
<% end %>
```

This also applies to adding forms of different types manually. For instance, if you had a "search" field
to allow them to search for a record (e.g in a liveview), and you had an `on_lookup` read action, you could
render a search form for that read action, and once they've selected a record, you could render the fields
to update that record (in the case of `on_lookup: :relate_and_update` configurations).

### Options - AshPhoenix.Form.Auto (module)

* `:relationship_fetcher` (`t:term/0`) - A two argument function that receives the parent data, the relationship to fetch.
  The default simply fetches the relationship value, and if it isn't loaded, it uses `[]` or `nil`.

* `:sparse_lists?` (`t:boolean/0`) - Sets all list type forms to `sparse?: true` by default. Has no effect on forms derived for embedded resources. The default value is `false`.

* `:include_non_map_types?` (`t:boolean/0`) - Creates form for non map or array of map type inputs The default value is `false`.

### Special Considerations - AshPhoenix.Form.Auto (module)

### `on_lookup: :relate_and_update`

For `on_lookup: :relate_and_update` configurations, the "read" form for that relationship will use the appropriate read action.
However, you may also want to include the relevant fields for the update that would subsequently occur. To that end, a special
nested form called `:_update` is created, that uses an empty instance of that resource as the base of its changeset. This may require
some manual manipulation of that data before rendering the relevant form because it assumes all the default values. To solve for this,
if you are using liveview, you could actually look up the record using the input from the read action, and then use `AshPhoenix.Form.update_form/3`
to set that looked up record as the data of the `_update` form.

### Many to Many Relationships - AshPhoenix.Form.Auto (module)

In the case that a manage_change option points to a join relationship, that form is presented via a special nested form called
`_join`. So the first form in `inputs_for(form, :relationship)` would be for the destination, and then inside of that you could say
`inputs_for(nested_form, :_join)`. The parameters are merged together during submission.

### AshPhoenix.Form.Auto.auto/3 (function)



### AshPhoenix.Form.Auto.embedded/3 (function)



### AshPhoenix.Form.Auto.related/3 (function)



### AshPhoenix.Form.Auto.unions/3 (function)



### AshPhoenix.Form.WrappedValue (module)

A sentinal value used when editing a union that has non-map values

### AshPhoenix.Form.WrappedValue.apply_constraints_array/2 (function)



### AshPhoenix.Form.WrappedValue.cast_input/2 (function)



### AshPhoenix.Form.WrappedValue.cast_stored/2 (function)



### AshPhoenix.Form.WrappedValue.check_atomic/2 (function)



### AshPhoenix.Form.WrappedValue.default_short_name/0 (function)



### AshPhoenix.Form.WrappedValue.dump_to_native/2 (function)



### AshPhoenix.Form.WrappedValue.fetch_key/2 (function)



### AshPhoenix.Form.WrappedValue.get_rewrites/4 (function)



### AshPhoenix.Form.WrappedValue.handle_change/3 (function)



### AshPhoenix.Form.WrappedValue.handle_change?/0 (function)



### AshPhoenix.Form.WrappedValue.handle_change_array/3 (function)



### AshPhoenix.Form.WrappedValue.input/1 (function)

Validates that the keys in the provided input are valid for at least one action on the resource.

Raises a KeyError error at compile time if not. This exists because generally a struct should only ever
be created by Ash as a result of a successful action. You should not be creating records manually in code,
e.g `%MyResource{value: 1, value: 2}`. Generally that is fine, but often with embedded resources it is nice
to be able to validate the keys that are being provided, e.g

```elixir
Resource
|> Ash.Changeset.for_create(:create, %{embedded: EmbeddedResource.input(foo: 1, bar: 2)})
|> Ash.create()
```

### AshPhoenix.Form.WrappedValue.input/2 (function)

Same as `input/1`, except restricts the keys to values accepted by the action provided.

### AshPhoenix.Form.WrappedValue.load/4 (function)



### AshPhoenix.Form.WrappedValue.prepare_change/3 (function)



### AshPhoenix.Form.WrappedValue.prepare_change?/0 (function)



### AshPhoenix.Form.WrappedValue.prepare_change_array/3 (function)



### AshPhoenix.Form.WrappedValue.rewrite/3 (function)



### AshPhoenix.Form.WrappedValue.storage_type/1 (function)



### AshPhoenix.Form.WrappedValue.t/0 (type)



### AshPhoenix.FormData.Error (protocol)

A protocol for allowing errors to be rendered into a form.

To implement, define a `to_form_error/1` and return a single error or list of errors of the following shape:

`{:field_name, message, replacements}`

Replacements is a keyword list to allow for translations, by extracting out the constants like numbers from the message.

### AshPhoenix.FormData.Error.t/0 (type)

All the types that implement this protocol.

### AshPhoenix.FormData.Error.to_form_error/1 (function)



### AshPhoenix.FilterForm (module)

A module to help you create complex forms that generate Ash filters.

```elixir
# Create a FilterForm
filter_form = AshPhoenix.FilterForm.new(MyApp.Payroll.Employee)
```

FilterForm's comprise 2 concepts, predicates and groups. Predicates are the simple boolean
expressions you can use to build a query (`name == "Joe"`), and groups can be used to group
predicates and more groups together. Groups can apply `and` or `or` operators to its nested
components.

```elixir
# Add a predicate to the root of the form (which is itself a group)
filter_form = AshPhoenix.FilterForm.add_predicate(filter_form, :some_field, :eq, "Some Value")

# Add a group and another predicate to that group
{filter_form, group_id} = AshPhoenix.FilterForm.add_group(filter_form, operator: :or, return_id?: true)
filter_form = AshPhoenix.FilterForm.add_predicate(filter_form, :another, :eq, "Other", to: group_id)
```

`validate/1` is used to merge the submitted form params into the filter form, and one of the
provided filter functions to apply the filter as a query, or generate an expression map,
depending on your requirements:

```elixir
filter_form = AshPhoenix.FilterForm.validate(socket.assigns.filter_form, params)

# Generate a query and pass it to the Domain
query = AshPhoenix.FilterForm.filter!(MyApp.Payroll.Employee, filter_form)
filtered_employees = MyApp.Payroll.read!(query)

# Or use one of the other filter functions
AshPhoenix.FilterForm.to_filter_expression(filter_form)
AshPhoenix.FilterForm.to_filter_map(filter_form)
```

### LiveView Example - AshPhoenix.FilterForm (module)

You can build a form and handle adding and removing nested groups and predicates with the following:

```elixir
alias MyApp.Payroll.Employee

@impl true
def render(assigns) do
  ~H"""
  <.simple_form
    :let={filter_form}
    for={@filter_form}
    phx-change="filter_validate"
    phx-submit="filter_submit"
  >
    <.filter_form_component component={filter_form} />
    <:actions>
      <.button>Submit</.button>
    </:actions>
  </.simple_form>
  <.table id="employees" rows={@employees}>
    <:col :let={employee} label="Payroll ID"><%= employee.employee_id %></:col>
    <:col :let={employee} label="Name"><%= employee.name %></:col>
    <:col :let={employee} label="Position"><%= employee.position %></:col>
  </.table>
  """
end

attr :component, :map, required: true, doc: "Could be a FilterForm (group) or a Predicate"

defp filter_form_component(%{component: %{source: %AshPhoenix.FilterForm{}}} = assigns) do
  ~H"""
   
     
       Filter 
       
        <.input type="select" field={@component[:operator]} options={["and", "or"]} />
        <.button phx-click="add_filter_group" phx-value-component-id={@component.source.id} type="button">
          Add Group
        </.button>
        <.button
          phx-click="add_filter_predicate"
          phx-value-component-id={@component.source.id}
          type="button"
        >
          Add Predicate
        </.button>
        <.button
          phx-click="remove_filter_component"
          phx-value-component-id={@component.source.id}
          type="button"
        >
          Remove Group
        </.button>
       
     
    <.inputs_for :let={component} field={@component[:components]}>
      <.filter_form_component component={component} />
    </.inputs_for>
   
  """
end

defp filter_form_component(
       %{component: %{source: %AshPhoenix.FilterForm.Predicate{}}} = assigns
     ) do
  ~H"""
   
    <.input
      type="select"
      options={AshPhoenix.FilterForm.fields(Employee)}
      field={@component[:field]}
    />
    <.input
      type="select"
      options={AshPhoenix.FilterForm.predicates(Employee)}
      field={@component[:operator]}
    />
    <.input field={@component[:value]} />
    <.button
      phx-click="remove_filter_component"
      phx-value-component-id={@component.source.id}
      type="button"
    >
      Remove
    </.button>
   
  """
end

@impl true
def mount(_params, _session, socket) do
  socket =
    socket
    |> assign(:filter_form, AshPhoenix.FilterForm.new(Employee))
    |> assign(:employees, Employee.read_all!())

  {:ok, socket}
end

@impl true
def handle_event("filter_validate", %{"filter" => params}, socket) do
  {:noreply,
   assign(socket,
     filter_form: AshPhoenix.FilterForm.validate(socket.assigns.filter_form, params)
   )}
end

def handle_event("filter_submit", %{"filter" => params}, socket) do
  filter_form = AshPhoenix.FilterForm.validate(socket.assigns.filter_form, params)

  case AshPhoenix.FilterForm.filter(Employee, filter_form) do
    {:ok, query} ->
      {:noreply,
       socket
       |> assign(:employees, Employee.read_all!(query: query))
       |> assign(:filter_form, filter_form)}

    {:error, filter_form} ->
      {:noreply, assign(socket, filter_form: filter_form)}
  end
end

def handle_event("remove_filter_component", %{"component-id" => component_id}, socket) do
  {:noreply,
   assign(socket,
     filter_form:
       AshPhoenix.FilterForm.remove_component(socket.assigns.filter_form, component_id)
   )}
end

def handle_event("add_filter_group", %{"component-id" => component_id}, socket) do
  {:noreply,
   assign(socket,
     filter_form: AshPhoenix.FilterForm.add_group(socket.assigns.filter_form, to: component_id)
   )}
end

def handle_event("add_filter_predicate", %{"component-id" => component_id}, socket) do
  {:noreply,
   assign(socket,
     filter_form:
       AshPhoenix.FilterForm.add_predicate(socket.assigns.filter_form, :name, :contains, nil,
         to: component_id
       )
   )}
end
```

### AshPhoenix.FilterForm.add_group/2 (function)

Add a group to the filter. A group can contain predicates and other groups,
allowing you to build quite complex nested filters.

Options:

* `:to` (`t:String.t/0`) - The nested group id to add the group to.

* `:operator` - The operator that the group should have internally. Valid values are :and, :or The default value is `:and`.

* `:return_id?` (`t:boolean/0`) - If set to `true`, the function returns `{form, predicate_id}` The default value is `false`.

### AshPhoenix.FilterForm.add_predicate/5 (function)

Add a predicate to the filter.

Options:

* `:to` (`t:String.t/0`) - The group id to add the predicate to. If not set, will be added to the top level group.

* `:return_id?` (`t:boolean/0`) - If set to `true`, the function returns `{form, predicate_id}` The default value is `false`.

* `:path` - The relationship path to apply the predicate to

### AshPhoenix.FilterForm.errors/2 (function)

Returns a flat list of all errors on all predicates in the filter, made safe for display in a form.

Only errors that implement the `AshPhoenix.FormData.Error` protocol are displayed.

### AshPhoenix.FilterForm.fields/1 (function)

Returns the list of available fields, which may be attributes, calculations, or aggregates.

### AshPhoenix.FilterForm.filter/2 (function)

Converts the form into a filter, and filters the provided query or resource with that filter.

### AshPhoenix.FilterForm.filter!/2 (function)

Same as `filter/2` but raises on errors.

### AshPhoenix.FilterForm.new/2 (function)

Create a new filter form.

Options:
* `:params` (`t:term/0`) - Initial parameters to create the form with The default value is `%{}`.

* `:as` (`t:String.t/0`) - Set the parameter name for the form. The default value is `"filter"`.

* `:transform_errors` (`t:term/0`) - Allows for manual manipulation and transformation of errors.  
  If possible, try to implement `AshPhoenix.FormData.Error` for the error (if it as a custom one, for example).
  If that isn't possible, you can provide this function which will get the predicate and the error, and should
  return a list of ash phoenix formatted errors, e.g `[{field :: atom, message :: String.t(), substituations :: Keyword.t()}]`

* `:warn_on_unhandled_errors?` (`t:boolean/0`) - Whether or not to emit warning log on unhandled form errors The default value is `true`.

* `:remove_empty_groups?` (`t:boolean/0`) - If true (the default), then any time a group would be made empty by removing a group or predicate, it is removed instead.  
  An empty form can still be added, this only affects a group if its last component is removed. The default value is `false`.

### AshPhoenix.FilterForm.params_for_query/1 (function)

Returns the minimal set of params (at the moment just strips ids) for use in a query string.

### AshPhoenix.FilterForm.predicates/1 (function)

Returns the list of available predicates for the given resource, which may be functions or operators.

### AshPhoenix.FilterForm.raw_errors/1 (function)

Returns a flat list of all errors on all predicates in the filter, without transforming.

### AshPhoenix.FilterForm.remove_component/2 (function)

Removes the group *or* predicate with the given id

### AshPhoenix.FilterForm.remove_group/2 (function)

Remove the group with the given id

### AshPhoenix.FilterForm.remove_predicate/2 (function)

Remove the predicate with the given id

### AshPhoenix.FilterForm.to_filter!/1 (function)



### AshPhoenix.FilterForm.to_filter_expression/1 (function)

Returns a filter expression that can be provided to Ash.Query.filter/2

To add this to a query, remember to use `^`, for example:
```elixir
filter = AshPhoenix.FilterForm.to_filter_expression(form)

Ash.Query.filter(MyApp.Post, ^filter)
```

Alternatively, you can use the shorthand: `filter/2` to apply the expression directly to a query.

### AshPhoenix.FilterForm.to_filter_expression!/1 (function)

Same as `to_filter_expression/1` but raises on errors.

### AshPhoenix.FilterForm.to_filter_map/1 (function)

Returns a filter map that can be provided to `Ash.Filter.parse`

This allows for things like saving a stored filter. Does not currently support parameterizing calculations or functions.

### AshPhoenix.FilterForm.update_predicate/3 (function)

Update the predicate with the given id

### AshPhoenix.FilterForm.validate/3 (function)

Updates the filter with the provided input and validates it.

At present, no validation actually occurs, but this will eventually be added.

Passing `reset_on_change?: false` into `opts` will prevent predicates to reset
the `value` and `operator` fields to `nil` if the predicate `field` changes.

### AshPhoenix.FilterForm.Arguments (module)

Represents the arguments to a calculation being filtered on

### AshPhoenix.FilterForm.Arguments.errors/2 (function)



### AshPhoenix.FilterForm.Arguments.new/2 (function)



### AshPhoenix.FilterForm.Arguments.validate_arguments/2 (function)



### AshPhoenix.FilterForm.Predicate (module)

Represents an individual predicate appearing in a filter form.

Predicates are grouped up in an `AshPhoenix.FilterForm` to create boolean
filter statements.

### AshPhoenix.FilterForm.Predicate.errors/2 (function)



### AshPhoenix.Form.InvalidPath.message/1 (function)



### AshPhoenix.Form.NoActionConfigured.message/1 (function)



### AshPhoenix.Form.NoDataLoaded.message/1 (function)



### AshPhoenix.Form.NoFormConfigured.message/1 (function)



### AshPhoenix.Form.NoResourceConfigured.message/1 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_phoenix)# ash_slug

> An Ash extension for slugifying attributes of a resource.

## Docs

### AshSlug (module)

An extension for slugifying attributes on a resource.

### AshSlug.Changes (module)

Change functions for the `AshSlug` extension.

### AshSlug.Changes.slugify/2 (function)

Slugify a string attribute on a changeset.

### Options - AshSlug.Changes.slugify/2 (function)

* `:attribute` (`t:atom/0`) - Required. The attribute to slugify.

* `:into` (`t:atom/0`) - The attribute to store the slug in. Unless specified, the slug will be stored in the same attribute.

* `:lowercase?` (`t:boolean/0`) - Whether to lowercase the slug. The default value is `true`.

* `:separator` (`t:String.t/0`) - The separator to use between words in the slug. The default value is `"-"`.

* `:truncate` (`t:integer/0`) - Truncates the slug at this character length, shortened to the nearest word.

* `:ignore` (one or a list of `t:String.t/0`) - A string or list of strings of characters to ignore when slugifying. The default value is `[]`.

### Examples - AshSlug.Changes.slugify/2 (function)

change slugify(:text)
    change slugify(:text, into: :text_slug, lowercase?: false, ignore: [".", "!"])

### AshSlug.Info (module)

Introspection functions for the `AshSlug` extension.

## Links

- [Online documentation](https://hexdocs.pm/ash_slug)# ash_events

> The extension for tracking changes to your resources via a centralized event log, with replay functionality.

## Docs

### AshEvents.ClearRecordsForReplay (behaviour)

Behaviour for clearing records from the event log.

### AshEvents.ClearRecordsForReplay.clear_records!/1 (callback)



### AshEvents.CreateActionWrapper (module)

Wrapper for create actions that enables event tracking.

### AshEvents.CreateActionWrapper.create/3 (function)



### AshEvents.DestroyActionWrapper (module)

Wrapper for destroy actions that enables event tracking.

### AshEvents.DestroyActionWrapper.destroy/3 (function)



### AshEvents.EventLog (module)

Extension to use on the Ash.Resource that will persist events.

### AshEvents.EventLog.event_log/1 (macro)



### AshEvents.EventLog.replay_overrides/1 (macro)



### AshEvents.EventLog.Actions.Replay (module)

Action module used by the event log resource to replay events.

### AshEvents.EventLog.Actions.Replay.run/3 (function)



### AshEvents.EventLog.Info (module)

Introspection helpers for `AshEvents.EventLog`

### AshEvents.EventLog.Info.event_log/1 (function)

event_log DSL entities

### AshEvents.EventLog.Info.event_log_clear_records_for_replay/1 (function)

A module with the AshEvents.ClearRecords-behaviour, that is expected to clear all records before an event replay.

### AshEvents.EventLog.Info.event_log_clear_records_for_replay!/1 (function)

A module with the AshEvents.ClearRecords-behaviour, that is expected to clear all records before an event replay.

### AshEvents.EventLog.Info.event_log_options/1 (function)

event_log DSL options

Returns a map containing the and any configured or default values.

### AshEvents.EventLog.Info.event_log_record_id_type/1 (function)

The type of the primary key used by the system, which will be the type of the `record_id`-field on the events. Defaults to :uuid.

### AshEvents.EventLog.Info.event_log_record_id_type!/1 (function)

The type of the primary key used by the system, which will be the type of the `record_id`-field on the events. Defaults to :uuid.

### AshEvents.EventLog.Info.replay_overrides/1 (function)

replay_overrides DSL entities

### AshEvents.EventLog.PersistActorPrimaryKey (module)

Adds a field (not relationship) on the event log resource that will be used to persist the actor primary key.

### AshEvents.EventLog.PersistActorPrimaryKey.t/0 (type)



### AshEvents.EventLog.Transformers.ValidatePersistActorPrimaryKey (module)

Validates that when multiple persist_actor_primary_key options are defined that they all allow_nil? true

### AshEvents.EventLog.Transformers.ValidatePersistActorPrimaryKey.after?/1 (function)



### AshEvents.EventLog.Transformers.ValidatePersistActorPrimaryKey.after_compile?/0 (function)



### AshEvents.EventLog.Transformers.ValidatePersistActorPrimaryKey.before?/1 (function)



### AshEvents.EventLog.Transformers.ValidatePersistActorPrimaryKey.transform/1 (function)



### AshEvents.Events (module)

Defines the events section for a resource.

### AshEvents.Events.events/1 (macro)



### AshEvents.Events.ActionWrapperHelpers (module)

Helper functions used by the action wrappers.

### AshEvents.Events.ActionWrapperHelpers.build_params/2 (function)



### AshEvents.Events.ActionWrapperHelpers.create_event!/4 (function)



### AshEvents.Events.Info (module)

@moduledoc "Introspection helpers for `AshEvents.Events`"

### AshEvents.Events.Info.events_current_action_versions/1 (function)

A keyword list of action versions. This will be used to set the version in the created events when the actions are run. Version will default to 1 for all actions that are not listed here.

### AshEvents.Events.Info.events_current_action_versions!/1 (function)

A keyword list of action versions. This will be used to set the version in the created events when the actions are run. Version will default to 1 for all actions that are not listed here.

### AshEvents.Events.Info.events_event_log/1 (function)

The event-log resource that creates and stores events.

### AshEvents.Events.Info.events_event_log!/1 (function)

The event-log resource that creates and stores events.

### AshEvents.Events.Info.events_ignore_actions/1 (function)

A list of actions that should not have events created when run.

### AshEvents.Events.Info.events_ignore_actions!/1 (function)

A list of actions that should not have events created when run.

### AshEvents.Events.Info.events_options/1 (function)

events DSL options

Returns a map containing the and any configured or default values.

### AshEvents.Events.RemoveLifecycleHooksChange (module)

Removes all lifecycle hooks for an action.
This change will be added during event replay, in order to disable
any side-effects in the action.

### AshEvents.Events.RemoveLifecycleHooksChange.change/3 (function)



### AshEvents.Helpers (module)

Internal helpers for AshEvents.

### AshEvents.Helpers.build_original_action_name/1 (function)



### AshEvents.Helpers.remove_changeset_lifecycle_hooks/1 (function)



### AshEvents.UpdateActionWrapper (module)

Wrapper for update actions that enables event tracking.

### AshEvents.UpdateActionWrapper.update/3 (function)



## Links

- [Online documentation](https://hexdocs.pm/ash_events)# iterex

> Lazy, external iterators for Elixir.

## Docs

### Iter (module)

Functions for working with iterators.

An iterator is a struct that wraps any value which implements the
`Iter.Iterable` protocol. Lists, maps and ranges are all common data types
which can be used as iterators.

### Explicit conversion - Iter (module)

Whilst the `Iter.Iterable` protocol is designed to work with many different
types, you must explicitly convert your iterables into an iterator using
`Iter.from/1`.  This allows for easy pattern matching of iterators as well as
for default implementations of Elixir's `Enum` and `Collectable` protocols.

Any value passed to `Iter.from/1` must implement the `Iter.IntoIterable`
protocol.

### Lazy by default - Iter (module)

Like Elixir's `Stream`, an `Iter` is lazy by default.  Any function which
returns an `Iter.t` does so by simply composing iterables on top of each
other.  No iteration is performed until it is needed, and then only the
minimum amount needed to return the result.

### Iter.all?/1 (function)

Returns `true` if all elements in the iterator are truthy.

### Examples - Iter.all?/1 (function)

iex> [1, 2, false]
    ...> |> Iter.from()
    ...> |> Iter.all?()
    false

    iex> [1, 2, nil]
    ...> |> Iter.from()
    ...> |> Iter.all?()
    false

    iex> [1, 2, 3]
    ...> |> Iter.from()
    ...> |> Iter.all?()
    true

### Iter.all?/2 (function)

Returns `true` if `fun.(element)` is truthy for all elements in the iterator.

Iterates over the iterator and invokes `fun` on each element. If `fun` ever
returns a falsy value (`false` or `nil`), iteration stops immediately and
`false` is returned.  Otherwise `true` is returned.

### Examples - Iter.all?/2 (function)

iex> [2, 4, 6]
    ...> |> Iter.from()
    ...> |> Iter.all?(&(rem(&1, 2) == 0))
    true

    iex> [2, 3, 4]
    ...> |> Iter.from()
    ...> |> Iter.all?(&(rem(&1, 2) == 0))
    false

    iex> []
    ...> |> Iter.from()
    ...> |> Iter.all?()
    true

### Iter.any?/1 (function)

Returns `true` if at least one element in the iterator is truthy.

When an element is a truthy value (neither `false` nor `nil`) iteration stops
immediately and `true` is returned.  In all other cases `false` is returned.

### Examples - Iter.any?/1 (function)

iex> [false, false, false]
    ...> |> Iter.from()
    ...> |> Iter.any?()
    false

    iex> [false, true, false]
    ...> |> Iter.from()
    ...> |> Iter.any?()
    true

    iex> []
    ...> |> Iter.from()
    ...> |> Iter.any?()
    false

### Iter.any?/2 (function)

Returns `true` if `fun.(element)` is truthy for at least one element in the
iterator.

Consumes the iterator and invokes `fun` on each element.  When an invocation
of `fun` returns a truthy value (neither `false` nor `nil`) iteration stops
immediately and `true` is returned.  In all other cases `false` is returned.

### Examples - Iter.any?/2 (function)

iex> [2, 4, 6]
    ...> |> Iter.from()
    ...> |> Iter.any?(&(rem(&1, 2) == 1))
    false

    iex> [2, 3, 4]
    ...> |> Iter.from()
    ...> |> Iter.any?(&(rem(&1, 2) == 1))
    true

    iex> []
    ...> |> Iter.from()
    ...> |> Iter.any?(&(rem(&1, 2) == 1))
    false

### Iter.append/2 (function)

Append a new element to the end of the iterable.

### Example - Iter.append/2 (function)

iex> 1..3
    ...> |> Iter.from()
    ...> |> Iter.append(4)
    ...> |> Iter.to_list()
    [1, 2, 3, 4]

### Iter.at/2 (function)

Return the element `index` items from the beginning of the iterator.

Works by advancing the iterator the specified number of elements and then
returning the element requested and an iterator of the remaining elements.

### Return values - Iter.at/2 (function)

- `{:ok, element, new_iterator}` - the element requested and the iterator of
  the remaining elements.
- `:done` - the iterator was exhausted before the element was found.

### Examples - Iter.at/2 (function)

iex> 10..20
    ...> |> Iter.from()
    ...> |> Iter.at(5)
    {:ok, 15, Iter.from(16..20)}

### Iter.chunk_by/2 (function)

Chunks the iterator by buffering elements for which `fun` returns the same
value.

Elements are only emitted when `fun` returns a new value or `iterable` is
exhausted.

### Examples - Iter.chunk_by/2 (function)

iex> [1, 2, 2, 3, 4, 4, 6, 7, 7]
    ...> |> Iter.from()
    ...> |> Iter.chunk_by(&(rem(&1, 2) == 1))
    ...> |> Iter.to_list()
    [[1], [2, 2], [3], [4, 4, 6], [7, 7]]

### Iter.chunk_every/2 (function)

Shortcut to `chunk_every(iterable, count, count)`.

### Iter.chunk_every/3 (function)

Consumes the iterator in chunks, containing `count` elements each, where each
new chunk steps `step` elements into the iterator.

`step` is optional and, if not passed defaults to `count`, i.e. chunks do not
overlap.  Chunking will stop as soon as the iterable is exhausted or when we
emit an incomplete chunk.

If the last chunk does not have `chunk` elements to fill the chunk, elements
are taken from `leftover` to fill in the chunk, if `leftover` does not have
enough elements to fill the chunk, then a partial chunk is returned with less
than `count` elements.

If `:discard` is given in `leftover` the last chunk is discarded unless it has
exactly `count` elements.

### Examples - Iter.chunk_every/3 (function)

iex> [a, b, c] = [1, 2, 3, 4, 5, 6]
    ...> |> Iter.from()
    ...> |> Iter.chunk_every(2)
    ...> |> Iter.to_list()
    iex> Iter.to_list(a)
    [1, 2]
    iex> Iter.to_list(b)
    [3, 4]
    iex> Iter.to_list(c)
    [5, 6]

    iex> [a, b] = [1, 2, 3, 4, 5, 6]
    ...> |> Iter.from()
    ...> |> Iter.chunk_every(3, 2, :discard)
    ...> |> Iter.to_list()
    iex> Iter.to_list(a)
    [1, 2, 3]
    iex> Iter.to_list(b)
    [3, 4, 5]

    iex> [a, b, c] = [1, 2, 3, 4, 5, 6]
    ...> |> Iter.from()
    ...> |> Iter.chunk_every(3, 2, [7] |> Iter.from())
    ...> |> Iter.to_list()
    iex> Iter.to_list(a)
    [1, 2, 3]
    iex> Iter.to_list(b)
    [3, 4, 5]
    iex> Iter.to_list(c)
    [5, 6, 7]

    iex> [a, b] = [1, 2, 3, 4, 5, 6]
    ...> |> Iter.from()
    ...> |> Iter.chunk_every(3, 3, [] |> Iter.from())
    ...> |> Iter.to_list()
    iex> Iter.to_list(a)
    [1, 2, 3]
    iex> Iter.to_list(b)
    [4, 5, 6]

    iex> [a, b] = [1, 2, 3, 4]
    ...> |> Iter.from()
    ...> |> Iter.chunk_every(3, 3, [0] |> Iter.from() |> Iter.cycle())
    ...> |> Iter.to_list()
    iex> Iter.to_list(a)
    [1, 2, 3]
    iex> Iter.to_list(b)
    [4, 0, 0]

### Iter.chunk_every/4 (function)



### Iter.chunk_while/4 (function)

Chunks the iterator with fine grained control of when every chunk is emitted.

`chunk_fun` receives the current element and the accumulator and must return
`{:cont, element, acc}` to emit the given chunk and continue with accumulator
or `{:cont, acc}` to not emit any chunk and continue with the return
accumulator.

`after_fun` is invoked when iteration is done and must also return `{:cont,
element, acc}` or `{:cont, acc}`.

### Examples - Iter.chunk_while/4 (function)

iex> chunk_fun = fn element, acc ->
    ...>   if rem(element, 2) == 0 do
    ...>     {:cont, Enum.reverse([element | acc]), []}
    ...>   else
    ...>     {:cont, [element | acc]}
    ...>   end
    ...> end
    iex> after_fun = fn
    ...>   [] -> {:cont, []}
    ...>   acc -> {:cont, Enum.reverse(acc), []}
    ...> end
    iex> 1..10
    ...> |> Iter.from()
    ...> |> Iter.chunk_while([], chunk_fun, after_fun)
    ...> |> Iter.to_list()
    [[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]]

### Iter.concat/1 (function)

Creates an iterator that concatenates an iterator of iterators.

### Example - Iter.concat/1 (function)

iex> [Iter.from(1..2), Iter.from(3..4)]
    ...> |> Iter.from()
    ...> |> Iter.concat()
    ...> |> Iter.to_list()
    [1, 2, 3, 4]

### Iter.concat/2 (function)

Creates an iterator that iterates the first argument, followed by the second argument.

### Example - Iter.concat/2 (function)

iex> lhs = Iter.from(1..3)
    ...> rhs = Iter.from(4..6)
    ...> Iter.concat(lhs, rhs) |> Iter.to_list()
    [1, 2, 3, 4, 5, 6]

### Iter.count/1 (function)

Count the number of elements remaining in the iterator.

Some iterators can be counted without consuming the iterator, but most cannot
and you should consider the iterator passed to this function as having been
exhausted.

### Example - Iter.count/1 (function)

iex> 1..10
    ...> |> Iter.from()
    ...> |> Iter.count()
    10

### Iter.count/2 (function)

Count the number of elements for which `fun` returns a truthy value.

### Example - Iter.count/2 (function)

iex> 1..5
    ...> |> Iter.from()
    ...> |> Iter.count(&(rem(&1, 2) == 0))
    2

### Iter.count_until/2 (function)

Counts the elements in iterator stopping at `limit`.

### Examples - Iter.count_until/2 (function)

iex> 1..20
    ...> |> Iter.from()
    ...> |> Iter.count_until(5)
    {:ok, 5, Iter.from(6..20)}

    iex> 1..3
    ...> |> Iter.from()
    ...> |> Iter.count_until(5)
    {:ok, 3, Iter.empty()}

    iex> []
    ...> |> Iter.from()
    ...> |> Iter.count_until(5)
    {:ok, 0, Iter.empty()}

### Iter.count_until/3 (function)

Counts the elements of iterator for which `predicate` returns a truthy value, stopping at `limit`.

### Examples - Iter.count_until/3 (function)

iex> 1..20
    ...> |> Iter.from()
    ...> |> Iter.count_until(&(rem(&1, 2) == 0), 7)
    {:ok, 7, Iter.from(15..20)}

    iex> 1..20
    ...> |> Iter.from()
    ...> |> Iter.count_until(&(rem(&1, 2) == 0), 11)
    {:ok, 10, Iter.empty()}

### Iter.cycle/1 (function)

Create an iterator that cycles it's elements eternally.

    iex> [:a, :b, :c]
    ...> |> Iter.from()
    ...> |> Iter.cycle()
    ...> |> Iter.take(5)
    ...> |> Iter.to_list()
    [:a, :b, :c, :a, :b]

### Iter.dedup/1 (function)

Remove consecutive duplicate elements from the iterator.

### Example - Iter.dedup/1 (function)

iex> [1, 1, 2, 3, 3, 4, 5, 4]
    ...> |> Iter.from()
    ...> |> Iter.dedup()
    ...> |> Iter.to_list()
    [1, 2, 3, 4, 5, 4]

### Iter.dedup_by/2 (function)

Remove consecutive elements for which `fun` returns duplicate values from the iterator.

### Example - Iter.dedup_by/2 (function)

iex> [{1, :a}, {2, :b}, {2, :c}, {1, :a}]
  ...> |> Iter.from()
  ...> |> Iter.dedup_by(&elem(&1, 0))
  ...> |> Iter.to_list()
  [{1, :a}, {2, :b}, {1, :a}]

### Iter.drop/2 (function)

Returns a new iterator which drops the first `how_many` elements.

### Examples - Iter.drop/2 (function)

iex> 1..3
    ...> |> Iter.from()
    ...> |> Iter.drop(2)
    ...> |> Iter.to_list()
    [3]

### Iter.drop_every/2 (function)

Returns a new iterator with every `nth` element in the iterator dropped,
starting with the first element.

### Examples - Iter.drop_every/2 (function)

iex> 1..10
    ...> |> Iter.from()
    ...> |> Iter.drop_every(2)
    ...> |> Iter.to_list()
    [2, 4, 6, 8, 10]

    iex> 1..10
    ...> |> Iter.from()
    ...> |> Iter.drop_every(0)
    ...> |> Iter.to_list()
    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

    iex> [1, 2, 3]
    ...> |> Iter.from()
    ...> |> Iter.drop_every(1)
    ...> |> Iter.to_list()
    []

### Iter.drop_while/2 (function)

Returns a new iterator which drops elements at the beginning of the iterator
until `predicate` returns a truthy value.

### Example - Iter.drop_while/2 (function)

iex> [1, 2, 3, 2, 1]
    ...> |> Iter.from()
    ...> |> Iter.drop_while(&(&1 < 3))
    ...> |> Iter.to_list()
    [3, 2, 1]

### Iter.each/2 (function)

Call `fun` for every element in the iterator.

The return value is not used.

### Example - Iter.each/2 (function)

```elixir
["marty", "doc"]
|> Iter.from()
|> Iter.each(&IO.puts/1)
"marty"
"doc"
#=> :done
```

### Iter.empty/0 (function)

Returns an iterator that contains no elements.

### Example - Iter.empty/0 (function)

iex> Iter.empty()
    ...> |> Iter.to_list()
    []

### Iter.empty?/1 (function)

Determines if the iterator is empty.

### Examples - Iter.empty?/1 (function)

iex> Iter.empty()
    ...> |> Iter.empty?()
    true

    iex> 1..20
    ...> |> Iter.from()
    ...> |> Iter.empty?
    false

### Iter.filter/2 (function)

Remove elements for which `predicate` returns a truthy value.

### Example - Iter.filter/2 (function)

iex> [1, 2, 3, 4]
    ...> |> Iter.from()
    ...> |> Iter.filter(&(rem(&1, 2) == 0))
    ...> |> Iter.to_list()
    [2, 4]

### Iter.find/2 (function)

Searches for the first element in the iterator which matches `predicate`.

### Example - Iter.find/2 (function)

iex> [1, 2, 3, 4, 5]
    ...> |> Iter.from()
    ...> |> Iter.find(&(&1 > 3))
    {:ok, 4, Iter.from([5])}

    iex> [1, 2, 3]
    ...> |> Iter.from()
    ...> |> Iter.find(&(&1 > 4))
    :done

### Iter.find_index/2 (function)

Finds the index of the first value in the iterator that matches `predicate`.

### Example - Iter.find_index/2 (function)

iex> [1, 2, 3, 4, 5]
    ...> |> Iter.from()
    ...> |> Iter.find_index(&(&1 > 3))
    {:ok, 3, Iter.from([5])}

### Iter.find_value/2 (function)

Similar to `find/3`, but returns the value of the function invocation instead
of the element itself.

### Example - Iter.find_value/2 (function)

iex> [2, 3, 4]
    ...> |> Iter.from()
    ...> |> Iter.find_value(fn x ->
    ...>   if x > 2, do: x * x
    ...> end)
    {:ok, 9, Iter.from([4])}

    iex> [2, 4, 6]
    ...> |> Iter.from()
    ...> |> Iter.find_value(&(rem(&1, 2) == 1))
    :done

    iex> [2, 3, 4]
    ...> |> Iter.from()
    ...> |> Iter.find_value(&(rem(&1, 2) == 1))
    {:ok, true, Iter.from([4])}

### Iter.flat_map/2 (function)

Maps `fun` over the iterator flattening the result.

### Example - Iter.flat_map/2 (function)

iex> [:a, :b, :c]
    ...> |> Iter.from()
    ...> |> Iter.flat_map(&Iter.from([&1, &1]))
    ...> |> Iter.to_list()
    [:a, :a, :b, :b, :c, :c]

### Iter.flatten/1 (function)

Flattens nested iterators.

### Example - Iter.flatten/1 (function)

iex> [[:a, :a], [:b, :b], [:c, :c]]
    ...> |> Iter.from()
    ...> |> Iter.flatten()
    ...> |> Iter.to_list()
    [:a, :a, :b, :b, :c, :c]

### Iter.from/1 (function)

Convert anything that implements `Iter.IntoIterable` into an `Iter`.

### Iter.from_enum/1 (function)

Convert an `Enumerable` into an `Iter`.

Provides an `Enumerable` compatible source for `Iter` using a `GenServer` to
orchestrate reduction and block as required.

> #### Warning {: .warning}
> You should almost always implement `IntoIterable` for your enumerable and
> use `from/1` rather than resort to calling this function.  Unfortunately it
> cannot always be avoided.

### Iter.intersperse/2 (function)

Intersperses `separator` between each element of the iterator.

### Examples - Iter.intersperse/2 (function)

iex> 1..3
    ...> |> Iter.from()
    ...> |> Iter.intersperse(0)
    ...> |> Iter.to_list()
    [1, 0, 2, 0, 3]

    iex> [1]
    ...> |> Iter.from()
    ...> |> Iter.intersperse(0)
    ...> |> Iter.to_list()
    [1]

    iex> []
    ...> |> Iter.from()
    ...> |> Iter.intersperse(0)
    ...> |> Iter.to_list()
    []

### Iter.is_iter/1 (macro)

Is the passed value an iterator?

### Iter.iterate/2 (function)

Emits a sequence of values, starting with `start_value`. Successive values are
generated by calling `next_fun` on the previous value.

    iex> Iter.iterate(0, &(&1 + 1))
    ...> |> Iter.take(5)
    ...> |> Iter.to_list()
    [0, 1, 2, 3, 4]

### Iter.map/2 (function)

Apply `fun` to each element in the iterator and collect the result.

### Example - Iter.map/2 (function)

iex> [1, 2, 3, 4]
    ...> |> Iter.from()
    ...> |> Iter.map(&(&1 * 2))
    ...> |> Iter.to_list()
    [2, 4, 6, 8]

### Iter.map_every/3 (function)

Creates a new iterator which applies `mapper` on every `nth` element of the
iterator, starting with the first element.

The first element is always mapped unless `nth` is `0`.

### Examples - Iter.map_every/3 (function)

iex> 1..10
    ...> |> Iter.from()
    ...> |> Iter.map_every(2, fn x -> x + 1000 end)
    ...> |> Iter.to_list()
    [1001, 2, 1003, 4, 1005, 6, 1007, 8, 1009, 10]

    iex> 1..10
    ...> |> Iter.from()
    ...> |> Iter.map_every(3, fn x -> x + 1000 end)
    ...> |> Iter.to_list()
    [1001, 2, 3, 1004, 5, 6, 1007, 8, 9, 1010]

    iex> 1..5
    ...> |> Iter.from()
    ...> |> Iter.map_every(0, fn x -> x + 1000 end)
    ...> |> Iter.to_list()
    [1, 2, 3, 4, 5]

    iex> 1..3
    ...> |> Iter.from()
    ...> |> Iter.map_every(1, fn x -> x + 1000 end)
    ...> |> Iter.to_list()
    [1001, 1002, 1003]

### Iter.max/2 (function)

Returns the maximal element in the iterator according to Erlang's term sorting.

### Example - Iter.max/2 (function)

iex> [1, 4, 3, 2]
    ...> |> Iter.from()
    ...> |> Iter.max()
    {:ok, 4}

    iex> Iter.empty()
    ...> |> Iter.max()
    :done

### Iter.max_by/3 (function)

Returns the maximal element in the iterator as calculated by `mapper`.

### Example - Iter.max_by/3 (function)

iex> ["a", "aa", "aaa"]
    ...> |> Iter.from()
    ...> |> Iter.max_by(&String.length/1)
    {:ok, "aaa"}

    iex> Iter.empty()
    ...> |> Iter.max_by(&String.length/1)
    :done

### Iter.member?/2 (function)

Checks if `element` is a member of `iterable`.

### Examples - Iter.member?/2 (function)

iex> 1..5
    ...> |> Iter.from()
    ...> |> Iter.member?(3)
    true

    iex> 1..5
    ...> |> Iter.from()
    ...> |> Iter.member?(6)
    false

### Iter.min/2 (function)

Returns the minimal element in the iterator according to Erlang's term sorting.

### Example - Iter.min/2 (function)

iex> [1, 4, 3, 2]
    ...> |> Iter.from()
    ...> |> Iter.min()
    {:ok, 1}

### Iter.min_by/3 (function)

Returns the minimal element in the iterator as calculated by `mapper`.

### Example - Iter.min_by/3 (function)

iex> ["a", "aa", "aaa"]
    ...> |> Iter.from()
    ...> |> Iter.min_by(&String.length/1)
    {:ok, "a"}

    iex> Iter.empty()
    ...> |> Iter.min_by(&String.length/1)
    :done

### Iter.min_max/1 (function)

Returns the minimal and maximal element in the iterator according to Erlang's
term ordering.

### Example - Iter.min_max/1 (function)

iex> [2, 3, 1]
    ...> |> Iter.from()
    ...> |> Iter.min_max()
    {:ok, 1, 3}

    iex> Iter.empty()
    ...> |> Iter.min_max()
    :done

### Iter.next/1 (function)

Advance the iterator and return the next value.

### Return values - Iter.next/1 (function)

- `{:ok, element, new_iterator}` - returns the next element and an updated iterator.
  - `:done` - the iterator is exhausted.

### Iter.peek/1 (function)

Peeks at the first element of the iterator, without consuming it.

> #### Warning {: .warning}
> Many iterators cannot be peeked, so this function simulates peeking by
> consuming an element from the iterator and returning a new iterator which
> pushes that element back onto the front.

### Example - Iter.peek/1 (function)

iex> {:ok, 1, iter} = 1..3
    ...> |> Iter.from()
    ...> |> Iter.peek()
    ...> Iter.to_list(iter)
    [1, 2, 3]

### Iter.peek/2 (function)

Peeks at the first `how_many` elements of the iterator, without consuming
them.

> #### Warning {: .warning}
> Many iterables cannot be peeked, so this function simulates peeking by
> consuming elements from the iterator and returning a new iterator which
> pushes those elements back on to the front.

Because it's possible to try and peek past the end of an iterator you
shouldn't expect the number of elements returned to always be the same as how
many you asked for.  For this reason the return value includes the number of
elements that were able to be peeked.

### Example - Iter.peek/2 (function)

iex> {:ok, peeks, 3, iter} = 1..5
    ...> |> Iter.from()
    ...> |> Iter.peek(3)
    iex> Iter.to_list(peeks)
    [1, 2, 3]
    iex> Iter.to_list(iter)
    [1, 2, 3, 4, 5]

    iex> {:ok, peeks, 3, iter} = 1..3
    ...> |> Iter.from()
    ...> |> Iter.peek(5)
    iex> Iter.to_list(peeks)
    [1, 2, 3]
    iex> Iter.to_list(iter)
    [1, 2, 3]

### Iter.prepend/2 (function)

Prepend a new element to the beginning of the iterable.

### Example - Iter.prepend/2 (function)

iex> 1..3
    ...> |> Iter.from()
    ...> |> Iter.prepend(4)
    ...> |> Iter.to_list()
    [4, 1, 2, 3]

### Iter.reject/2 (function)

Keep elements for which `predicate` returns a truthy value.

### Example - Iter.reject/2 (function)

iex> [1, 2, 3, 4]
    ...> |> Iter.from()
    ...> |> Iter.reject(&(rem(&1, 2) == 0))
    ...> |> Iter.to_list()
    [1, 3]

### Iter.repeatedly/1 (function)

Returns an iterator generated by calling `generator_fun` repeatedly.

### Examples - Iter.repeatedly/1 (function)

# Although not necessary, let's seed the random algorithm
    iex> :rand.seed(:exsss, {1, 2, 3})
    iex> Iter.repeatedly(&:rand.uniform/0) |> Iter.take(3) |> Iter.to_list()
    [0.5455598952593053, 0.6039309974353404, 0.6684893034823949]

### Iter.resource/3 (function)

Create an iterator from a resource.

    iex> Iter.resource(
    ...>   fn ->
    ...>     {:ok, pid} = StringIO.open("Marty")
    ...>     pid
    ...>   end,
    ...>   fn pid ->
    ...>     case IO.read(pid, 1) do
    ...>       :eof -> {:halt, pid}
    ...>       char -> {[char], pid}
    ...>     end
    ...>   end,
    ...>   fn pid ->
    ...>     StringIO.close(pid)
    ...>   end
    ...> )
    ...> |> Iter.to_list()
    ["M", "a", "r", "t", "y"]

### Iter.step_by/2 (function)

Creates an iterator starting at the same point, but stepping by `step_size`
each iteration.

The first element of the iterator will always be returned, regardless of the step given.

### Examples - Iter.step_by/2 (function)

iex> 1..9
      ...> |> Iter.from()
      ...> |> Iter.step_by(3)
      ...> |> Iter.to_list()
      [1, 4, 7]

### Iter.take/2 (function)

Takes the next `count` elements from the iterable and stops iteration.

If a negative count is given, the last count values will be taken. For such,
the collection is fully enumerated keeping up to `count` elements in memory.
Once the end of the collection is reached, the last `count` elements will be
iterated. Therefore, using a negative count on an infinite collection will
never return.

The rest of the underlying iterable is discarded.

### Examples - Iter.take/2 (function)

iex> Iter.empty()
    ...> |> Iter.take(3)
    ...> |> Iter.to_list()
    []

    iex> Iter.empty()
    ...> |> Iter.take(-3)
    ...> |> Iter.to_list()
    []

    iex> 1..5
    ...> |> Iter.from()
    ...> |> Iter.take(3)
    ...> |> Iter.to_list()
    [1, 2, 3]

    iex> 1..5
    ...> |> Iter.from()
    ...> |> Iter.take(-3)
    ...> |> Iter.to_list()
    [3, 4, 5]

### Iter.take_chunk/2 (function)

Collects the first `how_many` elements into a new iterator and returns it
along with the advanced initial iterator.

This is very much like `take/2` except that it returns the remaining iterator
so that it can be called repeatedly.

### Example - Iter.take_chunk/2 (function)

iex> iter = Iter.from(1..9)
    ...> {:ok, chunk_a, iter} = Iter.take_chunk(iter, 3)
    ...> {:ok, chunk_b, remainder} = Iter.take_chunk(iter, 3)
    ...> Iter.to_list(chunk_a)
    [1, 2, 3]
    iex> Iter.to_list(chunk_b)
    [4, 5, 6]
    iex> Iter.to_list(remainder)
    [7, 8, 9]

### Iter.take_while/2 (function)

Creates an iterable which emits elements until `predicate` returns `false`.

The rest of the underlying iterable is discarded.

### Example - Iter.take_while/2 (function)

iex> 1..3
    ...> |> Iter.from()
    ...> |> Iter.take_while(&(&1 < 3))
    ...> |> Iter.to_list()
    [1, 2]

### Iter.to_list/1 (function)

Convert an iterator into a list.

### Iter.to_stream/1 (function)

Convert an iterator into an Elixir stream.

### Example - Iter.to_stream/1 (function)

iex> [:a, :b, :c]
    ...> |> Iter.from()
    ...> |> Iter.cycle()
    ...> |> Iter.to_stream()
    ...> |> Enum.take(5)
    [:a, :b, :c, :a, :b]

### Iter.uniq/1 (function)

Creates a new iterator which returns only unique elements.

> #### Warning {: .warning}
> Except for specific data structures (eg `MapSet` and `Range`) most iterators
> will need to store a set of "seen values" in order to provide this function.
> In such cases memory usage will grow in direct relation to the number of
> unique elements in the iterator.

### Example - Iter.uniq/1 (function)

iex> 1..5
    ...> |> Iter.from()
    ...> |> Iter.uniq()
    Iter.from(1..5)

    iex> [1, 2, 3, 2, 1]
    ...> |> Iter.from()
    ...> |> Iter.uniq()
    ...> |> Iter.to_list()
    [1, 2, 3]

### Iter.with_index/1 (function)

Creates a new iterator which replaces each element with a tuple containing the
original element and the count of elements so far.

### Example - Iter.with_index/1 (function)

iex> 1..3
    ...> |> Iter.from()
    ...> |> Iter.with_index()
    ...> |> Iter.to_list()
    [{1, 0}, {2, 1}, {3, 2}]

### Iter.zip/1 (function)

Zips corresponding elements from a finite collection of iterators into one iterator of tuples.

The zipping finishes as soon as any iterable in the collection is exhausted.

### Example - Iter.zip/1 (function)

iex> first = Iter.from(1..3)
    ...> second = Iter.from([:a, :b, :c])
    ...> third = Iter.from(["a", "b", "c"])
    ...> [first, second, third]
    ...> |> Iter.from()
    ...> |> Iter.zip()
    ...> |> Iter.to_list()
    [{1, :a, "a"}, {2, :b, "b"}, {3, :c, "c"}]

### Iter.zip/2 (function)

Zips to iterators together.

The zipping finishes as soon as either iterator is exhausted.

### Example - Iter.zip/2 (function)

iex> first = Iter.from(1..3)
    ...> second = Iter.from([:a, :b, :c])
    ...> Iter.zip(first, second)
    ...> |> Iter.to_list()
    [{1, :a}, {2, :b}, {3, :c}]

### Iter.zip_with/2 (function)

Zips corresponding elements from a finite collection of iterators into a new
iterator, transforming them with `zip_fun` as it goes.

The first element from each of the iterators will be put into a list which is
then passed to the one-arity `zip_fun` function.  Then, the second elements
from each of the iterators are put into a list, and so on until any of the
iterators are exhausted.

### Example - Iter.zip_with/2 (function)

iex> first = Iter.from(1..3)
    ...> second = Iter.from(4..6)
    ...> third = Iter.from(7..9)
    ...> [first, second, third]
    ...> |> Iter.from()
    ...> |> Iter.zip_with(fn [a, b, c] -> a + b + c end)
    ...> |> Iter.to_list()
    [12, 15, 18]

### Iter.zip_with/3 (function)

Zips corresponding elements from two iterators into a new one, transforming
them with `zip_fun` as it goes.

The `zip_fun` will be called with the first elements from the iterators, then
the second elements and so on.

### Example - Iter.zip_with/3 (function)

iex> first = Iter.from(1..3)
    ...> second = Iter.from(4..6)
    ...> Iter.zip_with(first, second, &(&1 + &2))
    ...> |> Iter.to_list()
    [5, 7, 9]

### Iter.element/0 (type)



### Iter.mapper/0 (type)



### Iter.predicate/0 (type)



### Iter.sorter/0 (type)



### Iter.t/0 (type)



### Iter.Impl (module)

The default implementations of all `Iter.Iterable` callbacks except `next/1`.

By adding `use Iter.Impl` to your `Iter.Iterable` definition all of the
default functions will be automatically delegated and marked as overridable.

This allows you to implement only those callbacks which can reasonably be made
faster for your particular iterable, and not have to implement all of them.

For example, here's a fictional implementation of iterable for `List`:

```elixir
defimpl Iter.Iterable, for: List do
  use Iter.Impl

  def next([head | tail]), do: {:ok, head, tail}
  def next([]), do: :done

  def peek([]), do: :done
  def peek([head | _] = list), do: {:ok, head, list}

  def empty?([]), do: true
  def empty?(_), do: false
end
```

Be aware that all the default implementations rely on your implementation of
`next/1` which you always must provide.

### Iter.Impl.__using__/1 (macro)

Generate overridable delegations to the default iterable callbacks.

### Iter.Impl.all?/2 (function)

Tests if every element in the iterable matches `predicate`.

### Examples - Iter.Impl.all?/2 (function)

iex> Impl.all?([2, 4, 6, 8], &(rem(&1, 2) == 0))
    true

    iex> Impl.all?([2, 3, 4], &(rem(&1, 2) == 0))
    false

### Iter.Impl.any?/2 (function)

Tests if any element in the iterable matches `predicate`.

### Examples - Iter.Impl.any?/2 (function)

iex> Impl.any?([2, 4, 6], &(rem(&1, 2) == 1))
    false

    iex> Impl.any?([2, 3, 4], &(rem(&1, 2) == 1))
    true

### Iter.Impl.append/2 (function)

Creates an iterable that appends an element to the end of the iterable.

### Examples - Iter.Impl.append/2 (function)

iex> Impl.append(1..3, 4)
    ...> |> Impl.to_list()
    [1, 2, 3, 4]

### Iter.Impl.at/2 (function)

Returns the element `index` items from the beginning of the iterable.

### Example - Iter.Impl.at/2 (function)

iex> Impl.at([:a, :b, :c], 1)
    {:ok, :b, [:c]}

### Iter.Impl.chunk_by/2 (function)

Creates an iterable that chunks elements by subsequent return values of `fun`.

### Example - Iter.Impl.chunk_by/2 (function)

iex> Impl.chunk_by([1, 2, 2, 3, 4, 4, 6, 7, 7], &(rem(&1, 2) == 1))
    ...> |> Impl.to_list()
    [[1], [2, 2], [3], [4, 4, 6], [7, 7]]

### Iter.Impl.chunk_every/4 (function)

Creates an iterable that chunks elements into `count` sized chunks of `step` spacing.

### Examples - Iter.Impl.chunk_every/4 (function)

iex> Impl.chunk_every([1, 2, 3, 4, 5, 6], 2, 2, []) |> Impl.to_list()
    [[1, 2], [3, 4], [5, 6]]

    iex> Impl.chunk_every([1, 2, 3, 4, 5, 6], 3, 2, :discard) |> Impl.to_list()
    [[1, 2, 3], [3, 4, 5]]

    iex> Impl.chunk_every([1, 2, 3, 4, 5, 6], 3, 2, [7]) |> Impl.to_list()
    [[1, 2, 3], [3, 4, 5], [5, 6, 7]]

    iex> Impl.chunk_every([1, 2, 3, 4, 5, 6], 3, 3, []) |> Impl.to_list()
    [[1, 2, 3], [4, 5, 6]]

    iex> cycler = Impl.cycle([0])
    iex> Impl.chunk_every([1, 2, 3, 4], 3, 3, cycler) |> Impl.to_list()
    [[1, 2, 3], [4, 0, 0]]

### Iter.Impl.chunk_while/4 (function)

Creates an iterable that chunks based on a chunk function.

### Examples - Iter.Impl.chunk_while/4 (function)

iex> chunk_fun = fn element, acc ->
    ...>   if rem(element, 2) == 0 do
    ...>     {:cont, Enum.reverse([element | acc]), []}
    ...>   else
    ...>     {:cont, [element | acc]}
    ...>   end
    ...> end
    iex> after_fun = fn
    ...>   [] -> {:cont, []}
    ...>   acc -> {:cont, Enum.reverse(acc), []}
    ...> end
    iex> iter = 1..10 |> Impl.chunk_while([], chunk_fun, after_fun)
    iex> Impl.to_list(iter)
    [[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]]

### Iter.Impl.concat/1 (function)

Takes an iterable and iterates each iterable in an iterable.

### Example - Iter.Impl.concat/1 (function)

iex> Impl.concat([1..3, 2..4, 3..5]) |> Impl.to_list()
    [1, 2, 3, 2, 3, 4, 3, 4, 5]

### Iter.Impl.count/1 (function)

Consumes the iterable, returning the number of elements within

### Examples - Iter.Impl.count/1 (function)

iex> Impl.count([])
    0

    iex> Impl.count([1,2,3])
    3

### Iter.Impl.count/2 (function)

Consumes the iterable, returning the number of elements for which `fun` returns a truthy value.

### Example - Iter.Impl.count/2 (function)

iex> 1..5
    ...> |> Impl.count(&(rem(&1, 2) == 0))
    2

### Iter.Impl.cycle/1 (function)

Creates an iterator that cycles it's elements eternally.

### Example - Iter.Impl.cycle/1 (function)

iex> Impl.cycle(1..3)
    ...> |> Impl.take_head(5)
    ...> |> Impl.to_list()
    [1, 2, 3, 1, 2]

### Iter.Impl.dedup/1 (function)

Creates an iterable that only emits elements if they are different from the previous element.

### Example - Iter.Impl.dedup/1 (function)

iex> Impl.dedup([:a, :a, :b, :c, :b, :c, :c, :d])
    ...> |> Impl.to_list()
    [:a, :b, :c, :b, :c, :d]

### Iter.Impl.dedup_by/2 (function)

Creates an iterable that only emits elements if they are different from the previous element.

The function `fun` maps every element to a term which is used to determine if two elements are duplicates.

### Example - Iter.Impl.dedup_by/2 (function)

iex> [{1, :a}, {2, :b}, {2, :c}, {1, :a}]
    ...> |> Impl.dedup_by(&elem(&1, 0))
    ...> |> Impl.to_list()
    [{1, :a}, {2, :b}, {1, :a}]

### Iter.Impl.drop/2 (function)

Creates an iterable which drops the first `how_many` elements.

### Examples - Iter.Impl.drop/2 (function)

iex> Impl.drop([1, 2, 3], 2)
    ...> |> Impl.to_list()
    [3]

    iex> Impl.drop([1, 2, 3], 0)
    ...> |> Impl.to_list()
    [1, 2, 3]

    iex> Impl.drop([1, 2, 3], -2)
    ...> |> Impl.to_list()
    [1]

### Iter.Impl.drop_every/2 (function)

Returns a new iterable with every `nth` element in the `iterable` dropped,
starting with the first element.

### Examples - Iter.Impl.drop_every/2 (function)

iex> 1..10
    ...> |> Impl.drop_every(2)
    ...> |> Impl.to_list()
    [2, 4, 6, 8, 10]

    iex> 1..12
    ...> |> Impl.drop_every(3)
    ...> |> Impl.to_list()
    [2, 3, 5, 6, 8, 9, 11, 12]

    iex> 1..10
    ...> |> Impl.drop_every(0)
    ...> |> Impl.to_list()
    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

    iex> [1, 2, 3]
    ...> |> Impl.drop_every(1)
    ...> |> Impl.to_list()
    []

### Iter.Impl.drop_while/2 (function)

Drops elements at the beginning of `iterable` while fun returns a truthy
value.

### Example - Iter.Impl.drop_while/2 (function)

iex> [1, 2, 3, 2, 1]
    ...> |> Impl.drop_while(&(&1 < 3))
    ...> |> Impl.to_list()
    [3, 2, 1]

### Iter.Impl.each/2 (function)

Consumes the iterable and applies `fun` to each element.

Primarily used for side-effects.

Always returns `:done`.

### Example - Iter.Impl.each/2 (function)

```elixir
Impl.each([1, 2, 3], &IO.puts("#{&1}"))
"1"
"2"
"3"
#=> :done
```

### Iter.Impl.empty?/1 (function)

Determines if the iterable is empty.

### Example - Iter.Impl.empty?/1 (function)

iex> Impl.empty?([])
    true

    iex> Impl.empty?(1..20)
    false

### Iter.Impl.filter/2 (function)

Creates an iterable which drops elements for which `predicate` doesn't return true.

### Example - Iter.Impl.filter/2 (function)

iex> Impl.filter([1, 2, 3, 4], &(rem(&1, 2) == 1))
    ...> |> Impl.to_list()
    [1, 3]

### Iter.Impl.find/2 (function)

Searches for the first element in the iterable which matches `predicate`.

### Example - Iter.Impl.find/2 (function)

iex> Impl.find([1, 2, 3, 4], &(&1 > 2))
    {:ok, 3, [4]}

    iex> Impl.find([1, 2, 3, 4], &(&1 > 4))
    :done

### Iter.Impl.find_index/2 (function)

Returns the index of the first element in the iterable which matches `predicate`.

### Examples - Iter.Impl.find_index/2 (function)

iex> Impl.find_index([1, 2, 3, 4], &(&1 > 2))
    {:ok, 2, [4]}

    iex> Impl.find_index([1, 2, 3, 4], &(&1 > 4))
    :done

### Iter.Impl.find_value/2 (function)

Returns the first truthy value returned by `fun`.

### Example - Iter.Impl.find_value/2 (function)

iex> Impl.find_value([1, 2, 3, 4], fn
    ...>   i when i > 2 -> i * 2
    ...>   _ -> nil
    ...> end)
    {:ok, 6, [4]}

### Iter.Impl.flat_map/2 (function)

Creates an iterable which works like `map/2` but flattens nested iterables.

### Example - Iter.Impl.flat_map/2 (function)

iex> [:a, :b, :c]
    ...> |> Impl.flat_map(&[&1, &1])
    ...> |> Impl.to_list()
    [:a, :a, :b, :b, :c, :c]

### Iter.Impl.flatten/1 (function)

Creates an iterable which flattens nested iterables.

### Example - Iter.Impl.flatten/1 (function)

iex> Impl.flatten([[1, 2], [3, [4, [5, 6]]]])
    ...> |> Impl.to_list()
    [1, 2, 3, 4, 5, 6]

### Iter.Impl.intersperse/2 (function)

Creates a new iterable which places `separator` between adjacent items of the original iterable.

### Example - Iter.Impl.intersperse/2 (function)

iex> Impl.intersperse([:a, :b, :c], :wat)
    ...> |> Impl.to_list()
    [:a, :wat, :b, :wat, :c]

### Iter.Impl.map/2 (function)

Creates a new iterable which applies `mapper` to each element and using it's
result as the new element value.

### Example - Iter.Impl.map/2 (function)

iex> Impl.map([1, 2, 3], &(&1 * &1))
    ...> |> Impl.to_list()
    [1, 4, 9]

### Iter.Impl.map_every/3 (function)

Creates a new iterable which applies `mapper` on every `nth` element of the
iterable, starting with the first element.

The first element is always mapped unless `nth` is `0`.

### Examples - Iter.Impl.map_every/3 (function)

iex> Impl.map_every(1..10, 2, fn x -> x + 1000 end)
    ...> |> Impl.to_list()
    [1001, 2, 1003, 4, 1005, 6, 1007, 8, 1009, 10]

    iex> Impl.map_every(1..10, 3, fn x -> x + 1000 end)
    ...> |> Impl.to_list()
    [1001, 2, 3, 1004, 5, 6, 1007, 8, 9, 1010]

    iex> Impl.map_every(1..5, 0, fn x -> x + 1000 end)
    ...> |> Impl.to_list()
    [1, 2, 3, 4, 5]

    iex> Impl.map_every([1, 2, 3], 1, fn x -> x + 1000 end)
    ...> |> Impl.to_list()
    [1001, 1002, 1003]

### Iter.Impl.max/2 (function)

Returns the maximal element in the `iterable` according to Erlang's term ordering.

### Examples - Iter.Impl.max/2 (function)

iex> Impl.max([1, 3, 2], &>=/2)
    {:ok, 3}

    iex> Impl.max([], &>=/2)
    :done

### Iter.Impl.max_by/3 (function)

Returns the maximal element in the `iterable` as calculated by `mapper`.

### Example - Iter.Impl.max_by/3 (function)

iex> Impl.max_by(["a", "aa", "aaa"], &String.length/1, &>=/2)
    {:ok, "aaa"}

    iex> Impl.max_by([], &String.length/1, &>=/2)
    :done

### Iter.Impl.member?/2 (function)

Is the element a member of the iterable?

### Iter.Impl.min/2 (function)

Returns the minimal element in the `iterable` according to Erlang's term ordering.

### Examples - Iter.Impl.min/2 (function)

iex> Impl.min([1, 3, 2], &<=/2)
    {:ok, 1}

    iex> Impl.min([], &<=/2)
    :done

### Iter.Impl.min_by/3 (function)

Returns the minimal element in the `iterable` as calculated by `mapper`.

### Example - Iter.Impl.min_by/3 (function)

iex> Impl.min_by(["a", "aa", "aaa"], &String.length/1, &<=/2)
    {:ok, "a"}

    iex> Impl.min_by([], &String.length/1, &<=/2)
    :done

### Iter.Impl.min_max/1 (function)

Finds the minimal and maximal elements in the iterable.

### Example - Iter.Impl.min_max/1 (function)

iex> Impl.min_max(1..12)
    {:ok, 1, 12}

    iex> Impl.min_max([])
    :done

### Iter.Impl.peek/1 (function)

Peeks at the first element of the iterable, without consuming it.

> #### Warning {: .warning}
> Many iterables cannot be peeked, so this function simulates peeking by
> consuming an element from the iterable and returning a new iterable which
> pushes that element back on to the front.

### Example - Iter.Impl.peek/1 (function)

iex> {:ok, :a, iterable} = Impl.peek([:a, :b, :c])
    ...> Impl.to_list(iterable)
    [:a, :b, :c]

### Iter.Impl.peek/2 (function)

Peeks at the first `how_many` elements of the iterable, without consuming them.

> #### Warning {: .warning}
> Many iterables cannot be peeked, so this function simulates peeking by
> consuming elements from the iterable and returning a new iterable which
> pushes those elements back on to the front.

### Example - Iter.Impl.peek/2 (function)

iex> {:ok, [:a, :b, :c], 3, iterable} = Impl.peek([:a, :b, :c, :d], 3)
    ...> Impl.to_list(iterable)
    [:a, :b, :c, :d]

### Iter.Impl.prepend/2 (function)

Creates a new iterable which places `element` at the beginning of the iterable.

### Example - Iter.Impl.prepend/2 (function)

iex> 1..5
    ...> |> Impl.prepend(6)
    ...> |> Impl.to_list()
    [6, 1, 2, 3, 4, 5]

### Iter.Impl.step_by/2 (function)

Creates an iterable starting at the same point, but stepping by `how_many` each iteration.

### Example - Iter.Impl.step_by/2 (function)

iex> [0, 1, 2, 3, 4, 5]
    ...> |> Impl.step_by(2)
    ...> |> Impl.to_list()
    [0, 2, 4]

### Iter.Impl.take_chunk/2 (function)

Collects the first `how_many` elements into a new iterable and returns it
along with the advanced initial iterable.

This is very much like `take/2` except that it returns the remaining iterable
so that it can be called repeatedly.

### Example - Iter.Impl.take_chunk/2 (function)

iex> iter = 1..9
    ...> {:ok, [1, 2, 3], iter} = Impl.take_chunk(iter, 3)
    ...> {:ok, [4, 5, 6], iter} = Impl.take_chunk(iter, 3)
    ...> Impl.to_list(iter)
    [7, 8, 9]

### Iter.Impl.take_head/2 (function)

Creates an iterable which takes the first `how_many` elements.

### Example - Iter.Impl.take_head/2 (function)

iex> Impl.take_head(1..5, 0)
    ...> |> Impl.to_list()
    []

    iex> Impl.take_head(1..5, 3)
    ...> |> Impl.to_list()
    [1, 2, 3]

### Iter.Impl.take_tail/2 (function)

Creates an iterable which takes the last `how_many` elements.

### Example - Iter.Impl.take_tail/2 (function)

iex> Impl.take_tail(1..5, 0)
    ...> |> Impl.to_list()
    []

    iex> Impl.take_tail(1..5, 3)
    ...> |> Impl.to_list()
    [3, 4, 5]

### Iter.Impl.take_while/2 (function)

Creates an iterable which emits elements until `predicate` returns `false`.

### Example - Iter.Impl.take_while/2 (function)

iex> [1, 2, 3]
    ...> |> Impl.take_while(&(&1 < 3))
    ...> |> Impl.to_list()
    [1, 2]

### Iter.Impl.to_list/1 (function)

Convert the iterable into a list.

### Iter.Impl.uniq/1 (function)

Creates an iterable that only emits unique elements.

### Example - Iter.Impl.uniq/1 (function)

iex> Impl.uniq([:a, :a, :b, :c, :b, :c, :c, :d])
    ...> |> Impl.to_list()
    [:a, :b, :c, :d]

### Iter.Impl.with_index/1 (function)

Creates an iterable which emits the current iteration count as well as the
next value.

This is analogous to `Enum.with_index/1` except that counting starts from the
beginning of the iterable, meaning you can convert an iterable into an
enumerator after consuming some if it.

### Examples - Iter.Impl.with_index/1 (function)

iex> Impl.with_index([:a, :b, :c])
  ...> |> Impl.to_list()
  [a: 0, b: 1, c: 2]

   iex> [:a, :b, :c, :d]
   ...> |> Impl.drop(2)
   ...> |> Impl.with_index()
   ...> |> Impl.to_list()
   [c: 0, d: 1]

### Iter.Impl.zip/2 (function)

Zips corresponding elements from a finite collection of iterables into one iterable of results as computed by `zipper`.

### Example - Iter.Impl.zip/2 (function)

iex> Impl.zip([1..3, 4..6, 7..9], &List.to_tuple/1)
  ...> |> Impl.to_list()
  [{1, 4, 7}, {2, 5, 8}, {3, 6, 9}]

### Iter.Impl.element/0 (type)



### Iter.Impl.iterable/0 (type)



### Iter.Impl.predicate/0 (type)



### Iter.IntoIterable (protocol)

A protocol for converting a value into an iterable.

Required by `Iter.from/1` and others.

By default this protocol is implemented for `List`, `Map`, `MapSet`, `Range`,
`Date.Range`, `File.Stream` and `IO.Stream` as well as all iterex's internal
types.

Allows the data and the iterable for that data to be separate.  It could be as
simple as a reference to some external data source and a position marker or it
may be more efficient to read data in batches and iterate it.  Regardless,
most types simply return themselves from this function.

It is important that your `into_iterable/1` callback must not actually start
iterating, it simply returns a data structure suitable to track the iteration
of the underlying data.

### Iter.IntoIterable.into_iterable/1 (function)

Convert a value into an iterable.

### Iter.IntoIterable.t/0 (type)

All the types that implement this protocol.

### Iter.Iterable (protocol)

This is the main iterable protocol.

It is intentionally huge, however rte only function you have to implement is
`next/1`, for the remainder you can rely on the default implementations from
`Iter.Impl` unless your data structure can provide a more
efficient method of generating the correct answer.

### Iter.Iterable.all?/2 (function)

Tests if every element in the iterable matches `predicate`.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.any?/2 (function)

Tests if any element in the iterable matches `predicate`.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.append/2 (function)

Append an element onto the end of the iterable.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.at/2 (function)

Returns the element `index` items from the beginning of the iterator.

Note that all preceding elements, as well as the returned element, will be consumed from the iterable.

### Return values - Iter.Iterable.at/2 (function)

- `{:ok, element, new_iterable}` - the next element and an updated iterable.
  - `:done` - the iterable was exhausted before the element was found.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.chunk_by/2 (function)

Creates an iterable that only emits elements for which `fun` returns a new
value.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.chunk_every/4 (function)

Creates an iterable that chunks into `count` size elements, where each new
chunk starts `step` elements into the enumerable.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.chunk_while/4 (function)

Creates an iterable that chunks based on a chunk function.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.concat/1 (function)

Creates an iterable that iterates each iterable in an iterable.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.count/1 (function)

Consumes the iterable, counting the number of iterations remaining.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.count/2 (function)

Consumes the iterable, counting the number of elements for which `fun` returns a truthy value.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.cycle/1 (function)

Creates an iterable that cycles it's elements eternally.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.dedup/1 (function)

Creates an iterable that only emits elements if they are different from the previous element.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.dedup_by/2 (function)

Creates an iterable that only emits elements if they are different from the previous element.

The function `fun` maps every element to a term which is used to determine if two elements are duplicates.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.drop/2 (function)

Creates an iterable which drops the first `how_many` elements.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.drop_every/2 (function)

Returns a new iterable with every `nth` element in the `iterable` dropped,
starting with the first element.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.drop_while/2 (function)

Drops elements at the beginning of the `iterable` while `predicate` returns a
truthy value.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.each/2 (function)

Consumes the iterable and applies `fun` to each element.

Primarily used for side-effects.

Always returns `:done`.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.empty?/1 (function)

Determines if the iterable is empty.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.filter/2 (function)

Creates an iterable which drops elements for which `predicate` doesn't return
a truthy value.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.find/2 (function)

Searches for the first element in the iterable which matches `predicate`.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.find_index/2 (function)

Returns the index of the first element in the iterable which matches `predicate`.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.find_value/2 (function)

Returns the first non-falsy result of `fun`.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.flat_map/2 (function)

Creates an iterable which works like `map/2` but flattens nested iterables.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.flatten/1 (function)

Creates an iterable which flattens nested iterables.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.intersperse/2 (function)

Creates a new iterable which places `separator` between adjacent items of the original iterable.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.map/2 (function)

Creates a new iterable which applies `mapper` to each element and using it's
result as the new element value.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.map_every/3 (function)

Creates a new iterable which applies `mapper` on every `nth` element of the
iterable, starting with the first element.

The first element is always mapped unless `nth` is `0`.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.max/2 (function)

Returns the maximal element in the `iterable` according to Erlang's term ordering.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.max_by/3 (function)

Returns the maximal element in the `iterable` as calculated by `mapper`.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.member?/2 (function)

Is the element a member of the iterable?

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.min/2 (function)

Returns the minimal element in the `iterable` according to Erlang's term ordering.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.min_by/3 (function)

Returns the minimal element in the `iterable` as calculated by `mapper`.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.min_max/1 (function)

Return the minimal and maximal element of the iterable.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.next/1 (function)

Advance the iterable and return the next value.

This is the only required callback in the `Iterable` protocol.

### Return values - Iter.Iterable.next/1 (function)

- `{:ok, element, new_iterable}` - returns the next element and an updated iterable.
  - `:done` - the iterable is exhausted.

### Iter.Iterable.peek/1 (function)

Peeks at the first element of the iterable, without consuming it.

### Return values - Iter.Iterable.peek/1 (function)

- `{:ok, element, new_iterable}` - the next element and an updated iterable.
  - `:done` - the iterable is exhausted.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.peek/2 (function)

Peeks at the first n elements of the iterable, without consuming it.

### Return values - Iter.Iterable.peek/2 (function)

- `{:ok, [element], how_many, new_iterable}` - the peekable elements and an
    updated iterable.  Note that `how_many` may not be the same as you asked
    for if the underlying iterable is exhausted.
  - `:done` - the iterable is exhausted.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.prepend/2 (function)

Creates an iterable which prepends an element to the beginning of another
iterable.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.step_by/2 (function)

Creates an iterable starting at the same point, but stepping by `step_size` each iteration.

The first element of the iterable will always be returned, regardless of the step given.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.take_chunk/2 (function)

Collects `how_many` elements into a chunk and returns it as well as the
remaining iterable.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.take_head/2 (function)

Creates an iterable which takes the first `how_many` elements.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.take_tail/2 (function)

Creates an iterable which takes the last `how_many` elements.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.take_while/2 (function)

Creates an iterable which emits elements until `predicate` returns `false`.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.to_list/1 (function)

Convert the iterable into a list.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.uniq/1 (function)

Creates an iterable that returns only unique elements.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.with_index/1 (function)

Creates an iterable which emits the current iteration count as well as the next value.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.zip/2 (function)

Zips corresponding elements from a number of iterables into an iterable of
results as computed by `zipper`.

> #### Optional callback {: .tip}
> A default implementation of this function exists in the `Iter.Impl` module.
>
> You can add it to your protocol implementation by adding `use Iter.Impl`.

### Iter.Iterable.element/0 (type)



### Iter.Iterable.mapper/0 (type)



### Iter.Iterable.predicate/0 (type)



### Iter.Iterable.t/0 (type)



### Iter.Iterable.Appender (module)

An iterable which appends a single element to the end of another iterable.

### Iter.Iterable.Appender.new/2 (function)

Create a new appender iterable.

### Iter.Iterable.Appender.t/0 (type)



### Iter.Iterable.ByChunker (module)

An iterable that chunks elements by subsequent return values of `fun`.

### Iter.Iterable.ByChunker.new/2 (function)

Creates an iterable that chunks elements by subsequent return values of `fun`.

### Iter.Iterable.ByChunker.t/0 (type)



### Iter.Iterable.Concatenator (module)

An iterable which can concatenate a number of iterables.

### Iter.Iterable.Concatenator.new/1 (function)

Create a new concatenator out of an iterable of iterables.

### Iter.Iterable.Concatenator.t/0 (type)



### Iter.Iterable.Cycler (module)

An iterable which emits elements for ever.

### Iter.Iterable.Cycler.new/1 (function)

Create an eternal iterable.

### Iter.Iterable.Cycler.t/0 (type)



### Iter.Iterable.Deduper (module)

An iterable that only emits elements if they are different from the previous element.

### Iter.Iterable.Deduper.new/2 (function)

Creates an iterable that only emits elements if they are different from the previous element.

### Iter.Iterable.Deduper.t/0 (type)



### Iter.Iterable.Empty (module)

An iterable that's always exhausted

### Iter.Iterable.Empty.new/0 (function)

Creates an iterable that's always exhausted.

### Iter.Iterable.Enumerable (module)

Can we convert a enum into an iterable?  Let's find out.

### Iter.Iterable.Enumerable.child_spec/1 (function)

Returns a specification to start this module under a supervisor.

See `Supervisor`.

### Iter.Iterable.Enumerable.new/1 (function)

Wrap an enumerable in a genserver

### Iter.Iterable.Enumerable.t/0 (type)



### Iter.Iterable.EveryChunker (module)

An iterable that chunks into `count` size elements, where each new chunk
starts `step` elements into the enumerable.

### Iter.Iterable.EveryChunker.new/4 (function)

Creates an iterable that chunks into `count` size elements, where each new
chunk starts `step` elements into the enumerable.

### Iter.Iterable.EveryChunker.t/0 (type)



### Iter.Iterable.EveryDropper (module)

An iterable which drops every `nth` element from the iterable.

### Iter.Iterable.EveryDropper.new/2 (function)

Creates an iterable which drops every `nth` element from the iterable.

### Iter.Iterable.EveryDropper.t/0 (type)



### Iter.Iterable.EveryMapper (module)

An iterable which maps every `nth` element in the iterable.

### Iter.Iterable.EveryMapper.new/3 (function)

Creates a new iterable which maps every `nth` element in the iterable.

### Iter.Iterable.EveryMapper.t/0 (type)



### Iter.Iterable.Filterer (module)

An iterable which drops elements for which `predicate` doesn't return a truthy value.

### Iter.Iterable.Filterer.new/2 (function)

Create a new filter iterable.

### Iter.Iterable.Filterer.t/0 (type)



### Iter.Iterable.FlatMapper (module)

An iterable which works like `map/2` but flattens nested iterables.

### Iter.Iterable.FlatMapper.new/2 (function)

Creates an iterable which works like `map/2` but flattens nested iterables.

### Iter.Iterable.FlatMapper.mapper/0 (type)



### Iter.Iterable.FlatMapper.t/0 (type)



### Iter.Iterable.Flattener (module)

An iterable which flattens nested iterables.

### Iter.Iterable.Flattener.new/1 (function)

Creates an iterable which flattens nested iterables.

### Iter.Iterable.Flattener.t/0 (type)



### Iter.Iterable.HeadDropper (module)

An iterable which drops the first `how_many` elements.

### Iter.Iterable.HeadDropper.new/2 (function)

Creates an iterable which drops the first `how_many` elements.

### Iter.Iterable.HeadDropper.t/0 (type)



### Iter.Iterable.HeadTaker (module)

An iterable which takes the first `how_many` elements.

### Iter.Iterable.HeadTaker.new/2 (function)

Creates an iterable which takes the first `how_many` elements.

### Iter.Iterable.HeadTaker.t/0 (type)



### Iter.Iterable.Intersperser (module)

An iterable which places a separator value in between consecutive elements.

### Iter.Iterable.Intersperser.new/2 (function)

Create a new intersperser iterable out of an iterable and a separator

### Iter.Iterable.Intersperser.t/0 (type)



### Iter.Iterable.Map (module)

A wrapper around Erlang's `:maps.iterator`.

### Iter.Iterable.Map.new/1 (function)

Convert a map into a map iterable.

### Iter.Iterable.Map.t/0 (type)



### Iter.Iterable.Mapper (module)

An iterable which applies a mapper function to all it's elements and returns their new values.

### Iter.Iterable.Mapper.new/2 (function)

Create a new map iterable.

### Iter.Iterable.Mapper.t/0 (type)



### Iter.Iterable.Peeker (module)

The result of "peeking" into an iterable.

### Iter.Iterable.Peeker.new/1 (function)

Create a new "peeker" iterable.

### Iter.Iterable.Peeker.t/0 (type)



### Iter.Iterable.Prepender (module)

An iterable which prepends a single element to the end of another iterable.

### Iter.Iterable.Prepender.new/2 (function)

Create a new prepender iterable.

### Iter.Iterable.Prepender.t/0 (type)



### Iter.Iterable.Resource (module)

An iterable which provides compatibility with `Stream.resource/3`

### Iter.Iterable.Resource.new/3 (function)

Create an iterable from functions in a manner compatible with `Stream.resource/3`.

### Iter.Iterable.Resource.acc/0 (type)



### Iter.Iterable.Resource.after_fun/0 (type)



### Iter.Iterable.Resource.next_fun/0 (type)



### Iter.Iterable.Resource.start_fun/0 (type)



### Iter.Iterable.Resource.t/0 (type)



### Iter.Iterable.Stepper (module)

An iterable which advances it's internal iterable by a specific amount each time.

### Iter.Iterable.Stepper.new/2 (function)

Create a new iterable which wraps another iterable.

### Iter.Iterable.Stepper.t/0 (type)



### Iter.Iterable.TailDropper (module)

An iterable which drops the last `how_many` elements.

### Iter.Iterable.TailDropper.new/2 (function)

Creates an iterable which drops the last `how_many` elements.

### Iter.Iterable.TailDropper.t/0 (type)



### Iter.Iterable.TailTaker (module)

An iterable which takes `how_many` elements from the end of the iterable.

### Iter.Iterable.TailTaker.new/2 (function)

Creates an iterable which takes `how_many` elements from the end of the iterable.

### Iter.Iterable.TailTaker.t/0 (type)



### Iter.Iterable.Uniquer (module)

An iterable that only emits unique elements.

### Iter.Iterable.Uniquer.new/1 (function)

Creates an iterable that only emits unique elements.

### Iter.Iterable.Uniquer.t/0 (type)



### Iter.Iterable.WhileChunker (module)

An iterable that chunks based on a chunk function.

### Iter.Iterable.WhileChunker.new/4 (function)

Creates an iterable that chunks based on a chunk function.

### Iter.Iterable.WhileChunker.acc/0 (type)



### Iter.Iterable.WhileChunker.chunk/0 (type)



### Iter.Iterable.WhileChunker.t/0 (type)



### Iter.Iterable.WhileDropper (module)

An iterable that drops elements until `predicate` returns a truthy value.

### Iter.Iterable.WhileDropper.new/2 (function)

Creates an iterable that drops elements until `predicate` returns a truthy
value.

### Iter.Iterable.WhileDropper.t/0 (type)



### Iter.Iterable.WhileTaker (module)

An iterable which emits elements until `predicate` returns `false`.

### Iter.Iterable.WhileTaker.new/2 (function)

Creates an iterable which emits elements until `predicate` returns `false`.

### Iter.Iterable.WhileTaker.t/0 (type)



### Iter.Iterable.WithIndexer (module)

Creates an iterator which emits the current iteration count as well as the next value.

### Iter.Iterable.WithIndexer.new/1 (function)

Create a new filter iterable.

### Iter.Iterable.WithIndexer.t/0 (type)



### Iter.Iterable.Zipper (module)

An iterable which returns the elements of two iterables as tuple pairs.

### Iter.Iterable.Zipper.new/2 (function)

Create a new zip out of two iterables.

### Iter.Iterable.Zipper.t/0 (type)



## Links

- [Online documentation](https://hexdocs.pm/iterex)